import{S as ho,i as po,s as go,N as ow,O as sw,a as Lt,d as De,P as md,g as At,z as aw,C as yd,E as uo,Q as Cg,R as ly,T as iS,J as Ca,K as Pa,L as Na,q as Le,o as Je,I as Oa,e as Pt,k as en,c as Nt,m as tn,b as it,U as In,M as Me,V as Co,n as Po,p as No,W as Pg,X as ba,w as Cn,x as Pn,y as Nn,B as On,t as mn,h as yn,j as ki,Y as vc,G as Ng,Z as uy,l as Oo,_ as Ep,$ as dy,a0 as fy,a1 as oS,a2 as sS,v as cw}from"../chunks/index-87b49e04.js";import{d as lw,w as uw,_ as aS}from"../chunks/preload-helper-b46aab21.js";function cS(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}class T extends Array{constructor(e,n){if(super(e),this.sign=n,Object.setPrototypeOf(this,T.prototype),e>T.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded")}static BigInt(e){var n=Math.floor,r=Number.isFinite;if(typeof e=="number"){if(e===0)return T.__zero();if(T.__isOneDigitInt(e))return 0>e?T.__oneDigit(-e,!0):T.__oneDigit(e,!1);if(!r(e)||n(e)!==e)throw new RangeError("The number "+e+" cannot be converted to BigInt because it is not an integer");return T.__fromDouble(e)}if(typeof e=="string"){const i=T.__fromString(e);if(i===null)throw new SyntaxError("Cannot convert "+e+" to a BigInt");return i}if(typeof e=="boolean")return e===!0?T.__oneDigit(1,!1):T.__zero();if(typeof e=="object"){if(e.constructor===T)return e;const i=T.__toPrimitive(e);return T.BigInt(i)}throw new TypeError("Cannot convert "+e+" to a BigInt")}toDebugString(){const e=["BigInt["];for(const n of this)e.push((n&&(n>>>0).toString(16))+", ");return e.push("]"),e.join("")}toString(e=10){if(2>e||36<e)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(e&e-1)==0?T.__toStringBasePowerOfTwo(this,e):T.__toStringGeneric(this,e,!1)}valueOf(){throw new Error("Convert JSBI instances to native numbers using `toNumber`.")}static toNumber(e){const n=e.length;if(n===0)return 0;if(n===1){const E=e.__unsignedDigit(0);return e.sign?-E:E}const r=e.__digit(n-1),i=T.__clz30(r),o=30*n-i;if(1024<o)return e.sign?-1/0:1/0;let s=o-1,a=r,c=n-1;const l=i+3;let u=l===32?0:a<<l;u>>>=12;const d=l-12;let g=12<=l?0:a<<20+l,p=20+l;for(0<d&&0<c&&(c--,a=e.__digit(c),u|=a>>>30-d,g=a<<d+2,p=d+2);0<p&&0<c;)c--,a=e.__digit(c),g|=30<=p?a<<p-30:a>>>30-p,p-=30;const y=T.__decideRounding(e,p,c,a);if((y===1||y===0&&(1&g)==1)&&(g=g+1>>>0,g===0&&(u++,u>>>20!=0&&(u=0,s++,1023<s))))return e.sign?-1/0:1/0;const w=e.sign?-2147483648:0;return s=s+1023<<20,T.__kBitConversionInts[1]=w|s|u,T.__kBitConversionInts[0]=g,T.__kBitConversionDouble[0]}static unaryMinus(e){if(e.length===0)return e;const n=e.__copy();return n.sign=!e.sign,n}static bitwiseNot(e){return e.sign?T.__absoluteSubOne(e).__trim():T.__absoluteAddOne(e,!0)}static exponentiate(e,n){if(n.sign)throw new RangeError("Exponent must be positive");if(n.length===0)return T.__oneDigit(1,!1);if(e.length===0)return e;if(e.length===1&&e.__digit(0)===1)return e.sign&&(1&n.__digit(0))==0?T.unaryMinus(e):e;if(1<n.length)throw new RangeError("BigInt too big");let r=n.__unsignedDigit(0);if(r===1)return e;if(r>=T.__kMaxLengthBits)throw new RangeError("BigInt too big");if(e.length===1&&e.__digit(0)===2){const s=1+(0|r/30),a=e.sign&&(1&r)!=0,c=new T(s,a);c.__initializeDigits();const l=1<<r%30;return c.__setDigit(s-1,l),c}let i=null,o=e;for((1&r)!=0&&(i=e),r>>=1;r!==0;r>>=1)o=T.multiply(o,o),(1&r)!=0&&(i===null?i=o:i=T.multiply(i,o));return i}static multiply(e,n){if(e.length===0)return e;if(n.length===0)return n;let r=e.length+n.length;30<=e.__clzmsd()+n.__clzmsd()&&r--;const i=new T(r,e.sign!==n.sign);i.__initializeDigits();for(let o=0;o<e.length;o++)T.__multiplyAccumulate(n,e.__digit(o),i,o);return i.__trim()}static divide(e,n){if(n.length===0)throw new RangeError("Division by zero");if(0>T.__absoluteCompare(e,n))return T.__zero();const r=e.sign!==n.sign,i=n.__unsignedDigit(0);let o;if(n.length===1&&32767>=i){if(i===1)return r===e.sign?e:T.unaryMinus(e);o=T.__absoluteDivSmall(e,i,null)}else o=T.__absoluteDivLarge(e,n,!0,!1);return o.sign=r,o.__trim()}static remainder(e,n){if(n.length===0)throw new RangeError("Division by zero");if(0>T.__absoluteCompare(e,n))return e;const r=n.__unsignedDigit(0);if(n.length===1&&32767>=r){if(r===1)return T.__zero();const o=T.__absoluteModSmall(e,r);return o===0?T.__zero():T.__oneDigit(o,e.sign)}const i=T.__absoluteDivLarge(e,n,!1,!0);return i.sign=e.sign,i.__trim()}static add(e,n){const r=e.sign;return r===n.sign?T.__absoluteAdd(e,n,r):0<=T.__absoluteCompare(e,n)?T.__absoluteSub(e,n,r):T.__absoluteSub(n,e,!r)}static subtract(e,n){const r=e.sign;return r===n.sign?0<=T.__absoluteCompare(e,n)?T.__absoluteSub(e,n,r):T.__absoluteSub(n,e,!r):T.__absoluteAdd(e,n,r)}static leftShift(e,n){return n.length===0||e.length===0?e:n.sign?T.__rightShiftByAbsolute(e,n):T.__leftShiftByAbsolute(e,n)}static signedRightShift(e,n){return n.length===0||e.length===0?e:n.sign?T.__leftShiftByAbsolute(e,n):T.__rightShiftByAbsolute(e,n)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(e,n){return 0>T.__compareToBigInt(e,n)}static lessThanOrEqual(e,n){return 0>=T.__compareToBigInt(e,n)}static greaterThan(e,n){return 0<T.__compareToBigInt(e,n)}static greaterThanOrEqual(e,n){return 0<=T.__compareToBigInt(e,n)}static equal(e,n){if(e.sign!==n.sign||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e.__digit(r)!==n.__digit(r))return!1;return!0}static notEqual(e,n){return!T.equal(e,n)}static bitwiseAnd(e,n){var r=Math.max;if(!e.sign&&!n.sign)return T.__absoluteAnd(e,n).__trim();if(e.sign&&n.sign){const i=r(e.length,n.length)+1;let o=T.__absoluteSubOne(e,i);const s=T.__absoluteSubOne(n);return o=T.__absoluteOr(o,s,o),T.__absoluteAddOne(o,!0,o).__trim()}return e.sign&&([e,n]=[n,e]),T.__absoluteAndNot(e,T.__absoluteSubOne(n)).__trim()}static bitwiseXor(e,n){var r=Math.max;if(!e.sign&&!n.sign)return T.__absoluteXor(e,n).__trim();if(e.sign&&n.sign){const s=r(e.length,n.length),a=T.__absoluteSubOne(e,s),c=T.__absoluteSubOne(n);return T.__absoluteXor(a,c,a).__trim()}const i=r(e.length,n.length)+1;e.sign&&([e,n]=[n,e]);let o=T.__absoluteSubOne(n,i);return o=T.__absoluteXor(o,e,o),T.__absoluteAddOne(o,!0,o).__trim()}static bitwiseOr(e,n){var r=Math.max;const i=r(e.length,n.length);if(!e.sign&&!n.sign)return T.__absoluteOr(e,n).__trim();if(e.sign&&n.sign){let s=T.__absoluteSubOne(e,i);const a=T.__absoluteSubOne(n);return s=T.__absoluteAnd(s,a,s),T.__absoluteAddOne(s,!0,s).__trim()}e.sign&&([e,n]=[n,e]);let o=T.__absoluteSubOne(n,i);return o=T.__absoluteAndNot(o,e,o),T.__absoluteAddOne(o,!0,o).__trim()}static asIntN(e,n){var r=Math.floor;if(n.length===0)return n;if(e=r(e),0>e)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(e===0)return T.__zero();if(e>=T.__kMaxLengthBits)return n;const i=0|(e+29)/30;if(n.length<i)return n;const o=n.__unsignedDigit(i-1),s=1<<(e-1)%30;if(n.length===i&&o<s)return n;if((o&s)!==s)return T.__truncateToNBits(e,n);if(!n.sign)return T.__truncateAndSubFromPowerOfTwo(e,n,!0);if((o&s-1)==0){for(let a=i-2;0<=a;a--)if(n.__digit(a)!==0)return T.__truncateAndSubFromPowerOfTwo(e,n,!1);return n.length===i&&o===s?n:T.__truncateToNBits(e,n)}return T.__truncateAndSubFromPowerOfTwo(e,n,!1)}static asUintN(e,n){var r=Math.floor;if(n.length===0)return n;if(e=r(e),0>e)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(e===0)return T.__zero();if(n.sign){if(e>T.__kMaxLengthBits)throw new RangeError("BigInt too big");return T.__truncateAndSubFromPowerOfTwo(e,n,!1)}if(e>=T.__kMaxLengthBits)return n;const i=0|(e+29)/30;if(n.length<i)return n;const o=e%30;return n.length==i&&(o===0||n.__digit(i-1)>>>o==0)?n:T.__truncateToNBits(e,n)}static ADD(e,n){if(e=T.__toPrimitive(e),n=T.__toPrimitive(n),typeof e=="string")return typeof n!="string"&&(n=n.toString()),e+n;if(typeof n=="string")return e.toString()+n;if(e=T.__toNumeric(e),n=T.__toNumeric(n),T.__isBigInt(e)&&T.__isBigInt(n))return T.add(e,n);if(typeof e=="number"&&typeof n=="number")return e+n;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(e,n){return T.__compare(e,n,0)}static LE(e,n){return T.__compare(e,n,1)}static GT(e,n){return T.__compare(e,n,2)}static GE(e,n){return T.__compare(e,n,3)}static EQ(e,n){for(;;){if(T.__isBigInt(e))return T.__isBigInt(n)?T.equal(e,n):T.EQ(n,e);if(typeof e=="number"){if(T.__isBigInt(n))return T.__equalToNumber(n,e);if(typeof n!="object")return e==n;n=T.__toPrimitive(n)}else if(typeof e=="string"){if(T.__isBigInt(n))return e=T.__fromString(e),e!==null&&T.equal(e,n);if(typeof n!="object")return e==n;n=T.__toPrimitive(n)}else if(typeof e=="boolean"){if(T.__isBigInt(n))return T.__equalToNumber(n,+e);if(typeof n!="object")return e==n;n=T.__toPrimitive(n)}else if(typeof e=="symbol"){if(T.__isBigInt(n))return!1;if(typeof n!="object")return e==n;n=T.__toPrimitive(n)}else if(typeof e=="object"){if(typeof n=="object"&&n.constructor!==T)return e==n;e=T.__toPrimitive(e)}else return e==n}}static NE(e,n){return!T.EQ(e,n)}static DataViewGetBigInt64(e,n,r=!1){return T.asIntN(64,T.DataViewGetBigUint64(e,n,r))}static DataViewGetBigUint64(e,n,r=!1){const[i,o]=r?[4,0]:[0,4],s=e.getUint32(n+i,r),a=e.getUint32(n+o,r),c=new T(3,!1);return c.__setDigit(0,1073741823&a),c.__setDigit(1,(268435455&s)<<2|a>>>30),c.__setDigit(2,s>>>28),c.__trim()}static DataViewSetBigInt64(e,n,r,i=!1){T.DataViewSetBigUint64(e,n,r,i)}static DataViewSetBigUint64(e,n,r,i=!1){r=T.asUintN(64,r);let o=0,s=0;if(0<r.length&&(s=r.__digit(0),1<r.length)){const l=r.__digit(1);s|=l<<30,o=l>>>2,2<r.length&&(o|=r.__digit(2)<<28)}const[a,c]=i?[4,0]:[0,4];e.setUint32(n+a,o,i),e.setUint32(n+c,s,i)}static __zero(){return new T(0,!1)}static __oneDigit(e,n){const r=new T(1,n);return r.__setDigit(0,e),r}__copy(){const e=new T(this.length,this.sign);for(let n=0;n<this.length;n++)e[n]=this[n];return e}__trim(){let e=this.length,n=this[e-1];for(;n===0;)e--,n=this[e-1],this.pop();return e===0&&(this.sign=!1),this}__initializeDigits(){for(let e=0;e<this.length;e++)this[e]=0}static __decideRounding(e,n,r,i){if(0<n)return-1;let o;if(0>n)o=-n-1;else{if(r===0)return-1;r--,i=e.__digit(r),o=29}let s=1<<o;if((i&s)==0)return-1;if(s-=1,(i&s)!=0)return 1;for(;0<r;)if(r--,e.__digit(r)!==0)return 1;return 0}static __fromDouble(e){T.__kBitConversionDouble[0]=e;const n=2047&T.__kBitConversionInts[1]>>>20,r=n-1023,i=(0|r/30)+1,o=new T(i,0>e);let s=1048575&T.__kBitConversionInts[1]|1048576,a=T.__kBitConversionInts[0];const c=20,l=r%30;let u,d=0;if(l<20){const g=c-l;d=g+32,u=s>>>g,s=s<<32-g|a>>>g,a<<=32-g}else if(l===20)d=32,u=s,s=a,a=0;else{const g=l-c;d=32-g,u=s<<g|a>>>32-g,s=a<<g,a=0}o.__setDigit(i-1,u);for(let g=i-2;0<=g;g--)0<d?(d-=30,u=s>>>2,s=s<<30|a>>>2,a<<=30):u=0,o.__setDigit(g,u);return o.__trim()}static __isWhitespace(e){return 13>=e&&9<=e||(159>=e?e==32:131071>=e?e==160||e==5760:196607>=e?(e&=131071,10>=e||e==40||e==41||e==47||e==95||e==4096):e==65279)}static __fromString(e,n=0){let r=0;const i=e.length;let o=0;if(o===i)return T.__zero();let s=e.charCodeAt(o);for(;T.__isWhitespace(s);){if(++o===i)return T.__zero();s=e.charCodeAt(o)}if(s===43){if(++o===i)return null;s=e.charCodeAt(o),r=1}else if(s===45){if(++o===i)return null;s=e.charCodeAt(o),r=-1}if(n===0){if(n=10,s===48){if(++o===i)return T.__zero();if(s=e.charCodeAt(o),s===88||s===120){if(n=16,++o===i)return null;s=e.charCodeAt(o)}else if(s===79||s===111){if(n=8,++o===i)return null;s=e.charCodeAt(o)}else if(s===66||s===98){if(n=2,++o===i)return null;s=e.charCodeAt(o)}}}else if(n===16&&s===48){if(++o===i)return T.__zero();if(s=e.charCodeAt(o),s===88||s===120){if(++o===i)return null;s=e.charCodeAt(o)}}if(r!=0&&n!==10)return null;for(;s===48;){if(++o===i)return T.__zero();s=e.charCodeAt(o)}const a=i-o;let c=T.__kMaxBitsPerChar[n],l=T.__kBitsPerCharTableMultiplier-1;if(a>1073741824/c)return null;const u=c*a+l>>>T.__kBitsPerCharTableShift,d=new T(0|(u+29)/30,!1),g=10>n?n:10,p=10<n?n-10:0;if((n&n-1)==0){c>>=T.__kBitsPerCharTableShift;const y=[],w=[];let E=!1;do{let b=0,S=0;for(;;){let R;if(s-48>>>0<g)R=s-48;else if((32|s)-97>>>0<p)R=(32|s)-87;else{E=!0;break}if(S+=c,b=b<<c|R,++o===i){E=!0;break}if(s=e.charCodeAt(o),30<S+c)break}y.push(b),w.push(S)}while(!E);T.__fillFromParts(d,y,w)}else{d.__initializeDigits();let y=!1,w=0;do{let E=0,b=1;for(;;){let R;if(s-48>>>0<g)R=s-48;else if((32|s)-97>>>0<p)R=(32|s)-87;else{y=!0;break}const F=b*n;if(1073741823<F)break;if(b=F,E=E*n+R,w++,++o===i){y=!0;break}s=e.charCodeAt(o)}l=30*T.__kBitsPerCharTableMultiplier-1;const S=0|(c*w+l>>>T.__kBitsPerCharTableShift)/30;d.__inplaceMultiplyAdd(b,E,S)}while(!y)}if(o!==i){if(!T.__isWhitespace(s))return null;for(o++;o<i;o++)if(s=e.charCodeAt(o),!T.__isWhitespace(s))return null}return d.sign=r==-1,d.__trim()}static __fillFromParts(e,n,r){let i=0,o=0,s=0;for(let a=n.length-1;0<=a;a--){const c=n[a],l=r[a];o|=c<<s,s+=l,s===30?(e.__setDigit(i++,o),s=0,o=0):30<s&&(e.__setDigit(i++,1073741823&o),s-=30,o=c>>>l-s)}if(o!==0){if(i>=e.length)throw new Error("implementation bug");e.__setDigit(i++,o)}for(;i<e.length;i++)e.__setDigit(i,0)}static __toStringBasePowerOfTwo(e,n){const r=e.length;let i=n-1;i=(85&i>>>1)+(85&i),i=(51&i>>>2)+(51&i),i=(15&i>>>4)+(15&i);const o=i,s=n-1,a=e.__digit(r-1),c=T.__clz30(a);let l=0|(30*r-c+o-1)/o;if(e.sign&&l++,268435456<l)throw new Error("string too long");const u=Array(l);let d=l-1,g=0,p=0;for(let w=0;w<r-1;w++){const E=e.__digit(w),b=(g|E<<p)&s;u[d--]=T.__kConversionChars[b];const S=o-p;for(g=E>>>S,p=30-S;p>=o;)u[d--]=T.__kConversionChars[g&s],g>>>=o,p-=o}const y=(g|a<<p)&s;for(u[d--]=T.__kConversionChars[y],g=a>>>o-p;g!==0;)u[d--]=T.__kConversionChars[g&s],g>>>=o;if(e.sign&&(u[d--]="-"),d!=-1)throw new Error("implementation bug");return u.join("")}static __toStringGeneric(e,n,r){const i=e.length;if(i===0)return"";if(i===1){let w=e.__unsignedDigit(0).toString(n);return r===!1&&e.sign&&(w="-"+w),w}const o=30*i-T.__clz30(e.__digit(i-1)),s=T.__kMaxBitsPerChar[n],a=s-1;let c=o*T.__kBitsPerCharTableMultiplier;c+=a-1,c=0|c/a;const l=c+1>>1,u=T.exponentiate(T.__oneDigit(n,!1),T.__oneDigit(l,!1));let d,g;const p=u.__unsignedDigit(0);if(u.length===1&&32767>=p){d=new T(e.length,!1),d.__initializeDigits();let w=0;for(let E=2*e.length-1;0<=E;E--){const b=w<<15|e.__halfDigit(E);d.__setHalfDigit(E,0|b/p),w=0|b%p}g=w.toString(n)}else{const w=T.__absoluteDivLarge(e,u,!0,!0);d=w.quotient;const E=w.remainder.__trim();g=T.__toStringGeneric(E,n,!0)}d.__trim();let y=T.__toStringGeneric(d,n,!0);for(;g.length<l;)g="0"+g;return r===!1&&e.sign&&(y="-"+y),y+g}static __unequalSign(e){return e?-1:1}static __absoluteGreater(e){return e?-1:1}static __absoluteLess(e){return e?1:-1}static __compareToBigInt(e,n){const r=e.sign;if(r!==n.sign)return T.__unequalSign(r);const i=T.__absoluteCompare(e,n);return 0<i?T.__absoluteGreater(r):0>i?T.__absoluteLess(r):0}static __compareToNumber(e,n){if(T.__isOneDigitInt(n)){const r=e.sign,i=0>n;if(r!==i)return T.__unequalSign(r);if(e.length===0){if(i)throw new Error("implementation bug");return n===0?0:-1}if(1<e.length)return T.__absoluteGreater(r);const o=Math.abs(n),s=e.__unsignedDigit(0);return s>o?T.__absoluteGreater(r):s<o?T.__absoluteLess(r):0}return T.__compareToDouble(e,n)}static __compareToDouble(e,n){if(n!==n)return n;if(n===1/0)return-1;if(n===-1/0)return 1;const r=e.sign;if(r!==0>n)return T.__unequalSign(r);if(n===0)throw new Error("implementation bug: should be handled elsewhere");if(e.length===0)return-1;T.__kBitConversionDouble[0]=n;const i=2047&T.__kBitConversionInts[1]>>>20;if(i==2047)throw new Error("implementation bug: handled elsewhere");const o=i-1023;if(0>o)return T.__absoluteGreater(r);const s=e.length;let a=e.__digit(s-1);const c=T.__clz30(a),l=30*s-c,u=o+1;if(l<u)return T.__absoluteLess(r);if(l>u)return T.__absoluteGreater(r);let d=1048576|1048575&T.__kBitConversionInts[1],g=T.__kBitConversionInts[0];const p=20,y=29-c;if(y!==(0|(l-1)%30))throw new Error("implementation bug");let w,E=0;if(20>y){const b=p-y;E=b+32,w=d>>>b,d=d<<32-b|g>>>b,g<<=32-b}else if(y===20)E=32,w=d,d=g,g=0;else{const b=y-p;E=32-b,w=d<<b|g>>>32-b,d=g<<b,g=0}if(a>>>=0,w>>>=0,a>w)return T.__absoluteGreater(r);if(a<w)return T.__absoluteLess(r);for(let b=s-2;0<=b;b--){0<E?(E-=30,w=d>>>2,d=d<<30|g>>>2,g<<=30):w=0;const S=e.__unsignedDigit(b);if(S>w)return T.__absoluteGreater(r);if(S<w)return T.__absoluteLess(r)}if(d!==0||g!==0){if(E===0)throw new Error("implementation bug");return T.__absoluteLess(r)}return 0}static __equalToNumber(e,n){var r=Math.abs;return T.__isOneDigitInt(n)?n===0?e.length===0:e.length===1&&e.sign===0>n&&e.__unsignedDigit(0)===r(n):T.__compareToDouble(e,n)===0}static __comparisonResultToBool(e,n){return n===0?0>e:n===1?0>=e:n===2?0<e:n===3?0<=e:void 0}static __compare(e,n,r){if(e=T.__toPrimitive(e),n=T.__toPrimitive(n),typeof e=="string"&&typeof n=="string")switch(r){case 0:return e<n;case 1:return e<=n;case 2:return e>n;case 3:return e>=n}if(T.__isBigInt(e)&&typeof n=="string")return n=T.__fromString(n),n!==null&&T.__comparisonResultToBool(T.__compareToBigInt(e,n),r);if(typeof e=="string"&&T.__isBigInt(n))return e=T.__fromString(e),e!==null&&T.__comparisonResultToBool(T.__compareToBigInt(e,n),r);if(e=T.__toNumeric(e),n=T.__toNumeric(n),T.__isBigInt(e)){if(T.__isBigInt(n))return T.__comparisonResultToBool(T.__compareToBigInt(e,n),r);if(typeof n!="number")throw new Error("implementation bug");return T.__comparisonResultToBool(T.__compareToNumber(e,n),r)}if(typeof e!="number")throw new Error("implementation bug");if(T.__isBigInt(n))return T.__comparisonResultToBool(T.__compareToNumber(n,e),2^r);if(typeof n!="number")throw new Error("implementation bug");return r===0?e<n:r===1?e<=n:r===2?e>n:r===3?e>=n:void 0}__clzmsd(){return T.__clz30(this.__digit(this.length-1))}static __absoluteAdd(e,n,r){if(e.length<n.length)return T.__absoluteAdd(n,e,r);if(e.length===0)return e;if(n.length===0)return e.sign===r?e:T.unaryMinus(e);let i=e.length;(e.__clzmsd()===0||n.length===e.length&&n.__clzmsd()===0)&&i++;const o=new T(i,r);let s=0,a=0;for(;a<n.length;a++){const c=e.__digit(a)+n.__digit(a)+s;s=c>>>30,o.__setDigit(a,1073741823&c)}for(;a<e.length;a++){const c=e.__digit(a)+s;s=c>>>30,o.__setDigit(a,1073741823&c)}return a<o.length&&o.__setDigit(a,s),o.__trim()}static __absoluteSub(e,n,r){if(e.length===0)return e;if(n.length===0)return e.sign===r?e:T.unaryMinus(e);const i=new T(e.length,r);let o=0,s=0;for(;s<n.length;s++){const a=e.__digit(s)-n.__digit(s)-o;o=1&a>>>30,i.__setDigit(s,1073741823&a)}for(;s<e.length;s++){const a=e.__digit(s)-o;o=1&a>>>30,i.__setDigit(s,1073741823&a)}return i.__trim()}static __absoluteAddOne(e,n,r=null){const i=e.length;r===null?r=new T(i,n):r.sign=n;let o=1;for(let s=0;s<i;s++){const a=e.__digit(s)+o;o=a>>>30,r.__setDigit(s,1073741823&a)}return o!=0&&r.__setDigitGrow(i,1),r}static __absoluteSubOne(e,n){const r=e.length;n=n||r;const i=new T(n,!1);let o=1;for(let s=0;s<r;s++){const a=e.__digit(s)-o;o=1&a>>>30,i.__setDigit(s,1073741823&a)}if(o!=0)throw new Error("implementation bug");for(let s=r;s<n;s++)i.__setDigit(s,0);return i}static __absoluteAnd(e,n,r=null){let i=e.length,o=n.length,s=o;if(i<o){s=i;const l=e,u=i;e=n,i=o,n=l,o=u}let a=s;r===null?r=new T(a,!1):a=r.length;let c=0;for(;c<s;c++)r.__setDigit(c,e.__digit(c)&n.__digit(c));for(;c<a;c++)r.__setDigit(c,0);return r}static __absoluteAndNot(e,n,r=null){const i=e.length,o=n.length;let s=o;i<o&&(s=i);let a=i;r===null?r=new T(a,!1):a=r.length;let c=0;for(;c<s;c++)r.__setDigit(c,e.__digit(c)&~n.__digit(c));for(;c<i;c++)r.__setDigit(c,e.__digit(c));for(;c<a;c++)r.__setDigit(c,0);return r}static __absoluteOr(e,n,r=null){let i=e.length,o=n.length,s=o;if(i<o){s=i;const l=e,u=i;e=n,i=o,n=l,o=u}let a=i;r===null?r=new T(a,!1):a=r.length;let c=0;for(;c<s;c++)r.__setDigit(c,e.__digit(c)|n.__digit(c));for(;c<i;c++)r.__setDigit(c,e.__digit(c));for(;c<a;c++)r.__setDigit(c,0);return r}static __absoluteXor(e,n,r=null){let i=e.length,o=n.length,s=o;if(i<o){s=i;const l=e,u=i;e=n,i=o,n=l,o=u}let a=i;r===null?r=new T(a,!1):a=r.length;let c=0;for(;c<s;c++)r.__setDigit(c,e.__digit(c)^n.__digit(c));for(;c<i;c++)r.__setDigit(c,e.__digit(c));for(;c<a;c++)r.__setDigit(c,0);return r}static __absoluteCompare(e,n){const r=e.length-n.length;if(r!=0)return r;let i=e.length-1;for(;0<=i&&e.__digit(i)===n.__digit(i);)i--;return 0>i?0:e.__unsignedDigit(i)>n.__unsignedDigit(i)?1:-1}static __multiplyAccumulate(e,n,r,i){if(n===0)return;const o=32767&n,s=n>>>15;let a=0,c=0;for(let l,u=0;u<e.length;u++,i++){l=r.__digit(i);const d=e.__digit(u),g=32767&d,p=d>>>15,y=T.__imul(g,o),w=T.__imul(g,s),E=T.__imul(p,o),b=T.__imul(p,s);l+=c+y+a,a=l>>>30,l&=1073741823,l+=((32767&w)<<15)+((32767&E)<<15),a+=l>>>30,c=b+(w>>>15)+(E>>>15),r.__setDigit(i,1073741823&l)}for(;a!=0||c!==0;i++){let l=r.__digit(i);l+=a+c,c=0,a=l>>>30,r.__setDigit(i,1073741823&l)}}static __internalMultiplyAdd(e,n,r,i,o){let s=r,a=0;for(let c=0;c<i;c++){const l=e.__digit(c),u=T.__imul(32767&l,n),d=T.__imul(l>>>15,n),g=u+((32767&d)<<15)+a+s;s=g>>>30,a=d>>>15,o.__setDigit(c,1073741823&g)}if(o.length>i)for(o.__setDigit(i++,s+a);i<o.length;)o.__setDigit(i++,0);else if(s+a!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(e,n,r){r>this.length&&(r=this.length);const i=32767&e,o=e>>>15;let s=0,a=n;for(let c=0;c<r;c++){const l=this.__digit(c),u=32767&l,d=l>>>15,g=T.__imul(u,i),p=T.__imul(u,o),y=T.__imul(d,i),w=T.__imul(d,o);let E=a+g+s;s=E>>>30,E&=1073741823,E+=((32767&p)<<15)+((32767&y)<<15),s+=E>>>30,a=w+(p>>>15)+(y>>>15),this.__setDigit(c,1073741823&E)}if(s!=0||a!==0)throw new Error("implementation bug")}static __absoluteDivSmall(e,n,r=null){r===null&&(r=new T(e.length,!1));let i=0;for(let o,s=2*e.length-1;0<=s;s-=2){o=(i<<15|e.__halfDigit(s))>>>0;const a=0|o/n;i=0|o%n,o=(i<<15|e.__halfDigit(s-1))>>>0;const c=0|o/n;i=0|o%n,r.__setDigit(s>>>1,a<<15|c)}return r}static __absoluteModSmall(e,n){let r=0;for(let i=2*e.length-1;0<=i;i--){const o=(r<<15|e.__halfDigit(i))>>>0;r=0|o%n}return r}static __absoluteDivLarge(e,n,r,i){const o=n.__halfDigitLength(),s=n.length,a=e.__halfDigitLength()-o;let c=null;r&&(c=new T(a+2>>>1,!1),c.__initializeDigits());const l=new T(o+2>>>1,!1);l.__initializeDigits();const u=T.__clz15(n.__halfDigit(o-1));0<u&&(n=T.__specialLeftShift(n,u,0));const d=T.__specialLeftShift(e,u,1),g=n.__halfDigit(o-1);let p=0;for(let y,w=a;0<=w;w--){y=32767;const E=d.__halfDigit(w+o);if(E!==g){const S=(E<<15|d.__halfDigit(w+o-1))>>>0;y=0|S/g;let R=0|S%g;const F=n.__halfDigit(o-2),M=d.__halfDigit(w+o-2);for(;T.__imul(y,F)>>>0>(R<<16|M)>>>0&&(y--,R+=g,!(32767<R)););}T.__internalMultiplyAdd(n,y,0,s,l);let b=d.__inplaceSub(l,w,o+1);b!==0&&(b=d.__inplaceAdd(n,w,o),d.__setHalfDigit(w+o,32767&d.__halfDigit(w+o)+b),y--),r&&(1&w?p=y<<15:c.__setDigit(w>>>1,p|y))}if(i)return d.__inplaceRightShift(u),r?{quotient:c,remainder:d}:d;if(r)return c;throw new Error("unreachable")}static __clz15(e){return T.__clz30(e)-15}__inplaceAdd(e,n,r){let i=0;for(let o=0;o<r;o++){const s=this.__halfDigit(n+o)+e.__halfDigit(o)+i;i=s>>>15,this.__setHalfDigit(n+o,32767&s)}return i}__inplaceSub(e,n,r){let i=0;if(1&n){n>>=1;let o=this.__digit(n),s=32767&o,a=0;for(;a<r-1>>>1;a++){const u=e.__digit(a),d=(o>>>15)-(32767&u)-i;i=1&d>>>15,this.__setDigit(n+a,(32767&d)<<15|32767&s),o=this.__digit(n+a+1),s=(32767&o)-(u>>>15)-i,i=1&s>>>15}const c=e.__digit(a),l=(o>>>15)-(32767&c)-i;if(i=1&l>>>15,this.__setDigit(n+a,(32767&l)<<15|32767&s),n+a+1>=this.length)throw new RangeError("out of bounds");(1&r)==0&&(o=this.__digit(n+a+1),s=(32767&o)-(c>>>15)-i,i=1&s>>>15,this.__setDigit(n+e.length,1073709056&o|32767&s))}else{n>>=1;let o=0;for(;o<e.length-1;o++){const u=this.__digit(n+o),d=e.__digit(o),g=(32767&u)-(32767&d)-i;i=1&g>>>15;const p=(u>>>15)-(d>>>15)-i;i=1&p>>>15,this.__setDigit(n+o,(32767&p)<<15|32767&g)}const s=this.__digit(n+o),a=e.__digit(o),c=(32767&s)-(32767&a)-i;i=1&c>>>15;let l=0;(1&r)==0&&(l=(s>>>15)-(a>>>15)-i,i=1&l>>>15),this.__setDigit(n+o,(32767&l)<<15|32767&c)}return i}__inplaceRightShift(e){if(e===0)return;let n=this.__digit(0)>>>e;const r=this.length-1;for(let i=0;i<r;i++){const o=this.__digit(i+1);this.__setDigit(i,1073741823&o<<30-e|n),n=o>>>e}this.__setDigit(r,n)}static __specialLeftShift(e,n,r){const i=e.length,o=new T(i+r,!1);if(n===0){for(let a=0;a<i;a++)o.__setDigit(a,e.__digit(a));return 0<r&&o.__setDigit(i,0),o}let s=0;for(let a=0;a<i;a++){const c=e.__digit(a);o.__setDigit(a,1073741823&c<<n|s),s=c>>>30-n}return 0<r&&o.__setDigit(i,s),o}static __leftShiftByAbsolute(e,n){const r=T.__toShiftAmount(n);if(0>r)throw new RangeError("BigInt too big");const i=0|r/30,o=r%30,s=e.length,a=o!==0&&e.__digit(s-1)>>>30-o!=0,c=s+i+(a?1:0),l=new T(c,e.sign);if(o===0){let u=0;for(;u<i;u++)l.__setDigit(u,0);for(;u<c;u++)l.__setDigit(u,e.__digit(u-i))}else{let u=0;for(let d=0;d<i;d++)l.__setDigit(d,0);for(let d=0;d<s;d++){const g=e.__digit(d);l.__setDigit(d+i,1073741823&g<<o|u),u=g>>>30-o}if(a)l.__setDigit(s+i,u);else if(u!==0)throw new Error("implementation bug")}return l.__trim()}static __rightShiftByAbsolute(e,n){const r=e.length,i=e.sign,o=T.__toShiftAmount(n);if(0>o)return T.__rightShiftByMaximum(i);const s=0|o/30,a=o%30;let c=r-s;if(0>=c)return T.__rightShiftByMaximum(i);let l=!1;if(i){if((e.__digit(s)&(1<<a)-1)!=0)l=!0;else for(let d=0;d<s;d++)if(e.__digit(d)!==0){l=!0;break}}l&&a===0&&~e.__digit(r-1)==0&&c++;let u=new T(c,i);if(a===0){u.__setDigit(c-1,0);for(let d=s;d<r;d++)u.__setDigit(d-s,e.__digit(d))}else{let d=e.__digit(s)>>>a;const g=r-s-1;for(let p=0;p<g;p++){const y=e.__digit(p+s+1);u.__setDigit(p,1073741823&y<<30-a|d),d=y>>>a}u.__setDigit(g,d)}return l&&(u=T.__absoluteAddOne(u,!0,u)),u.__trim()}static __rightShiftByMaximum(e){return e?T.__oneDigit(1,!0):T.__zero()}static __toShiftAmount(e){if(1<e.length)return-1;const n=e.__unsignedDigit(0);return n>T.__kMaxLengthBits?-1:n}static __toPrimitive(e,n="default"){if(typeof e!="object"||e.constructor===T)return e;if(typeof Symbol!="undefined"&&typeof Symbol.toPrimitive=="symbol"){const o=e[Symbol.toPrimitive];if(o){const s=o(n);if(typeof s!="object")return s;throw new TypeError("Cannot convert object to primitive value")}}const r=e.valueOf;if(r){const o=r.call(e);if(typeof o!="object")return o}const i=e.toString;if(i){const o=i.call(e);if(typeof o!="object")return o}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(e){return T.__isBigInt(e)?e:+e}static __isBigInt(e){return typeof e=="object"&&e!==null&&e.constructor===T}static __truncateToNBits(e,n){const r=0|(e+29)/30,i=new T(r,n.sign),o=r-1;for(let a=0;a<o;a++)i.__setDigit(a,n.__digit(a));let s=n.__digit(o);if(e%30!=0){const a=32-e%30;s=s<<a>>>a}return i.__setDigit(o,s),i.__trim()}static __truncateAndSubFromPowerOfTwo(e,n,r){var i=Math.min;const o=0|(e+29)/30,s=new T(o,r);let a=0;const c=o-1;let l=0;for(const p=i(c,n.length);a<p;a++){const y=0-n.__digit(a)-l;l=1&y>>>30,s.__setDigit(a,1073741823&y)}for(;a<c;a++)s.__setDigit(a,0|1073741823&-l);let u=c<n.length?n.__digit(c):0;const d=e%30;let g;if(d==0)g=0-u-l,g&=1073741823;else{const p=32-d;u=u<<p>>>p;const y=1<<32-p;g=y-u-l,g&=y-1}return s.__setDigit(c,g),s.__trim()}__digit(e){return this[e]}__unsignedDigit(e){return this[e]>>>0}__setDigit(e,n){this[e]=0|n}__setDigitGrow(e,n){this[e]=0|n}__halfDigitLength(){const e=this.length;return 32767>=this.__unsignedDigit(e-1)?2*e-1:2*e}__halfDigit(e){return 32767&this[e>>>1]>>>15*(1&e)}__setHalfDigit(e,n){const r=e>>>1,i=this.__digit(r),o=1&e?32767&i|n<<15:1073709056&i|32767&n;this.__setDigit(r,o)}static __digitPow(e,n){let r=1;for(;0<n;)1&n&&(r*=e),n>>>=1,e*=e;return r}static __isOneDigitInt(e){return(1073741823&e)===e}}T.__kMaxLength=33554432,T.__kMaxLengthBits=T.__kMaxLength<<5,T.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],T.__kBitsPerCharTableShift=5,T.__kBitsPerCharTableMultiplier=1<<T.__kBitsPerCharTableShift,T.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],T.__kBitConversionBuffer=new ArrayBuffer(8),T.__kBitConversionDouble=new Float64Array(T.__kBitConversionBuffer),T.__kBitConversionInts=new Int32Array(T.__kBitConversionBuffer),T.__clz30=Math.clz32?function(t){return Math.clz32(t)-2}:function(t){return t===0?30:0|29-(0|Math.log(t>>>0)/Math.LN2)},T.__imul=Math.imul||function(t,e){return 0|t*e};const Sp={},lS={["Temporal.Duration"](t,e){const n=e.stylize(`${this[Symbol.toStringTag]} <${this}>`,"special");if(t<1)return n;const r=[];for(const i of["years","months","weeks","days","hours","minutes","seconds","milliseconds","microseconds","nanoseconds"])this[i]!==0&&r.push(`  ${i}: ${e.stylize(this[i],"number")}`);return n+` {
`+r.join(`,
`)+`
}`}};function uS(t,e){return e.stylize(`${this[Symbol.toStringTag]} <${this}>`,"special")}function $o(t,e){Object.defineProperty(t.prototype,Symbol.toStringTag,{value:e,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,Symbol.for("nodejs.util.inspect.custom"),{value:lS[e]||uS,writable:!1,enumerable:!1,configurable:!0});for(const n of Object.getOwnPropertyNames(t)){const r=Object.getOwnPropertyDescriptor(t,n);!r.configurable||!r.enumerable||(r.enumerable=!1,Object.defineProperty(t,n,r))}for(const n of Object.getOwnPropertyNames(t.prototype)){const r=Object.getOwnPropertyDescriptor(t.prototype,n);!r.configurable||!r.enumerable||(r.enumerable=!1,Object.defineProperty(t.prototype,n,r))}Tp(e,t),Tp(`${e}.prototype`,t.prototype)}function Tp(t,e){const n=`%${t}%`;if(Sp[n]!==void 0)throw new Error(`intrinsic ${t} already exists`);Sp[n]=e}function Pe(t){return Sp[t]}const Fe="slot-epochNanoSeconds",Es="slot-timezone-identifier",ve="slot-year",Se="slot-month",Te="slot-day",Ue="slot-hour",je="slot-minute",$e="slot-second",Be="slot-millisecond",He="slot-microsecond",Ke="slot-nanosecond",ae="slot-calendar",dw="slot-date-brand",fw="slot-year-month-brand",hw="slot-month-day-brand",pr="slot-cached-instant",yt="slot-time-zone",br="slot-years",qn="slot-months",Ur="slot-weeks",Er="slot-days",Sr="slot-hours",Tr="slot-minutes",Ar="slot-seconds",xr="slot-milliseconds",Ir="slot-microseconds",Rr="slot-nanoseconds",Tn="slot-calendar-identifier",pw=new WeakMap;function Bo(t){pw.set(t,Object.create(null))}function Og(t){return pw.get(t)}function Gn(t,...e){if(!t||typeof t!="object")return!1;const n=Og(t);return!!n&&e.reduce((r,i)=>r&&i in n,!0)}function _(t,e){const n=Og(t)[e];if(n===void 0)throw new TypeError(`Missing internal slot ${e}`);return n}function Xe(t,e,n){Og(t)[e]=n}const Fl=Array.prototype.includes,dS=Array.prototype.push,fS=globalThis.Intl.DateTimeFormat,hS=Array.prototype.sort,pS=Math.abs,gS=Math.floor,Ap=Object.entries,hy=Object.keys,Jt={};class zd{constructor(e){if(arguments.length<1)throw new RangeError("missing argument: id is required");const n=Ne(e);if(!ww(n))throw new RangeError(`invalid calendar identifier ${n}`);Bo(this),Xe(this,Tn,n),Object.defineProperty(this,"_repr_",{value:`${this[Symbol.toStringTag]} <${n}>`,writable:!1,enumerable:!1,configurable:!1})}get id(){if(!Sn(this))throw new TypeError("invalid receiver");return Ne(this)}dateFromFields(e,n=void 0){if(!Sn(this))throw new TypeError("invalid receiver");if(!jt(e))throw new TypeError("invalid fields");const r=We(n);return Jt[_(this,Tn)].dateFromFields(e,r,this)}yearMonthFromFields(e,n=void 0){if(!Sn(this))throw new TypeError("invalid receiver");if(!jt(e))throw new TypeError("invalid fields");const r=We(n);return Jt[_(this,Tn)].yearMonthFromFields(e,r,this)}monthDayFromFields(e,n=void 0){if(!Sn(this))throw new TypeError("invalid receiver");if(!jt(e))throw new TypeError("invalid fields");const r=We(n);return Jt[_(this,Tn)].monthDayFromFields(e,r,this)}fields(e){if(!Sn(this))throw new TypeError("invalid receiver");const n=[],r=new Set(["year","month","monthCode","day","hour","minute","second","millisecond","microsecond","nanosecond"]);for(const i of e){if(typeof i!="string")throw new TypeError("invalid fields");if(!r.has(i))throw new RangeError(`invalid field name ${i}`);r.delete(i),dS.call(n,i)}return Jt[_(this,Tn)].fields(n)}mergeFields(e,n){if(!Sn(this))throw new TypeError("invalid receiver");return Jt[_(this,Tn)].mergeFields(e,n)}dateAdd(e,n,r=void 0){if(!Sn(this))throw new TypeError("invalid receiver");const i=Tt(e),o=cc(n),s=We(r),a=ir(s),{days:c}=sr(_(o,Er),_(o,Sr),_(o,Tr),_(o,Ar),_(o,xr),_(o,Ir),_(o,Rr),"day");return Jt[_(this,Tn)].dateAdd(i,_(o,br),_(o,qn),_(o,Ur),c,a,this)}dateUntil(e,n,r=void 0){if(!Sn(this))throw new TypeError("invalid receiver");const i=Tt(e),o=Tt(n),s=We(r),a=vi(s,"auto",["hour","minute","second","millisecond","microsecond","nanosecond"],"day"),{years:c,months:l,weeks:u,days:d}=Jt[_(this,Tn)].dateUntil(i,o,a),g=Pe("%Temporal.Duration%");return new g(c,l,u,d,0,0,0,0,0,0)}year(e){let n=e;if(!Sn(this))throw new TypeError("invalid receiver");return vt(n)||(n=Tt(n)),Jt[_(this,Tn)].year(n)}month(e){let n=e;if(!Sn(this))throw new TypeError("invalid receiver");if(Qn(n))throw new TypeError("use monthCode on PlainMonthDay instead");return vt(n)||(n=Tt(n)),Jt[_(this,Tn)].month(n)}monthCode(e){let n=e;if(!Sn(this))throw new TypeError("invalid receiver");return!vt(n)&&!Qn(n)&&(n=Tt(n)),Jt[_(this,Tn)].monthCode(n)}day(e){let n=e;if(!Sn(this))throw new TypeError("invalid receiver");return Qn(n)||(n=Tt(n)),Jt[_(this,Tn)].day(n)}era(e){let n=e;if(!Sn(this))throw new TypeError("invalid receiver");return vt(n)||(n=Tt(n)),Jt[_(this,Tn)].era(n)}eraYear(e){let n=e;if(!Sn(this))throw new TypeError("invalid receiver");return vt(n)||(n=Tt(n)),Jt[_(this,Tn)].eraYear(n)}dayOfWeek(e){if(!Sn(this))throw new TypeError("invalid receiver");const n=Tt(e);return Jt[_(this,Tn)].dayOfWeek(n)}dayOfYear(e){if(!Sn(this))throw new TypeError("invalid receiver");const n=Tt(e);return Jt[_(this,Tn)].dayOfYear(n)}weekOfYear(e){if(!Sn(this))throw new TypeError("invalid receiver");const n=Tt(e);return Jt[_(this,Tn)].weekOfYear(n)}daysInWeek(e){if(!Sn(this))throw new TypeError("invalid receiver");const n=Tt(e);return Jt[_(this,Tn)].daysInWeek(n)}daysInMonth(e){let n=e;if(!Sn(this))throw new TypeError("invalid receiver");return vt(n)||(n=Tt(n)),Jt[_(this,Tn)].daysInMonth(n)}daysInYear(e){let n=e;if(!Sn(this))throw new TypeError("invalid receiver");return vt(n)||(n=Tt(n)),Jt[_(this,Tn)].daysInYear(n)}monthsInYear(e){let n=e;if(!Sn(this))throw new TypeError("invalid receiver");return vt(n)||(n=Tt(n)),Jt[_(this,Tn)].monthsInYear(n)}inLeapYear(e){let n=e;if(!Sn(this))throw new TypeError("invalid receiver");return vt(n)||(n=Tt(n)),Jt[_(this,Tn)].inLeapYear(n)}toString(){if(!Sn(this))throw new TypeError("invalid receiver");return _(this,Tn)}toJSON(){if(!Sn(this))throw new TypeError("invalid receiver");return Ne(this)}static from(e){return ar(e)}}$o(zd,"Temporal.Calendar");Tp("Temporal.Calendar.from",zd.from);Jt.iso8601={dateFromFields(t,e,n){const r=ir(e);let i=or(t,[["day"],["month",void 0],["monthCode",void 0],["year"]]);i=Xu(i);let{year:o,month:s,day:a}=i;return{year:o,month:s,day:a}=Ed(o,s,a,r),Gi(o,s,a,n)},yearMonthFromFields(t,e,n){const r=ir(e);let i=or(t,[["month",void 0],["monthCode",void 0],["year"]]);i=Xu(i);let{year:o,month:s}=i;return{year:o,month:s}=l2(o,s,r),Ul(o,s,n,1)},monthDayFromFields(t,e,n){const r=ir(e);let i=or(t,[["day"],["month",void 0],["monthCode",void 0],["year",void 0]]);if(i.month!==void 0&&i.year===void 0&&i.monthCode===void 0)throw new TypeError("either year or monthCode required with month");const o=i.monthCode===void 0,s=1972;i=Xu(i);let{month:a,day:c,year:l}=i;return{month:a,day:c}=Ed(o?l:s,a,c,r),Ll(a,c,n,s)},fields(t){return t},mergeFields(t,e){const n={};for(const i of hy(t))i==="month"||i==="monthCode"||(n[i]=t[i]);const r=hy(e);for(const i of r)n[i]=e[i];if(!Fl.call(r,"month")&&!Fl.call(r,"monthCode")){const{month:i,monthCode:o}=t;i!==void 0&&(n.month=i),o!==void 0&&(n.monthCode=o)}return n},dateAdd(t,e,n,r,i,o,s){let a=_(t,ve),c=_(t,Se),l=_(t,Te);return{year:a,month:c,day:l}=_a(a,c,l,e,n,r,i,o),Gi(a,c,l,s)},dateUntil(t,e,n){return Jg(_(t,ve),_(t,Se),_(t,Te),_(e,ve),_(e,Se),_(e,Te),n)},year(t){return _(t,ve)},era(){},eraYear(){},month(t){return _(t,Se)},monthCode(t){return cs(_(t,Se))},day(t){return _(t,Te)},dayOfWeek(t){return Mp(_(t,ve),_(t,Se),_(t,Te))},dayOfYear(t){return xd(_(t,ve),_(t,Se),_(t,Te))},weekOfYear(t){return w2(_(t,ve),_(t,Se),_(t,Te))},daysInWeek(){return 7},daysInMonth(t){return ds(_(t,ve),_(t,Se))},daysInYear(t){let e=t;return Gn(e,ve)||(e=Tt(e)),Ns(_(e,ve))?366:365},monthsInYear(){return 12},inLeapYear(t){let e=t;return Gn(e,ve)||(e=Tt(e)),Ns(_(e,ve))}};function Mg(t){if(!t.startsWith("M"))throw new RangeError(`Invalid month code: ${t}.  Month codes must start with M.`);const e=+t.slice(1);if(isNaN(e))throw new RangeError(`Invalid month code: ${t}`);return e}function cs(t,e=!1){return`M${t.toString().padStart(2,"0")}${e?"L":""}`}function Xu(t,e=void 0,n=12){let{month:r,monthCode:i}=t;if(i===void 0){if(r===void 0)throw new TypeError("Either month or monthCode are required");e==="reject"&&gr(r,1,n),e==="constrain"&&(r=ci(r,1,n)),i=cs(r)}else{const o=Mg(i);if(r!==void 0&&r!==o)throw new RangeError(`monthCode ${i} and month ${r} must match if both are present`);if(i!==cs(o))throw new RangeError(`Invalid month code: ${i}`);if(r=o,r<1||r>n)throw new RangeError(`Invalid monthCode: ${i}`)}return{...t,month:r,monthCode:i}}class Zt{constructor(e){if(this.map=new Map,this.calls=0,this.hits=0,this.misses=0,this.now=globalThis.performance?globalThis.performance.now():Date.now(),e!==void 0){let n=0;for(const r of e.map.entries()){if(++n>Zt.MAX_CACHE_ENTRIES)break;this.map.set(...r)}}}get(e){const n=this.map.get(e);return n&&(this.hits++,this.report()),this.calls++,n}set(e,n){this.map.set(e,n),this.misses++,this.report()}report(){}setObject(e){if(Zt.objectMap.get(e))throw new RangeError("object already cached");Zt.objectMap.set(e,this),this.report()}static getCacheForObject(e){let n=Zt.objectMap.get(e);return n||(n=new Zt,Zt.objectMap.set(e,n)),n}}Zt.objectMap=new WeakMap;Zt.MAX_CACHE_ENTRIES=1e3;function gw({isoYear:t,isoMonth:e,isoDay:n}){const r=Ma(t),i=zt(e),o=zt(n);return`${r}-${i}-${o}T00:00Z`}function vh(t,e){return{years:t.year-e.year,months:t.month-e.month,days:t.day-e.day}}class Nc{constructor(){this.eraLength="short",this.hasEra=!0}getFormatter(){return typeof this.formatter=="undefined"&&(this.formatter=new fS(`en-US-u-ca-${this.id}`,{day:"numeric",month:"numeric",year:"numeric",era:this.eraLength,timeZone:"UTC"})),this.formatter}isoToCalendarDate(e,n){const{year:r,month:i,day:o}=e,s=JSON.stringify({func:"isoToCalendarDate",isoYear:r,isoMonth:i,isoDay:o,id:this.id}),a=n.get(s);if(a)return a;const c=this.getFormatter();let l,u;try{u=gw({isoYear:r,isoMonth:i,isoDay:o}),l=c.formatToParts(new Date(u))}catch{throw new RangeError(`Invalid ISO date: ${JSON.stringify({isoYear:r,isoMonth:i,isoDay:o})}`)}const d={};for(let{type:p,value:y}of l){if(p==="year"&&(d.eraYear=+y),p==="relatedYear"&&(d.eraYear=+y),p==="month"){const w=/^([0-9]*)(.*?)$/.exec(y);if(!w||w.length!=3||!w[1]&&!w[2])throw new RangeError(`Unexpected month: ${y}`);if(d.month=w[1]?+w[1]:1,d.month<1)throw new RangeError(`Invalid month ${y} from ${u}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10527)`);if(d.month>13)throw new RangeError(`Invalid month ${y} from ${u}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10529)`);w[2]&&(d.monthExtra=w[2])}p==="day"&&(d.day=+y),this.hasEra&&p==="era"&&y!=null&&y!==""&&(y=y.split(" (")[0],d.era=y.normalize("NFD").replace(/[^-0-9 \p{L}]/gu,"").replace(" ","-").toLowerCase())}if(d.eraYear===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);if(this.reviseIntlEra){const{era:p,eraYear:y}=this.reviseIntlEra(d,e);d.era=p,d.eraYear=y}this.checkIcuBugs&&this.checkIcuBugs(e);const g=this.adjustCalendarDate(d,n,"constrain",!0);if(g.year===void 0)throw new RangeError(`Missing year converting ${JSON.stringify(e)}`);if(g.month===void 0)throw new RangeError(`Missing month converting ${JSON.stringify(e)}`);if(g.day===void 0)throw new RangeError(`Missing day converting ${JSON.stringify(e)}`);return n.set(s,g),["constrain","reject"].forEach(p=>{const y=JSON.stringify({func:"calendarToIsoDate",year:g.year,month:g.month,day:g.day,overflow:p,id:this.id});n.set(y,e)}),g}validateCalendarDate(e){const{era:n,month:r,year:i,day:o,eraYear:s,monthCode:a,monthExtra:c}=e;if(c!==void 0)throw new RangeError("Unexpected `monthExtra` value");if(i===void 0&&s===void 0)throw new TypeError("year or eraYear is required");if(r===void 0&&a===void 0)throw new TypeError("month or monthCode is required");if(o===void 0)throw new RangeError("Missing day");if(a!==void 0){if(typeof a!="string")throw new RangeError(`monthCode must be a string, not ${typeof a}`);if(!/^M([01]?\d)(L?)$/.test(a))throw new RangeError(`Invalid monthCode: ${a}`)}if(this.constantEra){if(n!==void 0&&n!==this.constantEra)throw new RangeError(`era must be ${this.constantEra}, not ${n}`);if(s!==void 0&&i!==void 0&&s!==i)throw new RangeError(`eraYear ${s} does not match year ${i}`)}}adjustCalendarDate(e,n=void 0,r="constrain",i=!1){if(this.calendarType==="lunisolar")throw new RangeError("Override required for lunisolar calendars");let o=e;if(this.validateCalendarDate(o),this.constantEra){const{year:l,eraYear:u}=o;o={...o,era:this.constantEra,year:l!==void 0?l:u,eraYear:u!==void 0?u:l}}const s=this.monthsInYear(o,n);let{month:a,monthCode:c}=o;return{month:a,monthCode:c}=Xu(o,r,s),{...o,month:a,monthCode:c}}regulateMonthDayNaive(e,n,r){const i=this.monthsInYear(e,r);let{month:o,day:s}=e;return n==="reject"?(gr(o,1,i),gr(s,1,this.maximumMonthLength(e))):(o=ci(o,1,i),s=ci(s,1,this.maximumMonthLength({...e,month:o}))),{...e,month:o,day:s}}calendarToIsoDate(e,n="constrain",r){const i=e;let o=this.adjustCalendarDate(e,r,n,!1);o=this.regulateMonthDayNaive(o,n,r);const{year:s,month:a,day:c}=o,l=JSON.stringify({func:"calendarToIsoDate",year:s,month:a,day:c,overflow:n,id:this.id});let u=r.get(l);if(u)return u;let d;if(i.year!==void 0&&i.month!==void 0&&i.day!==void 0&&(i.year!==o.year||i.month!==o.month||i.day!==o.day)&&(d=JSON.stringify({func:"calendarToIsoDate",year:i.year,month:i.month,day:i.day,overflow:n,id:this.id}),u=r.get(d),u))return u;let g=this.estimateIsoDate({year:s,month:a,day:c});const p=R=>{let F=this.addDaysIso(g,R);if(o.day>this.minimumMonthLength(o)){let M=this.isoToCalendarDate(F,r);for(;M.month!==a||M.year!==s;){if(n==="reject")throw new RangeError(`day ${c} does not exist in month ${a} of year ${s}`);F=this.addDaysIso(F,-1),M=this.isoToCalendarDate(F,r)}}return F};let y=0,w=this.isoToCalendarDate(g,r),E=vh(o,w);if(E.years!==0||E.months!==0||E.days!==0){const R=E.years*365+E.months*30+E.days;g=this.addDaysIso(g,R),w=this.isoToCalendarDate(g,r),E=vh(o,w),E.years===0&&E.months===0?g=p(E.days):y=this.compareCalendarDates(o,w)}let b=8,S=!1;for(;y;){g=this.addDaysIso(g,y*b);const R=w;w=this.isoToCalendarDate(g,r);const F=y;if(y=this.compareCalendarDates(o,w),y){if(E=vh(o,w),E.years===0&&E.months===0)g=p(E.days),y=0,S=o.day>this.minimumMonthLength(o);else if(F&&y!==F)if(b>1)b/=2;else{if(n==="reject")throw new RangeError(`Can't find ISO date from calendar date: ${JSON.stringify({...i})}`);this.compareCalendarDates(w,R)>0&&(g=this.addDaysIso(g,-1)),S=!0,y=0}}}if(r.set(l,g),d&&r.set(d,g),o.year===void 0||o.month===void 0||o.day===void 0||o.monthCode===void 0||this.hasEra&&(o.era===void 0||o.eraYear===void 0))throw new RangeError("Unexpected missing property");if(!S){const R=JSON.stringify({func:"isoToCalendarDate",isoYear:g.year,isoMonth:g.month,isoDay:g.day,id:this.id});r.set(R,o)}return g}temporalToCalendarDate(e,n){const r={year:_(e,ve),month:_(e,Se),day:_(e,Te)};return this.isoToCalendarDate(r,n)}compareCalendarDates(e,n){const r=or(e,[["day"],["month"],["year"]]),i=or(n,[["day"],["month"],["year"]]);return r.year!==i.year?wa(r.year-i.year):r.month!==i.month?wa(r.month-i.month):r.day!==i.day?wa(r.day-i.day):0}regulateDate(e,n="constrain",r){const i=this.calendarToIsoDate(e,n,r);return this.isoToCalendarDate(i,r)}addDaysIso(e,n){return _a(e.year,e.month,e.day,0,0,0,n,"constrain")}addDaysCalendar(e,n,r){const i=this.calendarToIsoDate(e,"constrain",r),o=this.addDaysIso(i,n);return this.isoToCalendarDate(o,r)}addMonthsCalendar(e,n,r,i){let o=e;const{day:s}=o;for(let a=0,c=pS(n);a<c;a++){const{month:l}=o,u=o,d=n<0?-Math.max(s,this.daysInPreviousMonth(o,i)):this.daysInMonth(o,i),g=this.calendarToIsoDate(o,"constrain",i);let p=this.addDaysIso(g,d);if(o=this.isoToCalendarDate(p,i),n>0){const y=this.monthsInYear(u,i);for(;o.month-1!==l%y;)p=this.addDaysIso(p,-1),o=this.isoToCalendarDate(p,i)}o.day!==s&&(o=this.regulateDate({...o,day:s},"constrain",i))}if(r==="reject"&&o.day!==s)throw new RangeError(`Day ${s} does not exist in resulting calendar month`);return o}addCalendar(e,{years:n=0,months:r=0,weeks:i=0,days:o=0},s,a){const{year:c,month:l,day:u}=e,d=this.addMonthsCalendar({year:c+n,month:l,day:u},r,s,a),g=o+i*7;return this.addDaysCalendar(d,g,a)}untilCalendar(e,n,r,i){let o=0,s=0,a=0,c=0;switch(r){case"day":o=this.calendarDaysUntil(e,n,i);break;case"week":{const l=this.calendarDaysUntil(e,n,i);o=l%7,s=(l-o)/7;break}case"month":case"year":{const l=n.year-e.year,u=n.month-e.month,d=n.day-e.day,g=this.compareCalendarDates(n,e);r==="year"&&l&&(c=u*g<0||u===0&&d*g<0?l-g:l);const p=c?this.addCalendar(e,{years:c},"constrain",i):e;let y,w=p;do a+=g,y=w,w=this.addMonthsCalendar(y,g,"constrain",i),w.day!==e.day&&(w=this.regulateDate({...w,day:e.day},"constrain",i));while(this.compareCalendarDates(n,w)*g>=0);a-=g,o=this.calendarDaysUntil(y,n,i);break}}return{years:c,months:a,weeks:s,days:o}}daysInMonth(e,n){const{day:r}=e,i=this.maximumMonthLength(e),o=this.minimumMonthLength(e);if(o===i)return o;const s=r<=i-o?i:o,a=this.calendarToIsoDate(e,"constrain",n),c=this.addDaysIso(a,s),l=this.isoToCalendarDate(c,n),u=this.addDaysIso(c,-l.day);return this.isoToCalendarDate(u,n).day}daysInPreviousMonth(e,n){const{day:r,month:i,year:o}=e;let a={year:i>1?o:o-1,month:i,day:1};const c=i>1?i-1:this.monthsInYear(a,n);a={...a,month:c};const l=this.minimumMonthLength(a),u=this.maximumMonthLength(a);if(l===u)return u;const d=this.calendarToIsoDate(e,"constrain",n),g=this.addDaysIso(d,-r);return this.isoToCalendarDate(g,n).day}startOfCalendarYear(e){return{year:e.year,month:1,day:1}}startOfCalendarMonth(e){return{year:e.year,month:e.month,day:1}}calendarDaysUntil(e,n,r){const i=this.calendarToIsoDate(e,"constrain",r),o=this.calendarToIsoDate(n,"constrain",r);return this.isoDaysUntil(i,o)}isoDaysUntil(e,n){return Jg(e.year,e.month,e.day,n.year,n.month,n.day,"day").days}monthDayFromFields(e,n,r){let{year:i,month:o,monthCode:s,day:a,era:c,eraYear:l}=e;if(s===void 0){if(i===void 0&&(c===void 0||l===void 0))throw new TypeError("`monthCode`, `year`, or `era` and `eraYear` is required");({monthCode:s,year:i}=this.adjustCalendarDate({year:i,month:o,monthCode:s,day:a,era:c,eraYear:l},r,n))}let u,d,g,p,y;const w={year:1972,month:1,day:1},{year:E}=this.isoToCalendarDate(w,r);for(let b=0;b<100;b++){const S=this.adjustCalendarDate({day:a,monthCode:s,year:E-b},r),R=this.calendarToIsoDate(S,"constrain",r),F=this.isoToCalendarDate(R,r);if({year:u,month:d,day:g}=R,F.monthCode===s&&F.day===a)return{month:d,day:g,year:u};n==="constrain"&&(p===void 0||F.monthCode===p.monthCode&&F.day>p.day)&&(p=F,y=R)}if(n==="constrain"&&y!==void 0)return y;throw new RangeError(`No recent ${this.id} year with monthCode ${s} and day ${a}`)}}class mS extends Nc{constructor(){super(...arguments),this.id="hebrew",this.calendarType="lunisolar",this.months={Tishri:{leap:1,regular:1,monthCode:"M01",days:30},Heshvan:{leap:2,regular:2,monthCode:"M02",days:{min:29,max:30}},Kislev:{leap:3,regular:3,monthCode:"M03",days:{min:29,max:30}},Tevet:{leap:4,regular:4,monthCode:"M04",days:29},Shevat:{leap:5,regular:5,monthCode:"M05",days:30},Adar:{leap:void 0,regular:6,monthCode:"M06",days:29},"Adar I":{leap:6,regular:void 0,monthCode:"M05L",days:30},"Adar II":{leap:7,regular:void 0,monthCode:"M06",days:29},Nisan:{leap:8,regular:7,monthCode:"M07",days:30},Iyar:{leap:9,regular:8,monthCode:"M08",days:29},Sivan:{leap:10,regular:9,monthCode:"M09",days:30},Tamuz:{leap:11,regular:10,monthCode:"M10",days:29},Av:{leap:12,regular:11,monthCode:"M11",days:30},Elul:{leap:13,regular:12,monthCode:"M12",days:29}},this.hasEra=!1}inLeapYear(e){const{year:n}=e;return(7*n+1)%19<7}monthsInYear(e){return this.inLeapYear(e)?13:12}minimumMonthLength(e){return this.minMaxMonthLength(e,"min")}maximumMonthLength(e){return this.minMaxMonthLength(e,"max")}minMaxMonthLength(e,n){const{month:r,year:i}=e,o=this.getMonthCode(i,r),s=Ap(this.months).find(c=>c[1].monthCode===o);if(s===void 0)throw new RangeError(`unmatched Hebrew month: ${r}`);const a=s[1].days;return typeof a=="number"?a:a[n]}estimateIsoDate(e){const{year:n}=e;return{year:n-3760,month:1,day:1}}getMonthCode(e,n){return this.inLeapYear({year:e})?n===6?cs(5,!0):cs(n<6?n:n-1):cs(n)}adjustCalendarDate(e,n,r="constrain",i=!1){let{year:o,eraYear:s,month:a,monthCode:c,day:l,monthExtra:u}=e;if(o===void 0&&s!==void 0&&(o=s),s===void 0&&o!==void 0&&(s=o),i){if(u){const g=this.months[u];if(!g)throw new RangeError(`Unrecognized month from formatToParts: ${u}`);a=this.inLeapYear({year:o})?g.leap:g.regular}return c=this.getMonthCode(o,a),{year:o,month:a,day:l,era:void 0,eraYear:s,monthCode:c}}else{if(this.validateCalendarDate(e),a===void 0)if(c.endsWith("L")){if(c!=="M05L")throw new RangeError(`Hebrew leap month must have monthCode M05L, not ${c}`);if(a=6,!this.inLeapYear({year:o})){if(r==="reject")throw new RangeError(`Hebrew monthCode M05L is invalid in year ${o} which is not a leap year`);a=5,l=30,c="M05"}}else{a=Mg(c),this.inLeapYear({year:o})&&a>6&&a++;const d=this.monthsInYear({year:o});if(a<1||a>d)throw new RangeError(`Invalid monthCode: ${c}`)}else if(r==="reject"?(gr(a,1,this.monthsInYear({year:o})),gr(l,1,this.maximumMonthLength({year:o,month:a}))):(a=ci(a,1,this.monthsInYear({year:o})),l=ci(l,1,this.maximumMonthLength({year:o,month:a}))),c===void 0)c=this.getMonthCode(o,a);else if(this.getMonthCode(o,a)!==c)throw new RangeError(`monthCode ${c} doesn't correspond to month ${a} in Hebrew year ${o}`);return{...e,day:l,month:a,monthCode:c,year:o,eraYear:s}}}}class Oc extends Nc{constructor(){super(...arguments),this.calendarType="lunar",this.DAYS_PER_ISLAMIC_YEAR=354+11/30,this.DAYS_PER_ISO_YEAR=365.2425,this.constantEra="ah"}inLeapYear(e,n){return this.daysInMonth({year:e.year,month:12,day:1},n)===30}monthsInYear(){return 12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}estimateIsoDate(e){const{year:n}=this.adjustCalendarDate(e);return{year:gS(n*this.DAYS_PER_ISLAMIC_YEAR/this.DAYS_PER_ISO_YEAR)+622,month:1,day:1}}}class mw extends Oc{constructor(){super(...arguments),this.id="islamic"}}class yS extends Oc{constructor(){super(...arguments),this.id="islamic-umalqura"}}class _S extends Oc{constructor(){super(...arguments),this.id="islamic-tbla"}}class wS extends Oc{constructor(){super(...arguments),this.id="islamic-civil"}}class vS extends Oc{constructor(){super(...arguments),this.id="islamic-rgsa"}}class bS extends Oc{constructor(){super(...arguments),this.id="islamicc"}}class ES extends Nc{constructor(){super(...arguments),this.id="persian",this.calendarType="solar",this.constantEra="ap"}inLeapYear(e,n){return mw.prototype.inLeapYear.call(this,e,n)}monthsInYear(){return 12}minimumMonthLength(e){const{month:n}=e;return n===12?29:n<=6?31:30}maximumMonthLength(e){const{month:n}=e;return n===12?30:n<=6?31:30}estimateIsoDate(e){const{year:n}=this.adjustCalendarDate(e);return{year:n+621,month:1,day:1}}}class SS extends Nc{constructor(){super(...arguments),this.id="indian",this.calendarType="solar",this.constantEra="saka",this.months={1:{length:30,month:3,day:22,leap:{length:31,month:3,day:21}},2:{length:31,month:4,day:21},3:{length:31,month:5,day:22},4:{length:31,month:6,day:22},5:{length:31,month:7,day:23},6:{length:31,month:8,day:23},7:{length:30,month:9,day:23},8:{length:30,month:10,day:23},9:{length:30,month:11,day:22},10:{length:30,month:12,day:22},11:{length:30,month:1,nextYear:!0,day:21},12:{length:30,month:2,nextYear:!0,day:20}},this.vulnerableToBceBug=new Date("0000-01-01T00:00Z").toLocaleDateString("en-US-u-ca-indian",{timeZone:"UTC"})!=="10/11/-79 Saka"}inLeapYear(e){return yw(e.year+78)}monthsInYear(){return 12}minimumMonthLength(e){return this.getMonthInfo(e).length}maximumMonthLength(e){return this.getMonthInfo(e).length}getMonthInfo(e){const{month:n}=e;let r=this.months[n];if(r===void 0)throw new RangeError(`Invalid month: ${n}`);return this.inLeapYear(e)&&r.leap&&(r=r.leap),r}estimateIsoDate(e){const n=this.adjustCalendarDate(e),r=this.getMonthInfo(n),i=n.year+78+(r.nextYear?1:0),o=r.month,s=r.day;return _a(i,o,s,0,0,0,n.day-1,"constrain")}checkIcuBugs(e){if(this.vulnerableToBceBug&&e.year<1)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 0001-01-01 (see https://bugs.chromium.org/p/v8/issues/detail?id=10529)`)}}function TS(t){let e=t;if(e.length===0)throw new RangeError("Invalid era data: eras are required");if(e.length===1&&e[0].reverseOf)throw new RangeError("Invalid era data: anchor era cannot count years backwards");if(e.length===1&&!e[0].name)throw new RangeError("Invalid era data: at least one named era is required");if(e.filter(i=>i.reverseOf!=null).length>1)throw new RangeError("Invalid era data: only one era can count years backwards");let n;e.forEach(i=>{if(i.isAnchor||!i.anchorEpoch&&!i.reverseOf){if(n)throw new RangeError("Invalid era data: cannot have multiple anchor eras");n=i,i.anchorEpoch={year:i.hasYearZero?0:1}}else if(!i.name)throw new RangeError("If era name is blank, it must be the anchor era")}),e=e.filter(i=>i.name),e.forEach(i=>{const{reverseOf:o}=i;if(o){const s=e.find(a=>a.name===o);if(s===void 0)throw new RangeError(`Invalid era data: unmatched reverseOf era: ${o}`);i.reverseOf=s,i.anchorEpoch=s.anchorEpoch,i.isoEpoch=s.isoEpoch}i.anchorEpoch.month===void 0&&(i.anchorEpoch.month=1),i.anchorEpoch.day===void 0&&(i.anchorEpoch.day=1)}),hS.call(e,(i,o)=>{if(i.reverseOf)return 1;if(o.reverseOf)return-1;if(!i.isoEpoch||!o.isoEpoch)throw new RangeError("Invalid era data: missing ISO epoch");return o.isoEpoch.year-i.isoEpoch.year});const r=e[e.length-1].reverseOf;if(r&&r!==e[e.length-2])throw new RangeError("Invalid era data: invalid reverse-sign era");return e.forEach((i,o)=>{i.genericName=`era${e.length-1-o}`}),{eras:e,anchorEra:n||e[0]}}function yw(t){return t%4===0&&(t%100!==0||t%400===0)}class zl extends Nc{constructor(e,n){super(),this.calendarType="solar",this.v8IsVulnerableToJulianBug=new Date("+001001-01-01T00:00Z").toLocaleDateString("en-US-u-ca-japanese",{timeZone:"UTC"}).startsWith("12"),this.calendarIsVulnerableToJulianBug=!1,this.id=e;const{eras:r,anchorEra:i}=TS(n);this.anchorEra=i,this.eras=r}inLeapYear(e){const{year:n}=this.estimateIsoDate({month:1,day:1,year:e.year});return yw(n)}monthsInYear(){return 12}minimumMonthLength(e){const{month:n}=e;return n===2?this.inLeapYear(e)?29:28:[4,6,9,11].indexOf(n)>=0?30:31}maximumMonthLength(e){return this.minimumMonthLength(e)}completeEraYear(e){const n=(a,c)=>{const l=e[a];if(l!=null&&l!=c)throw new RangeError(`Input ${a} ${l} doesn't match calculated value ${c}`)},r=a=>{let c;const l={...e,year:a},u=this.eras.find((d,g)=>{if(g===this.eras.length-1){if(d.reverseOf){if(a>0)throw new RangeError(`Signed year ${a} is invalid for era ${d.name}`);return c=d.anchorEpoch.year-a,!0}return c=a-d.anchorEpoch.year+(d.hasYearZero?0:1),!0}return this.compareCalendarDates(l,d.anchorEpoch)>=0?(c=a-d.anchorEpoch.year+(d.hasYearZero?0:1),!0):!1});if(!u)throw new RangeError(`Year ${a} was not matched by any era`);return{eraYear:c,era:u.name}};let{year:i,eraYear:o,era:s}=e;if(i!=null)({eraYear:o,era:s}=r(i)),n("era",s),n("eraYear",o);else if(o!=null){const a=s===void 0?void 0:this.eras.find(c=>c.name===s||c.genericName===s);if(!a)throw new RangeError(`Era ${s} (ISO year ${o}) was not matched by any era`);if(o<1&&a.reverseOf)throw new RangeError(`Years in ${s} era must be positive, not ${i}`);a.reverseOf?i=a.anchorEpoch.year-o:i=o+a.anchorEpoch.year-(a.hasYearZero?0:1),n("year",i),{eraYear:o,era:s}=r(i)}else throw new RangeError("Either `year` or `eraYear` and `era` are required");return{...e,year:i,eraYear:o,era:s}}adjustCalendarDate(e,n,r="constrain"){let i=e;const{month:o,monthCode:s}=i;return o===void 0&&(i={...i,month:Mg(s)}),this.validateCalendarDate(i),i=this.completeEraYear(i),super.adjustCalendarDate(i,n,r)}estimateIsoDate(e){const n=this.adjustCalendarDate(e),{year:r,month:i,day:o}=n,{anchorEra:s}=this,a=r+s.isoEpoch.year-(s.hasYearZero?0:1);return Ed(a,i,o,"constrain")}checkIcuBugs(e){if(this.calendarIsVulnerableToJulianBug&&this.v8IsVulnerableToJulianBug&&rs(e.year,e.month,e.day,1582,10,15)<0)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 1582-10-15 (see https://bugs.chromium.org/p/chromium/issues/detail?id=1173158)`)}}class Lg extends zl{constructor(e,n){super(e,n)}inLeapYear(e){const{year:n}=e;return(n+1)%4===0}monthsInYear(){return 13}minimumMonthLength(e){const{month:n}=e;return n===13?this.inLeapYear(e)?6:5:30}maximumMonthLength(e){return this.minimumMonthLength(e)}}class AS extends Lg{constructor(){super("ethioaa",[{name:"era0",isoEpoch:{year:-5492,month:7,day:17}}])}}class xS extends Lg{constructor(){super("coptic",[{name:"era1",isoEpoch:{year:284,month:8,day:29}},{name:"era0",reverseOf:"era1"}])}}class IS extends Lg{constructor(){super("ethiopic",[{name:"era0",isoEpoch:{year:-5492,month:7,day:17}},{name:"era1",isoEpoch:{year:8,month:8,day:27},anchorEpoch:{year:5501}}])}}class RS extends zl{constructor(){super("roc",[{name:"minguo",isoEpoch:{year:1912,month:1,day:1}},{name:"before-roc",reverseOf:"minguo"}]),this.calendarIsVulnerableToJulianBug=!0}}class kS extends zl{constructor(){super("buddhist",[{name:"be",hasYearZero:!0,isoEpoch:{year:-543,month:1,day:1}}]),this.calendarIsVulnerableToJulianBug=!0}}class FS extends zl{constructor(){super("gregory",[{name:"ce",isoEpoch:{year:1,month:1,day:1}},{name:"bce",reverseOf:"ce"}])}reviseIntlEra(e){let{era:n,eraYear:r}=e;return(n==="bc"||n==="b")&&(n="bce"),(n==="ad"||n==="a")&&(n="ce"),{era:n,eraYear:r}}}class DS extends zl{constructor(){super("japanese",[{name:"reiwa",isoEpoch:{year:2019,month:5,day:1},anchorEpoch:{year:2019,month:5,day:1}},{name:"heisei",isoEpoch:{year:1989,month:1,day:8},anchorEpoch:{year:1989,month:1,day:8}},{name:"showa",isoEpoch:{year:1926,month:12,day:25},anchorEpoch:{year:1926,month:12,day:25}},{name:"taisho",isoEpoch:{year:1912,month:7,day:30},anchorEpoch:{year:1912,month:7,day:30}},{name:"meiji",isoEpoch:{year:1868,month:9,day:8},anchorEpoch:{year:1868,month:9,day:8}},{name:"ce",isoEpoch:{year:1,month:1,day:1}},{name:"bce",reverseOf:"ce"}]),this.calendarIsVulnerableToJulianBug=!0,this.eraLength="long"}reviseIntlEra(e,n){const{era:r,eraYear:i}=e,{year:o}=n;return this.eras.find(s=>s.name===r)?{era:r,eraYear:i}:o<1?{era:"bce",eraYear:1-o}:{era:"ce",eraYear:o}}}class _w extends Nc{constructor(){super(...arguments),this.calendarType="lunisolar",this.hasEra=!1}inLeapYear(e,n){const r=this.getMonthList(e.year,n);return Ap(r).length===13}monthsInYear(e,n){return this.inLeapYear(e,n)?13:12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}getMonthList(e,n){if(e===void 0)throw new TypeError("Missing year");const r=JSON.stringify({func:"getMonthList",calendarYear:e,id:this.id}),i=n.get(r);if(i)return i;const o=this.getFormatter(),s=(E,b)=>{const S=gw({isoYear:E,isoMonth:2,isoDay:1}),R=new Date(S);R.setUTCDate(b+1);const F=o.formatToParts(R),M=F.find(Y=>Y.type==="month").value,P=+F.find(Y=>Y.type==="day").value;let D=F.find(Y=>Y.type==="relatedYear");if(D!==void 0)D=+D.value;else throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);return{calendarMonthString:M,calendarDay:P,calendarYearToVerify:D}};let a=17,{calendarMonthString:c,calendarDay:l,calendarYearToVerify:u}=s(e,a);c!=="1"&&(a+=29,{calendarMonthString:c,calendarDay:l}=s(e,a)),a-=l-5;const d={};let g=1,p,y,w=!1;do({calendarMonthString:c,calendarDay:l,calendarYearToVerify:u}=s(e,a)),p&&(d[y].daysInMonth=p+30-l),u!==e?w=!0:(d[c]={monthIndex:g++},a+=30),p=l,y=c;while(!w);return d[y].daysInMonth=p+30-l,n.set(r,d),d}estimateIsoDate(e){const{year:n,month:r}=e;return{year:n,month:r>=12?12:r+1,day:1}}adjustCalendarDate(e,n,r="constrain",i=!1){let{year:o,month:s,monthExtra:a,day:c,monthCode:l,eraYear:u}=e;if(i){if(o=u,a&&a!=="bis")throw new RangeError(`Unexpected leap month suffix: ${a}`);const d=cs(s,a!==void 0),g=`${s}${a||""}`,y=this.getMonthList(o,n)[g];if(y===void 0)throw new RangeError(`Unmatched month ${g} in Chinese year ${o}`);return s=y.monthIndex,{year:o,month:s,day:c,era:void 0,eraYear:u,monthCode:d}}else{if(this.validateCalendarDate(e),o===void 0&&(o=u),u===void 0&&(u=o),s===void 0){const d=this.getMonthList(o,n);let g=l.replace("L","bis").slice(1);g[0]==="0"&&(g=g.slice(1));let p=d[g];if(s=p&&p.monthIndex,s===void 0&&l.endsWith("L")&&!Fl.call(["M01L","M12L","M13L"],l)&&r==="constrain"){let y=l.slice(1,-1);y[0]==="0"&&(y=y.slice(1)),p=d[y],p&&({daysInMonth:c,monthIndex:s}=p,l=cs(y))}if(s===void 0)throw new RangeError(`Unmatched month ${l} in Chinese year ${o}`)}else if(l===void 0){const d=this.getMonthList(o,n),g=Ap(d),p=g.length;r==="reject"?(gr(s,1,p),gr(c,1,this.maximumMonthLength())):(s=ci(s,1,p),c=ci(c,1,this.maximumMonthLength()));const y=g.find(([,w])=>w.monthIndex===s);if(y===void 0)throw new RangeError(`Invalid month ${s} in Chinese year ${o}`);l=cs(y[0].replace("bis",""),y[0].indexOf("bis")!==-1)}else{const d=this.getMonthList(o,n);let g=l.replace("L","bis").slice(1);g[0]==="0"&&(g=g.slice(1));const p=d[g];if(!p)throw new RangeError(`Unmatched monthCode ${l} in Chinese year ${o}`);if(s!==p.monthIndex)throw new RangeError(`monthCode ${l} doesn't correspond to month ${s} in Chinese year ${o}`)}return{...e,year:o,eraYear:u,month:s,monthCode:l,day:c}}}}class CS extends _w{constructor(){super(...arguments),this.id="chinese"}}class PS extends _w{constructor(){super(...arguments),this.id="dangi"}}const NS={helper:void 0,dateFromFields(t,e,n){const r=ir(e),i=new Zt,o=or(t,[["day"],["era",void 0],["eraYear",void 0],["month",void 0],["monthCode",void 0],["year",void 0]]),{year:s,month:a,day:c}=this.helper.calendarToIsoDate(o,r,i),l=Gi(s,a,c,n);return i.setObject(l),l},yearMonthFromFields(t,e,n){const r=ir(e),i=new Zt,o=or(t,[["era",void 0],["eraYear",void 0],["month",void 0],["monthCode",void 0],["year",void 0]]),{year:s,month:a,day:c}=this.helper.calendarToIsoDate({...o,day:1},r,i),l=Ul(s,a,n,c);return i.setObject(l),l},monthDayFromFields(t,e,n){const r=ir(e),i=new Zt,o=or(t,[["day"],["era",void 0],["eraYear",void 0],["month",void 0],["monthCode",void 0],["year",void 0]]),{year:s,month:a,day:c}=this.helper.monthDayFromFields(o,r,i),l=Ll(a,c,n,s);return i.setObject(l),l},fields(t){let e=t;return Fl.call(e,"year")&&(e=[...e,"era","eraYear"]),e},mergeFields(t,e){const n={...t},r={...e},{month:i,monthCode:o,year:s,era:a,eraYear:c,...l}=n,{month:u,monthCode:d,year:g,era:p,eraYear:y}=r;return u===void 0&&d===void 0&&(l.month=i,l.monthCode=o),g===void 0&&p===void 0&&y===void 0&&(l.year=s),{...l,...r}},dateAdd(t,e,n,r,i,o,s){const a=Zt.getCacheForObject(t),c=this.helper.temporalToCalendarDate(t,a),l=this.helper.addCalendar(c,{years:e,months:n,weeks:r,days:i},o,a),u=this.helper.calendarToIsoDate(l,"constrain",a),{year:d,month:g,day:p}=u,y=Gi(d,g,p,s);return new Zt(a).setObject(y),y},dateUntil(t,e,n){const r=Zt.getCacheForObject(t),i=Zt.getCacheForObject(e),o=this.helper.temporalToCalendarDate(t,r),s=this.helper.temporalToCalendarDate(e,i);return this.helper.untilCalendar(o,s,n,r)},year(t){const e=Zt.getCacheForObject(t);return this.helper.temporalToCalendarDate(t,e).year},month(t){const e=Zt.getCacheForObject(t);return this.helper.temporalToCalendarDate(t,e).month},day(t){const e=Zt.getCacheForObject(t);return this.helper.temporalToCalendarDate(t,e).day},era(t){if(!this.helper.hasEra)return;const e=Zt.getCacheForObject(t);return this.helper.temporalToCalendarDate(t,e).era},eraYear(t){if(!this.helper.hasEra)return;const e=Zt.getCacheForObject(t);return this.helper.temporalToCalendarDate(t,e).eraYear},monthCode(t){const e=Zt.getCacheForObject(t);return this.helper.temporalToCalendarDate(t,e).monthCode},dayOfWeek(t){return Jt.iso8601.dayOfWeek(t)},dayOfYear(t){const e=Zt.getCacheForObject(t),n=this.helper.isoToCalendarDate(t,e),r=this.helper.startOfCalendarYear(n);return this.helper.calendarDaysUntil(r,n,e)+1},weekOfYear(t){return Jt.iso8601.weekOfYear(t)},daysInWeek(t){return Jt.iso8601.daysInWeek(t)},daysInMonth(t){const e=Zt.getCacheForObject(t),n=this.helper.temporalToCalendarDate(t,e),r=this.helper.maximumMonthLength(n),i=this.helper.minimumMonthLength(n);if(r===i)return r;const o=this.helper.startOfCalendarMonth(n),s=this.helper.addMonthsCalendar(o,1,"constrain",e);return this.helper.calendarDaysUntil(o,s,e)},daysInYear(t){let e=t;Gn(e,ve)||(e=Tt(e));const n=Zt.getCacheForObject(e),r=this.helper.temporalToCalendarDate(e,n),i=this.helper.startOfCalendarYear(r),o=this.helper.addCalendar(i,{years:1},"constrain",n);return this.helper.calendarDaysUntil(i,o,n)},monthsInYear(t){const e=Zt.getCacheForObject(t),n=this.helper.temporalToCalendarDate(t,e);return this.helper.monthsInYear(n,e)},inLeapYear(t){let e=t;Gn(e,ve)||(e=Tt(e));const n=Zt.getCacheForObject(e),r=this.helper.temporalToCalendarDate(e,n);return this.helper.inLeapYear(r,n)}};for(const t of[mS,ES,IS,AS,xS,CS,PS,RS,SS,kS,FS,DS,mw,yS,_S,wS,vS,bS]){const e=new t;Jt[e.id]={...NS,helper:e}}const OS=Object.keys(Jt);function ww(t){return Fl.call(OS,t)}const py=/\.[-A-Za-z_]|\.\.[-A-Za-z._]{1,12}|\.[-A-Za-z_][-A-Za-z._]{0,12}|[A-Za-z_][-A-Za-z._]{0,13}/,MS=/(?:[+\u2212-][0-2][0-9](?::?[0-5][0-9](?::?[0-5][0-9](?:[.,]\d{1,9})?)?)?)/,LS=new RegExp(`(?:(?:${py.source})(?:\\/(?:${py.source}))*|Etc/GMT[-+]\\d{1,2}|${MS.source})`),gy=/[A-Za-z0-9]{3,8}/,US=new RegExp(`(?:${gy.source}(?:-${gy.source})*)`),vw=/(?:[+\u2212-]\d{6}|\d{4})/,_d=/(?:0[1-9]|1[0-2])/,xp=/(?:0[1-9]|[12]\d|3[01])/,jS=new RegExp(`(${vw.source})(?:-(${_d.source})-(${xp.source})|(${_d.source})(${xp.source}))`),bw=/(\d{2})(?::(\d{2})(?::(\d{2})(?:[.,](\d{1,9}))?)?|(\d{2})(?:(\d{2})(?:[.,](\d{1,9}))?)?)?/,Ew=/([+\u2212-])([01][0-9]|2[0-3])(?::?([0-5][0-9])(?::?([0-5][0-9])(?:[.,](\d{1,9}))?)?)?/,Sw=new RegExp(`(?:([zZ])|(?:${Ew.source})?)(?:\\[(${LS.source})\\])?`),Tw=new RegExp(`\\[u-ca=(${US.source})\\]`),$S=new RegExp(`^${jS.source}(?:(?:T|\\s+)${bw.source})?${Sw.source}(?:${Tw.source})?$`,"i"),BS=new RegExp(`^T?${bw.source}(?:${Sw.source})?(?:${Tw.source})?$`,"i"),HS=new RegExp(`^(${vw.source})-?(${_d.source})$`),KS=new RegExp(`^(?:--)?(${_d.source})-?(${xp.source})$`),bh=/(\d+)(?:[.,](\d{1,9}))?/,WS=/(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)W)?(?:(\d+)D)?/,qS=new RegExp(`(?:${bh.source}H)?(?:${bh.source}M)?(?:${bh.source}S)?`),VS=new RegExp(`^([+\u2212-])?P${WS.source}(?:T(?!$)${qS.source})?$`,"i"),Aw=Array.prototype.push,xw=globalThis.Intl.DateTimeFormat,zS=Math.min,GS=Math.max,wt=Math.abs,Vn=Math.floor,Dl=Math.sign,rc=Math.trunc,Gl=Number.isNaN,nr=Number.isFinite,YS=Number,Yl=String,JS=Number.MAX_SAFE_INTEGER,Rt=Object.create,ZS=Object.defineProperty,QS=Object.is,Ug=Reflect.apply,xn=T.BigInt(0),jg=T.BigInt(1),ga=T.BigInt(60),bt=T.BigInt(1e3),Fi=T.BigInt(1e6),ls=T.BigInt(1e9),XS=T.BigInt(-1),e2=86400,Cs=T.multiply(T.BigInt(e2),ls),Cl=T.multiply(T.BigInt(-86400),T.BigInt(1e17)),Pl=T.multiply(T.BigInt(86400),T.BigInt(1e17)),wd=-271821,vd=275760,Iw=T.multiply(T.BigInt(-388152),T.BigInt(1e13)),t2=T.multiply(Cs,T.BigInt(366*10)),Rw=T.multiply(Cs,T.BigInt(366*1)),kw=T.multiply(Cs,T.BigInt(2*7));function Fw(t){if(typeof t!="number"||!nr(t))return!1;const e=wt(t);return Vn(e)===e}function jt(t){return typeof t=="object"&&t!==null||typeof t=="function"}function Nl(t){if(typeof t=="bigint")throw new TypeError("Cannot convert BigInt to number");return YS(t)}function Et(t){const e=Nl(t);if(Gl(e))return 0;const n=rc(e);return e===0?0:n}function Ne(t){if(typeof t=="symbol")throw new TypeError("Cannot convert a Symbol value to a String");return Yl(t)}function It(t){const e=Et(t);if(!nr(e))throw new RangeError("infinity is out of range");return e}function bc(t,e){const n=Et(t);if(!nr(n))throw new RangeError("infinity is out of range");if(n<1)throw e!==void 0?new RangeError(`property '${e}' cannot be a a number less than one`):new RangeError("Cannot convert a number less than one to a positive integer");return n}function Xn(t){const e=Nl(t);if(Gl(e))return 0;if(!nr(e))throw new RangeError("infinity is out of range");if(!Fw(e))throw new RangeError(`unsupported fractional value ${e}`);return Et(e)}function Wn(t,e){const n=T.divide(t,e),r=T.remainder(t,e);return{quotient:n,remainder:r}}function $g(t){return T.lessThan(t,xn)?T.multiply(t,XS):t}const bd=new Map([["year",It],["month",bc],["monthCode",Ne],["day",bc],["hour",It],["minute",It],["second",It],["millisecond",It],["microsecond",It],["nanosecond",It],["years",Xn],["months",Xn],["weeks",Xn],["days",Xn],["hours",Xn],["minutes",Xn],["seconds",Xn],["milliseconds",Xn],["microseconds",Xn],["nanoseconds",Xn],["era",Ne],["eraYear",Et],["offset",Ne]]),Ec=["year","month","week","day","hour","minute","second","millisecond","microsecond","nanosecond"],Gd=[["years","year"],["months","month"],["weeks","week"],["days","day"],["hours","hour"],["minutes","minute"],["seconds","second"],["milliseconds","millisecond"],["microseconds","microsecond"],["nanoseconds","nanosecond"]],my=new Map;function Dw(t){let e=my.get(t);return e===void 0&&(e=new xw("en-us",{timeZone:Yl(t),hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),my.set(t,e)),e}function Un(t){return Gn(t,Fe)&&!Gn(t,yt,ae)}function bo(t){return Gn(t,Es)}function Sn(t){return Gn(t,Tn)}function sn(t){return Gn(t,br,qn,Er,Sr,Tr,Ar,xr,Ir,Rr)}function ot(t){return Gn(t,dw)}function an(t){return Gn(t,Ue,je,$e,Be,He,Ke)&&!Gn(t,ve,Se,Te)}function Qe(t){return Gn(t,ve,Se,Te,Ue,je,$e,Be,He,Ke)}function vt(t){return Gn(t,fw)}function Qn(t){return Gn(t,hw)}function Ie(t){return Gn(t,Fe,yt,ae)}function Mc(t){if(Gn(t,ae)||Gn(t,yt))throw new TypeError("with() does not support a calendar or timeZone property");if(t.calendar!==void 0)throw new TypeError("with() does not support a calendar property");if(t.timeZone!==void 0)throw new TypeError("with() does not support a timeZone property")}function Cw(t){let{ianaName:e,offset:n,z:r}=a2(t);return e||(r?"UTC":n)}function Jl(t,e){return e==="never"||e==="auto"&&t==="iso8601"?"":`[u-ca=${t}]`}function Ho(t){const e=$S.exec(t);if(!e)throw new RangeError(`invalid ISO 8601 string: ${t}`);let n=e[1];if(n[0]==="\u2212"&&(n=`-${n.slice(1)}`),n==="-000000")throw new RangeError(`invalid ISO 8601 string: ${t}`);const r=Et(n),i=Et(e[2]||e[4]),o=Et(e[3]||e[5]),s=Et(e[6]),a=e[6]!==void 0,c=Et(e[7]||e[10]);let l=Et(e[8]||e[11]);l===60&&(l=59);const u=(e[9]||e[12])+"000000000",d=Et(u.slice(0,3)),g=Et(u.slice(3,6)),p=Et(u.slice(6,9));let y,w=!1;if(e[13])y=void 0,w=!0;else if(e[14]&&e[15]){const S=e[14]==="-"||e[14]==="\u2212"?"-":"+",R=e[15]||"00",F=e[16]||"00",M=e[17]||"00";let P=e[18]||"0";if(y=`${S}${R}:${F}`,+P){for(;P.endsWith("0");)P=P.slice(0,-1);y+=`:${M}.${P}`}else+M&&(y+=`:${M}`);y==="-00:00"&&(y="+00:00")}let E=e[19];if(E)try{E=zg(E).toString()}catch{}const b=e[20];return{year:r,month:i,day:o,hasTime:a,hour:s,minute:c,second:l,millisecond:d,microsecond:g,nanosecond:p,ianaName:E,offset:y,z:w,calendar:b}}function n2(t){const e=Ho(t);if(!e.z&&!e.offset)throw new RangeError("Temporal.Instant requires a time zone offset");return e}function r2(t){const e=Ho(t);if(!e.ianaName)throw new RangeError("Temporal.ZonedDateTime requires a time zone ID in brackets");return e}function i2(t){return Ho(t)}function o2(t){return Ho(t)}function s2(t){const e=BS.exec(t);let n,r,i,o,s,a,c;if(e){n=Et(e[1]),r=Et(e[2]||e[5]),i=Et(e[3]||e[6]),i===60&&(i=59);const l=(e[4]||e[7])+"000000000";o=Et(l.slice(0,3)),s=Et(l.slice(3,6)),a=Et(l.slice(6,9)),c=e[15]}else{let l,u;if({hasTime:u,hour:n,minute:r,second:i,millisecond:o,microsecond:s,nanosecond:a,calendar:c,z:l}=Ho(t),!u)throw new RangeError(`time is missing in string: ${t}`);if(l)throw new RangeError("Z designator not supported for PlainTime")}if(/[tT ][0-9][0-9]/.test(t))return{hour:n,minute:r,second:i,millisecond:o,microsecond:s,nanosecond:a,calendar:c};try{const{month:l,day:u}=Nw(t);Lo(1972,l,u)}catch{try{const{year:l,month:u}=Pw(t);Lo(l,u,1)}catch{return{hour:n,minute:r,second:i,millisecond:o,microsecond:s,nanosecond:a,calendar:c}}}throw new RangeError(`invalid ISO 8601 time-only string ${t}; may need a T prefix`)}function Pw(t){const e=HS.exec(t);let n,r,i,o;if(e){let s=e[1];if(s[0]==="\u2212"&&(s=`-${s.slice(1)}`),s==="-000000")throw new RangeError(`invalid ISO 8601 string: ${t}`);n=Et(s),r=Et(e[2]),i=e[3]}else{let s;if({year:n,month:r,calendar:i,day:o,z:s}=Ho(t),s)throw new RangeError("Z designator not supported for PlainYearMonth")}return{year:n,month:r,calendar:i,referenceISODay:o}}function Nw(t){const e=KS.exec(t);let n,r,i,o;if(e)n=Et(e[1]),r=Et(e[2]);else{let s;if({month:n,day:r,calendar:i,year:o,z:s}=Ho(t),s)throw new RangeError("Z designator not supported for PlainMonthDay")}return{month:n,day:r,calendar:i,referenceISOYear:o}}function a2(t){try{let e=zg(t);if(e)return e=e.toString(),oc(e)?{offset:e}:{ianaName:e}}catch{}try{const e=Ho(t);if(e.z||e.offset||e.ianaName)return e}catch{}throw new RangeError(`Invalid time zone: ${t}`)}function Ow(t){const e=VS.exec(t);if(!e)throw new RangeError(`invalid duration: ${t}`);if(e.slice(2).every(E=>E===void 0))throw new RangeError(`invalid duration: ${t}`);const n=e[1]==="-"||e[1]==="\u2212"?-1:1,r=Et(e[2])*n,i=Et(e[3])*n,o=Et(e[4])*n,s=Et(e[5])*n,a=Et(e[6])*n;let c=e[7],l=Et(e[8])*n,u=e[9],d=Et(e[10])*n;const g=e[11]+"000000000";let p=Et(g.slice(0,3))*n,y=Et(g.slice(3,6))*n,w=Et(g.slice(6,9))*n;return c=c?n*Et(c)/10**c.length:0,u=u?n*Et(u)/10**u.length:0,{minutes:l,seconds:d,milliseconds:p,microseconds:y,nanoseconds:w}=u2(c,l,u,d,p,y,w),{years:r,months:i,weeks:o,days:s,hours:a,minutes:l,seconds:d,milliseconds:p,microseconds:y,nanoseconds:w}}function c2(t){const{year:e,month:n,day:r,hour:i,minute:o,second:s,millisecond:a,microsecond:c,nanosecond:l,offset:u,z:d}=n2(t),g=Ps(e,n,r,i,o,s,a,c,l);if(g===null)throw new RangeError("DateTime outside of supported range");const p=d?0:Sa(u);return T.subtract(g,T.BigInt(p))}function Ed(t,e,n,r){let i=t,o=e,s=n;switch(r){case"reject":Lo(i,o,s);break;case"constrain":({year:i,month:o,day:s}=Zw(i,o,s));break}return{year:i,month:o,day:s}}function _l(t,e,n,r,i,o,s){let a=t,c=e,l=n,u=r,d=i,g=o;switch(s){case"reject":of(a,c,l,u,d,g);break;case"constrain":({hour:a,minute:c,second:l,millisecond:u,microsecond:d,nanosecond:g}=b2(a,c,l,u,d,g));break}return{hour:a,minute:c,second:l,millisecond:u,microsecond:d,nanosecond:g}}function l2(t,e,n){let r=t,i=e;const o=1;switch(n){case"reject":Lo(r,i,o);break;case"constrain":({year:r,month:i}=Zw(r,i));break}return{year:r,month:i}}function u2(t,e,n,r,i,o,s){let a=t,c=e,l=n,u=r,d=i,g=o,p=s;if(a!==0){[c,l,u,d,g,p].forEach(w=>{if(w!==0)throw new RangeError("only the smallest unit can be fractional")});const y=a*60;c=rc(y),l=y%1}if(l!==0){[u,d,g,p].forEach(E=>{if(E!==0)throw new RangeError("only the smallest unit can be fractional")});const y=l*60;u=rc(y);const w=y%1;if(w!==0){const E=w*1e3;d=rc(E);const b=E%1;if(b!==0){const S=b*1e3;g=rc(S);const R=S%1;if(R!==0){const F=R*1e3;p=rc(F)}}}}return{minutes:c,seconds:u,milliseconds:d,microseconds:g,nanoseconds:p}}function Mw(t){if(sn(t))return{years:_(t,br),months:_(t,qn),weeks:_(t,Ur),days:_(t,Er),hours:_(t,Sr),minutes:_(t,Tr),seconds:_(t,Ar),milliseconds:_(t,xr),microseconds:_(t,Ir),nanoseconds:_(t,Rr)};const e=js(t,["days","hours","microseconds","milliseconds","minutes","months","nanoseconds","seconds","weeks","years"]);if(!e)throw new TypeError("invalid duration-like");const{years:n=0,months:r=0,weeks:i=0,days:o=0,hours:s=0,minutes:a=0,seconds:c=0,milliseconds:l=0,microseconds:u=0,nanoseconds:d=0}=e;return{years:n,months:r,weeks:i,days:o,hours:s,minutes:a,seconds:c,milliseconds:l,microseconds:u,nanoseconds:d}}function Vi(t,e=[]){let n;if(jt(t))n=Mw(t);else{const p=Ne(t);n=Ow(p)}const{years:r,months:i,weeks:o,days:s,hours:a,minutes:c,seconds:l,milliseconds:u,microseconds:d,nanoseconds:g}=n;tv(r,i,o,s,a,c,l,u,d,g);for(const p of e)if(n[p]!==0)throw new RangeError(`Duration field ${p} not supported by Temporal.Instant. Try Temporal.ZonedDateTime instead.`);return n}function ir(t){return Ko(t,"overflow",["constrain","reject"],"constrain")}function Ol(t){return Ko(t,"disambiguation",["compatible","earlier","later","reject"],"compatible")}function $n(t,e){return Ko(t,"roundingMode",["ceil","floor","trunc","halfExpand"],e)}function Zl(t){switch(t){case"ceil":return"floor";case"floor":return"ceil";default:return t}}function Ip(t,e){return Ko(t,"offset",["prefer","use","ignore","reject"],e)}function Ql(t){return Ko(t,"calendarName",["auto","always","never"],"auto")}function d2(t){return Ko(t,"timeZoneName",["auto","never"],"auto")}function f2(t){return Ko(t,"offset",["auto","never"],"auto")}function Di(t,e,n){let r=1/0;e!==void 0&&(r=e),!n&&e!==void 0&&(r=e>1?e-1:1);const i=T2(t,"roundingIncrement",1,r,1);if(e!==void 0&&e%i!==0)throw new RangeError(`Rounding increment must divide evenly into ${e}`);return i}function Ml(t,e){return Di(t,{year:void 0,month:void 0,week:void 0,day:void 0,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[e],!1)}function Xl(t){switch(Pr(t,void 0,["year","month","week","day","hour"])){case"minute":return{precision:"minute",unit:"minute",increment:1};case"second":return{precision:0,unit:"second",increment:1};case"millisecond":return{precision:3,unit:"millisecond",increment:1};case"microsecond":return{precision:6,unit:"microsecond",increment:1};case"nanosecond":return{precision:9,unit:"nanosecond",increment:1}}let n=t.fractionalSecondDigits;if(n===void 0&&(n="auto"),typeof n!="number"){const i=Ne(n);if(i==="auto")return{precision:"auto",unit:"nanosecond",increment:1};throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${i}`)}if(Gl(n)||n<0||n>9)throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`);const r=Vn(n);switch(r){case 0:return{precision:r,unit:"second",increment:1};case 1:case 2:case 3:return{precision:r,unit:"millisecond",increment:10**(3-r)};case 4:case 5:case 6:return{precision:r,unit:"microsecond",increment:10**(6-r)};case 7:case 8:case 9:return{precision:r,unit:"nanosecond",increment:10**(9-r)};default:throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`)}}function vi(t,e,n=[],r){const i=new Map(Gd.filter(([,a])=>!n.includes(a))),o=new Set(Ec);for(const a of n)o.delete(a);const s=Ko(t,"largestUnit",["auto",...o,...i.keys()],e);return s==="auto"&&r!==void 0?r:i.has(s)?i.get(s):s}function Pr(t,e,n=[]){const r=new Map(Gd.filter(([,s])=>!n.includes(s))),i=new Set(Ec);for(const s of n)i.delete(s);const o=Ko(t,"smallestUnit",[...i,...r.keys()],e);return r.has(o)?r.get(o):o}function h2(t){const e=new Map(Gd),n=Ko(t,"unit",[...e.values(),...e.keys()],void 0);return e.has(n)?e.get(n):n}function tl(t){const e=t.relativeTo;if(e===void 0)return e;let n="option",r=!1,i,o,s,a,c,l,u,d,g,p,y,w;if(jt(e)){if(Ie(e)||ot(e))return e;if(Qe(e))return ya(e);p=Lc(e);const E=pn(p,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),b=Sd(e,E),S=Rt(null);S.overflow="constrain",{year:i,month:o,day:s,hour:a,minute:c,second:l,millisecond:u,microsecond:d,nanosecond:g}=eu(p,b,S),w=e.offset,w===void 0&&(n="wall"),y=e.timeZone}else{let E,b;({year:i,month:o,day:s,hour:a,minute:c,second:l,millisecond:u,microsecond:d,nanosecond:g,calendar:p,ianaName:E,offset:w,z:b}=Ho(Ne(e))),E&&(y=E),b?n="exact":w||(n="wall"),p||(p=kn()),p=ar(p),r=!0}if(y){y=Br(y);let E=0;n==="option"&&(E=Sa(Ne(w)));const b=Td(i,o,s,a,c,l,u,d,g,n,E,y,"compatible","reject",r);return er(b,y,p)}return Gi(i,o,s,p)}function Ci(t,e){if(Ec.indexOf(t)>Ec.indexOf(e))throw new RangeError(`largestUnit ${t} cannot be smaller than smallestUnit ${e}`)}function Rp(t,e,n,r,i,o,s,a,c,l){const u=new Map(Gd);for(const[d,g]of[["years",t],["months",e],["weeks",n],["days",r],["hours",i],["minutes",o],["seconds",s],["milliseconds",a],["microseconds",c],["nanoseconds",l]])if(g!==0)return u.get(d);return"nanosecond"}function zi(t,e){return Ec.indexOf(t)>Ec.indexOf(e)?e:t}function js(t,e){const n=t,r=e;let i=!1,o={};for(const s of r){const a=n[s];a!==void 0&&(i=!0,bd.has(s)?o[s]=bd.get(s)(a):o[s]=a)}return i?o:!1}function or(t,e){const n=t,r=e,i={};let o=!1;for(const s of r){const[a,c]=s;let l=n[a];if(l===void 0){if(s.length===1)throw new TypeError(`required property '${a}' missing or undefined`);l=c}else o=!0,bd.has(a)&&(l=bd.get(a)(l));i[a]=l}if(!o)throw new TypeError("no supported properties found");if(i.era===void 0!=(i.eraYear===void 0))throw new RangeError("properties 'era' and 'eraYear' must be provided together");return i}function kp(t,e){const n=[["day",void 0],["month",void 0],["monthCode",void 0],["year",void 0]];return e.forEach(r=>{n.some(([i])=>i===r)||n.push([r,void 0])}),or(t,n)}function Sd(t,e){const n=[["day",void 0],["hour",0],["microsecond",0],["millisecond",0],["minute",0],["month",void 0],["monthCode",void 0],["nanosecond",0],["second",0],["year",void 0]];return e.forEach(r=>{n.some(([i])=>i===r)||n.push([r,void 0])}),or(t,n)}function ma(t,e){const n=[["day",void 0],["month",void 0],["monthCode",void 0],["year",void 0]];return e.forEach(r=>{n.some(([i])=>i===r)||n.push([r,void 0])}),or(t,n)}function Bg(t){return or(t,[["hour",0],["microsecond",0],["millisecond",0],["minute",0],["nanosecond",0],["second",0]])}function ii(t,e){const n=[["month",void 0],["monthCode",void 0],["year",void 0]];return e.forEach(r=>{n.some(([i])=>i===r)||n.push([r,void 0])}),or(t,n)}function p2(t,e){const n=[["day",void 0],["hour",0],["microsecond",0],["millisecond",0],["minute",0],["month",void 0],["monthCode",void 0],["nanosecond",0],["second",0],["year",void 0],["offset",void 0],["timeZone"]];return e.forEach(r=>{n.some(([i])=>i===r)||n.push([r,void 0])}),or(t,n)}function Tt(t,e=Rt(null)){let n=t;if(jt(n)){if(ot(n))return n;if(Ie(n)&&(n=bi(_(n,yt),_(n,pr),_(n,ae))),Qe(n))return Gi(_(n,ve),_(n,Se),_(n,Te),_(n,ae));const l=Lc(n),u=pn(l,["day","month","monthCode","year"]),d=kp(n,u);return so(l,d,e)}ir(e);const{year:r,month:i,day:o,calendar:s,z:a}=o2(Ne(n));if(a)throw new RangeError("Z designator not supported for PlainDate");const c=Pe("%Temporal.PlainDate%");return new c(r,i,o,s)}function eu(t,e,n){let{hour:r,minute:i,second:o,millisecond:s,microsecond:a,nanosecond:c}=Bg(e);const l=ir(n),u=so(t,e,n),d=_(u,ve),g=_(u,Se),p=_(u,Te);return{hour:r,minute:i,second:o,millisecond:s,microsecond:a,nanosecond:c}=_l(r,i,o,s,a,c,l),{year:d,month:g,day:p,hour:r,minute:i,second:o,millisecond:s,microsecond:a,nanosecond:c}}function Ss(t,e=Rt(null)){let n,r,i,o,s,a,c,l,u,d;if(jt(t)){if(Qe(t))return t;if(Ie(t))return bi(_(t,yt),_(t,pr),_(t,ae));if(ot(t))return Zr(_(t,ve),_(t,Se),_(t,Te),0,0,0,0,0,0,_(t,ae));d=Lc(t);const g=pn(d,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),p=Sd(t,g);({year:n,month:r,day:i,hour:o,minute:s,second:a,millisecond:c,microsecond:l,nanosecond:u}=eu(d,p,e))}else{ir(e);let g;if({year:n,month:r,day:i,hour:o,minute:s,second:a,millisecond:c,microsecond:l,nanosecond:u,calendar:d,z:g}=i2(Ne(t)),g)throw new RangeError("Z designator not supported for PlainDateTime");Xw(n,r,i,o,s,a,c,l,u),d===void 0&&(d=kn()),d=ar(d)}return Zr(n,r,i,o,s,a,c,l,u,d)}function cc(t){let e,n,r,i,o,s,a,c,l,u;if(jt(t)){if(sn(t))return t;({years:e,months:n,weeks:r,days:i,hours:o,minutes:s,seconds:a,milliseconds:c,microseconds:l,nanoseconds:u}=Mw(t))}else({years:e,months:n,weeks:r,days:i,hours:o,minutes:s,seconds:a,milliseconds:c,microseconds:l,nanoseconds:u}=Ow(Ne(t)));const d=Pe("%Temporal.Duration%");return new d(e,n,r,i,o,s,a,c,l,u)}function ao(t){if(Un(t))return t;if(Ie(t)){const r=Pe("%Temporal.Instant%");return new r(_(t,Fe))}const e=c2(Ne(t)),n=Pe("%Temporal.Instant%");return new n(e)}function yy(t,e=Rt(null)){if(jt(t)){if(Qn(t))return t;let l,u;if(Gn(t,ae))l=_(t,ae),u=!1;else{let p=t.calendar;u=p===void 0,p===void 0&&(p=kn()),l=ar(p)}const d=pn(l,["day","month","monthCode","year"]),g=ma(t,d);return u&&g.month!==void 0&&g.monthCode===void 0&&g.year===void 0&&(g.year=1972),Sc(l,g,e)}ir(e);let{month:n,day:r,referenceISOYear:i,calendar:o}=Nw(Ne(t)),s=o;if(s===void 0&&(s=kn()),s=ar(s),i===void 0)return Lo(1972,n,r),Ll(n,r,s);const a=Ll(n,r,s,i),c=Rt(null);return Sc(s,a,c)}function Ao(t,e="constrain"){let n=t,r,i,o,s,a,c,l;if(jt(n)){if(an(n))return n;if(Ie(n)&&(n=bi(_(n,yt),_(n,pr),_(n,ae))),Qe(n)){const d=Pe("%Temporal.PlainTime%");return new d(_(n,Ue),_(n,je),_(n,$e),_(n,Be),_(n,He),_(n,Ke))}if(l=Lc(n),Ne(l)!=="iso8601")throw new RangeError("PlainTime can only have iso8601 calendar");({hour:r,minute:i,second:o,millisecond:s,microsecond:a,nanosecond:c}=Bg(n)),{hour:r,minute:i,second:o,millisecond:s,microsecond:a,nanosecond:c}=_l(r,i,o,s,a,c,e)}else if({hour:r,minute:i,second:o,millisecond:s,microsecond:a,nanosecond:c,calendar:l}=s2(Ne(n)),of(r,i,o,s,a,c),l!==void 0&&l!=="iso8601")throw new RangeError("PlainTime can only have iso8601 calendar");const u=Pe("%Temporal.PlainTime%");return new u(r,i,o,s,a,c)}function Ja(t,e=Rt(null)){if(jt(t)){if(vt(t))return t;const l=Lc(t),u=pn(l,["month","monthCode","year"]),d=ii(t,u);return Ds(l,d,e)}ir(e);let{year:n,month:r,referenceISODay:i,calendar:o}=Pw(Ne(t)),s=o;if(s===void 0&&(s=kn()),s=ar(s),i===void 0)return Lo(n,r,1),Ul(n,r,s);const a=Ul(n,r,s,i),c=Rt(null);return Ds(s,a,c)}function Td(t,e,n,r,i,o,s,a,c,l,u,d,g,p,y){const w=Pe("%Temporal.PlainDateTime%"),E=new w(t,e,n,r,i,o,s,a,c);if(l==="wall"||p==="ignore"){const R=$r(d,E,g);return _(R,Fe)}if(l==="exact"||p==="use"){const R=Ps(t,e,n,r,i,o,s,a,c);if(R===null)throw new RangeError("ZonedDateTime outside of supported range");return T.subtract(R,T.BigInt(u))}const b=Ad(d,E);for(const R of b){const F=fo(d,R),M=T.toNumber(oi(T.BigInt(F),6e10,"halfExpand"));if(F===u||y&&M===u)return _(R,Fe)}if(p==="reject"){const R=Gg(u),F=bo(d)?_(d,Es):"time zone";throw new RangeError(`Offset ${R} is invalid for ${E.toString()} in ${F}`)}const S=Kw(b,d,E,g);return _(S,Fe)}function Za(t,e=Rt(null)){let n,r,i,o,s,a,c,l,u,d,g,p,y=!1,w="option";if(jt(t)){if(Ie(t))return t;p=Lc(t);const F=pn(p,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),M=p2(t,F);({year:n,month:r,day:i,hour:o,minute:s,second:a,millisecond:c,microsecond:l,nanosecond:u}=eu(p,M,e)),d=Br(M.timeZone),g=M.offset,g===void 0?w="wall":g=Ne(g)}else{ir(e);let F,M;if({year:n,month:r,day:i,hour:o,minute:s,second:a,millisecond:c,microsecond:l,nanosecond:u,ianaName:F,offset:g,z:M,calendar:p}=r2(Ne(t)),!F)throw new RangeError("time zone ID required in brackets");M?w="exact":g||(w="wall");const P=Pe("%Temporal.TimeZone%");d=new P(F),p||(p=kn()),p=ar(p),y=!0}let E=0;w==="option"&&(E=Sa(g));const b=Ol(e),S=Ip(e,"reject"),R=Td(n,r,i,o,s,a,c,l,u,w,E,d,b,S,y);return er(R,d,p)}function Lw(t,e,n,r,i){Lo(e,n,r),Qw(e,n,r),Bo(t),Xe(t,ve,e),Xe(t,Se,n),Xe(t,Te,r),Xe(t,ae,i),Xe(t,dw,!0),ZS(t,"_repr_",{value:`${t[Symbol.toStringTag]} <${Dp(t)}>`,writable:!1,enumerable:!1,configurable:!1})}function Gi(t,e,n,r=kn()){const i=Pe("%Temporal.PlainDate%"),o=Rt(i.prototype);return Lw(o,t,e,n,r),o}function Uw(t,e,n,r,i,o,s,a,c,l,u){Xw(e,n,r,i,o,s,a,c,l),ev(e,n,r,i,o,s,a,c,l),Bo(t),Xe(t,ve,e),Xe(t,Se,n),Xe(t,Te,r),Xe(t,Ue,i),Xe(t,je,o),Xe(t,$e,s),Xe(t,Be,a),Xe(t,He,c),Xe(t,Ke,l),Xe(t,ae,u),Object.defineProperty(t,"_repr_",{value:`${t[Symbol.toStringTag]} <${Cp(t,"auto")}>`,writable:!1,enumerable:!1,configurable:!1})}function Zr(t,e,n,r,i,o,s,a,c,l=kn()){const u=Pe("%Temporal.PlainDateTime%"),d=Rt(u.prototype);return Uw(d,t,e,n,r,i,o,s,a,c,l),d}function jw(t,e,n,r,i){Lo(i,e,n),Qw(i,e,n),Bo(t),Xe(t,Se,e),Xe(t,Te,n),Xe(t,ve,i),Xe(t,ae,r),Xe(t,hw,!0),Object.defineProperty(t,"_repr_",{value:`${t[Symbol.toStringTag]} <${Pp(t)}>`,writable:!1,enumerable:!1,configurable:!1})}function Ll(t,e,n=kn(),r=1972){const i=Pe("%Temporal.PlainMonthDay%"),o=Rt(i.prototype);return jw(o,t,e,n,r),o}function $w(t,e,n,r,i){Lo(e,n,i),E2(e,n),Bo(t),Xe(t,ve,e),Xe(t,Se,n),Xe(t,Te,i),Xe(t,ae,r),Xe(t,fw,!0),Object.defineProperty(t,"_repr_",{value:`${t[Symbol.toStringTag]} <${Np(t)}>`,writable:!1,enumerable:!1,configurable:!1})}function Ul(t,e,n=kn(),r=1){const i=Pe("%Temporal.PlainYearMonth%"),o=Rt(i.prototype);return $w(o,t,e,n,r),o}function Bw(t,e,n,r){sa(e),Bo(t),Xe(t,Fe,e),Xe(t,yt,n),Xe(t,ae,r);const i=Pe("%Temporal.Instant%"),o=new i(_(t,Fe));Xe(t,pr,o),Object.defineProperty(t,"_repr_",{value:`${t[Symbol.toStringTag]} <${Op(t,"auto")}>`,writable:!1,enumerable:!1,configurable:!1})}function er(t,e,n=kn()){const r=Pe("%Temporal.ZonedDateTime%"),i=Rt(r.prototype);return Bw(i,t,e,n),i}function kn(){const t=Pe("%Temporal.Calendar%");return new t("iso8601")}function pn(t,e){let n=e;t.fields&&(n=t.fields(n));const r=[];for(const i of n){if(typeof i!="string")throw new TypeError("bad return from calendar.fields()");Aw.call(r,i)}return r}function Ea(t,e,n){const r=t.mergeFields;if(!r)return{...e,...n};const i=Reflect.apply(r,t,[e,n]);if(!jt(i))throw new TypeError("bad return from calendar.mergeFields()");return i}function Cr(t,e,n,r,i){let o=i;o===void 0&&(o=t.dateAdd);const s=Ug(o,t,[e,n,r]);if(!ot(s))throw new TypeError("invalid result");return s}function Mo(t,e,n,r,i){let o=i;o===void 0&&(o=t.dateUntil);const s=Ug(o,t,[e,n,r]);if(!sn(s))throw new TypeError("invalid result");return s}function Yd(t,e){const n=t.year(e);if(n===void 0)throw new RangeError("calendar year result must be an integer");return It(n)}function Jd(t,e){const n=t.month(e);if(n===void 0)throw new RangeError("calendar month result must be a positive integer");return bc(n)}function tu(t,e){const n=t.monthCode(e);if(n===void 0)throw new RangeError("calendar monthCode result must be a string");return Ne(n)}function Zd(t,e){const n=t.day(e);if(n===void 0)throw new RangeError("calendar day result must be a positive integer");return bc(n)}function Qd(t,e){let n=t.era(e);return n!==void 0&&(n=Ne(n)),n}function Xd(t,e){let n=t.eraYear(e);return n!==void 0&&(n=It(n)),n}function Hg(t,e){return t.dayOfWeek(e)}function Kg(t,e){return t.dayOfYear(e)}function Wg(t,e){return t.weekOfYear(e)}function qg(t,e){return t.daysInWeek(e)}function lc(t,e){return t.daysInMonth(e)}function ef(t,e){return t.daysInYear(e)}function tf(t,e){return t.monthsInYear(e)}function nf(t,e){return t.inLeapYear(e)}function ar(t){let e=t;if(jt(e)){if(Gn(e,ae))return _(e,ae);if(!("calendar"in e)||(e=e.calendar,jt(e)&&!("calendar"in e)))return e}const n=Ne(e),r=Pe("%Temporal.Calendar%");if(ww(n))return new r(n);let i;try{({calendar:i}=Ho(n))}catch{throw new RangeError(`Invalid calendar: ${n}`)}return i||(i="iso8601"),new r(i)}function Lc(t){if(Gn(t,ae))return _(t,ae);const{calendar:e}=t;return e===void 0?kn():ar(e)}function nu(t,e){if(t===e)return!0;const n=Ne(t),r=Ne(e);return n===r}function Hw(t,e){if(t===e)return e;const n=Ne(t),r=Ne(e);if(n===r||n==="iso8601")return e;if(r==="iso8601")return t;throw new RangeError("irreconcilable calendars")}function so(t,e,n){const r=t.dateFromFields(e,n);if(!ot(r))throw new TypeError("invalid result");return r}function Ds(t,e,n){const r=t.yearMonthFromFields(e,n);if(!vt(r))throw new TypeError("invalid result");return r}function Sc(t,e,n){const r=t.monthDayFromFields(e,n);if(!Qn(r))throw new TypeError("invalid result");return r}function Br(t){let e=t;if(jt(e)){if(Ie(e))return _(e,yt);if(!("timeZone"in e)||(e=e.timeZone,jt(e)&&!("timeZone"in e)))return e}const n=Ne(e),r=Cw(n),i=Pe("%Temporal.TimeZone%");return new i(r)}function Eh(t,e){if(t===e)return!0;const n=Ne(t),r=Ne(e);return n===r}function ya(t){return Gi(_(t,ve),_(t,Se),_(t,Te),_(t,ae))}function Vg(t){const e=Pe("%Temporal.PlainTime%");return new e(_(t,Ue),_(t,je),_(t,$e),_(t,Be),_(t,He),_(t,Ke))}function fo(t,e){let n=t.getOffsetNanosecondsFor;if(typeof n!="function")throw new TypeError("getOffsetNanosecondsFor not callable");const r=Reflect.apply(n,t,[e]);if(typeof r!="number")throw new TypeError("bad return from getOffsetNanosecondsFor");if(!Fw(r)||wt(r)>864e11)throw new RangeError("out-of-range return from getOffsetNanosecondsFor");return r}function Fp(t,e){const n=fo(t,e);return Gg(n)}function bi(t,e,n){const r=_(e,Fe),i=fo(t,e);let{year:o,month:s,day:a,hour:c,minute:l,second:u,millisecond:d,microsecond:g,nanosecond:p}=qw(r);return{year:o,month:s,day:a,hour:c,minute:l,second:u,millisecond:d,microsecond:g,nanosecond:p}=Yw(o,s,a,c,l,u,d,g,p+i),Zr(o,s,a,c,l,u,d,g,p,n)}function $r(t,e,n){const r=Ad(t,e);return Kw(r,t,e,n)}function Kw(t,e,n,r){const i=Pe("%Temporal.Instant%"),o=t.length;if(o===1)return t[0];if(o)switch(r){case"compatible":case"earlier":return t[0];case"later":return t[o-1];case"reject":throw new RangeError("multiple instants found")}const s=_(n,ve),a=_(n,Se),c=_(n,Te),l=_(n,Ue),u=_(n,je),d=_(n,$e),g=_(n,Be),p=_(n,He),y=_(n,Ke),w=Ps(s,a,c,l,u,d,g,p,y);if(w===null)throw new RangeError("DateTime outside of supported range");const E=new i(T.subtract(w,Cs)),b=new i(T.add(w,Cs)),S=fo(e,E),F=fo(e,b)-S;switch(r){case"earlier":{const M=_(n,ae),P=Pe("%Temporal.PlainDateTime%"),D=kd(s,a,c,l,u,d,g,p,y,M,0,0,0,0,0,0,0,0,0,-F,void 0),Y=new P(D.year,D.month,D.day,D.hour,D.minute,D.second,D.millisecond,D.microsecond,D.nanosecond,M);return Ad(e,Y)[0]}case"compatible":case"later":{const M=_(n,ae),P=Pe("%Temporal.PlainDateTime%"),D=kd(s,a,c,l,u,d,g,p,y,M,0,0,0,0,0,0,0,0,0,F,void 0),Y=new P(D.year,D.month,D.day,D.hour,D.minute,D.second,D.millisecond,D.microsecond,D.nanosecond,M),X=Ad(e,Y);return X[X.length-1]}case"reject":throw new RangeError("no such instant found")}}function Ad(t,e){const n=t.getPossibleInstantsFor(e),r=[];for(const i of n){if(!Un(i))throw new TypeError("bad return from getPossibleInstantsFor");Aw.call(r,i)}return r}function Ma(t){let e;if(t<1e3||t>9999){const n=t<0?"-":"+",r=wt(t);e=n+`000000${r}`.slice(-6)}else e=`${t}`;return e}function zt(t){return`00${t}`.slice(-2)}function rf(t,e,n,r,i){if(i==="minute")return"";const o=`:${zt(t)}`;let s=e*1e6+n*1e3+r,a;if(i==="auto"){if(s===0)return o;for(a=`${s}`.padStart(9,"0");a[a.length-1]==="0";)a=a.slice(0,-1)}else{if(i===0)return o;a=`${s}`.padStart(9,"0").slice(0,i)}return`${o}.${a}`}function Sh(t,e,n){let r=e;if(r===void 0){const p=Pe("%Temporal.TimeZone%");r=new p("UTC")}const i=kn(),o=bi(r,t,i),s=Ma(_(o,ve)),a=zt(_(o,Se)),c=zt(_(o,Te)),l=zt(_(o,Ue)),u=zt(_(o,je)),d=rf(_(o,$e),_(o,Be),_(o,He),_(o,Ke),n);let g="Z";if(e!==void 0){const p=fo(r,t);g=Ww(p)}return`${s}-${a}-${c}T${l}:${u}${d}${g}`}function ju(t,e="auto",n=void 0){function r(X){return X<=JS?X.toString(10):T.BigInt(X).toString(10)}const i=_(t,br),o=_(t,qn),s=_(t,Ur),a=_(t,Er),c=_(t,Sr),l=_(t,Tr);let u=_(t,Ar),d=_(t,xr),g=_(t,Ir),p=_(t,Rr);const y=Wi(i,o,s,a,c,l,u,d,g,p);if(n){const{unit:X,increment:$,roundingMode:te}=n;({seconds:u,milliseconds:d,microseconds:g,nanoseconds:p}=Pi(0,0,0,0,0,0,u,d,g,p,$,X,te))}const w=[];i&&w.push(`${r(wt(i))}Y`),o&&w.push(`${r(wt(o))}M`),s&&w.push(`${r(wt(s))}W`),a&&w.push(`${r(wt(a))}D`);const E=[];c&&E.push(`${r(wt(c))}H`),l&&E.push(`${r(wt(l))}M`);const b=[];let S=Tc(0,0,0,u,d,g,p,0),R,F,M,P;({quotient:S,remainder:R}=Wn(S,bt)),{quotient:S,remainder:F}=Wn(S,bt),{quotient:P,remainder:M}=Wn(S,bt);const D=wt(T.toNumber(M))*1e6+wt(T.toNumber(F))*1e3+wt(T.toNumber(R));let Y;if(e==="auto"){if(D!==0)for(Y=`${D}`.padStart(9,"0");Y[Y.length-1]==="0";)Y=Y.slice(0,-1)}else e!==0&&(Y=`${D}`.padStart(9,"0").slice(0,e));return Y&&b.unshift(".",Y),(!T.equal(P,xn)||b.length||e!=="auto")&&b.unshift($g(P).toString()),b.length&&E.push(`${b.join("")}S`),E.length&&E.unshift("T"),!w.length&&!E.length?"PT0S":`${y<0?"-":""}P${w.join("")}${E.join("")}`}function Dp(t,e="auto"){const n=Ma(_(t,ve)),r=zt(_(t,Se)),i=zt(_(t,Te)),o=Ne(_(t,ae)),s=Jl(o,e);return`${n}-${r}-${i}${s}`}function Cp(t,e,n="auto",r=void 0){let i=_(t,ve),o=_(t,Se),s=_(t,Te),a=_(t,Ue),c=_(t,je),l=_(t,$e),u=_(t,Be),d=_(t,He),g=_(t,Ke);if(r){const{unit:M,increment:P,roundingMode:D}=r;({year:i,month:o,day:s,hour:a,minute:c,second:l,millisecond:u,microsecond:d,nanosecond:g}=Zg(i,o,s,a,c,l,u,d,g,P,M,D))}const p=Ma(i),y=zt(o),w=zt(s),E=zt(a),b=zt(c),S=rf(l,u,d,g,e),R=Ne(_(t,ae)),F=Jl(R,n);return`${p}-${y}-${w}T${E}:${b}${S}${F}`}function Pp(t,e="auto"){const n=zt(_(t,Se)),r=zt(_(t,Te));let i=`${n}-${r}`;const o=_(t,ae),s=Ne(o);s!=="iso8601"&&(i=`${Ma(_(t,ve))}-${i}`);const a=Jl(s,e);return a&&(i+=a),i}function Np(t,e="auto"){const n=Ma(_(t,ve)),r=zt(_(t,Se));let i=`${n}-${r}`;const o=_(t,ae),s=Ne(o);s!=="iso8601"&&(i+=`-${zt(_(t,Te))}`);const a=Jl(s,e);return a&&(i+=a),i}function Op(t,e,n="auto",r="auto",i="auto",o=void 0){let s=_(t,pr);if(o){const{unit:S,increment:R,roundingMode:F}=o,M=Fd(_(t,Fe),R,S,F),P=Pe("%Temporal.Instant%");s=new P(M)}const a=_(t,yt),c=kn(),l=bi(a,s,c),u=Ma(_(l,ve)),d=zt(_(l,Se)),g=zt(_(l,Te)),p=zt(_(l,Ue)),y=zt(_(l,je)),w=rf(_(l,$e),_(l,Be),_(l,He),_(l,Ke),e);let E=`${u}-${d}-${g}T${p}:${y}${w}`;if(i!=="never"){const S=fo(a,s);E+=Ww(S)}r!=="never"&&(E+=`[${a}]`);const b=Ne(_(t,ae));return E+=Jl(b,n),E}function oc(t){return nv.test(Yl(t))}function Sa(t){const e=nv.exec(Yl(t));if(!e)throw new RangeError(`invalid time zone offset: ${t}`);const n=e[1]==="-"||e[1]==="\u2212"?-1:1,r=+e[2],i=+(e[3]||0),o=+(e[4]||0),s=+((e[5]||0)+"000000000").slice(0,9);return n*(((r*60+i)*60+o)*1e9+s)}function zg(t){if(oc(t)){const n=Sa(t);return Gg(n)}return Dw(Yl(t)).resolvedOptions().timeZone}function us(t,e){const{year:n,month:r,day:i,hour:o,minute:s,second:a,millisecond:c,microsecond:l,nanosecond:u}=Vw(t,e),d=Ps(n,r,i,o,s,a,c,l,u);if(d===null)throw new RangeError("Date outside of supported range");return T.toNumber(T.subtract(d,t))}function Gg(t){const e=t<0?"-":"+",n=wt(t),r=n%1e9,i=Vn(n/1e9)%60,o=Vn(n/6e10)%60,s=Vn(n/36e11),a=zt(s),c=zt(o),l=zt(i);let u="";if(r){let d=`${r}`.padStart(9,"0");for(;d[d.length-1]==="0";)d=d.slice(0,-1);u=`:${l}.${d}`}else i&&(u=`:${l}`);return`${e}${a}:${c}${u}`}function Ww(t){let e=T.toNumber(oi(T.BigInt(t),6e10,"halfExpand"));const n=e<0?"-":"+";e=wt(e);const r=e/6e10%60,i=Vn(e/36e11),o=zt(i),s=zt(r);return`${n}${o}:${s}`}function Ps(t,e,n,r,i,o,s,a,c){const l=new Date;l.setUTCHours(r,i,o,s),l.setUTCFullYear(t,e-1,n);const u=l.getTime();if(Gl(u))return null;let d=T.multiply(T.BigInt(u),Fi);return d=T.add(d,T.multiply(T.BigInt(a),bt)),d=T.add(d,T.BigInt(c)),T.lessThan(d,Cl)||T.greaterThan(d,Pl)?null:d}function qw(t){const{quotient:e,remainder:n}=Wn(t,Fi);let r=T.toNumber(e),i=T.toNumber(n);i<0&&(i+=1e6,r-=1);const o=Vn(i/1e3)%1e3,s=i%1e3,a=new Date(r),c=a.getUTCFullYear(),l=a.getUTCMonth()+1,u=a.getUTCDate(),d=a.getUTCHours(),g=a.getUTCMinutes(),p=a.getUTCSeconds(),y=a.getUTCMilliseconds();return{epochMilliseconds:r,year:c,month:l,day:u,hour:d,minute:g,second:p,millisecond:y,microsecond:o,nanosecond:s}}function Vw(t,e){const{epochMilliseconds:n,millisecond:r,microsecond:i,nanosecond:o}=qw(t),{year:s,month:a,day:c,hour:l,minute:u,second:d}=y2(e,n);return Yw(s,a,c,l,u,d,r,i,o)}function _y(t,e){return T.lessThan(t,e)?e:t}function zw(){return T.add(Xg(),t2)}function g2(t,e){const n=T.add(t,Rw),r=_y(zw(),n);let i=_y(Iw,t);const o=us(i,e);let s=i,a=o;for(;o===a&&T.lessThan(T.BigInt(i),r);)s=T.add(i,kw),a=us(s,e),o===a&&(i=s);return o===a?null:rv(l=>us(l,e),i,s,o,a)}function Gw(t,e){const n=zw(),r=T.greaterThan(t,n),i=r?T.subtract(t,Rw):Iw;let o=T.subtract(t,jg);const s=us(o,e);let a=o,c=s;for(;s===c&&T.greaterThan(o,i);)a=T.subtract(o,kw),c=us(a,e),s===c&&(o=a);if(s===c){if(r){const u=T.subtract(n,Cs);return Gw(u,e)}return null}return rv(u=>us(u,e),a,o,c,s)}function m2(t){const e=t.split(/[^\w]+/);if(e.length!==7)throw new RangeError(`expected 7 parts in "${t}`);const n=+e[0],r=+e[1];let i=+e[2];const o=e[3].toUpperCase();if(o==="B"||o==="BC")i=-i+1;else if(o!=="A"&&o!=="AD")throw new RangeError(`Unknown era ${o} in "${t}`);let s=+e[4];s===24&&(s=0);const a=+e[5],c=+e[6];if(!nr(i)||!nr(n)||!nr(r)||!nr(s)||!nr(a)||!nr(c))throw new RangeError(`Invalid number in "${t}`);return{year:i,month:n,day:r,hour:s,minute:a,second:c}}function y2(t,e){const r=Dw(t).format(new Date(e));return m2(r)}function _2(t,e,n,r,i,o,s,a,c,l){const u=Ps(e,n,r,i,o,s,a,c,l);if(u===null)throw new RangeError("DateTime outside of supported range");let d=T.subtract(u,Cs);T.lessThan(d,Cl)&&(d=u);let g=T.add(u,Cs);T.greaterThan(g,Pl)&&(g=u);const p=us(d,t),y=us(g,t);return(p===y?[p]:[p,y]).map(E=>{const b=T.subtract(u,T.BigInt(E)),S=Vw(b,t);if(!(e!==S.year||n!==S.month||r!==S.day||i!==S.hour||o!==S.minute||s!==S.second||a!==S.millisecond||c!==S.microsecond||l!==S.nanosecond))return b}).filter(E=>E!==void 0)}function Ns(t){if(t===void 0)return!1;const e=t%4===0,n=t%100===0,r=t%400===0;return e&&(!n||r)}function ds(t,e){return{standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]}[Ns(t)?"leapyear":"standard"][e-1]}function Mp(t,e,n){const r=e+(e<3?10:-2),i=t-(e<3?1:0),o=Vn(i/100),s=i-o*100,c=n,l=Vn(2.6*r-.2),u=s+Vn(s/4),d=Vn(o/4)-2*o,g=(c+l+u+d)%7;return g+(g<=0?7:0)}function xd(t,e,n){let r=n;for(let i=e-1;i>0;i--)r+=ds(t,i);return r}function w2(t,e,n){const r=xd(t,e,n),i=Mp(t,e,n)||7,o=Mp(t,1,1),s=Vn((r-i+10)/7);return s<1?o===5||o===6&&Ns(t-1)?53:52:s===53&&(Ns(t)?366:365)-r<4-i?1:s}function Wi(t,e,n,r,i,o,s,a,c,l){for(const u of[t,e,n,r,i,o,s,a,c,l])if(u!==0)return u<0?-1:1;return 0}function ed(t,e){let n=t,r=e;if(!nr(n)||!nr(r))throw new RangeError("infinity is out of range");return r-=1,n+=Vn(r/12),r%=12,r<0&&(r+=12),r+=1,{year:n,month:r}}function jl(t,e,n){let r=t,i=e,o=n;if(!nr(o))throw new RangeError("infinity is out of range");({year:r,month:i}=ed(r,i));let s=0,a=i>2?r:r-1;for(;s=Ns(a)?366:365,o<-s;)r-=1,a-=1,o+=s;for(a+=1;s=Ns(a)?366:365,o>s;)r+=1,a+=1,o-=s;for(;o<1;)({year:r,month:i}=ed(r,i-1)),o+=ds(r,i);for(;o>ds(r,i);)o-=ds(r,i),{year:r,month:i}=ed(r,i+1);return{year:r,month:i,day:o}}function Yw(t,e,n,r,i,o,s,a,c){const{deltaDays:l,hour:u,minute:d,second:g,millisecond:p,microsecond:y,nanosecond:w}=ts(r,i,o,s,a,c),{year:E,month:b,day:S}=jl(t,e,n+l);return{year:E,month:b,day:S,hour:u,minute:d,second:g,millisecond:p,microsecond:y,nanosecond:w}}function ts(t,e,n,r,i,o){let s=t,a=e,c=n,l=r,u=i,d=o;if(!nr(s)||!nr(a)||!nr(c)||!nr(l)||!nr(u)||!nr(d))throw new RangeError("infinity is out of range");u+=Vn(d/1e3),d=Qa(d,1e3),l+=Vn(u/1e3),u=Qa(u,1e3),c+=Vn(l/1e3),l=Qa(l,1e3),a+=Vn(c/60),c=Qa(c,60),s+=Vn(a/60),a=Qa(a,60);const g=Vn(s/24);return s=Qa(s,24),{deltaDays:g,hour:s,minute:a,second:c,millisecond:l,microsecond:u,nanosecond:d}}function Tc(t,e,n,r,i,o,s,a){const c=T.BigInt(t);let l=T.BigInt(s);t!==0&&(l=T.subtract(T.BigInt(s),T.BigInt(a)));const u=T.add(T.BigInt(e),T.multiply(c,T.BigInt(24))),d=T.add(T.BigInt(n),T.multiply(u,ga)),g=T.add(T.BigInt(r),T.multiply(d,ga)),p=T.add(T.BigInt(i),T.multiply(g,bt)),y=T.add(T.BigInt(o),T.multiply(p,bt));return T.add(T.BigInt(l),T.multiply(y,bt))}function Yg(t,e){const n=Pe("%Temporal.Instant%"),r=Dl(T.toNumber(t));let i=T.BigInt(t),o=864e11;if(r===0)return{days:0,nanoseconds:xn,dayLengthNs:o};if(!Ie(e)){let S;return{quotient:S,remainder:i}=Wn(i,T.BigInt(o)),{days:T.toNumber(S),nanoseconds:i,dayLengthNs:o}}const s=_(e,Fe),a=_(e,pr),c=T.add(s,i),l=new n(c),u=_(e,yt),d=_(e,ae),g=bi(u,a,d),p=bi(u,l,d);let{days:y}=Id(_(g,ve),_(g,Se),_(g,Te),_(g,Ue),_(g,je),_(g,$e),_(g,Be),_(g,He),_(g,Ke),_(p,ve),_(p,Se),_(p,Te),_(p,Ue),_(p,je),_(p,$e),_(p,Be),_(p,He),_(p,Ke),d,"day"),w=wi(a,u,d,0,0,0,y,0,0,0,0,0,0);if(r===1)for(;y>0&&T.greaterThan(w,c);)--y,w=wi(a,u,d,0,0,0,y,0,0,0,0,0,0);i=T.subtract(c,w);let E=!1,b=new n(w);do{const S=wi(b,u,d,0,0,0,r,0,0,0,0,0,0),R=_(b,Fe);o=T.toNumber(T.subtract(S,R)),E=T.greaterThan(T.multiply(T.subtract(i,T.BigInt(o)),T.BigInt(r)),xn),E&&(i=T.subtract(i,T.BigInt(o)),b=new n(S),y+=r)}while(E);return{days:y,nanoseconds:i,dayLengthNs:wt(o)}}function sr(t,e,n,r,i,o,s,a,c=void 0){let l=t,u,d,g,p,y,w;if(Ie(c)){const D=wi(_(c,pr),_(c,yt),_(c,ae),0,0,0,l,e,n,r,i,o,s),Y=_(c,Fe);u=T.subtract(D,Y)}else u=Tc(l,e,n,r,i,o,s,0);a==="year"||a==="month"||a==="week"||a==="day"?{days:l,nanoseconds:u}=Yg(u,c):l=0;const E=T.lessThan(u,xn)?-1:1;switch(u=$g(u),d=g=p=y=w=xn,a){case"year":case"month":case"week":case"day":case"hour":({quotient:d,remainder:u}=Wn(u,bt)),{quotient:g,remainder:d}=Wn(d,bt),{quotient:p,remainder:g}=Wn(g,bt),{quotient:y,remainder:p}=Wn(p,ga),{quotient:w,remainder:y}=Wn(y,ga);break;case"minute":({quotient:d,remainder:u}=Wn(u,bt)),{quotient:g,remainder:d}=Wn(d,bt),{quotient:p,remainder:g}=Wn(g,bt),{quotient:y,remainder:p}=Wn(p,ga);break;case"second":({quotient:d,remainder:u}=Wn(u,bt)),{quotient:g,remainder:d}=Wn(d,bt),{quotient:p,remainder:g}=Wn(g,bt);break;case"millisecond":({quotient:d,remainder:u}=Wn(u,bt)),{quotient:g,remainder:d}=Wn(d,bt);break;case"microsecond":({quotient:d,remainder:u}=Wn(u,bt));break;case"nanosecond":break;default:throw new Error("assert not reached")}const b=T.toNumber(w)*E,S=T.toNumber(y)*E,R=T.toNumber(p)*E,F=T.toNumber(g)*E,M=T.toNumber(d)*E,P=T.toNumber(u)*E;return{days:l,hours:b,minutes:S,seconds:R,milliseconds:F,microseconds:M,nanoseconds:P}}function $u(t,e,n,r,i,o){let s=t,a=e,c=n,l=r;const u=Pe("%Temporal.Duration%"),d=Wi(s,a,c,l,0,0,0,0,0,0);let g,p;o&&(p=Tt(o),g=_(p,ae));const y=new u(d),w=new u(0,d),E=new u(0,0,d);switch(i){case"year":break;case"month":{if(!g)throw new RangeError("a starting point is required for months balancing");const b=g.dateAdd,S=g.dateUntil;let R=p;for(;wt(s)>0;){const F=Rt(null),M=Cr(g,R,y,F,b),P=Rt(null);P.largestUnit="month";const D=Mo(g,R,M,P,S),Y=_(D,qn);R=M,a+=Y,s-=d}}break;case"week":if(!g)throw new RangeError("a starting point is required for weeks balancing");for(;wt(s)>0;){let b;({relativeTo:p,days:b}=kr(g,p,y)),l+=b,s-=d}for(;wt(a)>0;){let b;({relativeTo:p,days:b}=kr(g,p,w)),l+=b,a-=d}break;default:for(;wt(s)>0;){if(!g)throw new RangeError("a starting point is required for balancing calendar units");let b;({relativeTo:p,days:b}=kr(g,p,y)),l+=b,s-=d}for(;wt(a)>0;){if(!g)throw new RangeError("a starting point is required for balancing calendar units");let b;({relativeTo:p,days:b}=kr(g,p,w)),l+=b,a-=d}for(;wt(c)>0;){if(!g)throw new RangeError("a starting point is required for balancing calendar units");let b;({relativeTo:p,days:b}=kr(g,p,E)),l+=b,c-=d}break}return{years:s,months:a,weeks:c,days:l}}function v2(t,e,n,r,i,o){let s=t,a=e,c=n,l=r;const u=Pe("%Temporal.Duration%"),d=Wi(s,a,c,l,0,0,0,0,0,0);if(d===0)return{years:s,months:a,weeks:c,days:l};let g,p;o&&(p=Tt(o),g=_(p,ae));const y=new u(d),w=new u(0,d),E=new u(0,0,d);switch(i){case"year":{if(!g)throw new RangeError("a starting point is required for years balancing");let b,S;for({relativeTo:b,days:S}=kr(g,p,y);wt(l)>=wt(S);)l-=S,s+=d,p=b,{relativeTo:b,days:S}=kr(g,p,y);let R;for({relativeTo:b,days:R}=kr(g,p,w);wt(l)>=wt(R);)l-=R,a+=d,p=b,{relativeTo:b,days:R}=kr(g,p,w);const F=g.dateAdd,M=Rt(null);b=Cr(g,p,y,M,F);const P=g.dateUntil,D=Rt(null);D.largestUnit="month";let Y=Mo(g,p,b,D,P),X=_(Y,qn);for(;wt(a)>=wt(X);){a-=X,s+=d,p=b;const $=Rt(null);b=Cr(g,p,y,$,F);const te=Rt(null);te.largestUnit="month",Y=Mo(g,p,b,te,P),X=_(Y,qn)}break}case"month":{if(!g)throw new RangeError("a starting point is required for months balancing");let b,S;for({relativeTo:b,days:S}=kr(g,p,w);wt(l)>=wt(S);)l-=S,a+=d,p=b,{relativeTo:b,days:S}=kr(g,p,w);break}case"week":{if(!g)throw new RangeError("a starting point is required for weeks balancing");let b,S;for({relativeTo:b,days:S}=kr(g,p,E);wt(l)>=wt(S);)l-=S,c+=d,p=b,{relativeTo:b,days:S}=kr(g,p,E);break}}return{years:s,months:a,weeks:c,days:l}}function wy(t,e,n,r,i,o,s,a,c,l,u){if(Ie(t)){const d=_(t,pr),g=_(t,yt),p=_(t,ae),y=fo(g,d),w=wi(d,g,p,e,n,r,i,o,s,a,c,l,u),E=Pe("%Temporal.Instant%"),b=new E(w);return fo(g,b)-y}return 0}function Jw(t){const e=Pe("%Temporal.Duration%");return new e(-_(t,br),-_(t,qn),-_(t,Ur),-_(t,Er),-_(t,Sr),-_(t,Tr),-_(t,Ar),-_(t,xr),-_(t,Ir),-_(t,Rr))}function ci(t,e,n){return zS(n,GS(e,t))}function Zw(t,e,n){const r=ci(e,1,12),i=ci(n,1,ds(t,r));return{year:t,month:r,day:i}}function b2(t,e,n,r,i,o){const s=ci(t,0,23),a=ci(e,0,59),c=ci(n,0,59),l=ci(r,0,999),u=ci(i,0,999),d=ci(o,0,999);return{hour:s,minute:a,second:c,millisecond:l,microsecond:u,nanosecond:d}}function gr(t,e,n){if(t<e||t>n)throw new RangeError(`value out of range: ${e} <= ${t} <= ${n}`)}function Lo(t,e,n){gr(e,1,12),gr(n,1,ds(t,e))}function Qw(t,e,n){ev(t,e,n,12,0,0,0,0,0)}function of(t,e,n,r,i,o){gr(t,0,23),gr(e,0,59),gr(n,0,59),gr(r,0,999),gr(i,0,999),gr(o,0,999)}function Xw(t,e,n,r,i,o,s,a,c){Lo(t,e,n),of(r,i,o,s,a,c)}function ev(t,e,n,r,i,o,s,a,c){if(gr(t,wd,vd),t===wd&&Ps(t,e,n+1,r,i,o,s,a,c-1)==null||t===vd&&Ps(t,e,n-1,r,i,o,s,a,c+1)==null)throw new RangeError("DateTime outside of supported range")}function sa(t){if(T.lessThan(t,Cl)||T.greaterThan(t,Pl))throw new RangeError("Instant outside of supported range")}function E2(t,e){gr(t,wd,vd),t===wd?gr(e,4,12):t===vd&&gr(e,1,9)}function tv(t,e,n,r,i,o,s,a,c,l){const u=Wi(t,e,n,r,i,o,s,a,c,l);for(const d of[t,e,n,r,i,o,s,a,c,l]){if(!nr(d))throw new RangeError("infinite values not allowed as duration fields");const g=Dl(d);if(g!==0&&g!==u)throw new RangeError("mixed-sign values not allowed as duration fields")}}function Jg(t,e,n,r,i,o,s){switch(s){case"year":case"month":{const a=-rs(t,e,n,r,i,o);if(a===0)return{years:0,months:0,weeks:0,days:0};const c={year:t,month:e,day:n},l={year:r,month:i,day:o};let u=l.year-c.year,d=_a(t,e,n,u,0,0,0,"constrain"),g=-rs(d.year,d.month,d.day,r,i,o);if(g===0)return s==="year"?{years:u,months:0,weeks:0,days:0}:{years:0,months:u*12,weeks:0,days:0};let p=l.month-c.month;if(g!==a&&(u-=a,p+=a*12),d=_a(t,e,n,u,p,0,0,"constrain"),g=-rs(d.year,d.month,d.day,r,i,o),g===0)return s==="year"?{years:u,months:p,weeks:0,days:0}:{years:0,months:p+u*12,weeks:0,days:0};g!==a&&(p-=a,p===-a&&(u-=a,p=11*a),d=_a(t,e,n,u,p,0,0,"constrain"),g=-rs(t,e,n,d.year,d.month,d.day));let y=0;return d.month===l.month?y=l.day-d.day:a<0?y=-d.day-(ds(l.year,l.month)-l.day):y=l.day+(ds(d.year,d.month)-d.day),s==="month"&&(p+=u*12,u=0),{years:u,months:p,weeks:0,days:y}}case"week":case"day":{let a,c,l;rs(t,e,n,r,i,o)<0?(c={year:t,month:e,day:n},a={year:r,month:i,day:o},l=1):(c={year:r,month:i,day:o},a={year:t,month:e,day:n},l=-1);let u=xd(a.year,a.month,a.day)-xd(c.year,c.month,c.day);for(let g=c.year;g<a.year;++g)u+=Ns(g)?366:365;let d=0;return s==="week"&&(d=Vn(u/7),u%=7),d*=l,u*=l,{years:0,months:0,weeks:d,days:u}}default:throw new Error("assert not reached")}}function Lp(t,e,n,r,i,o,s,a,c,l,u,d){let g=s-t,p=a-e,y=c-n,w=l-r,E=u-i,b=d-o;const S=Wi(0,0,0,0,g,p,y,w,E,b);g*=S,p*=S,y*=S,w*=S,E*=S,b*=S;let R=0;return{deltaDays:R,hour:g,minute:p,second:y,millisecond:w,microsecond:E,nanosecond:b}=ts(g,p,y,w,E,b),R*=S,g*=S,p*=S,y*=S,w*=S,E*=S,b*=S,{deltaDays:R,hours:g,minutes:p,seconds:y,milliseconds:w,microseconds:E,nanoseconds:b}}function $l(t,e,n,r,i){const o=T.subtract(e,t),s=T.remainder(o,T.BigInt(864e11)),a=T.subtract(o,s),c=oi(s,e0[r]*n,i),l=T.add(a,c),u=T.toNumber(T.remainder(l,bt)),d=T.toNumber(T.remainder(T.divide(l,bt),bt)),g=T.toNumber(T.remainder(T.divide(l,Fi),bt));return{seconds:T.toNumber(T.divide(l,ls)),milliseconds:g,microseconds:d,nanoseconds:u}}function Id(t,e,n,r,i,o,s,a,c,l,u,d,g,p,y,w,E,b,S,R,F=Rt(null)){let M=t,P=e,D=n,{deltaDays:Y,hours:X,minutes:$,seconds:te,milliseconds:_e,microseconds:Ae,nanoseconds:re}=Lp(r,i,o,s,a,c,g,p,y,w,E,b);const se=Wi(0,0,0,Y,X,$,te,_e,Ae,re);({year:M,month:P,day:D}=jl(M,P,D+Y)),rs(l,u,d,M,P,D)===-se&&({year:M,month:P,day:D}=jl(M,P,D-se),{hours:X,minutes:$,seconds:te,milliseconds:_e,microseconds:Ae,nanoseconds:re}=sr(-se,X,$,te,_e,Ae,re,R));const Ce=Gi(M,P,D,S),Ze=Gi(l,u,d,S),Ee=zi("day",R),Ve={...F,largestUnit:Ee};let{years:Ge,months:tt,weeks:rn,days:St}=Mo(S,Ce,Ze,Ve);return{days:St,hours:X,minutes:$,seconds:te,milliseconds:_e,microseconds:Ae,nanoseconds:re}=sr(St,X,$,te,_e,Ae,re,R),{years:Ge,months:tt,weeks:rn,days:St,hours:X,minutes:$,seconds:te,milliseconds:_e,microseconds:Ae,nanoseconds:re}}function Up(t,e,n,r,i,o){const s=T.subtract(e,t);if(T.equal(s,xn))return{years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};const a=Pe("%Temporal.Instant%"),c=new a(t),l=new a(e),u=bi(n,c,r),d=bi(n,l,r);let{years:g,months:p,weeks:y,days:w}=Id(_(u,ve),_(u,Se),_(u,Te),_(u,Ue),_(u,je),_(u,$e),_(u,Be),_(u,He),_(u,Ke),_(d,ve),_(d,Se),_(d,Te),_(d,Ue),_(d,je),_(d,$e),_(d,Be),_(d,He),_(d,Ke),r,i,o);const E=wi(c,n,r,g,p,y,0,0,0,0,0,0,0);let b=T.subtract(e,E);const S=er(E,n,r);({nanoseconds:b,days:w}=Yg(b,S));const{hours:R,minutes:F,seconds:M,milliseconds:P,microseconds:D,nanoseconds:Y}=sr(0,0,0,0,0,0,T.toNumber(b),"hour");return{years:g,months:p,weeks:y,days:w,hours:R,minutes:F,seconds:M,milliseconds:P,microseconds:D,nanoseconds:Y}}function _a(t,e,n,r,i,o,s,a){let c=t,l=e,u=n,d=r,g=i,p=o,y=s;return c+=d,l+=g,{year:c,month:l}=ed(c,l),{year:c,month:l,day:u}=Ed(c,l,u,a),y+=7*p,u+=y,{year:c,month:l,day:u}=jl(c,l,u),{year:c,month:l,day:u}}function jp(t,e,n,r,i,o,s,a,c,l,u,d){let g=t,p=e,y=n,w=r,E=i,b=o;g+=s,p+=a,y+=c,w+=l,E+=u,b+=d;let S=0;return{deltaDays:S,hour:g,minute:p,second:y,millisecond:w,microsecond:E,nanosecond:b}=ts(g,p,y,w,E,b),{deltaDays:S,hour:g,minute:p,second:y,millisecond:w,microsecond:E,nanosecond:b}}function $p(t,e,n,r,i,o,s,a,c,l,u,d,g,p,y,w,E,b,S,R,F){const M=Rp(t,e,n,r,i,o,s,a,c,l),P=Rp(u,d,g,p,y,w,E,b,S,R),D=zi(M,P);let Y,X,$,te,_e,Ae,re,se,we,Ce;if(F)if(ot(F)){const Ze=Pe("%Temporal.Duration%"),Ee=_(F,ae),Ve=new Ze(t,e,n,r,0,0,0,0,0,0),Ge=new Ze(u,d,g,p,0,0,0,0,0,0),tt=Ee.dateAdd,rn=Rt(null),St=Cr(Ee,F,Ve,rn,tt),cn=Rt(null),_r=Cr(Ee,St,Ge,cn,tt),Fn=zi("day",D),ln=Rt(null);ln.largestUnit=Fn,{years:Y,months:X,weeks:$,days:te}=Mo(Ee,F,_r,ln),{days:te,hours:_e,minutes:Ae,seconds:re,milliseconds:se,microseconds:we,nanoseconds:Ce}=sr(te,i+y,o+w,s+E,a+b,c+S,l+R,D)}else{const Ze=Pe("%Temporal.Instant%"),Ee=_(F,yt),Ve=_(F,ae),Ge=wi(_(F,pr),Ee,Ve,t,e,n,r,i,o,s,a,c,l),tt=wi(new Ze(Ge),Ee,Ve,u,d,g,p,y,w,E,b,S,R);D!=="year"&&D!=="month"&&D!=="week"&&D!=="day"?(Y=0,X=0,$=0,te=0,{seconds:re,milliseconds:se,microseconds:we,nanoseconds:Ce}=$l(_(F,Fe),tt,1,"nanosecond","halfExpand"),{hours:_e,minutes:Ae,seconds:re,milliseconds:se,microseconds:we,nanoseconds:Ce}=sr(0,0,0,re,se,we,Ce,D)):{years:Y,months:X,weeks:$,days:te,hours:_e,minutes:Ae,seconds:re,milliseconds:se,microseconds:we,nanoseconds:Ce}=Up(_(F,Fe),tt,Ee,Ve,D)}else{if(D==="year"||D==="month"||D==="week")throw new RangeError("relativeTo is required for years, months, or weeks arithmetic");Y=X=$=0,{days:te,hours:_e,minutes:Ae,seconds:re,milliseconds:se,microseconds:we,nanoseconds:Ce}=sr(r+p,i+y,o+w,s+E,a+b,c+S,l+R,D)}return tv(Y,X,$,te,_e,Ae,re,se,we,Ce),{years:Y,months:X,weeks:$,days:te,hours:_e,minutes:Ae,seconds:re,milliseconds:se,microseconds:we,nanoseconds:Ce}}function Rd(t,e,n,r,i,o,s){let a=xn;a=T.add(a,T.BigInt(s)),a=T.add(a,T.multiply(T.BigInt(o),bt)),a=T.add(a,T.multiply(T.BigInt(i),Fi)),a=T.add(a,T.multiply(T.BigInt(r),ls)),a=T.add(a,T.multiply(T.BigInt(n),T.BigInt(60*1e9))),a=T.add(a,T.multiply(T.BigInt(e),T.BigInt(60*60*1e9)));const c=T.add(t,a);return sa(c),c}function kd(t,e,n,r,i,o,s,a,c,l,u,d,g,p,y,w,E,b,S,R,F){let M=p,{deltaDays:P,hour:D,minute:Y,second:X,millisecond:$,microsecond:te,nanosecond:_e}=jp(r,i,o,s,a,c,y,w,E,b,S,R);M+=P;const Ae=Pe("%Temporal.Duration%"),re=Gi(t,e,n,l),se=new Ae(u,d,g,M,0,0,0,0,0,0),we=Cr(l,re,se,F);return{year:_(we,ve),month:_(we,Se),day:_(we,Te),hour:D,minute:Y,second:X,millisecond:$,microsecond:te,nanosecond:_e}}function wi(t,e,n,r,i,o,s,a,c,l,u,d,g,p){const y=Pe("%Temporal.Duration%");if(Wi(r,i,o,s,0,0,0,0,0,0)===0)return Rd(_(t,Fe),a,c,l,u,d,g);const w=bi(e,t,n),E=Gi(_(w,ve),_(w,Se),_(w,Te),n),b=new y(r,i,o,s,0,0,0,0,0,0),S=Cr(n,E,b,p),R=Zr(_(S,ve),_(S,Se),_(S,Te),_(w,Ue),_(w,je),_(w,$e),_(w,Be),_(w,He),_(w,Ke),n),F=$r(e,R,"compatible");return Rd(_(F,Fe),a,c,l,u,d,g)}function oi(t,e,n){if(e===1)return t;let{quotient:r,remainder:i}=Wn(t,T.BigInt(e));if(T.equal(i,xn))return t;const o=T.lessThan(i,xn)?-1:1;switch(n){case"ceil":o>0&&(r=T.add(r,T.BigInt(o)));break;case"floor":o<0&&(r=T.add(r,T.BigInt(o)));break;case"trunc":break;case"halfExpand":T.toNumber($g(T.multiply(i,T.BigInt(2))))>=e&&(r=T.add(r,T.BigInt(o)));break}return T.multiply(r,T.BigInt(e))}function Fd(t,e,n,r){let i=T.remainder(t,T.BigInt(864e11));T.lessThan(i,xn)&&(i=T.add(i,T.BigInt(864e11)));const o=T.subtract(t,i),s=oi(i,e0[n]*e,r);return T.add(o,s)}function Zg(t,e,n,r,i,o,s,a,c,l,u,d,g=864e11){const{deltaDays:p,hour:y,minute:w,second:E,millisecond:b,microsecond:S,nanosecond:R}=Qg(r,i,o,s,a,c,l,u,d,g),{year:F,month:M,day:P}=jl(t,e,n+p);return{year:F,month:M,day:P,hour:y,minute:w,second:E,millisecond:b,microsecond:S,nanosecond:R}}function Qg(t,e,n,r,i,o,s,a,c,l=864e11){let u=xn;switch(a){case"day":case"hour":u=T.BigInt(t);case"minute":u=T.add(T.multiply(u,ga),T.BigInt(e));case"second":u=T.add(T.multiply(u,ga),T.BigInt(n));case"millisecond":u=T.add(T.multiply(u,bt),T.BigInt(r));case"microsecond":u=T.add(T.multiply(u,bt),T.BigInt(i));case"nanosecond":u=T.add(T.multiply(u,bt),T.BigInt(o))}const d=a==="day"?l:e0[a],g=oi(u,d*s,c),p=T.toNumber(T.divide(g,T.BigInt(d)));switch(a){case"day":return{deltaDays:p,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0};case"hour":return ts(p,0,0,0,0,0);case"minute":return ts(t,p,0,0,0,0);case"second":return ts(t,e,p,0,0,0);case"millisecond":return ts(t,e,n,p,0,0);case"microsecond":return ts(t,e,n,r,p,0);case"nanosecond":return ts(t,e,n,r,i,p);default:throw new Error(`Invalid unit ${a}`)}}function td(t,e){return Jg(_(t,ve),_(t,Se),_(t,Te),_(e,ve),_(e,Se),_(e,Te),"day").days}function kr(t,e,n){const r=Rt(null),i=Cr(t,e,n,r),o=td(e,i);return{relativeTo:i,days:o}}function Bp(t,e,n,r,i){const o=_(t,yt),s=_(t,ae),a=wi(_(t,pr),o,s,e,n,r,i,0,0,0,0,0,0);return er(a,o,s)}function Hp(t,e,n,r,i,o,s,a,c,l,u,d,g,p){let y=t,w=e,E=n,b=r,S=i,R=o,F=s,M=a,P=c,D=l;if(!Ie(p)||d==="year"||d==="month"||d==="week"||d==="day"||d==="nanosecond"&&u===1)return{years:y,months:w,weeks:E,days:b,hours:S,minutes:R,seconds:F,milliseconds:M,microseconds:P,nanoseconds:D};let Y=Tc(0,S,R,F,M,P,D,0);const X=Dl(T.toNumber(Y)),$=_(p,yt),te=_(p,ae),_e=wi(_(p,pr),$,te,y,w,E,b,0,0,0,0,0,0),Ae=Pe("%Temporal.Instant%"),re=wi(new Ae(_e),$,te,0,0,0,X,0,0,0,0,0,0),se=T.subtract(re,_e);return T.greaterThanOrEqual(T.multiply(T.subtract(Y,se),T.BigInt(X)),xn)&&({years:y,months:w,weeks:E,days:b}=$p(y,w,E,b,0,0,0,0,0,0,0,0,0,X,0,0,0,0,0,0,p),Y=Fd(T.subtract(Y,se),u,d,g),{hours:S,minutes:R,seconds:F,milliseconds:M,microseconds:P,nanoseconds:D}=sr(0,0,0,0,0,0,T.toNumber(Y),"hour")),{years:y,months:w,weeks:E,days:b,hours:S,minutes:R,seconds:F,milliseconds:M,microseconds:P,nanoseconds:D}}function Pi(t,e,n,r,i,o,s,a,c,l,u,d,g,p=void 0){let y=t,w=e,E=n,b=r,S=i,R=o,F=s,M=a,P=c,D=T.BigInt(l);const Y=Pe("%Temporal.Duration%");let X,$,te=p;if(te){if(Ie(te))$=te,te=Tt(te);else if(!ot(te))throw new TypeError("starting point must be PlainDate or ZonedDateTime");X=_(te,ae)}let _e;if(d==="year"||d==="month"||d==="week"||d==="day"){D=Tc(0,S,R,F,M,P,l,0);let re;$&&(re=Bp($,y,w,E,b));let se,we;({days:se,nanoseconds:D,dayLengthNs:we}=Yg(D,re)),_e=T.BigInt(we),b+=se,S=R=F=M=P=0}let Ae;switch(d){case"year":{if(!X)throw new RangeError("A starting point is required for years rounding");const re=new Y(y),se=X.dateAdd,we=Rt(null),Ce=Cr(X,te,re,we,se),Ze=new Y(y,w,E),Ee=Rt(null),Ve=Cr(X,te,Ze,Ee,se),Ge=td(Ce,Ve);te=Ce,b+=Ge;const tt=Rt(null),rn=Cr(X,te,{days:b},tt,se),St=Rt(null);St.largestUnit="year";const cn=Mo(X,te,rn,St).years;y+=cn;const _r=te,Fn=Rt(null);te=Cr(X,te,{years:cn},Fn,se),b-=td(_r,te);const vn=new Y(b<0?-1:1);let{days:Mt}=kr(X,te,vn);Mt=wt(Mt);const Q=T.multiply(T.BigInt(Mt),_e);D=T.add(T.add(T.multiply(Q,T.BigInt(y)),T.multiply(T.BigInt(b),_e)),D);const N=oi(D,T.toNumber(T.multiply(Q,T.BigInt(u))),g);Ae=T.toNumber(D)/T.toNumber(Q),y=T.toNumber(T.divide(N,Q)),D=xn,w=E=b=0;break}case"month":{if(!X)throw new RangeError("A starting point is required for months rounding");const re=new Y(y,w),se=X.dateAdd,we=Rt(null),Ce=Cr(X,te,re,we,se),Ze=new Y(y,w,E),Ee=Rt(null),Ve=Cr(X,te,Ze,Ee,se),Ge=td(Ce,Ve);te=Ce,b+=Ge;const tt=Dl(b),rn=new Y(0,b<0?-1:1);let St;for({relativeTo:te,days:St}=kr(X,te,rn);wt(b)>=wt(St);)w+=tt,b-=St,{relativeTo:te,days:St}=kr(X,te,rn);St=wt(St);const cn=T.multiply(T.BigInt(St),_e);D=T.add(T.add(T.multiply(cn,T.BigInt(w)),T.multiply(T.BigInt(b),_e)),D);const _r=oi(D,T.toNumber(T.multiply(cn,T.BigInt(u))),g);Ae=T.toNumber(D)/T.toNumber(cn),w=T.toNumber(T.divide(_r,cn)),D=xn,E=b=0;break}case"week":{if(!X)throw new RangeError("A starting point is required for weeks rounding");const re=Dl(b),se=new Y(0,0,b<0?-1:1);let we;for({relativeTo:te,days:we}=kr(X,te,se);wt(b)>=wt(we);)E+=re,b-=we,{relativeTo:te,days:we}=kr(X,te,se);we=wt(we);const Ce=T.multiply(T.BigInt(we),_e);D=T.add(T.add(T.multiply(Ce,T.BigInt(E)),T.multiply(T.BigInt(b),_e)),D);const Ze=oi(D,T.toNumber(T.multiply(Ce,T.BigInt(u))),g);Ae=T.toNumber(D)/T.toNumber(Ce),E=T.toNumber(T.divide(Ze,Ce)),D=xn,b=0;break}case"day":{const re=_e;D=T.add(T.multiply(re,T.BigInt(b)),D);const se=oi(D,T.toNumber(T.multiply(re,T.BigInt(u))),g);Ae=T.toNumber(D)/T.toNumber(re),b=T.toNumber(T.divide(se,re)),D=xn;break}case"hour":{let se=T.multiply(T.BigInt(S),T.BigInt(36e11));se=T.add(se,T.multiply(T.BigInt(R),T.BigInt(6e10))),se=T.add(se,T.multiply(T.BigInt(F),ls)),se=T.add(se,T.multiply(T.BigInt(M),Fi)),se=T.add(se,T.multiply(T.BigInt(P),bt)),se=T.add(se,D),Ae=T.toNumber(se)/36e11;const we=oi(se,36e11*u,g);S=T.toNumber(T.divide(we,T.BigInt(36e11))),D=xn,R=F=M=P=0;break}case"minute":{let se=T.multiply(T.BigInt(R),T.BigInt(6e10));se=T.add(se,T.multiply(T.BigInt(F),ls)),se=T.add(se,T.multiply(T.BigInt(M),Fi)),se=T.add(se,T.multiply(T.BigInt(P),bt)),se=T.add(se,D),Ae=T.toNumber(se)/6e10;const we=oi(se,6e10*u,g);R=T.toNumber(T.divide(we,T.BigInt(6e10))),D=xn,F=M=P=0;break}case"second":{let se=T.multiply(T.BigInt(F),ls);se=T.add(se,T.multiply(T.BigInt(M),Fi)),se=T.add(se,T.multiply(T.BigInt(P),bt)),se=T.add(se,D),Ae=T.toNumber(se)/1e9;const we=oi(se,1e9*u,g);F=T.toNumber(T.divide(we,T.BigInt(1e9))),D=xn,M=P=0;break}case"millisecond":{let se=T.multiply(T.BigInt(M),Fi);se=T.add(se,T.multiply(T.BigInt(P),bt)),se=T.add(se,D),Ae=T.toNumber(se)/1e6;const we=oi(se,1e6*u,g);M=T.toNumber(T.divide(we,T.BigInt(1e6))),D=xn,P=0;break}case"microsecond":{let se=T.multiply(T.BigInt(P),bt);se=T.add(se,D),Ae=T.toNumber(se)/1e3;const we=oi(se,1e3*u,g);P=T.toNumber(T.divide(we,T.BigInt(1e3))),D=xn;break}case"nanosecond":{Ae=T.toNumber(D),D=oi(D,u,g);break}}return{years:y,months:w,weeks:E,days:b,hours:S,minutes:R,seconds:F,milliseconds:M,microseconds:P,nanoseconds:T.toNumber(D),total:Ae}}function rs(t,e,n,r,i,o){for(const[s,a]of[[t,r],[e,i],[n,o]])if(s!==a)return wa(s-a);return 0}function Qa(t,e){let n=t%e;return QS(n,-0)?0:(n<0&&(n+=e),n)}function Dd(t){const e=wl(t);return typeof globalThis.BigInt!="undefined"?globalThis.BigInt(e.toString(10)):e}function wl(t){if(t instanceof T)return t;let e=t;if(typeof t=="object"){const n=t[Symbol.toPrimitive];n&&typeof n=="function"&&(e=Ug(n,t,["number"]))}switch(typeof e){case"undefined":case"object":case"number":case"symbol":default:throw new TypeError(`cannot convert ${typeof t} to bigint`);case"string":if(!e.match(/^\s*(?:[+-]?\d+\s*)?$/))throw new SyntaxError("invalid BigInt syntax");case"bigint":try{return T.BigInt(e.toString())}catch(n){throw n instanceof Error&&n.message.startsWith("Invalid integer")?new SyntaxError(n.message):n}case"boolean":return e?jg:xn}}const Xg=(()=>{let t=T.BigInt(Date.now()%1e6);return()=>{const e=T.BigInt(Date.now()),n=T.add(T.multiply(e,Fi),t);return t=T.divide(e,Fi),T.greaterThan(n,Pl)?Pl:T.lessThan(n,Cl)?Cl:n}})();function S2(){const t=new xw("en-us"),e=Pe("%Temporal.TimeZone%");return new e(Cw(t.resolvedOptions().timeZone))}function wa(t){return t<0?-1:t>0?1:t}function We(t){if(t===void 0)return Rt(null);if(jt(t)&&t!==null)return t;throw new TypeError(`Options parameter must be an object, not ${t===null?"null":`${typeof t}`}`)}function Ac(t,e){const n=Rt(null);return n[t]=e,n}function Ko(t,e,n,r){let i=t[e];if(i!==void 0){if(i=Ne(i),!n.includes(i))throw new RangeError(`${e} must be one of ${n.join(", ")}, not ${i}`);return i}return r}function T2(t,e,n,r,i){let o=t[e];if(o===void 0)return i;const s=Nl(o);if(Gl(s)||s<n||s>r)throw new RangeError(`${e} must be between ${n} and ${r}, not ${s}`);return Vn(s)}const nv=new RegExp(`^${Ew.source}$`);function rv(t,e,n,r=t(e),i=t(n)){let o=T.BigInt(e),s=T.BigInt(n),a=r,c=i;for(;T.greaterThan(T.subtract(s,o),jg);){const l=T.divide(T.add(o,s),T.BigInt(2)),u=t(l);if(u===a)o=l,a=u;else if(u===c)s=l,c=u;else throw new Error(`invalid state in bisection ${a} - ${u} - ${c}`)}return s}const e0={hour:36e11,minute:6e10,second:1e9,millisecond:1e6,microsecond:1e3,nanosecond:1},iv=Symbol("date"),ov=Symbol("ym"),sv=Symbol("md"),av=Symbol("time"),cv=Symbol("datetime"),lv=Symbol("zoneddatetime"),uv=Symbol("instant"),Uc=Symbol("original"),Kp=Symbol("timezone"),nd=Symbol("timezone-id-given"),pi=Symbol("calendar-id"),dv=Symbol("locale"),Wp=Symbol("options"),vl=t=>({value:t,enumerable:!0,writable:!1,configurable:!0}),La=globalThis.Intl.DateTimeFormat,Uo=Object.assign,A2=Object.prototype.hasOwnProperty,x2=Reflect.apply;function Xs(t,e){let n=t[e];return typeof n=="function"&&(n=new La(t[dv],n(t[Wp])),t[e]=n),n}function nl(t){let e=t[Kp];return typeof e=="string"&&(e=Br(e),t[Kp]=e),e}function Ta(t=void 0,e={}){if(!(this instanceof Ta))return new Ta(t,e);const n=typeof e!="undefined",r=n?Uo({},e):{},i=new La(t,r),o=i.resolvedOptions();if(n){const s=Uo({},o);for(const a in s)x2(A2,r,[a])||delete s[a];this[Wp]=s}else this[Wp]=r;this[nd]=r.timeZone?r.timeZone:null,this[dv]=o.locale,this[Uc]=i,this[Kp]=o.timeZone,this[pi]=o.calendar,this[iv]=O2,this[ov]=P2,this[sv]=N2,this[av]=C2,this[cv]=M2,this[lv]=L2,this[uv]=U2}Object.defineProperty(Ta,"name",{writable:!0,value:"DateTimeFormat"});Ta.supportedLocalesOf=function(t,e){return La.supportedLocalesOf(t,e)};const t0={resolvedOptions:vl(I2),format:vl(R2),formatRange:vl(F2)};"formatToParts"in La.prototype&&(t0.formatToParts=vl(k2));"formatRangeToParts"in La.prototype&&(t0.formatRangeToParts=vl(D2));Ta.prototype=Object.create(La.prototype,t0);Object.defineProperty(Ta,"prototype",{writable:!1,enumerable:!1,configurable:!1});const $s=Ta;function I2(){return this[Uc].resolvedOptions()}function sf(t,e){if(!e)return t;const n=t.resolvedOptions();return n.timeZone===e?t:((n.dateStyle||n.timeStyle)&&(delete n.weekday,delete n.era,delete n.year,delete n.month,delete n.day,delete n.hour,delete n.minute,delete n.second,delete n.timeZoneName,delete n.hourCycle,delete n.hour12,delete n.dayPeriod),new La(n.locale,{...n,timeZone:e}))}function R2(t,...e){let{instant:n,formatter:r,timeZone:i}=Ic(t,this);return n&&r?(r=sf(r,i),r.format(n.epochMilliseconds)):this[Uc].format(t,...e)}function k2(t,...e){let{instant:n,formatter:r,timeZone:i}=Ic(t,this);return n&&r?(r=sf(r,i),r.formatToParts(n.epochMilliseconds)):this[Uc].formatToParts(t,...e)}function F2(t,e){if(xc(t)||xc(e)){if(!fv(t,e))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");const{instant:n,formatter:r,timeZone:i}=Ic(t,this),{instant:o,formatter:s,timeZone:a}=Ic(e,this);if(i&&a&&i!==a)throw new RangeError("cannot format range between different time zones");if(n&&o&&r&&s&&r===s)return sf(r,i).formatRange(n.epochMilliseconds,o.epochMilliseconds)}return this[Uc].formatRange(t,e)}function D2(t,e){if(xc(t)||xc(e)){if(!fv(t,e))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");const{instant:n,formatter:r,timeZone:i}=Ic(t,this),{instant:o,formatter:s,timeZone:a}=Ic(e,this);if(i&&a&&i!==a)throw new RangeError("cannot format range between different time zones");if(n&&o&&r&&s&&r===s)return sf(r,i).formatRangeToParts(n.epochMilliseconds,o.epochMilliseconds)}return this[Uc].formatRangeToParts(t,e)}function ru(t={},e={}){const n=Uo({},t);for(const r of["year","month","day","hour","minute","second","weekday","dayPeriod","timeZoneName","dateStyle","timeStyle"])n[r]=r in e?e[r]:n[r],(n[r]===!1||n[r]===void 0)&&delete n[r];return n}function C2(t){let e=ru(t,{year:!1,month:!1,day:!1,weekday:!1,timeZoneName:!1,dateStyle:!1});return cf(e)||(e=Uo({},e,{hour:"numeric",minute:"numeric",second:"numeric"})),e}function P2(t){let e=ru(t,{day:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,dateStyle:!1,timeStyle:!1});return"year"in e||"month"in e||(e=Uo(e,{year:"numeric",month:"numeric"})),e}function N2(t){let e=ru(t,{year:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,dateStyle:!1,timeStyle:!1});return"month"in e||"day"in e||(e=Uo({},e,{month:"numeric",day:"numeric"})),e}function O2(t){let e=ru(t,{hour:!1,minute:!1,second:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});return af(e)||(e=Uo({},e,{year:"numeric",month:"numeric",day:"numeric"})),e}function M2(t){let e=ru(t,{timeZoneName:!1});return!cf(e)&&!af(e)&&(e=Uo({},e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),e}function L2(t){let e=t;return!cf(e)&&!af(e)&&(e=Uo({},e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),e.timeZoneName===void 0&&(e.timeZoneName="short")),e}function U2(t){let e=t;return!cf(e)&&!af(e)&&(e=Uo({},e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),e}function af(t){return"year"in t||"month"in t||"day"in t||"weekday"in t||"dateStyle"in t}function cf(t){return"hour"in t||"minute"in t||"second"in t||"timeStyle"in t||"dayPeriod"in t}function xc(t){return ot(t)||an(t)||Qe(t)||Ie(t)||vt(t)||Qn(t)||Un(t)}function fv(t,e){return!(!xc(t)||!xc(e)||an(t)&&!an(e)||ot(t)&&!ot(e)||Qe(t)&&!Qe(e)||Ie(t)&&!Ie(e)||vt(t)&&!vt(e)||Qn(t)&&!Qn(e)||Un(t)&&!Un(e))}function Ic(t,e){const n=Pe("%Temporal.PlainDateTime%");if(an(t)){const r=_(t,Ue),i=_(t,je),o=_(t,$e),s=_(t,Be),a=_(t,He),c=_(t,Ke),l=new n(1970,1,1,r,i,o,s,a,c,e[pi]);return{instant:$r(nl(e),l,"compatible"),formatter:Xs(e,av)}}if(vt(t)){const r=_(t,ve),i=_(t,Se),o=_(t,Te),s=Ne(_(t,ae));if(s!==e[pi])throw new RangeError(`cannot format PlainYearMonth with calendar ${s} in locale with calendar ${e[pi]}`);const a=new n(r,i,o,12,0,0,0,0,0,s);return{instant:$r(nl(e),a,"compatible"),formatter:Xs(e,ov)}}if(Qn(t)){const r=_(t,ve),i=_(t,Se),o=_(t,Te),s=Ne(_(t,ae));if(s!==e[pi])throw new RangeError(`cannot format PlainMonthDay with calendar ${s} in locale with calendar ${e[pi]}`);const a=new n(r,i,o,12,0,0,0,0,0,s);return{instant:$r(nl(e),a,"compatible"),formatter:Xs(e,sv)}}if(ot(t)){const r=_(t,ve),i=_(t,Se),o=_(t,Te),s=Ne(_(t,ae));if(s!=="iso8601"&&s!==e[pi])throw new RangeError(`cannot format PlainDate with calendar ${s} in locale with calendar ${e[pi]}`);const a=new n(r,i,o,12,0,0,0,0,0,e[pi]);return{instant:$r(nl(e),a,"compatible"),formatter:Xs(e,iv)}}if(Qe(t)){const r=_(t,ve),i=_(t,Se),o=_(t,Te),s=_(t,Ue),a=_(t,je),c=_(t,$e),l=_(t,Be),u=_(t,He),d=_(t,Ke),g=Ne(_(t,ae));if(g!=="iso8601"&&g!==e[pi])throw new RangeError(`cannot format PlainDateTime with calendar ${g} in locale with calendar ${e[pi]}`);let p=t;return g==="iso8601"&&(p=new n(r,i,o,s,a,c,l,u,d,e[pi])),{instant:$r(nl(e),p,"compatible"),formatter:Xs(e,cv)}}if(Ie(t)){const r=Ne(_(t,ae));if(r!=="iso8601"&&r!==e[pi])throw new RangeError(`cannot format ZonedDateTime with calendar ${r} in locale with calendar ${e[pi]}`);const i=_(t,yt),o=Ne(i);if(e[nd]&&e[nd]!==o)throw new RangeError(`timeZone option ${e[nd]} doesn't match actual time zone ${o}`);return{instant:_(t,pr),formatter:Xs(e,lv),timeZone:o}}return Un(t)?{instant:t,formatter:Xs(e,uv)}:{}}var vy=Object.freeze({__proto__:null,DateTimeFormat:$s});const rl=["year","month","week","day"],by={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3};class Ii{constructor(e){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");const n=wl(e);sa(n),Bo(this),Xe(this,Fe,n);{const r=Sh(this,void 0,"auto");Object.defineProperty(this,"_repr_",{value:`${this[Symbol.toStringTag]} <${r}>`,writable:!1,enumerable:!1,configurable:!1})}}get epochSeconds(){if(!Un(this))throw new TypeError("invalid receiver");const e=_(this,Fe);return T.toNumber(T.divide(e,ls))}get epochMilliseconds(){if(!Un(this))throw new TypeError("invalid receiver");const e=T.BigInt(_(this,Fe));return T.toNumber(T.divide(e,Fi))}get epochMicroseconds(){if(!Un(this))throw new TypeError("invalid receiver");const e=T.BigInt(_(this,Fe));return Dd(T.divide(e,bt))}get epochNanoseconds(){if(!Un(this))throw new TypeError("invalid receiver");return Dd(T.BigInt(_(this,Fe)))}add(e){if(!Un(this))throw new TypeError("invalid receiver");const{hours:n,minutes:r,seconds:i,milliseconds:o,microseconds:s,nanoseconds:a}=Vi(e,["years","months","weeks","days"]),c=Rd(_(this,Fe),n,r,i,o,s,a);return new Ii(c)}subtract(e){if(!Un(this))throw new TypeError("invalid receiver");const{hours:n,minutes:r,seconds:i,milliseconds:o,microseconds:s,nanoseconds:a}=Vi(e,["years","months","weeks","days"]),c=Rd(_(this,Fe),-n,-r,-i,-o,-s,-a);return new Ii(c)}until(e,n=void 0){if(!Un(this))throw new TypeError("invalid receiver");const r=ao(e),i=We(n),o=Pr(i,"nanosecond",rl),s=zi("second",o),a=vi(i,"auto",rl,s);Ci(a,o);const c=$n(i,"trunc"),l=Di(i,by[o],!1),u=_(this,Fe),d=_(r,Fe);let{seconds:g,milliseconds:p,microseconds:y,nanoseconds:w}=$l(u,d,l,o,c),E,b;({hours:E,minutes:b,seconds:g,milliseconds:p,microseconds:y,nanoseconds:w}=sr(0,0,0,g,p,y,w,a));const S=Pe("%Temporal.Duration%");return new S(0,0,0,0,E,b,g,p,y,w)}since(e,n=void 0){if(!Un(this))throw new TypeError("invalid receiver");const r=ao(e),i=We(n),o=Pr(i,"nanosecond",rl),s=zi("second",o),a=vi(i,"auto",rl,s);Ci(a,o);const c=$n(i,"trunc"),l=Di(i,by[o],!1),u=_(r,Fe),d=_(this,Fe);let{seconds:g,milliseconds:p,microseconds:y,nanoseconds:w}=$l(u,d,l,o,c),E,b;({hours:E,minutes:b,seconds:g,milliseconds:p,microseconds:y,nanoseconds:w}=sr(0,0,0,g,p,y,w,a));const S=Pe("%Temporal.Duration%");return new S(0,0,0,0,E,b,g,p,y,w)}round(e){if(!Un(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");const n=typeof e=="string"?Ac("smallestUnit",e):We(e),r=Pr(n,void 0,rl);if(r===void 0)throw new RangeError("smallestUnit is required");const i=$n(n,"halfExpand"),s=Di(n,{hour:24,minute:1440,second:86400,millisecond:864e5,microsecond:864e8,nanosecond:864e11}[r],!0),a=_(this,Fe),c=Fd(a,s,r,i);return new Ii(c)}equals(e){if(!Un(this))throw new TypeError("invalid receiver");const n=ao(e),r=_(this,Fe),i=_(n,Fe);return T.equal(T.BigInt(r),T.BigInt(i))}toString(e=void 0){if(!Un(this))throw new TypeError("invalid receiver");const n=We(e);let r=n.timeZone;r!==void 0&&(r=Br(r));const{precision:i,unit:o,increment:s}=Xl(n),a=$n(n,"trunc"),c=_(this,Fe),l=Fd(c,s,o,a),u=new Ii(l);return Sh(u,r,i)}toJSON(){if(!Un(this))throw new TypeError("invalid receiver");return Sh(this,void 0,"auto")}toLocaleString(e=void 0,n=void 0){if(!Un(this))throw new TypeError("invalid receiver");return new $s(e,n).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.Instant")}toZonedDateTime(e){if(!Un(this))throw new TypeError("invalid receiver");if(!jt(e))throw new TypeError("invalid argument in toZonedDateTime");const n=e.calendar;if(n===void 0)throw new TypeError("missing calendar property in toZonedDateTime");const r=ar(n),i=e.timeZone;if(i===void 0)throw new TypeError("missing timeZone property in toZonedDateTime");const o=Br(i);return er(_(this,Fe),o,r)}toZonedDateTimeISO(e){let n=e;if(!Un(this))throw new TypeError("invalid receiver");if(jt(n)){const o=n.timeZone;o!==void 0&&(n=o)}const r=Br(n),i=kn();return er(_(this,Fe),r,i)}static fromEpochSeconds(e){const n=Nl(e),r=T.multiply(T.BigInt(n),ls);return sa(r),new Ii(r)}static fromEpochMilliseconds(e){const n=Nl(e),r=T.multiply(T.BigInt(n),Fi);return sa(r),new Ii(r)}static fromEpochMicroseconds(e){const n=wl(e),r=T.multiply(n,bt);return sa(r),new Ii(r)}static fromEpochNanoseconds(e){const n=wl(e);return sa(n),new Ii(n)}static from(e){return Un(e)?new Ii(_(e,Fe)):ao(e)}static compare(e,n){const r=ao(e),i=ao(n),o=_(r,Fe),s=_(i,Fe);return T.lessThan(o,s)?-1:T.greaterThan(o,s)?1:0}}$o(Ii,"Temporal.Instant");const Bu=["hour","minute","second","millisecond","microsecond","nanosecond"];class iu{constructor(e,n,r,i=kn()){const o=It(e),s=It(n),a=It(r),c=ar(i);if(arguments.length<3)throw new RangeError("missing argument: isoYear, isoMonth and isoDay are required");Lw(this,o,s,a,c)}get calendar(){if(!ot(this))throw new TypeError("invalid receiver");return _(this,ae)}get era(){if(!ot(this))throw new TypeError("invalid receiver");return Qd(_(this,ae),this)}get eraYear(){if(!ot(this))throw new TypeError("invalid receiver");return Xd(_(this,ae),this)}get year(){if(!ot(this))throw new TypeError("invalid receiver");return Yd(_(this,ae),this)}get month(){if(!ot(this))throw new TypeError("invalid receiver");return Jd(_(this,ae),this)}get monthCode(){if(!ot(this))throw new TypeError("invalid receiver");return tu(_(this,ae),this)}get day(){if(!ot(this))throw new TypeError("invalid receiver");return Zd(_(this,ae),this)}get dayOfWeek(){if(!ot(this))throw new TypeError("invalid receiver");return Hg(_(this,ae),this)}get dayOfYear(){if(!ot(this))throw new TypeError("invalid receiver");return Kg(_(this,ae),this)}get weekOfYear(){if(!ot(this))throw new TypeError("invalid receiver");return Wg(_(this,ae),this)}get daysInWeek(){if(!ot(this))throw new TypeError("invalid receiver");return qg(_(this,ae),this)}get daysInMonth(){if(!ot(this))throw new TypeError("invalid receiver");return lc(_(this,ae),this)}get daysInYear(){if(!ot(this))throw new TypeError("invalid receiver");return ef(_(this,ae),this)}get monthsInYear(){if(!ot(this))throw new TypeError("invalid receiver");return tf(_(this,ae),this)}get inLeapYear(){if(!ot(this))throw new TypeError("invalid receiver");return nf(_(this,ae),this)}with(e,n=void 0){if(!ot(this))throw new TypeError("invalid receiver");if(!jt(e))throw new TypeError("invalid argument");Mc(e);const r=_(this,ae),i=pn(r,["day","month","monthCode","year"]),o=js(e,i);if(!o)throw new TypeError("invalid date-like");let s=kp(this,i);s=Ea(r,s,o),s=kp(s,i);const a=We(n);return so(r,s,a)}withCalendar(e){if(!ot(this))throw new TypeError("invalid receiver");const n=ar(e);return new iu(_(this,ve),_(this,Se),_(this,Te),n)}add(e,n=void 0){if(!ot(this))throw new TypeError("invalid receiver");const r=cc(e),i=We(n);return Cr(_(this,ae),this,r,i)}subtract(e,n=void 0){if(!ot(this))throw new TypeError("invalid receiver");const r=Jw(cc(e)),i=We(n);return Cr(_(this,ae),this,r,i)}until(e,n=void 0){if(!ot(this))throw new TypeError("invalid receiver");const r=Tt(e),i=_(this,ae),o=_(r,ae),s=Ne(i),a=Ne(o);if(s!==a)throw new RangeError(`cannot compute difference between dates of ${s} and ${a} calendars`);const c=We(n),l=Pr(c,"day",Bu),u=zi("day",l),d=vi(c,"auto",Bu,u);Ci(d,l);const g=$n(c,"trunc"),p=Di(c,void 0,!1),y={...c,largestUnit:d},w=Mo(i,this,r,y);if(l==="day"&&p===1)return w;let{years:E,months:b,weeks:S,days:R}=w;({years:E,months:b,weeks:S,days:R}=Pi(E,b,S,R,0,0,0,0,0,0,p,l,g,this));const F=Pe("%Temporal.Duration%");return new F(E,b,S,R,0,0,0,0,0,0)}since(e,n=void 0){if(!ot(this))throw new TypeError("invalid receiver");const r=Tt(e),i=_(this,ae),o=_(r,ae),s=Ne(i),a=Ne(o);if(s!==a)throw new RangeError(`cannot compute difference between dates of ${s} and ${a} calendars`);const c=We(n),l=Pr(c,"day",Bu),u=zi("day",l),d=vi(c,"auto",Bu,u);Ci(d,l);const g=$n(c,"trunc"),p=Di(c,void 0,!1),y={...c,largestUnit:d};let{years:w,months:E,weeks:b,days:S}=Mo(i,this,r,y);const R=Pe("%Temporal.Duration%");return l==="day"&&p===1?new R(-w,-E,-b,-S,0,0,0,0,0,0):({years:w,months:E,weeks:b,days:S}=Pi(w,E,b,S,0,0,0,0,0,0,p,l,Zl(g),this),new R(-w,-E,-b,-S,0,0,0,0,0,0))}equals(e){if(!ot(this))throw new TypeError("invalid receiver");const n=Tt(e);for(const r of[ve,Se,Te]){const i=_(this,r),o=_(n,r);if(i!==o)return!1}return nu(_(this,ae),_(n,ae))}toString(e=void 0){if(!ot(this))throw new TypeError("invalid receiver");const n=We(e),r=Ql(n);return Dp(this,r)}toJSON(){if(!ot(this))throw new TypeError("invalid receiver");return Dp(this)}toLocaleString(e=void 0,n=void 0){if(!ot(this))throw new TypeError("invalid receiver");return new $s(e,n).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainDate")}toPlainDateTime(e=void 0){if(!ot(this))throw new TypeError("invalid receiver");const n=_(this,ve),r=_(this,Se),i=_(this,Te),o=_(this,ae);if(e===void 0)return Zr(n,r,i,0,0,0,0,0,0,o);const s=Ao(e),a=_(s,Ue),c=_(s,je),l=_(s,$e),u=_(s,Be),d=_(s,He),g=_(s,Ke);return Zr(n,r,i,a,c,l,u,d,g,o)}toZonedDateTime(e){if(!ot(this))throw new TypeError("invalid receiver");let n,r;if(jt(e)){const E=e.timeZone;E===void 0?n=Br(e):(n=Br(E),r=e.plainTime)}else n=Br(e);const i=_(this,ve),o=_(this,Se),s=_(this,Te),a=_(this,ae);let c=0,l=0,u=0,d=0,g=0,p=0;r!==void 0&&(r=Ao(r),c=_(r,Ue),l=_(r,je),u=_(r,$e),d=_(r,Be),g=_(r,He),p=_(r,Ke));const y=Zr(i,o,s,c,l,u,d,g,p,a),w=$r(n,y,"compatible");return er(_(w,Fe),n,a)}toPlainYearMonth(){if(!ot(this))throw new TypeError("invalid receiver");const e=_(this,ae),n=pn(e,["monthCode","year"]),r=ii(this,n);return Ds(e,r)}toPlainMonthDay(){if(!ot(this))throw new TypeError("invalid receiver");const e=_(this,ae),n=pn(e,["day","monthCode"]),r=ma(this,n);return Sc(e,r)}getISOFields(){if(!ot(this))throw new TypeError("invalid receiver");return{calendar:_(this,ae),isoDay:_(this,Te),isoMonth:_(this,Se),isoYear:_(this,ve)}}static from(e,n=void 0){const r=We(n);return ot(e)?(ir(r),Gi(_(e,ve),_(e,Se),_(e,Te),_(e,ae))):Tt(e,r)}static compare(e,n){const r=Tt(e),i=Tt(n);return rs(_(r,ve),_(r,Se),_(r,Te),_(i,ve),_(i,Se),_(i,Te))}}$o(iu,"Temporal.PlainDate");class ou{constructor(e,n,r,i=0,o=0,s=0,a=0,c=0,l=0,u=kn()){const d=It(e),g=It(n),p=It(r),y=It(i),w=It(o),E=It(s),b=It(a),S=It(c),R=It(l),F=ar(u);if(arguments.length<3)throw new RangeError("missing argument: isoYear, isoMonth and isoDay are required");Uw(this,d,g,p,y,w,E,b,S,R,F)}get calendar(){if(!Qe(this))throw new TypeError("invalid receiver");return _(this,ae)}get year(){if(!Qe(this))throw new TypeError("invalid receiver");return Yd(_(this,ae),this)}get month(){if(!Qe(this))throw new TypeError("invalid receiver");return Jd(_(this,ae),this)}get monthCode(){if(!Qe(this))throw new TypeError("invalid receiver");return tu(_(this,ae),this)}get day(){if(!Qe(this))throw new TypeError("invalid receiver");return Zd(_(this,ae),this)}get hour(){if(!Qe(this))throw new TypeError("invalid receiver");return _(this,Ue)}get minute(){if(!Qe(this))throw new TypeError("invalid receiver");return _(this,je)}get second(){if(!Qe(this))throw new TypeError("invalid receiver");return _(this,$e)}get millisecond(){if(!Qe(this))throw new TypeError("invalid receiver");return _(this,Be)}get microsecond(){if(!Qe(this))throw new TypeError("invalid receiver");return _(this,He)}get nanosecond(){if(!Qe(this))throw new TypeError("invalid receiver");return _(this,Ke)}get era(){if(!Qe(this))throw new TypeError("invalid receiver");return Qd(_(this,ae),this)}get eraYear(){if(!Qe(this))throw new TypeError("invalid receiver");return Xd(_(this,ae),this)}get dayOfWeek(){if(!Qe(this))throw new TypeError("invalid receiver");return Hg(_(this,ae),this)}get dayOfYear(){if(!Qe(this))throw new TypeError("invalid receiver");return Kg(_(this,ae),this)}get weekOfYear(){if(!Qe(this))throw new TypeError("invalid receiver");return Wg(_(this,ae),this)}get daysInWeek(){if(!Qe(this))throw new TypeError("invalid receiver");return qg(_(this,ae),this)}get daysInYear(){if(!Qe(this))throw new TypeError("invalid receiver");return ef(_(this,ae),this)}get daysInMonth(){if(!Qe(this))throw new TypeError("invalid receiver");return lc(_(this,ae),this)}get monthsInYear(){if(!Qe(this))throw new TypeError("invalid receiver");return tf(_(this,ae),this)}get inLeapYear(){if(!Qe(this))throw new TypeError("invalid receiver");return nf(_(this,ae),this)}with(e,n=void 0){if(!Qe(this))throw new TypeError("invalid receiver");if(!jt(e))throw new TypeError("invalid argument");Mc(e);const r=We(n),i=_(this,ae),o=pn(i,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),s=js(e,o);if(!s)throw new TypeError("invalid date-time-like");let a=Sd(this,o);a=Ea(i,a,s),a=Sd(a,o);const{year:c,month:l,day:u,hour:d,minute:g,second:p,millisecond:y,microsecond:w,nanosecond:E}=eu(i,a,r);return Zr(c,l,u,d,g,p,y,w,E,i)}withPlainTime(e=void 0){if(!Qe(this))throw new TypeError("invalid receiver");const n=_(this,ve),r=_(this,Se),i=_(this,Te),o=_(this,ae);if(e===void 0)return Zr(n,r,i,0,0,0,0,0,0,o);const s=Ao(e),a=_(s,Ue),c=_(s,je),l=_(s,$e),u=_(s,Be),d=_(s,He),g=_(s,Ke);return Zr(n,r,i,a,c,l,u,d,g,o)}withPlainDate(e){if(!Qe(this))throw new TypeError("invalid receiver");const n=Tt(e),r=_(n,ve),i=_(n,Se),o=_(n,Te);let s=_(n,ae);const a=_(this,Ue),c=_(this,je),l=_(this,$e),u=_(this,Be),d=_(this,He),g=_(this,Ke);return s=Hw(_(this,ae),s),Zr(r,i,o,a,c,l,u,d,g,s)}withCalendar(e){if(!Qe(this))throw new TypeError("invalid receiver");const n=ar(e);return new ou(_(this,ve),_(this,Se),_(this,Te),_(this,Ue),_(this,je),_(this,$e),_(this,Be),_(this,He),_(this,Ke),n)}add(e,n=void 0){if(!Qe(this))throw new TypeError("invalid receiver");const r=Vi(e),{years:i,months:o,weeks:s,days:a,hours:c,minutes:l,seconds:u,milliseconds:d,microseconds:g,nanoseconds:p}=r,y=We(n),w=_(this,ae),{year:E,month:b,day:S,hour:R,minute:F,second:M,millisecond:P,microsecond:D,nanosecond:Y}=kd(_(this,ve),_(this,Se),_(this,Te),_(this,Ue),_(this,je),_(this,$e),_(this,Be),_(this,He),_(this,Ke),w,i,o,s,a,c,l,u,d,g,p,y);return Zr(E,b,S,R,F,M,P,D,Y,w)}subtract(e,n=void 0){if(!Qe(this))throw new TypeError("invalid receiver");const r=Vi(e),{years:i,months:o,weeks:s,days:a,hours:c,minutes:l,seconds:u,milliseconds:d,microseconds:g,nanoseconds:p}=r,y=We(n),w=_(this,ae),{year:E,month:b,day:S,hour:R,minute:F,second:M,millisecond:P,microsecond:D,nanosecond:Y}=kd(_(this,ve),_(this,Se),_(this,Te),_(this,Ue),_(this,je),_(this,$e),_(this,Be),_(this,He),_(this,Ke),w,-i,-o,-s,-a,-c,-l,-u,-d,-g,-p,y);return Zr(E,b,S,R,F,M,P,D,Y,w)}until(e,n=void 0){if(!Qe(this))throw new TypeError("invalid receiver");const r=Ss(e),i=_(this,ae),o=_(r,ae),s=Ne(i),a=Ne(o);if(s!==a)throw new RangeError(`cannot compute difference between dates of ${s} and ${a} calendars`);const c=We(n),l=Pr(c,"nanosecond"),u=zi("day",l),d=vi(c,"auto",[],u);Ci(d,l);const g=$n(c,"trunc"),p=Ml(c,l);let{years:y,months:w,weeks:E,days:b,hours:S,minutes:R,seconds:F,milliseconds:M,microseconds:P,nanoseconds:D}=Id(_(this,ve),_(this,Se),_(this,Te),_(this,Ue),_(this,je),_(this,$e),_(this,Be),_(this,He),_(this,Ke),_(r,ve),_(r,Se),_(r,Te),_(r,Ue),_(r,je),_(r,$e),_(r,Be),_(r,He),_(r,Ke),i,d,c);const Y=ya(this);({years:y,months:w,weeks:E,days:b,hours:S,minutes:R,seconds:F,milliseconds:M,microseconds:P,nanoseconds:D}=Pi(y,w,E,b,S,R,F,M,P,D,p,l,g,Y)),{days:b,hours:S,minutes:R,seconds:F,milliseconds:M,microseconds:P,nanoseconds:D}=sr(b,S,R,F,M,P,D,d);const X=Pe("%Temporal.Duration%");return new X(y,w,E,b,S,R,F,M,P,D)}since(e,n=void 0){if(!Qe(this))throw new TypeError("invalid receiver");const r=Ss(e),i=_(this,ae),o=_(r,ae),s=Ne(i),a=Ne(o);if(s!==a)throw new RangeError(`cannot compute difference between dates of ${s} and ${a} calendars`);const c=We(n),l=Pr(c,"nanosecond"),u=zi("day",l),d=vi(c,"auto",[],u);Ci(d,l);const g=$n(c,"trunc"),p=Ml(c,l);let{years:y,months:w,weeks:E,days:b,hours:S,minutes:R,seconds:F,milliseconds:M,microseconds:P,nanoseconds:D}=Id(_(this,ve),_(this,Se),_(this,Te),_(this,Ue),_(this,je),_(this,$e),_(this,Be),_(this,He),_(this,Ke),_(r,ve),_(r,Se),_(r,Te),_(r,Ue),_(r,je),_(r,$e),_(r,Be),_(r,He),_(r,Ke),i,d,c);const Y=ya(this);({years:y,months:w,weeks:E,days:b,hours:S,minutes:R,seconds:F,milliseconds:M,microseconds:P,nanoseconds:D}=Pi(y,w,E,b,S,R,F,M,P,D,p,l,Zl(g),Y)),{days:b,hours:S,minutes:R,seconds:F,milliseconds:M,microseconds:P,nanoseconds:D}=sr(b,S,R,F,M,P,D,d);const X=Pe("%Temporal.Duration%");return new X(-y,-w,-E,-b,-S,-R,-F,-M,-P,-D)}round(e){if(!Qe(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");const n=typeof e=="string"?Ac("smallestUnit",e):We(e),r=Pr(n,void 0,["year","month","week"]);if(r===void 0)throw new RangeError("smallestUnit is required");const i=$n(n,"halfExpand"),s=Di(n,{day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[r],!1);let a=_(this,ve),c=_(this,Se),l=_(this,Te),u=_(this,Ue),d=_(this,je),g=_(this,$e),p=_(this,Be),y=_(this,He),w=_(this,Ke);return{year:a,month:c,day:l,hour:u,minute:d,second:g,millisecond:p,microsecond:y,nanosecond:w}=Zg(a,c,l,u,d,g,p,y,w,s,r,i),Zr(a,c,l,u,d,g,p,y,w,_(this,ae))}equals(e){if(!Qe(this))throw new TypeError("invalid receiver");const n=Ss(e);for(const r of[ve,Se,Te,Ue,je,$e,Be,He,Ke]){const i=_(this,r),o=_(n,r);if(i!==o)return!1}return nu(_(this,ae),_(n,ae))}toString(e=void 0){if(!Qe(this))throw new TypeError("invalid receiver");const n=We(e),{precision:r,unit:i,increment:o}=Xl(n),s=Ql(n),a=$n(n,"trunc");return Cp(this,r,s,{unit:i,increment:o,roundingMode:a})}toJSON(){if(!Qe(this))throw new TypeError("invalid receiver");return Cp(this,"auto")}toLocaleString(e=void 0,n=void 0){if(!Qe(this))throw new TypeError("invalid receiver");return new $s(e,n).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainDateTime")}toZonedDateTime(e,n=void 0){if(!Qe(this))throw new TypeError("invalid receiver");const r=Br(e),i=We(n),o=Ol(i),s=$r(r,this,o);return er(_(s,Fe),r,_(this,ae))}toPlainDate(){if(!Qe(this))throw new TypeError("invalid receiver");return ya(this)}toPlainYearMonth(){if(!Qe(this))throw new TypeError("invalid receiver");const e=_(this,ae),n=pn(e,["monthCode","year"]),r=ii(this,n);return Ds(e,r)}toPlainMonthDay(){if(!Qe(this))throw new TypeError("invalid receiver");const e=_(this,ae),n=pn(e,["day","monthCode"]),r=ma(this,n);return Sc(e,r)}toPlainTime(){if(!Qe(this))throw new TypeError("invalid receiver");return Vg(this)}getISOFields(){if(!Qe(this))throw new TypeError("invalid receiver");return{calendar:_(this,ae),isoDay:_(this,Te),isoHour:_(this,Ue),isoMicrosecond:_(this,He),isoMillisecond:_(this,Be),isoMinute:_(this,je),isoMonth:_(this,Se),isoNanosecond:_(this,Ke),isoSecond:_(this,$e),isoYear:_(this,ve)}}static from(e,n=void 0){const r=We(n);return Qe(e)?(ir(r),Zr(_(e,ve),_(e,Se),_(e,Te),_(e,Ue),_(e,je),_(e,$e),_(e,Be),_(e,He),_(e,Ke),_(e,ae))):Ss(e,r)}static compare(e,n){const r=Ss(e),i=Ss(n);for(const o of[ve,Se,Te,Ue,je,$e,Be,He,Ke]){const s=_(r,o),a=_(i,o);if(s!==a)return wa(s-a)}return 0}}$o(ou,"Temporal.PlainDateTime");class xo{constructor(e=0,n=0,r=0,i=0,o=0,s=0,a=0,c=0,l=0,u=0){const d=Xn(e),g=Xn(n),p=Xn(r),y=Xn(i),w=Xn(o),E=Xn(s),b=Xn(a),S=Xn(c),R=Xn(l),F=Xn(u),M=Wi(d,g,p,y,w,E,b,S,R,F);for(const P of[d,g,p,y,w,E,b,S,R,F]){if(!Number.isFinite(P))throw new RangeError("infinite values not allowed as duration fields");const D=Math.sign(P);if(D!==0&&D!==M)throw new RangeError("mixed-sign values not allowed as duration fields")}Bo(this),Xe(this,br,d),Xe(this,qn,g),Xe(this,Ur,p),Xe(this,Er,y),Xe(this,Sr,w),Xe(this,Tr,E),Xe(this,Ar,b),Xe(this,xr,S),Xe(this,Ir,R),Xe(this,Rr,F),Object.defineProperty(this,"_repr_",{value:`${this[Symbol.toStringTag]} <${ju(this)}>`,writable:!1,enumerable:!1,configurable:!1})}get years(){if(!sn(this))throw new TypeError("invalid receiver");return _(this,br)}get months(){if(!sn(this))throw new TypeError("invalid receiver");return _(this,qn)}get weeks(){if(!sn(this))throw new TypeError("invalid receiver");return _(this,Ur)}get days(){if(!sn(this))throw new TypeError("invalid receiver");return _(this,Er)}get hours(){if(!sn(this))throw new TypeError("invalid receiver");return _(this,Sr)}get minutes(){if(!sn(this))throw new TypeError("invalid receiver");return _(this,Tr)}get seconds(){if(!sn(this))throw new TypeError("invalid receiver");return _(this,Ar)}get milliseconds(){if(!sn(this))throw new TypeError("invalid receiver");return _(this,xr)}get microseconds(){if(!sn(this))throw new TypeError("invalid receiver");return _(this,Ir)}get nanoseconds(){if(!sn(this))throw new TypeError("invalid receiver");return _(this,Rr)}get sign(){if(!sn(this))throw new TypeError("invalid receiver");return Wi(_(this,br),_(this,qn),_(this,Ur),_(this,Er),_(this,Sr),_(this,Tr),_(this,Ar),_(this,xr),_(this,Ir),_(this,Rr))}get blank(){if(!sn(this))throw new TypeError("invalid receiver");return Wi(_(this,br),_(this,qn),_(this,Ur),_(this,Er),_(this,Sr),_(this,Tr),_(this,Ar),_(this,xr),_(this,Ir),_(this,Rr))===0}with(e){if(!sn(this))throw new TypeError("invalid receiver");const n=js(e,["days","hours","microseconds","milliseconds","minutes","months","nanoseconds","seconds","weeks","years"]);if(!n)throw new TypeError("invalid duration-like");const{years:r=_(this,br),months:i=_(this,qn),weeks:o=_(this,Ur),days:s=_(this,Er),hours:a=_(this,Sr),minutes:c=_(this,Tr),seconds:l=_(this,Ar),milliseconds:u=_(this,xr),microseconds:d=_(this,Ir),nanoseconds:g=_(this,Rr)}=n;return new xo(r,i,o,s,a,c,l,u,d,g)}negated(){if(!sn(this))throw new TypeError("invalid receiver");return Jw(this)}abs(){if(!sn(this))throw new TypeError("invalid receiver");return new xo(Math.abs(_(this,br)),Math.abs(_(this,qn)),Math.abs(_(this,Ur)),Math.abs(_(this,Er)),Math.abs(_(this,Sr)),Math.abs(_(this,Tr)),Math.abs(_(this,Ar)),Math.abs(_(this,xr)),Math.abs(_(this,Ir)),Math.abs(_(this,Rr)))}add(e,n=void 0){if(!sn(this))throw new TypeError("invalid receiver");let{years:r,months:i,weeks:o,days:s,hours:a,minutes:c,seconds:l,milliseconds:u,microseconds:d,nanoseconds:g}=Vi(e);const p=We(n),y=tl(p);return{years:r,months:i,weeks:o,days:s,hours:a,minutes:c,seconds:l,milliseconds:u,microseconds:d,nanoseconds:g}=$p(_(this,br),_(this,qn),_(this,Ur),_(this,Er),_(this,Sr),_(this,Tr),_(this,Ar),_(this,xr),_(this,Ir),_(this,Rr),r,i,o,s,a,c,l,u,d,g,y),new xo(r,i,o,s,a,c,l,u,d,g)}subtract(e,n=void 0){if(!sn(this))throw new TypeError("invalid receiver");let{years:r,months:i,weeks:o,days:s,hours:a,minutes:c,seconds:l,milliseconds:u,microseconds:d,nanoseconds:g}=Vi(e);const p=We(n),y=tl(p);return{years:r,months:i,weeks:o,days:s,hours:a,minutes:c,seconds:l,milliseconds:u,microseconds:d,nanoseconds:g}=$p(_(this,br),_(this,qn),_(this,Ur),_(this,Er),_(this,Sr),_(this,Tr),_(this,Ar),_(this,xr),_(this,Ir),_(this,Rr),-r,-i,-o,-s,-a,-c,-l,-u,-d,-g,y),new xo(r,i,o,s,a,c,l,u,d,g)}round(e){if(!sn(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");let n=_(this,br),r=_(this,qn),i=_(this,Ur),o=_(this,Er),s=_(this,Sr),a=_(this,Tr),c=_(this,Ar),l=_(this,xr),u=_(this,Ir),d=_(this,Rr),g=Rp(n,r,i,o,s,a,c,l,u,d);const p=typeof e=="string"?Ac("smallestUnit",e):We(e);let y=Pr(p,void 0),w=!0;y||(w=!1,y="nanosecond"),g=zi(g,y);let E=vi(p,void 0),b=!0;if(E||(b=!1,E=g),E==="auto"&&(E=g),!w&&!b)throw new RangeError("at least one of smallestUnit or largestUnit is required");Ci(E,y);const S=$n(p,"halfExpand"),R=Ml(p,y);let F=tl(p);return{years:n,months:r,weeks:i,days:o}=$u(n,r,i,o,E,F),{years:n,months:r,weeks:i,days:o,hours:s,minutes:a,seconds:c,milliseconds:l,microseconds:u,nanoseconds:d}=Pi(n,r,i,o,s,a,c,l,u,d,R,y,S,F),{years:n,months:r,weeks:i,days:o,hours:s,minutes:a,seconds:c,milliseconds:l,microseconds:u,nanoseconds:d}=Hp(n,r,i,o,s,a,c,l,u,d,R,y,S,F),{years:n,months:r,weeks:i,days:o}=v2(n,r,i,o,E,F),Ie(F)&&(F=Bp(F,n,r,i,0)),{days:o,hours:s,minutes:a,seconds:c,milliseconds:l,microseconds:u,nanoseconds:d}=sr(o,s,a,c,l,u,d,E,F),new xo(n,r,i,o,s,a,c,l,u,d)}total(e){if(!sn(this))throw new TypeError("invalid receiver");let n=_(this,br),r=_(this,qn),i=_(this,Ur),o=_(this,Er),s=_(this,Sr),a=_(this,Tr),c=_(this,Ar),l=_(this,xr),u=_(this,Ir),d=_(this,Rr);if(e===void 0)throw new TypeError("options argument is required");const g=typeof e=="string"?Ac("unit",e):We(e),p=h2(g);if(p===void 0)throw new RangeError("unit option is required");const y=tl(g);({years:n,months:r,weeks:i,days:o}=$u(n,r,i,o,p,y));let w;Ie(y)&&(w=Bp(y,n,r,i,0)),{days:o,hours:s,minutes:a,seconds:c,milliseconds:l,microseconds:u,nanoseconds:d}=sr(o,s,a,c,l,u,d,p,w);const{total:E}=Pi(n,r,i,o,s,a,c,l,u,d,1,p,"trunc",y);return E}toString(e=void 0){if(!sn(this))throw new TypeError("invalid receiver");const n=We(e),{precision:r,unit:i,increment:o}=Xl(n);if(r==="minute")throw new RangeError('smallestUnit must not be "minute"');const s=$n(n,"trunc");return ju(this,r,{unit:i,increment:o,roundingMode:s})}toJSON(){if(!sn(this))throw new TypeError("invalid receiver");return ju(this)}toLocaleString(e=void 0,n=void 0){if(!sn(this))throw new TypeError("invalid receiver");return typeof Intl!="undefined"&&typeof Intl.DurationFormat!="undefined"?new Intl.DurationFormat(e,n).format(this):(console.warn("Temporal.Duration.prototype.toLocaleString() requires Intl.DurationFormat."),ju(this))}valueOf(){throw new TypeError("use compare() to compare Temporal.Duration")}static from(e){return sn(e)?new xo(_(e,br),_(e,qn),_(e,Ur),_(e,Er),_(e,Sr),_(e,Tr),_(e,Ar),_(e,xr),_(e,Ir),_(e,Rr)):cc(e)}static compare(e,n,r=void 0){const i=cc(e),o=cc(n),s=We(r),a=tl(s),c=_(i,br),l=_(i,qn),u=_(i,Ur);let d=_(i,Er);const g=_(i,Sr),p=_(i,Tr),y=_(i,Ar),w=_(i,xr),E=_(i,Ir);let b=_(i,Rr);const S=_(o,br),R=_(o,qn),F=_(o,Ur);let M=_(o,Er);const P=_(o,Sr),D=_(o,Tr),Y=_(o,Ar),X=_(o,xr),$=_(o,Ir);let te=_(o,Rr);const _e=wy(a,c,l,u,d,g,p,y,w,E,b),Ae=wy(a,S,R,F,M,P,D,Y,X,$,te);(c!==0||S!==0||l!==0||R!==0||u!==0||F!==0)&&({days:d}=$u(c,l,u,d,"day",a),{days:M}=$u(S,R,F,M,"day",a));const re=Tc(d,g,p,y,w,E,b,_e),se=Tc(M,P,D,Y,X,$,te,Ae);return wa(T.toNumber(T.subtract(re,se)))}}$o(xo,"Temporal.Duration");const j2=Object.create;class n0{constructor(e,n,r=kn(),i=1972){const o=It(e),s=It(n),a=ar(r),c=It(i);if(arguments.length<2)throw new RangeError("missing argument: isoMonth and isoDay are required");jw(this,o,s,a,c)}get monthCode(){if(!Qn(this))throw new TypeError("invalid receiver");return tu(_(this,ae),this)}get day(){if(!Qn(this))throw new TypeError("invalid receiver");return Zd(_(this,ae),this)}get calendar(){if(!Qn(this))throw new TypeError("invalid receiver");return _(this,ae)}with(e,n=void 0){if(!Qn(this))throw new TypeError("invalid receiver");if(!jt(e))throw new TypeError("invalid argument");Mc(e);const r=_(this,ae),i=pn(r,["day","month","monthCode","year"]),o=js(e,i);if(!o)throw new TypeError("invalid month-day-like");let s=ma(this,i);s=Ea(r,s,o),s=ma(s,i);const a=We(n);return Sc(r,s,a)}equals(e){if(!Qn(this))throw new TypeError("invalid receiver");const n=yy(e);for(const r of[Se,Te,ve]){const i=_(this,r),o=_(n,r);if(i!==o)return!1}return nu(_(this,ae),_(n,ae))}toString(e=void 0){if(!Qn(this))throw new TypeError("invalid receiver");const n=We(e),r=Ql(n);return Pp(this,r)}toJSON(){if(!Qn(this))throw new TypeError("invalid receiver");return Pp(this)}toLocaleString(e=void 0,n=void 0){if(!Qn(this))throw new TypeError("invalid receiver");return new $s(e,n).format(this)}valueOf(){throw new TypeError("use equals() to compare Temporal.PlainMonthDay")}toPlainDate(e){if(!Qn(this))throw new TypeError("invalid receiver");if(!jt(e))throw new TypeError("argument should be an object");const n=_(this,ae),r=pn(n,["day","monthCode"]),i=ma(this,r),o=pn(n,["year"]),s=[["year",void 0]];o.forEach(g=>{s.some(([p])=>p===g)||s.push([g,void 0])});const a=or(e,s);let c=Ea(n,i,a);const l=[...new Set([...r,...o])],u=[];l.forEach(g=>{u.some(([p])=>p===g)||u.push([g,void 0])}),c=or(c,u);const d=j2(null);return d.overflow="reject",so(n,c,d)}getISOFields(){if(!Qn(this))throw new TypeError("invalid receiver");return{calendar:_(this,ae),isoDay:_(this,Te),isoMonth:_(this,Se),isoYear:_(this,ve)}}static from(e,n=void 0){const r=We(n);return Qn(e)?(ir(r),Ll(_(e,Se),_(e,Te),_(e,ae),_(e,ve))):yy(e,r)}}$o(n0,"Temporal.PlainMonthDay");const r0=()=>{const t=Pe("%Temporal.Instant%");return new t(Xg())},hv=(t,e=Bs())=>{const n=Br(e),r=ar(t),i=r0();return bi(n,i,r)},i0=(t=Bs())=>{const e=Br(t),n=kn(),r=r0();return bi(e,r,n)},pv=(t,e=Bs())=>{const n=Br(e),r=ar(t);return er(Xg(),n,r)},$2=(t=Bs())=>pv(kn(),t),B2=(t,e=Bs())=>ya(hv(t,e)),H2=(t=Bs())=>ya(i0(t)),K2=(t=Bs())=>Vg(i0(t)),Bs=()=>S2(),gv={instant:r0,plainDateTime:hv,plainDateTimeISO:i0,plainDate:B2,plainDateISO:H2,plainTimeISO:K2,timeZone:Bs,zonedDateTime:pv,zonedDateTimeISO:$2,[Symbol.toStringTag]:"Temporal.Now"};Object.defineProperty(gv,Symbol.toStringTag,{value:"Temporal.Now",writable:!1,enumerable:!1,configurable:!0});const W2=Object.assign,il=["year","month","week","day"],Th={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3};function Ah(t,e,n=void 0){let r=_(t,Ue),i=_(t,je),o=_(t,$e),s=_(t,Be),a=_(t,He),c=_(t,Ke);if(n){const{unit:g,increment:p,roundingMode:y}=n;({hour:r,minute:i,second:o,millisecond:s,microsecond:a,nanosecond:c}=Qg(r,i,o,s,a,c,p,g,y))}const l=zt(r),u=zt(i),d=rf(o,s,a,c,e);return`${l}:${u}${d}`}class is{constructor(e=0,n=0,r=0,i=0,o=0,s=0){const a=It(e),c=It(n),l=It(r),u=It(i),d=It(o),g=It(s);of(a,c,l,u,d,g),Bo(this),Xe(this,Ue,a),Xe(this,je,c),Xe(this,$e,l),Xe(this,Be,u),Xe(this,He,d),Xe(this,Ke,g),Xe(this,ae,kn()),Object.defineProperty(this,"_repr_",{value:`${this[Symbol.toStringTag]} <${Ah(this,"auto")}>`,writable:!1,enumerable:!1,configurable:!1})}get calendar(){if(!an(this))throw new TypeError("invalid receiver");return _(this,ae)}get hour(){if(!an(this))throw new TypeError("invalid receiver");return _(this,Ue)}get minute(){if(!an(this))throw new TypeError("invalid receiver");return _(this,je)}get second(){if(!an(this))throw new TypeError("invalid receiver");return _(this,$e)}get millisecond(){if(!an(this))throw new TypeError("invalid receiver");return _(this,Be)}get microsecond(){if(!an(this))throw new TypeError("invalid receiver");return _(this,He)}get nanosecond(){if(!an(this))throw new TypeError("invalid receiver");return _(this,Ke)}with(e,n=void 0){if(!an(this))throw new TypeError("invalid receiver");if(!jt(e))throw new TypeError("invalid argument");Mc(e);const r=We(n),i=ir(r),o=js(e,["hour","microsecond","millisecond","minute","nanosecond","second"]);if(!o)throw new TypeError("invalid time-like");const s=Bg(this);let{hour:a,minute:c,second:l,millisecond:u,microsecond:d,nanosecond:g}=W2(s,o);return{hour:a,minute:c,second:l,millisecond:u,microsecond:d,nanosecond:g}=_l(a,c,l,u,d,g,i),new is(a,c,l,u,d,g)}add(e){if(!an(this))throw new TypeError("invalid receiver");const n=Vi(e),{hours:r,minutes:i,seconds:o,milliseconds:s,microseconds:a,nanoseconds:c}=n;let l=_(this,Ue),u=_(this,je),d=_(this,$e),g=_(this,Be),p=_(this,He),y=_(this,Ke);return{hour:l,minute:u,second:d,millisecond:g,microsecond:p,nanosecond:y}=jp(l,u,d,g,p,y,r,i,o,s,a,c),{hour:l,minute:u,second:d,millisecond:g,microsecond:p,nanosecond:y}=_l(l,u,d,g,p,y,"reject"),new is(l,u,d,g,p,y)}subtract(e){if(!an(this))throw new TypeError("invalid receiver");const n=Vi(e),{hours:r,minutes:i,seconds:o,milliseconds:s,microseconds:a,nanoseconds:c}=n;let l=_(this,Ue),u=_(this,je),d=_(this,$e),g=_(this,Be),p=_(this,He),y=_(this,Ke);return{hour:l,minute:u,second:d,millisecond:g,microsecond:p,nanosecond:y}=jp(l,u,d,g,p,y,-r,-i,-o,-s,-a,-c),{hour:l,minute:u,second:d,millisecond:g,microsecond:p,nanosecond:y}=_l(l,u,d,g,p,y,"reject"),new is(l,u,d,g,p,y)}until(e,n=void 0){if(!an(this))throw new TypeError("invalid receiver");const r=Ao(e),i=We(n),o=vi(i,"auto",il,"hour"),s=Pr(i,"nanosecond",il);Ci(o,s);const a=$n(i,"trunc"),c=Di(i,Th[s],!1);let{hours:l,minutes:u,seconds:d,milliseconds:g,microseconds:p,nanoseconds:y}=Lp(_(this,Ue),_(this,je),_(this,$e),_(this,Be),_(this,He),_(this,Ke),_(r,Ue),_(r,je),_(r,$e),_(r,Be),_(r,He),_(r,Ke));({hours:l,minutes:u,seconds:d,milliseconds:g,microseconds:p,nanoseconds:y}=Pi(0,0,0,0,l,u,d,g,p,y,c,s,a)),{hours:l,minutes:u,seconds:d,milliseconds:g,microseconds:p,nanoseconds:y}=sr(0,l,u,d,g,p,y,o);const w=Pe("%Temporal.Duration%");return new w(0,0,0,0,l,u,d,g,p,y)}since(e,n=void 0){if(!an(this))throw new TypeError("invalid receiver");const r=Ao(e),i=We(n),o=vi(i,"auto",il,"hour"),s=Pr(i,"nanosecond",il);Ci(o,s);const a=$n(i,"trunc"),c=Di(i,Th[s],!1);let{hours:l,minutes:u,seconds:d,milliseconds:g,microseconds:p,nanoseconds:y}=Lp(_(r,Ue),_(r,je),_(r,$e),_(r,Be),_(r,He),_(r,Ke),_(this,Ue),_(this,je),_(this,$e),_(this,Be),_(this,He),_(this,Ke));({hours:l,minutes:u,seconds:d,milliseconds:g,microseconds:p,nanoseconds:y}=Pi(0,0,0,0,-l,-u,-d,-g,-p,-y,c,s,Zl(a))),l=-l,u=-u,d=-d,g=-g,p=-p,y=-y,{hours:l,minutes:u,seconds:d,milliseconds:g,microseconds:p,nanoseconds:y}=sr(0,l,u,d,g,p,y,o);const w=Pe("%Temporal.Duration%");return new w(0,0,0,0,l,u,d,g,p,y)}round(e){if(!an(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");const n=typeof e=="string"?Ac("smallestUnit",e):We(e),r=Pr(n,void 0,il);if(r===void 0)throw new RangeError("smallestUnit is required");const i=$n(n,"halfExpand"),o=Di(n,Th[r],!1);let s=_(this,Ue),a=_(this,je),c=_(this,$e),l=_(this,Be),u=_(this,He),d=_(this,Ke);return{hour:s,minute:a,second:c,millisecond:l,microsecond:u,nanosecond:d}=Qg(s,a,c,l,u,d,o,r,i),new is(s,a,c,l,u,d)}equals(e){if(!an(this))throw new TypeError("invalid receiver");const n=Ao(e);for(const r of[Ue,je,$e,Be,He,Ke]){const i=_(this,r),o=_(n,r);if(i!==o)return!1}return!0}toString(e=void 0){if(!an(this))throw new TypeError("invalid receiver");const n=We(e),{precision:r,unit:i,increment:o}=Xl(n),s=$n(n,"trunc");return Ah(this,r,{unit:i,increment:o,roundingMode:s})}toJSON(){if(!an(this))throw new TypeError("invalid receiver");return Ah(this,"auto")}toLocaleString(e=void 0,n=void 0){if(!an(this))throw new TypeError("invalid receiver");return new $s(e,n).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainTime")}toPlainDateTime(e){if(!an(this))throw new TypeError("invalid receiver");const n=Tt(e),r=_(n,ve),i=_(n,Se),o=_(n,Te),s=_(n,ae),a=_(this,Ue),c=_(this,je),l=_(this,$e),u=_(this,Be),d=_(this,He),g=_(this,Ke);return Zr(r,i,o,a,c,l,u,d,g,s)}toZonedDateTime(e){if(!an(this))throw new TypeError("invalid receiver");if(!jt(e))throw new TypeError("invalid argument");const n=e.plainDate;if(n===void 0)throw new TypeError("missing date property");const r=Tt(n),i=e.timeZone;if(i===void 0)throw new TypeError("missing timeZone property");const o=Br(i),s=_(r,ve),a=_(r,Se),c=_(r,Te),l=_(r,ae),u=_(this,Ue),d=_(this,je),g=_(this,$e),p=_(this,Be),y=_(this,He),w=_(this,Ke),E=Pe("%Temporal.PlainDateTime%"),b=new E(s,a,c,u,d,g,p,y,w,l),S=$r(o,b,"compatible");return er(_(S,Fe),o,l)}getISOFields(){if(!an(this))throw new TypeError("invalid receiver");return{calendar:_(this,ae),isoHour:_(this,Ue),isoMicrosecond:_(this,He),isoMillisecond:_(this,Be),isoMinute:_(this,je),isoNanosecond:_(this,Ke),isoSecond:_(this,$e)}}static from(e,n=void 0){const r=We(n),i=ir(r);return an(e)?new is(_(e,Ue),_(e,je),_(e,$e),_(e,Be),_(e,He),_(e,Ke)):Ao(e,i)}static compare(e,n){const r=Ao(e),i=Ao(n);for(const o of[Ue,je,$e,Be,He,Ke]){const s=_(r,o),a=_(i,o);if(s!==a)return wa(s-a)}return 0}}$o(is,"Temporal.PlainTime");class o0{constructor(e){if(arguments.length<1)throw new RangeError("missing argument: identifier is required");const n=zg(e);Bo(this),Xe(this,Es,n),Object.defineProperty(this,"_repr_",{value:`${this[Symbol.toStringTag]} <${n}>`,writable:!1,enumerable:!1,configurable:!1})}get id(){if(!bo(this))throw new TypeError("invalid receiver");return Ne(this)}getOffsetNanosecondsFor(e){if(!bo(this))throw new TypeError("invalid receiver");const n=ao(e),r=_(this,Es);return oc(r)?Sa(r):us(_(n,Fe),r)}getOffsetStringFor(e){if(!bo(this))throw new TypeError("invalid receiver");const n=ao(e);return Fp(this,n)}getPlainDateTimeFor(e,n=kn()){const r=ao(e),i=ar(n);return bi(this,r,i)}getInstantFor(e,n=void 0){if(!bo(this))throw new TypeError("invalid receiver");const r=Ss(e),i=We(n),o=Ol(i);return $r(this,r,o)}getPossibleInstantsFor(e){if(!bo(this))throw new TypeError("invalid receiver");const n=Ss(e),r=Pe("%Temporal.Instant%"),i=_(this,Es);if(oc(i)){const s=Ps(_(n,ve),_(n,Se),_(n,Te),_(n,Ue),_(n,je),_(n,$e),_(n,Be),_(n,He),_(n,Ke));if(s===null)throw new RangeError("DateTime outside of supported range");const a=Sa(i);return[new r(T.subtract(s,T.BigInt(a)))]}return _2(i,_(n,ve),_(n,Se),_(n,Te),_(n,Ue),_(n,je),_(n,$e),_(n,Be),_(n,He),_(n,Ke)).map(s=>new r(s))}getNextTransition(e){if(!bo(this))throw new TypeError("invalid receiver");const n=ao(e),r=_(this,Es);if(oc(r)||r==="UTC")return null;let i=_(n,Fe);const o=Pe("%Temporal.Instant%");return i=g2(i,r),i===null?null:new o(i)}getPreviousTransition(e){if(!bo(this))throw new TypeError("invalid receiver");const n=ao(e),r=_(this,Es);if(oc(r)||r==="UTC")return null;let i=_(n,Fe);const o=Pe("%Temporal.Instant%");return i=Gw(i,r),i===null?null:new o(i)}toString(){if(!bo(this))throw new TypeError("invalid receiver");return Ne(_(this,Es))}toJSON(){if(!bo(this))throw new TypeError("invalid receiver");return Ne(this)}static from(e){return Br(e)}}$o(o0,"Temporal.TimeZone");const q2=Object.create,Hu=["week","day","hour","minute","second","millisecond","microsecond","nanosecond"];class s0{constructor(e,n,r=kn(),i=1){const o=It(e),s=It(n),a=ar(r),c=It(i);if(arguments.length<2)throw new RangeError("missing argument: isoYear and isoMonth are required");$w(this,o,s,a,c)}get year(){if(!vt(this))throw new TypeError("invalid receiver");return Yd(_(this,ae),this)}get month(){if(!vt(this))throw new TypeError("invalid receiver");return Jd(_(this,ae),this)}get monthCode(){if(!vt(this))throw new TypeError("invalid receiver");return tu(_(this,ae),this)}get calendar(){if(!vt(this))throw new TypeError("invalid receiver");return _(this,ae)}get era(){if(!vt(this))throw new TypeError("invalid receiver");return Qd(_(this,ae),this)}get eraYear(){if(!vt(this))throw new TypeError("invalid receiver");return Xd(_(this,ae),this)}get daysInMonth(){if(!vt(this))throw new TypeError("invalid receiver");return lc(_(this,ae),this)}get daysInYear(){if(!vt(this))throw new TypeError("invalid receiver");return ef(_(this,ae),this)}get monthsInYear(){if(!vt(this))throw new TypeError("invalid receiver");return tf(_(this,ae),this)}get inLeapYear(){if(!vt(this))throw new TypeError("invalid receiver");return nf(_(this,ae),this)}with(e,n=void 0){if(!vt(this))throw new TypeError("invalid receiver");if(!jt(e))throw new TypeError("invalid argument");Mc(e);const r=_(this,ae),i=pn(r,["month","monthCode","year"]),o=js(e,i);if(!o)throw new TypeError("invalid year-month-like");let s=ii(this,i);s=Ea(r,s,o),s=ii(s,i);const a=We(n);return Ds(r,s,a)}add(e,n=void 0){if(!vt(this))throw new TypeError("invalid receiver");const r=Vi(e);let{years:i,months:o,weeks:s,days:a,hours:c,minutes:l,seconds:u,milliseconds:d,microseconds:g,nanoseconds:p}=r;({days:a}=sr(a,c,l,u,d,g,p,"day"));const y=We(n),w=_(this,ae),E=pn(w,["monthCode","year"]),b=ii(this,E),R=Wi(i,o,s,a,0,0,0,0,0,0)<0?bc(lc(w,this)):1,F=so(w,{...b,day:R}),M={...y},P=Cr(w,F,{...r,days:a},y),D=ii(P,E);return Ds(w,D,M)}subtract(e,n=void 0){if(!vt(this))throw new TypeError("invalid receiver");let r=Vi(e);r={years:-r.years,months:-r.months,weeks:-r.weeks,days:-r.days,hours:-r.hours,minutes:-r.minutes,seconds:-r.seconds,milliseconds:-r.milliseconds,microseconds:-r.microseconds,nanoseconds:-r.nanoseconds};let{years:i,months:o,weeks:s,days:a,hours:c,minutes:l,seconds:u,milliseconds:d,microseconds:g,nanoseconds:p}=r;({days:a}=sr(a,c,l,u,d,g,p,"day"));const y=We(n),w=_(this,ae),E=pn(w,["monthCode","year"]),b=ii(this,E),R=Wi(i,o,s,a,0,0,0,0,0,0)<0?bc(lc(w,this)):1,F=so(w,{...b,day:R}),M={...y},P=Cr(w,F,{...r,days:a},y),D=ii(P,E);return Ds(w,D,M)}until(e,n=void 0){if(!vt(this))throw new TypeError("invalid receiver");const r=Ja(e),i=_(this,ae),o=_(r,ae),s=Ne(i),a=Ne(o);if(s!==a)throw new RangeError(`cannot compute difference between months of ${s} and ${a} calendars`);const c=We(n),l=Pr(c,"month",Hu),u=vi(c,"auto",Hu,"year");Ci(u,l);const d=$n(c,"trunc"),g=Di(c,void 0,!1),p=pn(i,["monthCode","year"]),y=ii(r,p),w=ii(this,p),E=so(i,{...y,day:1}),b=so(i,{...w,day:1}),S={...c,largestUnit:u},R=Mo(i,b,E,S);if(l==="month"&&g===1)return R;let{years:F,months:M}=R;({years:F,months:M}=Pi(F,M,0,0,0,0,0,0,0,0,g,l,d,b));const P=Pe("%Temporal.Duration%");return new P(F,M,0,0,0,0,0,0,0,0)}since(e,n=void 0){if(!vt(this))throw new TypeError("invalid receiver");const r=Ja(e),i=_(this,ae),o=_(r,ae),s=Ne(i),a=Ne(o);if(s!==a)throw new RangeError(`cannot compute difference between months of ${s} and ${a} calendars`);const c=We(n),l=Pr(c,"month",Hu),u=vi(c,"auto",Hu,"year");Ci(u,l);const d=$n(c,"trunc"),g=Di(c,void 0,!1),p=pn(i,["monthCode","year"]),y=ii(r,p),w=ii(this,p),E=so(i,{...y,day:1}),b=so(i,{...w,day:1}),S={...c,largestUnit:u};let{years:R,months:F}=Mo(i,b,E,S);const M=Pe("%Temporal.Duration%");return l==="month"&&g===1?new M(-R,-F,0,0,0,0,0,0,0,0):({years:R,months:F}=Pi(R,F,0,0,0,0,0,0,0,0,g,l,Zl(d),b),new M(-R,-F,0,0,0,0,0,0,0,0))}equals(e){if(!vt(this))throw new TypeError("invalid receiver");const n=Ja(e);for(const r of[ve,Se,Te]){const i=_(this,r),o=_(n,r);if(i!==o)return!1}return nu(_(this,ae),_(n,ae))}toString(e=void 0){if(!vt(this))throw new TypeError("invalid receiver");const n=We(e),r=Ql(n);return Np(this,r)}toJSON(){if(!vt(this))throw new TypeError("invalid receiver");return Np(this)}toLocaleString(e=void 0,n=void 0){if(!vt(this))throw new TypeError("invalid receiver");return new $s(e,n).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainYearMonth")}toPlainDate(e){if(!vt(this))throw new TypeError("invalid receiver");if(!jt(e))throw new TypeError("argument should be an object");const n=_(this,ae),r=pn(n,["monthCode","year"]),i=ii(this,r),o=pn(n,["day"]),s=[["day"]];o.forEach(g=>{s.some(([p])=>p===g)||s.push([g,void 0])});const a=or(e,s);let c=Ea(n,i,a);const l=[...new Set([...r,...o])],u=[];l.forEach(g=>{u.some(([p])=>p===g)||u.push([g,void 0])}),c=or(c,u);const d=q2(null);return d.overflow="reject",so(n,c,d)}getISOFields(){if(!vt(this))throw new TypeError("invalid receiver");return{calendar:_(this,ae),isoDay:_(this,Te),isoMonth:_(this,Se),isoYear:_(this,ve)}}static from(e,n=void 0){const r=We(n);return vt(e)?(ir(r),Ul(_(e,ve),_(e,Se),_(e,ae),_(e,Te))):Ja(e,r)}static compare(e,n){const r=Ja(e),i=Ja(n);return rs(_(r,ve),_(r,Se),_(r,Te),_(i,ve),_(i,Se),_(i,Te))}}$o(s0,"Temporal.PlainYearMonth");const V2=Array.prototype.push;class a0{constructor(e,n,r=kn()){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");const i=wl(e),o=Br(n),s=ar(r);Bw(this,i,o,s)}get calendar(){if(!Ie(this))throw new TypeError("invalid receiver");return _(this,ae)}get timeZone(){if(!Ie(this))throw new TypeError("invalid receiver");return _(this,yt)}get year(){if(!Ie(this))throw new TypeError("invalid receiver");return Yd(_(this,ae),Bt(this))}get month(){if(!Ie(this))throw new TypeError("invalid receiver");return Jd(_(this,ae),Bt(this))}get monthCode(){if(!Ie(this))throw new TypeError("invalid receiver");return tu(_(this,ae),Bt(this))}get day(){if(!Ie(this))throw new TypeError("invalid receiver");return Zd(_(this,ae),Bt(this))}get hour(){if(!Ie(this))throw new TypeError("invalid receiver");return _(Bt(this),Ue)}get minute(){if(!Ie(this))throw new TypeError("invalid receiver");return _(Bt(this),je)}get second(){if(!Ie(this))throw new TypeError("invalid receiver");return _(Bt(this),$e)}get millisecond(){if(!Ie(this))throw new TypeError("invalid receiver");return _(Bt(this),Be)}get microsecond(){if(!Ie(this))throw new TypeError("invalid receiver");return _(Bt(this),He)}get nanosecond(){if(!Ie(this))throw new TypeError("invalid receiver");return _(Bt(this),Ke)}get era(){if(!Ie(this))throw new TypeError("invalid receiver");return Qd(_(this,ae),Bt(this))}get eraYear(){if(!Ie(this))throw new TypeError("invalid receiver");return Xd(_(this,ae),Bt(this))}get epochSeconds(){if(!Ie(this))throw new TypeError("invalid receiver");const e=_(this,Fe);return T.toNumber(T.divide(e,ls))}get epochMilliseconds(){if(!Ie(this))throw new TypeError("invalid receiver");const e=_(this,Fe);return T.toNumber(T.divide(e,Fi))}get epochMicroseconds(){if(!Ie(this))throw new TypeError("invalid receiver");const e=_(this,Fe);return Dd(T.divide(e,bt))}get epochNanoseconds(){if(!Ie(this))throw new TypeError("invalid receiver");return Dd(_(this,Fe))}get dayOfWeek(){if(!Ie(this))throw new TypeError("invalid receiver");return Hg(_(this,ae),Bt(this))}get dayOfYear(){if(!Ie(this))throw new TypeError("invalid receiver");return Kg(_(this,ae),Bt(this))}get weekOfYear(){if(!Ie(this))throw new TypeError("invalid receiver");return Wg(_(this,ae),Bt(this))}get hoursInDay(){if(!Ie(this))throw new TypeError("invalid receiver");const e=Bt(this),n=Pe("%Temporal.PlainDateTime%"),r=_(e,ve),i=_(e,Se),o=_(e,Te),s=new n(r,i,o,0,0,0,0,0,0),a=_a(r,i,o,0,0,0,1,"reject"),c=new n(a.year,a.month,a.day,0,0,0,0,0,0),l=_(this,yt),u=_($r(l,s,"compatible"),Fe),d=_($r(l,c,"compatible"),Fe);return T.toNumber(T.subtract(d,u))/36e11}get daysInWeek(){if(!Ie(this))throw new TypeError("invalid receiver");return qg(_(this,ae),Bt(this))}get daysInMonth(){if(!Ie(this))throw new TypeError("invalid receiver");return lc(_(this,ae),Bt(this))}get daysInYear(){if(!Ie(this))throw new TypeError("invalid receiver");return ef(_(this,ae),Bt(this))}get monthsInYear(){if(!Ie(this))throw new TypeError("invalid receiver");return tf(_(this,ae),Bt(this))}get inLeapYear(){if(!Ie(this))throw new TypeError("invalid receiver");return nf(_(this,ae),Bt(this))}get offset(){if(!Ie(this))throw new TypeError("invalid receiver");return Fp(_(this,yt),_(this,pr))}get offsetNanoseconds(){if(!Ie(this))throw new TypeError("invalid receiver");return fo(_(this,yt),_(this,pr))}with(e,n=void 0){if(!Ie(this))throw new TypeError("invalid receiver");if(!jt(e))throw new TypeError("invalid zoned-date-time-like");Mc(e);const r=We(n),i=Ol(r),o=Ip(r,"prefer"),s=_(this,yt),a=_(this,ae),c=pn(a,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);V2.call(c,"offset");const l=js(e,c);if(!l)throw new TypeError("invalid zoned-date-time-like");const u=[["day",void 0],["hour",0],["microsecond",0],["millisecond",0],["minute",0],["month",void 0],["monthCode",void 0],["nanosecond",0],["second",0],["year",void 0],["offset"],["timeZone"]];c.forEach(D=>{u.some(([Y])=>Y===D)||u.push([D,void 0])});let d=or(this,u);d=Ea(a,d,l),d=or(d,u);const{year:g,month:p,day:y,hour:w,minute:E,second:b,millisecond:S,microsecond:R,nanosecond:F}=eu(a,d,r),M=Sa(d.offset),P=Td(g,p,y,w,E,b,S,R,F,"option",M,s,i,o,!1);return er(P,_(this,yt),a)}withPlainDate(e){if(!Ie(this))throw new TypeError("invalid receiver");const n=Tt(e),r=_(n,ve),i=_(n,Se),o=_(n,Te);let s=_(n,ae);const a=Bt(this),c=_(a,Ue),l=_(a,je),u=_(a,$e),d=_(a,Be),g=_(a,He),p=_(a,Ke);s=Hw(_(this,ae),s);const y=_(this,yt),w=Pe("%Temporal.PlainDateTime%"),E=new w(r,i,o,c,l,u,d,g,p,s),b=$r(y,E,"compatible");return er(_(b,Fe),y,s)}withPlainTime(e=void 0){if(!Ie(this))throw new TypeError("invalid receiver");const n=Pe("%Temporal.PlainTime%"),r=e==null?new n:Ao(e),i=Bt(this),o=_(i,ve),s=_(i,Se),a=_(i,Te),c=_(this,ae),l=_(r,Ue),u=_(r,je),d=_(r,$e),g=_(r,Be),p=_(r,He),y=_(r,Ke),w=_(this,yt),E=Pe("%Temporal.PlainDateTime%"),b=new E(o,s,a,l,u,d,g,p,y,c),S=$r(w,b,"compatible");return er(_(S,Fe),w,c)}withTimeZone(e){if(!Ie(this))throw new TypeError("invalid receiver");const n=Br(e);return er(_(this,Fe),n,_(this,ae))}withCalendar(e){if(!Ie(this))throw new TypeError("invalid receiver");const n=ar(e);return er(_(this,Fe),_(this,yt),n)}add(e,n=void 0){if(!Ie(this))throw new TypeError("invalid receiver");const r=Vi(e),{years:i,months:o,weeks:s,days:a,hours:c,minutes:l,seconds:u,milliseconds:d,microseconds:g,nanoseconds:p}=r,y=We(n),w=_(this,yt),E=_(this,ae),b=wi(_(this,pr),w,E,i,o,s,a,c,l,u,d,g,p,y);return er(b,w,E)}subtract(e,n=void 0){if(!Ie(this))throw new TypeError("invalid receiver");const r=Vi(e),{years:i,months:o,weeks:s,days:a,hours:c,minutes:l,seconds:u,milliseconds:d,microseconds:g,nanoseconds:p}=r,y=We(n),w=_(this,yt),E=_(this,ae),b=wi(_(this,pr),w,E,-i,-o,-s,-a,-c,-l,-u,-d,-g,-p,y);return er(b,w,E)}until(e,n=void 0){if(!Ie(this))throw new TypeError("invalid receiver");const r=Za(e),i=_(this,ae),o=_(r,ae),s=Ne(i),a=Ne(o);if(s!==a)throw new RangeError(`cannot compute difference between dates of ${s} and ${a} calendars`);const c=We(n),l=Pr(c,"nanosecond"),u=zi("hour",l),d=vi(c,"auto",[],u);Ci(d,l);const g=$n(c,"trunc"),p=Ml(c,l),y=_(this,Fe),w=_(r,Fe);let E,b,S,R,F,M,P,D,Y,X;if(d!=="year"&&d!=="month"&&d!=="week"&&d!=="day")E=0,b=0,S=0,R=0,{seconds:P,milliseconds:D,microseconds:Y,nanoseconds:X}=$l(y,w,p,l,g),{hours:F,minutes:M,seconds:P,milliseconds:D,microseconds:Y,nanoseconds:X}=sr(0,0,0,P,D,Y,X,d);else{const te=_(this,yt);if(!Eh(te,_(r,yt)))throw new RangeError("When calculating difference between time zones, largestUnit must be 'hours' or smaller because day lengths can vary between time zones due to DST or time zone offset changes.");const _e={...c,largestUnit:d};({years:E,months:b,weeks:S,days:R,hours:F,minutes:M,seconds:P,milliseconds:D,microseconds:Y,nanoseconds:X}=Up(y,w,te,i,d,_e)),{years:E,months:b,weeks:S,days:R,hours:F,minutes:M,seconds:P,milliseconds:D,microseconds:Y,nanoseconds:X}=Pi(E,b,S,R,F,M,P,D,Y,X,p,l,g,this),{years:E,months:b,weeks:S,days:R,hours:F,minutes:M,seconds:P,milliseconds:D,microseconds:Y,nanoseconds:X}=Hp(E,b,S,R,F,M,P,D,Y,X,p,l,g,this)}const $=Pe("%Temporal.Duration%");return new $(E,b,S,R,F,M,P,D,Y,X)}since(e,n=void 0){if(!Ie(this))throw new TypeError("invalid receiver");const r=Za(e),i=_(this,ae),o=_(r,ae),s=Ne(i),a=Ne(o);if(s!==a)throw new RangeError(`cannot compute difference between dates of ${s} and ${a} calendars`);const c=We(n),l=Pr(c,"nanosecond"),u=zi("hour",l),d=vi(c,"auto",[],u);Ci(d,l);let g=$n(c,"trunc");g=Zl(g);const p=Ml(c,l),y=_(this,Fe),w=_(r,Fe);let E,b,S,R,F,M,P,D,Y,X;if(d!=="year"&&d!=="month"&&d!=="week"&&d!=="day")E=0,b=0,S=0,R=0,{seconds:P,milliseconds:D,microseconds:Y,nanoseconds:X}=$l(y,w,p,l,g),{hours:F,minutes:M,seconds:P,milliseconds:D,microseconds:Y,nanoseconds:X}=sr(0,0,0,P,D,Y,X,d);else{const te=_(this,yt);if(!Eh(te,_(r,yt)))throw new RangeError("When calculating difference between time zones, largestUnit must be 'hours' or smaller because day lengths can vary between time zones due to DST or time zone offset changes.");const _e={...c,largestUnit:d};({years:E,months:b,weeks:S,days:R,hours:F,minutes:M,seconds:P,milliseconds:D,microseconds:Y,nanoseconds:X}=Up(y,w,te,i,d,_e)),{years:E,months:b,weeks:S,days:R,hours:F,minutes:M,seconds:P,milliseconds:D,microseconds:Y,nanoseconds:X}=Pi(E,b,S,R,F,M,P,D,Y,X,p,l,g,this),{years:E,months:b,weeks:S,days:R,hours:F,minutes:M,seconds:P,milliseconds:D,microseconds:Y,nanoseconds:X}=Hp(E,b,S,R,F,M,P,D,Y,X,p,l,g,this)}const $=Pe("%Temporal.Duration%");return new $(-E,-b,-S,-R,-F,-M,-P,-D,-Y,-X)}round(e){if(!Ie(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");const n=typeof e=="string"?Ac("smallestUnit",e):We(e),r=Pr(n,void 0,["year","month","week"]);if(r===void 0)throw new RangeError("smallestUnit is required");const i=$n(n,"halfExpand"),s=Di(n,{day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[r],!1),a=Bt(this);let c=_(a,ve),l=_(a,Se),u=_(a,Te),d=_(a,Ue),g=_(a,je),p=_(a,$e),y=_(a,Be),w=_(a,He),E=_(a,Ke);const b=Pe("%Temporal.PlainDateTime%"),S=_(this,yt),R=_(this,ae),F=new b(_(a,ve),_(a,Se),_(a,Te),0,0,0,0,0,0),M=$r(S,F,"compatible"),P=wi(M,S,R,0,0,0,1,0,0,0,0,0,0),D=T.subtract(P,T.BigInt(_(M,Fe)));if(T.equal(D,xn))throw new RangeError("cannot round a ZonedDateTime in a calendar with zero-length days");({year:c,month:l,day:u,hour:d,minute:g,second:p,millisecond:y,microsecond:w,nanosecond:E}=Zg(c,l,u,d,g,p,y,w,E,s,r,i,T.toNumber(D)));const Y=fo(S,_(this,pr)),X=Td(c,l,u,d,g,p,y,w,E,"option",Y,S,"compatible","prefer",!1);return er(X,S,_(this,ae))}equals(e){if(!Ie(this))throw new TypeError("invalid receiver");const n=Za(e),r=_(this,Fe),i=_(n,Fe);return!T.equal(T.BigInt(r),T.BigInt(i))||!Eh(_(this,yt),_(n,yt))?!1:nu(_(this,ae),_(n,ae))}toString(e=void 0){if(!Ie(this))throw new TypeError("invalid receiver");const n=We(e),{precision:r,unit:i,increment:o}=Xl(n),s=$n(n,"trunc"),a=Ql(n),c=d2(n),l=f2(n);return Op(this,r,a,c,l,{unit:i,increment:o,roundingMode:s})}toLocaleString(e=void 0,n=void 0){if(!Ie(this))throw new TypeError("invalid receiver");return new $s(e,n).format(this)}toJSON(){if(!Ie(this))throw new TypeError("invalid receiver");return Op(this,"auto")}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.ZonedDateTime")}startOfDay(){if(!Ie(this))throw new TypeError("invalid receiver");const e=Bt(this),n=Pe("%Temporal.PlainDateTime%"),r=_(this,ae),i=new n(_(e,ve),_(e,Se),_(e,Te),0,0,0,0,0,0,r),o=_(this,yt),s=$r(o,i,"compatible");return er(_(s,Fe),o,r)}toInstant(){if(!Ie(this))throw new TypeError("invalid receiver");const e=Pe("%Temporal.Instant%");return new e(_(this,Fe))}toPlainDate(){if(!Ie(this))throw new TypeError("invalid receiver");return ya(Bt(this))}toPlainTime(){if(!Ie(this))throw new TypeError("invalid receiver");return Vg(Bt(this))}toPlainDateTime(){if(!Ie(this))throw new TypeError("invalid receiver");return Bt(this)}toPlainYearMonth(){if(!Ie(this))throw new TypeError("invalid receiver");const e=_(this,ae),n=pn(e,["monthCode","year"]),r=ii(this,n);return Ds(e,r)}toPlainMonthDay(){if(!Ie(this))throw new TypeError("invalid receiver");const e=_(this,ae),n=pn(e,["day","monthCode"]),r=ma(this,n);return Sc(e,r)}getISOFields(){if(!Ie(this))throw new TypeError("invalid receiver");const e=Bt(this),n=_(this,yt);return{calendar:_(this,ae),isoDay:_(e,Te),isoHour:_(e,Ue),isoMicrosecond:_(e,He),isoMillisecond:_(e,Be),isoMinute:_(e,je),isoMonth:_(e,Se),isoNanosecond:_(e,Ke),isoSecond:_(e,$e),isoYear:_(e,ve),offset:Fp(n,_(this,pr)),timeZone:n}}static from(e,n=void 0){const r=We(n);return Ie(e)?(ir(r),Ol(r),Ip(r,"reject"),er(_(e,Fe),_(e,yt),_(e,ae))):Za(e,r)}static compare(e,n){const r=Za(e),i=Za(n),o=_(r,Fe),s=_(i,Fe);return T.lessThan(T.BigInt(o),T.BigInt(s))?-1:T.greaterThan(T.BigInt(o),T.BigInt(s))?1:0}}$o(a0,"Temporal.ZonedDateTime");function Bt(t){return bi(_(t,yt),_(t,pr),_(t,ae))}var ua=Object.freeze({__proto__:null,Instant:Ii,Calendar:zd,PlainDate:iu,PlainDateTime:ou,Duration:xo,PlainMonthDay:n0,Now:gv,PlainTime:is,TimeZone:o0,PlainYearMonth:s0,ZonedDateTime:a0});const z2=[Ii,zd,iu,ou,xo,n0,is,o0,s0,a0];for(const t of z2){const e=Object.getOwnPropertyDescriptor(t,"prototype");(e.configurable||e.enumerable||e.writable)&&(e.configurable=!1,e.enumerable=!1,e.writable=!1,Object.defineProperty(t,"prototype",e))}const G2={default:{a:{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},path:[{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"}]},solid:{a:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},path:[{"fill-rule":"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z","clip-rule":"evenodd"}]}},Y2={default:{a:{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},path:[{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14 5l7 7m0 0l-7 7m7-7H3"}]},solid:{a:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},path:[{"fill-rule":"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z","clip-rule":"evenodd"}]}},J2={default:{a:{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},path:[{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"}]},solid:{a:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},path:[{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"}]}};function Ey(t,e,n){const r=t.slice();return r[5]=e[n],r}function Sy(t){let e,n=[t[5]],r={};for(let i=0;i<n.length;i+=1)r=yd(r,n[i]);return{c(){e=ow("path"),this.h()},l(i){e=sw(i,"path",{}),Lt(e).forEach(De),this.h()},h(){md(e,r)},m(i,o){At(i,e,o)},p(i,o){md(e,r=aw(n,[o&2&&i[5]]))},d(i){i&&De(e)}}}function Z2(t){var s,a,c;let e,n=(a=(s=t[1])==null?void 0:s.path)!=null?a:[],r=[];for(let l=0;l<n.length;l+=1)r[l]=Sy(Ey(t,n,l));let i=[(c=t[1])==null?void 0:c.a,{xmlns:"http://www.w3.org/2000/svg"},{width:t[0]},{height:t[0]},{"aria-hidden":"true"},t[2]],o={};for(let l=0;l<i.length;l+=1)o=yd(o,i[l]);return{c(){e=ow("svg");for(let l=0;l<r.length;l+=1)r[l].c();this.h()},l(l){e=sw(l,"svg",{xmlns:!0,width:!0,height:!0,"aria-hidden":!0});var u=Lt(e);for(let d=0;d<r.length;d+=1)r[d].l(u);u.forEach(De),this.h()},h(){md(e,o)},m(l,u){At(l,e,u);for(let d=0;d<r.length;d+=1)r[d].m(e,null)},p(l,[u]){var d,g,p;if(u&2){n=(g=(d=l[1])==null?void 0:d.path)!=null?g:[];let y;for(y=0;y<n.length;y+=1){const w=Ey(l,n,y);r[y]?r[y].p(w,u):(r[y]=Sy(w),r[y].c(),r[y].m(e,null))}for(;y<r.length;y+=1)r[y].d(1);r.length=n.length}md(e,o=aw(i,[u&2&&((p=l[1])==null?void 0:p.a),{xmlns:"http://www.w3.org/2000/svg"},u&1&&{width:l[0]},u&1&&{height:l[0]},{"aria-hidden":"true"},u&4&&l[2]]))},i:uo,o:uo,d(l){l&&De(e),Cg(r,l)}}}function Q2(t,e,n){let r;const i=["src","size","solid"];let o=ly(e,i),{src:s}=e,{size:a="100%"}=e,{solid:c=!1}=e;if(a!=="100%"&&a.slice(-1)!="x"&&a.slice(-1)!="m"&&a.slice(-1)!="%")try{a=parseInt(a)+"px"}catch{a="100%"}return t.$$set=l=>{e=yd(yd({},e),iS(l)),n(2,o=ly(e,i)),"src"in l&&n(3,s=l.src),"size"in l&&n(0,a=l.size),"solid"in l&&n(4,c=l.solid)},t.$$.update=()=>{t.$$.dirty&24&&n(1,r=s==null?void 0:s[c?"solid":"default"])},[a,r,o,s,c]}class c0 extends ho{constructor(e){super(),po(this,e,Q2,Z2,go,{src:3,size:0,solid:4})}}function l0(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}class X2{constructor(){this.id=l0()}equals(e){return"id"in e&&this.id===e.id}}const xh="Europe/Brussels";class bl extends X2{constructor(e,n,r,i){super(),this.id=l0(),this.date=e,this.time=n,this.title=r,this.description=i}toZonedTime(e,n){var s;const r=(s=e.target)==null?void 0:s.value;if(!r)return;const[i,o]=r.split(":").map(parseInt);this.time[n]=ua.PlainTime.from({hour:i,minute:o})}setDate(e){var s;const n=(s=e.target)==null?void 0:s.value,r=new Date(n).getTime(),o=ua.Instant.fromEpochMilliseconds(r).toZonedDateTimeISO(xh);this.date=o.toPlainDate()}setFromTime(e){this.toZonedTime(e,"from")}setToTime(e){this.toZonedTime(e,"to")}static new(e,n){e=e!=null?e:ua.Now.plainDateISO(xh),n=n!=null?n:ua.Now.plainTimeISO(xh);const r={from:n,to:n.add({hours:1})};return new bl(e,r,"","")}}function eT(){const{subscribe:t,set:e,update:n}=uw([]);return{subscribe:t,addEvent:r=>n(i=>(i.push(r),i)),deleteEvent:r=>n(i=>i.filter(o=>!o.equals(r))),updateEvent:r=>n(i=>i.map(o=>o==r?r:o)),reset:()=>e([])}}const El=eT(),tT=lw(El,t=>t.reduce((e,n)=>{const r=n.date.toString();return r in e?e[r].push(n):e[r]=[n],e},{}));lw(El,t=>console.log(t));function nT(){const{subscribe:t,set:e}=uw({visible:!1,editMode:!1,event:bl.new()});return{subscribe:t,edit:n=>{e({visible:!0,editMode:!0,event:n})},new:()=>{e({visible:!0,editMode:!1,event:bl.new()})},reset:()=>e({visible:!1,editMode:!1,event:bl.new()})}}const Os=nT();const rT=t=>({}),Ty=t=>({});function Ay(t){let e;const n=t[5].icon,r=Oa(n,t,t[4],Ty);return{c(){r&&r.c()},l(i){r&&r.l(i)},m(i,o){r&&r.m(i,o),e=!0},p(i,o){r&&r.p&&(!e||o&16)&&Ca(r,n,i,i[4],e?Na(n,i[4],o,rT):Pa(i[4]),Ty)},i(i){e||(Le(r,i),e=!0)},o(i){Je(r,i),e=!1},d(i){r&&r.d(i)}}}function iT(t){let e,n,r,i,o,s,a=t[3].icon&&Ay(t);const c=t[5].default,l=Oa(c,t,t[4],null);return{c(){e=Pt("div"),a&&a.c(),n=en(),r=Pt("div"),l&&l.c(),this.h()},l(u){e=Nt(u,"DIV",{class:!0});var d=Lt(e);a&&a.l(d),n=tn(d),r=Nt(d,"DIV",{class:!0});var g=Lt(r);l&&l.l(g),g.forEach(De),d.forEach(De),this.h()},h(){it(r,"class","div"),it(e,"class","rounded-md py-2 px-4 cursor-pointer bg-slate-100 hover:bg-slate-300 transition-colors flex items-center gap-2 svelte-c36zp3"),In(e,"filled",t[0]),In(e,"focused",t[1]),In(e,"destructive",t[2])},m(u,d){At(u,e,d),a&&a.m(e,null),Me(e,n),Me(e,r),l&&l.m(r,null),i=!0,o||(s=Co(e,"click",t[6]),o=!0)},p(u,[d]){u[3].icon?a?(a.p(u,d),d&8&&Le(a,1)):(a=Ay(u),a.c(),Le(a,1),a.m(e,n)):a&&(Po(),Je(a,1,1,()=>{a=null}),No()),l&&l.p&&(!i||d&16)&&Ca(l,c,u,u[4],i?Na(c,u[4],d,null):Pa(u[4]),null),d&1&&In(e,"filled",u[0]),d&2&&In(e,"focused",u[1]),d&4&&In(e,"destructive",u[2])},i(u){i||(Le(a),Le(l,u),i=!0)},o(u){Je(a),Je(l,u),i=!1},d(u){u&&De(e),a&&a.d(),l&&l.d(u),o=!1,s()}}}function oT(t,e,n){let{$$slots:r={},$$scope:i}=e;const o=Pg(r);let{filled:s=!1}=e,{focused:a=!1}=e,{destructive:c=!1}=e;function l(u){ba.call(this,t,u)}return t.$$set=u=>{"filled"in u&&n(0,s=u.filled),"focused"in u&&n(1,a=u.focused),"destructive"in u&&n(2,c=u.destructive),"$$scope"in u&&n(4,i=u.$$scope)},[s,a,c,o,i,r,l]}class Aa extends ho{constructor(e){super(),po(this,e,oT,iT,go,{filled:0,focused:1,destructive:2})}}function sT(t){let e,n,r=t[0].title+"",i,o,s,a,c,l,u,d,g=t[0].description+"",p;return{c(){e=Pt("div"),n=Pt("span"),i=mn(r),o=en(),s=Pt("span"),a=mn(t[2]),c=mn("-"),l=mn(t[1]),u=en(),d=Pt("div"),p=mn(g),this.h()},l(y){e=Nt(y,"DIV",{class:!0});var w=Lt(e);n=Nt(w,"SPAN",{class:!0});var E=Lt(n);i=yn(E,r),E.forEach(De),o=tn(w),s=Nt(w,"SPAN",{class:!0});var b=Lt(s);a=yn(b,t[2]),c=yn(b,"-"),l=yn(b,t[1]),b.forEach(De),w.forEach(De),u=tn(y),d=Nt(y,"DIV",{class:!0});var S=Lt(d);p=yn(S,g),S.forEach(De),this.h()},h(){it(n,"class","text-lg text-bol"),it(s,"class","text-sm"),it(e,"class","flex justify-between items-end mb-2"),it(d,"class","text-sm line-clamp-3")},m(y,w){At(y,e,w),Me(e,n),Me(n,i),Me(e,o),Me(e,s),Me(s,a),Me(s,c),Me(s,l),At(y,u,w),At(y,d,w),Me(d,p)},p(y,w){w&1&&r!==(r=y[0].title+"")&&ki(i,r),w&4&&ki(a,y[2]),w&2&&ki(l,y[1]),w&1&&g!==(g=y[0].description+"")&&ki(p,g)},d(y){y&&De(e),y&&De(u),y&&De(d)}}}function aT(t){let e,n;return e=new Aa({props:{focused:!0,$$slots:{default:[sT]},$$scope:{ctx:t}}}),e.$on("click",t[3]),{c(){Cn(e.$$.fragment)},l(r){Pn(e.$$.fragment,r)},m(r,i){Nn(e,r,i),n=!0},p(r,[i]){const o={};i&23&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(Le(e.$$.fragment,r),n=!0)},o(r){Je(e.$$.fragment,r),n=!1},d(r){On(e,r)}}}function cT(t,e,n){let r,i,{event:o}=e;function s(a){ba.call(this,t,a)}return t.$$set=a=>{"event"in a&&n(0,o=a.event)},t.$$.update=()=>{t.$$.dirty&1&&n(2,r=o.time.from.toString({smallestUnit:"minute"})),t.$$.dirty&1&&n(1,i=o.time.to.toString({smallestUnit:"minute"}))},[o,i,r,s]}class lT extends ho{constructor(e){super(),po(this,e,cT,aT,go,{event:0})}}const uT=t=>({}),xy=t=>({});function dT(t){let e;return{c(){e=mn(t[1])},l(n){e=yn(n,t[1])},m(n,r){At(n,e,r)},p(n,r){r&2&&ki(e,n[1])},i:uo,o:uo,d(n){n&&De(e)}}}function fT(t){let e;const n=t[8].label,r=Oa(n,t,t[7],xy);return{c(){r&&r.c()},l(i){r&&r.l(i)},m(i,o){r&&r.m(i,o),e=!0},p(i,o){r&&r.p&&(!e||o&128)&&Ca(r,n,i,i[7],e?Na(n,i[7],o,uT):Pa(i[7]),xy)},i(i){e||(Le(r,i),e=!0)},o(i){Je(r,i),e=!1},d(i){r&&r.d(i)}}}function hT(t){let e,n,r,i;return{c(){e=Pt("input"),this.h()},l(o){e=Nt(o,"INPUT",{id:!0,class:!0,type:!0,placeholder:!0}),this.h()},h(){it(e,"id",t[5]),it(e,"class","rounded-md p-2 w-full bg-slate-100 hover:ring transition-all"),it(e,"type","text"),it(e,"placeholder",n=t[2]||t[1]),In(e,"ring",t[3]),In(e,"ring-red-500",t[3])},m(o,s){At(o,e,s),vc(e,t[0]),r||(i=Co(e,"input",t[13]),r=!0)},p(o,s){s&6&&n!==(n=o[2]||o[1])&&it(e,"placeholder",n),s&1&&e.value!==o[0]&&vc(e,o[0]),s&8&&In(e,"ring",o[3]),s&8&&In(e,"ring-red-500",o[3])},d(o){o&&De(e),r=!1,i()}}}function pT(t){let e,n,r,i;return{c(){e=Pt("input"),this.h()},l(o){e=Nt(o,"INPUT",{id:!0,class:!0,type:!0,placeholder:!0}),this.h()},h(){it(e,"id",t[5]),it(e,"class","rounded-md p-2 w-full bg-slate-100 hover:ring transition-all"),it(e,"type","time"),it(e,"placeholder",n=t[2]||t[1]),In(e,"ring",t[3]),In(e,"ring-red-500",t[3])},m(o,s){At(o,e,s),vc(e,t[0]),r||(i=[Co(e,"input",t[12]),Co(e,"change",t[10])],r=!0)},p(o,s){s&6&&n!==(n=o[2]||o[1])&&it(e,"placeholder",n),s&1&&vc(e,o[0]),s&8&&In(e,"ring",o[3]),s&8&&In(e,"ring-red-500",o[3])},d(o){o&&De(e),r=!1,Ng(i)}}}function gT(t){let e,n,r,i;return{c(){e=Pt("input"),this.h()},l(o){e=Nt(o,"INPUT",{id:!0,class:!0,type:!0,placeholder:!0}),this.h()},h(){it(e,"id",t[5]),it(e,"class","rounded-md p-2 w-full bg-slate-100 hover:ring transition-all"),it(e,"type","date"),it(e,"placeholder",n=t[2]||t[1]),In(e,"ring",t[3]),In(e,"ring-red-500",t[3])},m(o,s){At(o,e,s),vc(e,t[0]),r||(i=[Co(e,"input",t[11]),Co(e,"change",t[9])],r=!0)},p(o,s){s&6&&n!==(n=o[2]||o[1])&&it(e,"placeholder",n),s&1&&vc(e,o[0]),s&8&&In(e,"ring",o[3]),s&8&&In(e,"ring-red-500",o[3])},d(o){o&&De(e),r=!1,Ng(i)}}}function mT(t){let e,n,r,i,o,s,a,c,l;const u=[fT,dT],d=[];function g(E,b){return E[6].label?0:E[1]?1:-1}~(r=g(t))&&(i=d[r]=u[r](t));function p(E,b){return E[4]=="date"?gT:E[4]=="time"?pT:hT}let y=p(t),w=y(t);return{c(){e=Pt("label"),n=Pt("div"),i&&i.c(),o=en(),w.c(),s=en(),a=Pt("div"),c=mn(t[3]),this.h()},l(E){e=Nt(E,"LABEL",{class:!0,for:!0});var b=Lt(e);n=Nt(b,"DIV",{class:!0});var S=Lt(n);i&&i.l(S),S.forEach(De),o=tn(b),w.l(b),s=tn(b),a=Nt(b,"DIV",{class:!0});var R=Lt(a);c=yn(R,t[3]),R.forEach(De),b.forEach(De),this.h()},h(){it(n,"class","mx-1 mb-px text-sm capitalize"),it(a,"class","text-sm h-2 text-red-700 "),In(a,"opacity-0",!t[3]),it(e,"class","my-4 block"),it(e,"for",t[5])},m(E,b){At(E,e,b),Me(e,n),~r&&d[r].m(n,null),Me(e,o),w.m(e,null),Me(e,s),Me(e,a),Me(a,c),l=!0},p(E,[b]){let S=r;r=g(E),r===S?~r&&d[r].p(E,b):(i&&(Po(),Je(d[S],1,1,()=>{d[S]=null}),No()),~r?(i=d[r],i?i.p(E,b):(i=d[r]=u[r](E),i.c()),Le(i,1),i.m(n,null)):i=null),y===(y=p(E))&&w?w.p(E,b):(w.d(1),w=y(E),w&&(w.c(),w.m(e,s))),(!l||b&8)&&ki(c,E[3]),b&8&&In(a,"opacity-0",!E[3])},i(E){l||(Le(i),l=!0)},o(E){Je(i),l=!1},d(E){E&&De(e),~r&&d[r].d(),w.d()}}}function yT(t,e,n){let{$$slots:r={},$$scope:i}=e;const o=Pg(r);let{label:s=""}=e,{placeholder:a=""}=e,{error:c=""}=e,{value:l=""}=e,{type:u="text"}=e,d=l0();function g(b){ba.call(this,t,b)}function p(b){ba.call(this,t,b)}function y(){l=this.value,n(0,l)}function w(){l=this.value,n(0,l)}function E(){l=this.value,n(0,l)}return t.$$set=b=>{"label"in b&&n(1,s=b.label),"placeholder"in b&&n(2,a=b.placeholder),"error"in b&&n(3,c=b.error),"value"in b&&n(0,l=b.value),"type"in b&&n(4,u=b.type),"$$scope"in b&&n(7,i=b.$$scope)},[l,s,a,c,u,d,o,i,r,g,p,y,w,E]}class ol extends ho{constructor(e){super(),po(this,e,yT,mT,go,{label:1,placeholder:2,error:3,value:0,type:4})}}const _T=t=>({}),Iy=t=>({submit:t[2]});function Ry(t){let e,n,r=t[1].editMode?"Edit":"Create",i,o,s,a,c,l,u,d,g,p,y,w,E,b,S,R,F;a=new ol({props:{type:"date",label:"date",value:t[0].date.toString()}}),a.$on("change",t[5]),l=new ol({props:{type:"time",label:"from",value:t[0].time.from.toString({smallestUnit:"minute"})}}),l.$on("change",t[6]),d=new ol({props:{type:"time",label:"to",value:t[0].time.to.toString({smallestUnit:"minute"})}}),d.$on("change",t[7]);function M(te){t[8](te)}let P={label:"title"};t[0].title!==void 0&&(P.value=t[0].title),p=new ol({props:P}),dy.push(()=>fy(p,"value",M));function D(te){t[9](te)}let Y={label:"description"};t[0].description!==void 0&&(Y.value=t[0].description),E=new ol({props:Y}),dy.push(()=>fy(E,"value",D));const X=t[4].default,$=Oa(X,t,t[3],Iy);return{c(){e=Pt("form"),n=Pt("h3"),i=mn(r),o=mn(" event"),s=en(),Cn(a.$$.fragment),c=en(),Cn(l.$$.fragment),u=en(),Cn(d.$$.fragment),g=en(),Cn(p.$$.fragment),w=en(),Cn(E.$$.fragment),S=en(),R=Pt("div"),$&&$.c(),this.h()},l(te){e=Nt(te,"FORM",{class:!0});var _e=Lt(e);n=Nt(_e,"H3",{class:!0});var Ae=Lt(n);i=yn(Ae,r),o=yn(Ae," event"),Ae.forEach(De),s=tn(_e),Pn(a.$$.fragment,_e),c=tn(_e),Pn(l.$$.fragment,_e),u=tn(_e),Pn(d.$$.fragment,_e),g=tn(_e),Pn(p.$$.fragment,_e),w=tn(_e),Pn(E.$$.fragment,_e),S=tn(_e),R=Nt(_e,"DIV",{class:!0});var re=Lt(R);$&&$.l(re),re.forEach(De),_e.forEach(De),this.h()},h(){it(n,"class","text-xl border-b border-b-black/50 border-solid mb-4 pb-2"),it(R,"class","flex gap-2 justify-end"),it(e,"class","editEvent")},m(te,_e){At(te,e,_e),Me(e,n),Me(n,i),Me(n,o),Me(e,s),Nn(a,e,null),Me(e,c),Nn(l,e,null),Me(e,u),Nn(d,e,null),Me(e,g),Nn(p,e,null),Me(e,w),Nn(E,e,null),Me(e,S),Me(e,R),$&&$.m(R,null),F=!0},p(te,_e){(!F||_e&2)&&r!==(r=te[1].editMode?"Edit":"Create")&&ki(i,r);const Ae={};_e&1&&(Ae.value=te[0].date.toString()),a.$set(Ae);const re={};_e&1&&(re.value=te[0].time.from.toString({smallestUnit:"minute"})),l.$set(re);const se={};_e&1&&(se.value=te[0].time.to.toString({smallestUnit:"minute"})),d.$set(se);const we={};!y&&_e&1&&(y=!0,we.value=te[0].title,uy(()=>y=!1)),p.$set(we);const Ce={};!b&&_e&1&&(b=!0,Ce.value=te[0].description,uy(()=>b=!1)),E.$set(Ce),$&&$.p&&(!F||_e&8)&&Ca($,X,te,te[3],F?Na(X,te[3],_e,_T):Pa(te[3]),Iy)},i(te){F||(Le(a.$$.fragment,te),Le(l.$$.fragment,te),Le(d.$$.fragment,te),Le(p.$$.fragment,te),Le(E.$$.fragment,te),Le($,te),F=!0)},o(te){Je(a.$$.fragment,te),Je(l.$$.fragment,te),Je(d.$$.fragment,te),Je(p.$$.fragment,te),Je(E.$$.fragment,te),Je($,te),F=!1},d(te){te&&De(e),On(a),On(l),On(d),On(p),On(E),$&&$.d(te)}}}function wT(t){let e,n,r=t[0]&&Ry(t);return{c(){r&&r.c(),e=Oo()},l(i){r&&r.l(i),e=Oo()},m(i,o){r&&r.m(i,o),At(i,e,o),n=!0},p(i,[o]){i[0]?r?(r.p(i,o),o&1&&Le(r,1)):(r=Ry(i),r.c(),Le(r,1),r.m(e.parentNode,e)):r&&(Po(),Je(r,1,1,()=>{r=null}),No())},i(i){n||(Le(r),n=!0)},o(i){Je(r),n=!1},d(i){r&&r.d(i),i&&De(e)}}}function vT(t,e,n){let r;Ep(t,Os,p=>n(1,r=p));let{$$slots:i={},$$scope:o}=e,s=r.event;function a(p){Os.reset(),p(s)}const c=p=>s.setDate(p),l=p=>s.setFromTime(p),u=p=>s.setToTime(p);function d(p){t.$$.not_equal(s.title,p)&&(s.title=p,n(0,s))}function g(p){t.$$.not_equal(s.description,p)&&(s.description=p,n(0,s))}return t.$$set=p=>{"$$scope"in p&&n(3,o=p.$$scope)},[s,r,a,o,i,c,l,u,d,g]}class bT extends ho{constructor(e){super(),po(this,e,vT,wT,go,{})}}function ky(t){let e,n,r,i,o;const s=t[3].default,a=Oa(s,t,t[2],null);return{c(){e=Pt("div"),n=Pt("div"),a&&a.c(),this.h()},l(c){e=Nt(c,"DIV",{class:!0});var l=Lt(e);n=Nt(l,"DIV",{class:!0});var u=Lt(n);a&&a.l(u),u.forEach(De),l.forEach(De),this.h()},h(){it(n,"class","modal svelte-7qxvgi"),it(e,"class","backdrop svelte-7qxvgi")},m(c,l){At(c,e,l),Me(e,n),a&&a.m(n,null),r=!0,i||(o=[Co(n,"click",oS(t[4])),Co(e,"click",t[1])],i=!0)},p(c,l){a&&a.p&&(!r||l&4)&&Ca(a,s,c,c[2],r?Na(s,c[2],l,null):Pa(c[2]),null)},i(c){r||(Le(a,c),r=!0)},o(c){Je(a,c),r=!1},d(c){c&&De(e),a&&a.d(c),i=!1,Ng(o)}}}function ET(t){let e,n,r=t[0]&&ky(t);return{c(){r&&r.c(),e=Oo()},l(i){r&&r.l(i),e=Oo()},m(i,o){r&&r.m(i,o),At(i,e,o),n=!0},p(i,[o]){i[0]?r?(r.p(i,o),o&1&&Le(r,1)):(r=ky(i),r.c(),Le(r,1),r.m(e.parentNode,e)):r&&(Po(),Je(r,1,1,()=>{r=null}),No())},i(i){n||(Le(r),n=!0)},o(i){Je(r),n=!1},d(i){r&&r.d(i),i&&De(e)}}}function ST(t,e,n){let{$$slots:r={},$$scope:i}=e,{visible:o=!1}=e;const s=sS();function a(){s("close"),n(0,o=!1)}function c(l){ba.call(this,t,l)}return t.$$set=l=>{"visible"in l&&n(0,o=l.visible),"$$scope"in l&&n(2,i=l.$$scope)},[o,a,i,r,c]}class TT extends ho{constructor(e){super(),po(this,e,ST,ET,go,{visible:0})}}const sl={location:{name:"Brussels",region:"",country:"Belgium",lat:50.83,lon:4.33,tz_id:"Europe/Brussels",localtime_epoch:1657108178,localtime:"2022-07-06 13:49"},current:{last_updated_epoch:1657107900,last_updated:"2022-07-06 13:45",temp_c:19,temp_f:66.2,is_day:1,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/116.png",code:1003},wind_mph:3.8,wind_kph:6.1,wind_degree:10,wind_dir:"N",pressure_mb:1026,pressure_in:30.3,precip_mm:0,precip_in:0,humidity:56,cloud:75,feelslike_c:19,feelslike_f:66.2,vis_km:10,vis_miles:6,uv:5,gust_mph:7.8,gust_kph:12.6},forecast:{forecastday:[{date:"2022-07-06",date_epoch:1657065600,day:{maxtemp_c:23.9,maxtemp_f:75,mintemp_c:10.9,mintemp_f:51.6,avgtemp_c:17.3,avgtemp_f:63.2,maxwind_mph:11.9,maxwind_kph:19.1,totalprecip_mm:0,totalprecip_in:0,avgvis_km:10,avgvis_miles:6,avghumidity:65,daily_will_it_rain:0,daily_chance_of_rain:0,daily_will_it_snow:0,daily_chance_of_snow:0,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/116.png",code:1003},uv:5},astro:{sunrise:"05:38 AM",sunset:"09:57 PM",moonrise:"01:14 PM",moonset:"01:11 AM",moon_phase:"First Quarter",moon_illumination:"48"},hour:[{time_epoch:1657058400,time:"2022-07-06 00:00",temp_c:12.6,temp_f:54.7,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:4.3,wind_kph:6.8,wind_degree:6,wind_dir:"N",pressure_mb:1027,pressure_in:30.31,precip_mm:0,precip_in:0,humidity:84,cloud:1,feelslike_c:12.3,feelslike_f:54.1,windchill_c:12.3,windchill_f:54.1,heatindex_c:12.6,heatindex_f:54.7,dewpoint_c:9.9,dewpoint_f:49.8,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:8.5,gust_kph:13.7,uv:1},{time_epoch:1657062e3,time:"2022-07-06 01:00",temp_c:12.2,temp_f:54,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:2.7,wind_kph:4.3,wind_degree:15,wind_dir:"NNE",pressure_mb:1027,pressure_in:30.31,precip_mm:0,precip_in:0,humidity:84,cloud:0,feelslike_c:12.4,feelslike_f:54.3,windchill_c:12.4,windchill_f:54.3,heatindex_c:12.2,heatindex_f:54,dewpoint_c:9.5,dewpoint_f:49.1,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:5.4,gust_kph:8.6,uv:1},{time_epoch:1657065600,time:"2022-07-06 02:00",temp_c:11.7,temp_f:53.1,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:2,wind_kph:3.2,wind_degree:31,wind_dir:"NNE",pressure_mb:1026,pressure_in:30.31,precip_mm:0,precip_in:0,humidity:84,cloud:19,feelslike_c:12.3,feelslike_f:54.1,windchill_c:12.3,windchill_f:54.1,heatindex_c:11.7,heatindex_f:53.1,dewpoint_c:9,dewpoint_f:48.2,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:4,gust_kph:6.5,uv:1},{time_epoch:1657069200,time:"2022-07-06 03:00",temp_c:11.4,temp_f:52.5,is_day:0,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/night/116.png",code:1003},wind_mph:1.8,wind_kph:2.9,wind_degree:48,wind_dir:"NE",pressure_mb:1026,pressure_in:30.31,precip_mm:0,precip_in:0,humidity:84,cloud:26,feelslike_c:11.4,feelslike_f:52.5,windchill_c:11.4,windchill_f:52.5,heatindex_c:11.4,heatindex_f:52.5,dewpoint_c:8.8,dewpoint_f:47.8,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:3.6,gust_kph:5.8,uv:1},{time_epoch:1657072800,time:"2022-07-06 04:00",temp_c:11.1,temp_f:52,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:2,wind_kph:3.2,wind_degree:135,wind_dir:"SE",pressure_mb:1026,pressure_in:30.3,precip_mm:0,precip_in:0,humidity:83,cloud:20,feelslike_c:11.6,feelslike_f:52.9,windchill_c:11.6,windchill_f:52.9,heatindex_c:11.1,heatindex_f:52,dewpoint_c:8.4,dewpoint_f:47.1,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:4.3,gust_kph:6.8,uv:1},{time_epoch:1657076400,time:"2022-07-06 05:00",temp_c:10.9,temp_f:51.6,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:3.4,wind_kph:5.4,wind_degree:167,wind_dir:"SSE",pressure_mb:1026,pressure_in:30.29,precip_mm:0,precip_in:0,humidity:82,cloud:17,feelslike_c:10.7,feelslike_f:51.3,windchill_c:10.7,windchill_f:51.3,heatindex_c:10.9,heatindex_f:51.6,dewpoint_c:8,dewpoint_f:46.4,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:6.9,gust_kph:11.2,uv:1},{time_epoch:165708e4,time:"2022-07-06 06:00",temp_c:12.2,temp_f:54,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:2.7,wind_kph:4.3,wind_degree:218,wind_dir:"SW",pressure_mb:1026,pressure_in:30.31,precip_mm:0,precip_in:0,humidity:77,cloud:9,feelslike_c:12.4,feelslike_f:54.3,windchill_c:12.4,windchill_f:54.3,heatindex_c:12.2,heatindex_f:54,dewpoint_c:8.4,dewpoint_f:47.1,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:4.7,gust_kph:7.6,uv:4},{time_epoch:1657083600,time:"2022-07-06 07:00",temp_c:13.7,temp_f:56.7,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:3.4,wind_kph:5.4,wind_degree:254,wind_dir:"WSW",pressure_mb:1027,pressure_in:30.32,precip_mm:0,precip_in:0,humidity:71,cloud:14,feelslike_c:13.9,feelslike_f:57,windchill_c:13.9,windchill_f:57,heatindex_c:13.7,heatindex_f:56.7,dewpoint_c:8.6,dewpoint_f:47.5,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:4.7,gust_kph:7.6,uv:4},{time_epoch:1657087200,time:"2022-07-06 08:00",temp_c:15.5,temp_f:59.9,is_day:1,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/116.png",code:1003},wind_mph:4,wind_kph:6.5,wind_degree:237,wind_dir:"WSW",pressure_mb:1027,pressure_in:30.32,precip_mm:0,precip_in:0,humidity:64,cloud:54,feelslike_c:15.5,feelslike_f:59.9,windchill_c:15.5,windchill_f:59.9,heatindex_c:15.5,heatindex_f:59.9,dewpoint_c:8.8,dewpoint_f:47.8,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:4.9,gust_kph:7.9,uv:5},{time_epoch:1657090800,time:"2022-07-06 09:00",temp_c:16.9,temp_f:62.4,is_day:1,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/116.png",code:1003},wind_mph:4.7,wind_kph:7.6,wind_degree:244,wind_dir:"WSW",pressure_mb:1027,pressure_in:30.31,precip_mm:0,precip_in:0,humidity:59,cloud:62,feelslike_c:16.9,feelslike_f:62.4,windchill_c:16.9,windchill_f:62.4,heatindex_c:16.9,heatindex_f:62.4,dewpoint_c:8.9,dewpoint_f:48,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:5.6,gust_kph:9,uv:5},{time_epoch:1657094400,time:"2022-07-06 10:00",temp_c:18,temp_f:64.4,is_day:1,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/116.png",code:1003},wind_mph:5.1,wind_kph:8.3,wind_degree:249,wind_dir:"WSW",pressure_mb:1026,pressure_in:30.3,precip_mm:0,precip_in:0,humidity:56,cloud:56,feelslike_c:18,feelslike_f:64.4,windchill_c:18,windchill_f:64.4,heatindex_c:18,heatindex_f:64.4,dewpoint_c:9.1,dewpoint_f:48.4,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:6,gust_kph:9.7,uv:5},{time_epoch:1657098e3,time:"2022-07-06 11:00",temp_c:19.3,temp_f:66.7,is_day:1,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/116.png",code:1003},wind_mph:6,wind_kph:9.7,wind_degree:259,wind_dir:"W",pressure_mb:1026,pressure_in:30.31,precip_mm:0,precip_in:0,humidity:54,cloud:61,feelslike_c:19.3,feelslike_f:66.7,windchill_c:19.3,windchill_f:66.7,heatindex_c:19.3,heatindex_f:66.7,dewpoint_c:9.6,dewpoint_f:49.3,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:6.9,gust_kph:11.2,uv:5},{time_epoch:1657101600,time:"2022-07-06 12:00",temp_c:20.2,temp_f:68.4,is_day:1,condition:{text:"Overcast",icon:"//cdn.weatherapi.com/weather/64x64/day/122.png",code:1009},wind_mph:6.7,wind_kph:10.8,wind_degree:270,wind_dir:"W",pressure_mb:1026,pressure_in:30.3,precip_mm:0,precip_in:0,humidity:52,cloud:89,feelslike_c:20.2,feelslike_f:68.4,windchill_c:20.2,windchill_f:68.4,heatindex_c:20.2,heatindex_f:68.4,dewpoint_c:9.9,dewpoint_f:49.8,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:7.8,gust_kph:12.6,uv:5},{time_epoch:1657105200,time:"2022-07-06 13:00",temp_c:21.5,temp_f:70.7,is_day:1,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/116.png",code:1003},wind_mph:5.6,wind_kph:9,wind_degree:259,wind_dir:"W",pressure_mb:1025,pressure_in:30.27,precip_mm:0,precip_in:0,humidity:48,cloud:55,feelslike_c:21.5,feelslike_f:70.7,windchill_c:21.5,windchill_f:70.7,heatindex_c:24.2,heatindex_f:75.6,dewpoint_c:9.9,dewpoint_f:49.8,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:6.5,gust_kph:10.4,uv:6},{time_epoch:1657108800,time:"2022-07-06 14:00",temp_c:23,temp_f:73.4,is_day:1,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/116.png",code:1003},wind_mph:5.4,wind_kph:8.6,wind_degree:277,wind_dir:"W",pressure_mb:1025,pressure_in:30.25,precip_mm:0,precip_in:0,humidity:44,cloud:47,feelslike_c:24.5,feelslike_f:76.1,windchill_c:23,windchill_f:73.4,heatindex_c:24.5,heatindex_f:76.1,dewpoint_c:9.9,dewpoint_f:49.8,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:6.3,gust_kph:10.1,uv:6},{time_epoch:1657112400,time:"2022-07-06 15:00",temp_c:23.9,temp_f:75,is_day:1,condition:{text:"Cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/119.png",code:1006},wind_mph:5.4,wind_kph:8.6,wind_degree:282,wind_dir:"WNW",pressure_mb:1024,pressure_in:30.23,precip_mm:0,precip_in:0,humidity:41,cloud:81,feelslike_c:24.8,feelslike_f:76.6,windchill_c:23.9,windchill_f:75,heatindex_c:24.8,heatindex_f:76.6,dewpoint_c:9.9,dewpoint_f:49.8,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:6.3,gust_kph:10.1,uv:5},{time_epoch:1657116e3,time:"2022-07-06 16:00",temp_c:23.9,temp_f:75,is_day:1,condition:{text:"Cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/119.png",code:1006},wind_mph:8.3,wind_kph:13.3,wind_degree:298,wind_dir:"WNW",pressure_mb:1023,pressure_in:30.22,precip_mm:0,precip_in:0,humidity:41,cloud:81,feelslike_c:24.8,feelslike_f:76.6,windchill_c:23.9,windchill_f:75,heatindex_c:24.8,heatindex_f:76.6,dewpoint_c:9.9,dewpoint_f:49.8,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:9.8,gust_kph:15.8,uv:5},{time_epoch:1657119600,time:"2022-07-06 17:00",temp_c:22.7,temp_f:72.9,is_day:1,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/116.png",code:1003},wind_mph:10.3,wind_kph:16.6,wind_degree:311,wind_dir:"NW",pressure_mb:1023,pressure_in:30.21,precip_mm:0,precip_in:0,humidity:46,cloud:54,feelslike_c:24.5,feelslike_f:76.1,windchill_c:22.7,windchill_f:72.9,heatindex_c:24.5,heatindex_f:76.1,dewpoint_c:10.6,dewpoint_f:51.1,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:14.5,gust_kph:23.4,uv:6},{time_epoch:1657123200,time:"2022-07-06 18:00",temp_c:22.7,temp_f:72.9,is_day:1,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/116.png",code:1003},wind_mph:11.9,wind_kph:19.1,wind_degree:318,wind_dir:"NW",pressure_mb:1023,pressure_in:30.22,precip_mm:0,precip_in:0,humidity:51,cloud:55,feelslike_c:24.6,feelslike_f:76.3,windchill_c:22.7,windchill_f:72.9,heatindex_c:24.6,heatindex_f:76.3,dewpoint_c:12,dewpoint_f:53.6,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:13.6,gust_kph:22,uv:6},{time_epoch:1657126800,time:"2022-07-06 19:00",temp_c:22.1,temp_f:71.8,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:11,wind_kph:17.6,wind_degree:317,wind_dir:"NW",pressure_mb:1023,pressure_in:30.22,precip_mm:0,precip_in:0,humidity:57,cloud:25,feelslike_c:24.6,feelslike_f:76.3,windchill_c:22.1,windchill_f:71.8,heatindex_c:24.6,heatindex_f:76.3,dewpoint_c:13.3,dewpoint_f:55.9,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:12.5,gust_kph:20.2,uv:6},{time_epoch:1657130400,time:"2022-07-06 20:00",temp_c:19.5,temp_f:67.1,is_day:1,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/116.png",code:1003},wind_mph:8.3,wind_kph:13.3,wind_degree:314,wind_dir:"NW",pressure_mb:1024,pressure_in:30.23,precip_mm:0,precip_in:0,humidity:64,cloud:28,feelslike_c:19.5,feelslike_f:67.1,windchill_c:19.5,windchill_f:67.1,heatindex_c:19.5,heatindex_f:67.1,dewpoint_c:12.6,dewpoint_f:54.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:13.2,gust_kph:21.2,uv:5},{time_epoch:1657134e3,time:"2022-07-06 21:00",temp_c:17.8,temp_f:64,is_day:1,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/116.png",code:1003},wind_mph:6.3,wind_kph:10.1,wind_degree:291,wind_dir:"WNW",pressure_mb:1024,pressure_in:30.22,precip_mm:0,precip_in:0,humidity:72,cloud:35,feelslike_c:17.8,feelslike_f:64,windchill_c:17.8,windchill_f:64,heatindex_c:17.8,heatindex_f:64,dewpoint_c:12.7,dewpoint_f:54.9,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:11.6,gust_kph:18.7,uv:5},{time_epoch:1657137600,time:"2022-07-06 22:00",temp_c:16.9,temp_f:62.4,is_day:0,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/night/116.png",code:1003},wind_mph:5.8,wind_kph:9.4,wind_degree:268,wind_dir:"W",pressure_mb:1023,pressure_in:30.22,precip_mm:0,precip_in:0,humidity:77,cloud:38,feelslike_c:16.9,feelslike_f:62.4,windchill_c:16.9,windchill_f:62.4,heatindex_c:16.9,heatindex_f:62.4,dewpoint_c:12.8,dewpoint_f:55,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:11.2,gust_kph:18,uv:1},{time_epoch:1657141200,time:"2022-07-06 23:00",temp_c:16.2,temp_f:61.2,is_day:0,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/night/116.png",code:1003},wind_mph:6.9,wind_kph:11.2,wind_degree:247,wind_dir:"WSW",pressure_mb:1023,pressure_in:30.21,precip_mm:0,precip_in:0,humidity:79,cloud:34,feelslike_c:16.2,feelslike_f:61.2,windchill_c:16.2,windchill_f:61.2,heatindex_c:16.2,heatindex_f:61.2,dewpoint_c:12.6,dewpoint_f:54.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:13.6,gust_kph:22,uv:1}]},{date:"2022-07-07",date_epoch:1657152e3,day:{maxtemp_c:22.8,maxtemp_f:73,mintemp_c:12.3,mintemp_f:54.1,avgtemp_c:17.6,avgtemp_f:63.6,maxwind_mph:16.8,maxwind_kph:27,totalprecip_mm:1.3,totalprecip_in:.05,avgvis_km:10,avgvis_miles:6,avghumidity:71,daily_will_it_rain:1,daily_chance_of_rain:89,daily_will_it_snow:0,daily_chance_of_snow:0,condition:{text:"Patchy rain possible",icon:"//cdn.weatherapi.com/weather/64x64/day/176.png",code:1063},uv:4},astro:{sunrise:"05:38 AM",sunset:"09:57 PM",moonrise:"02:29 PM",moonset:"01:25 AM",moon_phase:"First Quarter",moon_illumination:"55"},hour:[{time_epoch:1657144800,time:"2022-07-07 00:00",temp_c:15.9,temp_f:60.6,is_day:0,condition:{text:"Cloudy",icon:"//cdn.weatherapi.com/weather/64x64/night/119.png",code:1006},wind_mph:8.9,wind_kph:14.4,wind_degree:235,wind_dir:"SW",pressure_mb:1023,pressure_in:30.19,precip_mm:0,precip_in:0,humidity:81,cloud:72,feelslike_c:15.9,feelslike_f:60.6,windchill_c:15.9,windchill_f:60.6,heatindex_c:15.9,heatindex_f:60.6,dewpoint_c:12.6,dewpoint_f:54.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:16.8,gust_kph:27,uv:1},{time_epoch:1657148400,time:"2022-07-07 01:00",temp_c:15.6,temp_f:60.1,is_day:0,condition:{text:"Overcast",icon:"//cdn.weatherapi.com/weather/64x64/night/122.png",code:1009},wind_mph:8.9,wind_kph:14.4,wind_degree:242,wind_dir:"WSW",pressure_mb:1022,pressure_in:30.18,precip_mm:0,precip_in:0,humidity:84,cloud:100,feelslike_c:15.6,feelslike_f:60.1,windchill_c:15.6,windchill_f:60.1,heatindex_c:15.6,heatindex_f:60.1,dewpoint_c:12.9,dewpoint_f:55.2,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:16.6,gust_kph:26.6,uv:1},{time_epoch:1657152e3,time:"2022-07-07 02:00",temp_c:17,temp_f:62.6,is_day:0,condition:{text:"Overcast",icon:"//cdn.weatherapi.com/weather/64x64/night/122.png",code:1009},wind_mph:9.6,wind_kph:15.5,wind_degree:256,wind_dir:"WSW",pressure_mb:1022,pressure_in:30.17,precip_mm:0,precip_in:0,humidity:78,cloud:100,feelslike_c:17,feelslike_f:62.6,windchill_c:17,windchill_f:62.6,heatindex_c:17,heatindex_f:62.6,dewpoint_c:13.1,dewpoint_f:55.6,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:14.3,gust_kph:23,uv:1},{time_epoch:1657155600,time:"2022-07-07 03:00",temp_c:17.3,temp_f:63.1,is_day:0,condition:{text:"Overcast",icon:"//cdn.weatherapi.com/weather/64x64/night/122.png",code:1009},wind_mph:9.4,wind_kph:15.1,wind_degree:261,wind_dir:"W",pressure_mb:1022,pressure_in:30.16,precip_mm:0,precip_in:0,humidity:77,cloud:100,feelslike_c:17.3,feelslike_f:63.1,windchill_c:17.3,windchill_f:63.1,heatindex_c:17.3,heatindex_f:63.1,dewpoint_c:13.2,dewpoint_f:55.8,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:13.6,gust_kph:22,uv:1},{time_epoch:1657159200,time:"2022-07-07 04:00",temp_c:16.8,temp_f:62.2,is_day:0,condition:{text:"Patchy rain possible",icon:"//cdn.weatherapi.com/weather/64x64/night/176.png",code:1063},wind_mph:9.2,wind_kph:14.8,wind_degree:265,wind_dir:"W",pressure_mb:1021,pressure_in:30.16,precip_mm:.1,precip_in:0,humidity:82,cloud:100,feelslike_c:16.8,feelslike_f:62.2,windchill_c:16.8,windchill_f:62.2,heatindex_c:16.8,heatindex_f:62.2,dewpoint_c:13.7,dewpoint_f:56.7,will_it_rain:0,chance_of_rain:69,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:13.9,gust_kph:22.3,uv:1},{time_epoch:1657162800,time:"2022-07-07 05:00",temp_c:15.7,temp_f:60.3,is_day:0,condition:{text:"Overcast",icon:"//cdn.weatherapi.com/weather/64x64/night/122.png",code:1009},wind_mph:10.3,wind_kph:16.6,wind_degree:282,wind_dir:"WNW",pressure_mb:1021,pressure_in:30.16,precip_mm:0,precip_in:0,humidity:89,cloud:100,feelslike_c:15.7,feelslike_f:60.3,windchill_c:15.7,windchill_f:60.3,heatindex_c:15.7,heatindex_f:60.3,dewpoint_c:14,dewpoint_f:57.2,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:16.6,gust_kph:26.6,uv:1},{time_epoch:1657166400,time:"2022-07-07 06:00",temp_c:15.7,temp_f:60.3,is_day:1,condition:{text:"Patchy rain possible",icon:"//cdn.weatherapi.com/weather/64x64/day/176.png",code:1063},wind_mph:11,wind_kph:17.6,wind_degree:302,wind_dir:"WNW",pressure_mb:1022,pressure_in:30.17,precip_mm:.1,precip_in:0,humidity:92,cloud:100,feelslike_c:15.7,feelslike_f:60.3,windchill_c:15.7,windchill_f:60.3,heatindex_c:15.7,heatindex_f:60.3,dewpoint_c:14.4,dewpoint_f:57.9,will_it_rain:1,chance_of_rain:72,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:16.6,gust_kph:26.6,uv:4},{time_epoch:165717e4,time:"2022-07-07 07:00",temp_c:15.8,temp_f:60.4,is_day:1,condition:{text:"Light rain shower",icon:"//cdn.weatherapi.com/weather/64x64/day/353.png",code:1240},wind_mph:11.6,wind_kph:18.7,wind_degree:325,wind_dir:"NW",pressure_mb:1022,pressure_in:30.19,precip_mm:.5,precip_in:.02,humidity:88,cloud:100,feelslike_c:15.8,feelslike_f:60.4,windchill_c:15.8,windchill_f:60.4,heatindex_c:15.8,heatindex_f:60.4,dewpoint_c:13.8,dewpoint_f:56.8,will_it_rain:0,chance_of_rain:63,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:17,gust_kph:27.4,uv:4},{time_epoch:1657173600,time:"2022-07-07 08:00",temp_c:16,temp_f:60.8,is_day:1,condition:{text:"Cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/119.png",code:1006},wind_mph:11.9,wind_kph:19.1,wind_degree:325,wind_dir:"NW",pressure_mb:1023,pressure_in:30.21,precip_mm:0,precip_in:0,humidity:84,cloud:78,feelslike_c:16,feelslike_f:60.8,windchill_c:16,windchill_f:60.8,heatindex_c:16,heatindex_f:60.8,dewpoint_c:13.3,dewpoint_f:55.9,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:16.6,gust_kph:26.6,uv:4},{time_epoch:1657177200,time:"2022-07-07 09:00",temp_c:16.8,temp_f:62.2,is_day:1,condition:{text:"Cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/119.png",code:1006},wind_mph:12.8,wind_kph:20.5,wind_degree:326,wind_dir:"NNW",pressure_mb:1023,pressure_in:30.22,precip_mm:0,precip_in:0,humidity:77,cloud:63,feelslike_c:16.8,feelslike_f:62.2,windchill_c:16.8,windchill_f:62.2,heatindex_c:16.8,heatindex_f:62.2,dewpoint_c:12.7,dewpoint_f:54.9,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:17,gust_kph:27.4,uv:4},{time_epoch:1657180800,time:"2022-07-07 10:00",temp_c:18.5,temp_f:65.3,is_day:1,condition:{text:"Light rain shower",icon:"//cdn.weatherapi.com/weather/64x64/day/353.png",code:1240},wind_mph:15.2,wind_kph:24.5,wind_degree:332,wind_dir:"NNW",pressure_mb:1024,pressure_in:30.24,precip_mm:.2,precip_in:.01,humidity:65,cloud:91,feelslike_c:18.5,feelslike_f:65.3,windchill_c:18.5,windchill_f:65.3,heatindex_c:18.5,heatindex_f:65.3,dewpoint_c:11.7,dewpoint_f:53.1,will_it_rain:1,chance_of_rain:89,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:17.7,gust_kph:28.4,uv:4},{time_epoch:1657184400,time:"2022-07-07 11:00",temp_c:18.8,temp_f:65.8,is_day:1,condition:{text:"Cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/119.png",code:1006},wind_mph:15.4,wind_kph:24.8,wind_degree:335,wind_dir:"NNW",pressure_mb:1025,pressure_in:30.26,precip_mm:0,precip_in:0,humidity:63,cloud:86,feelslike_c:18.8,feelslike_f:65.8,windchill_c:18.8,windchill_f:65.8,heatindex_c:18.8,heatindex_f:65.8,dewpoint_c:11.7,dewpoint_f:53.1,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:17.7,gust_kph:28.4,uv:4},{time_epoch:1657188e3,time:"2022-07-07 12:00",temp_c:19,temp_f:66.2,is_day:1,condition:{text:"Patchy rain possible",icon:"//cdn.weatherapi.com/weather/64x64/day/176.png",code:1063},wind_mph:15.2,wind_kph:24.5,wind_degree:332,wind_dir:"NNW",pressure_mb:1025,pressure_in:30.27,precip_mm:.1,precip_in:0,humidity:63,cloud:91,feelslike_c:19,feelslike_f:66.2,windchill_c:19,windchill_f:66.2,heatindex_c:19,heatindex_f:66.2,dewpoint_c:11.9,dewpoint_f:53.4,will_it_rain:1,chance_of_rain:74,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:18.3,gust_kph:29.5,uv:4},{time_epoch:1657191600,time:"2022-07-07 13:00",temp_c:21.1,temp_f:70,is_day:1,condition:{text:"Patchy rain possible",icon:"//cdn.weatherapi.com/weather/64x64/day/176.png",code:1063},wind_mph:15.9,wind_kph:25.6,wind_degree:336,wind_dir:"NNW",pressure_mb:1025,pressure_in:30.28,precip_mm:.1,precip_in:0,humidity:56,cloud:77,feelslike_c:21.1,feelslike_f:70,windchill_c:21.1,windchill_f:70,heatindex_c:24.4,heatindex_f:75.9,dewpoint_c:12,dewpoint_f:53.6,will_it_rain:0,chance_of_rain:68,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:18.3,gust_kph:29.5,uv:5},{time_epoch:1657195200,time:"2022-07-07 14:00",temp_c:20.4,temp_f:68.7,is_day:1,condition:{text:"Patchy rain possible",icon:"//cdn.weatherapi.com/weather/64x64/day/176.png",code:1063},wind_mph:16.6,wind_kph:26.6,wind_degree:338,wind_dir:"NNW",pressure_mb:1026,pressure_in:30.29,precip_mm:.1,precip_in:0,humidity:57,cloud:91,feelslike_c:20.4,feelslike_f:68.7,windchill_c:20.4,windchill_f:68.7,heatindex_c:20.4,heatindex_f:68.7,dewpoint_c:11.7,dewpoint_f:53.1,will_it_rain:1,chance_of_rain:80,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:19,gust_kph:30.6,uv:5},{time_epoch:1657198800,time:"2022-07-07 15:00",temp_c:20.3,temp_f:68.5,is_day:1,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/day/116.png",code:1003},wind_mph:16.8,wind_kph:27,wind_degree:340,wind_dir:"NNW",pressure_mb:1026,pressure_in:30.31,precip_mm:0,precip_in:0,humidity:57,cloud:25,feelslike_c:20.3,feelslike_f:68.5,windchill_c:20.3,windchill_f:68.5,heatindex_c:20.3,heatindex_f:68.5,dewpoint_c:11.5,dewpoint_f:52.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:19.2,gust_kph:31,uv:6},{time_epoch:1657202400,time:"2022-07-07 16:00",temp_c:22.8,temp_f:73,is_day:1,condition:{text:"Patchy rain possible",icon:"//cdn.weatherapi.com/weather/64x64/day/176.png",code:1063},wind_mph:16.3,wind_kph:26.3,wind_degree:341,wind_dir:"NNW",pressure_mb:1027,pressure_in:30.32,precip_mm:.1,precip_in:0,humidity:50,cloud:78,feelslike_c:24.7,feelslike_f:76.5,windchill_c:22.8,windchill_f:73,heatindex_c:24.7,heatindex_f:76.5,dewpoint_c:11.9,dewpoint_f:53.4,will_it_rain:1,chance_of_rain:87,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:18.8,gust_kph:30.2,uv:5},{time_epoch:1657206e3,time:"2022-07-07 17:00",temp_c:22.3,temp_f:72.1,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:15.9,wind_kph:25.6,wind_degree:340,wind_dir:"NNW",pressure_mb:1027,pressure_in:30.34,precip_mm:0,precip_in:0,humidity:50,cloud:2,feelslike_c:24.5,feelslike_f:76.1,windchill_c:22.3,windchill_f:72.1,heatindex_c:24.5,heatindex_f:76.1,dewpoint_c:11.5,dewpoint_f:52.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:18.3,gust_kph:29.5,uv:6},{time_epoch:1657209600,time:"2022-07-07 18:00",temp_c:20.2,temp_f:68.4,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:14.8,wind_kph:23.8,wind_degree:341,wind_dir:"NNW",pressure_mb:1028,pressure_in:30.35,precip_mm:0,precip_in:0,humidity:53,cloud:11,feelslike_c:20.2,feelslike_f:68.4,windchill_c:20.2,windchill_f:68.4,heatindex_c:20.2,heatindex_f:68.4,dewpoint_c:10.4,dewpoint_f:50.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:17,gust_kph:27.4,uv:6},{time_epoch:1657213200,time:"2022-07-07 19:00",temp_c:19.2,temp_f:66.6,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:13.4,wind_kph:21.6,wind_degree:339,wind_dir:"NNW",pressure_mb:1028,pressure_in:30.36,precip_mm:0,precip_in:0,humidity:59,cloud:19,feelslike_c:19.2,feelslike_f:66.6,windchill_c:19.2,windchill_f:66.6,heatindex_c:19.2,heatindex_f:66.6,dewpoint_c:10.9,dewpoint_f:51.6,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:15.4,gust_kph:24.8,uv:5},{time_epoch:1657216800,time:"2022-07-07 20:00",temp_c:16.3,temp_f:61.3,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:12.3,wind_kph:19.8,wind_degree:340,wind_dir:"NNW",pressure_mb:1029,pressure_in:30.38,precip_mm:0,precip_in:0,humidity:65,cloud:8,feelslike_c:16.3,feelslike_f:61.3,windchill_c:16.3,windchill_f:61.3,heatindex_c:16.3,heatindex_f:61.3,dewpoint_c:9.8,dewpoint_f:49.6,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:17.2,gust_kph:27.7,uv:5},{time_epoch:1657220400,time:"2022-07-07 21:00",temp_c:14.3,temp_f:57.7,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:10.1,wind_kph:16.2,wind_degree:345,wind_dir:"NNW",pressure_mb:1030,pressure_in:30.4,precip_mm:0,precip_in:0,humidity:73,cloud:7,feelslike_c:13.1,feelslike_f:55.6,windchill_c:13.1,windchill_f:55.6,heatindex_c:14.3,heatindex_f:57.7,dewpoint_c:9.6,dewpoint_f:49.3,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:16.8,gust_kph:27,uv:4},{time_epoch:1657224e3,time:"2022-07-07 22:00",temp_c:13.1,temp_f:55.6,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:8.1,wind_kph:13,wind_degree:350,wind_dir:"N",pressure_mb:1030,pressure_in:30.42,precip_mm:0,precip_in:0,humidity:80,cloud:6,feelslike_c:12,feelslike_f:53.6,windchill_c:12,windchill_f:53.6,heatindex_c:13.1,heatindex_f:55.6,dewpoint_c:9.7,dewpoint_f:49.5,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:14.5,gust_kph:23.4,uv:1},{time_epoch:1657227600,time:"2022-07-07 23:00",temp_c:12.3,temp_f:54.1,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:6.7,wind_kph:10.8,wind_degree:351,wind_dir:"N",pressure_mb:1031,pressure_in:30.43,precip_mm:0,precip_in:0,humidity:84,cloud:4,feelslike_c:11.3,feelslike_f:52.3,windchill_c:11.3,windchill_f:52.3,heatindex_c:12.3,heatindex_f:54.1,dewpoint_c:9.7,dewpoint_f:49.5,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:12.8,gust_kph:20.5,uv:1}]},{date:"2022-07-08",date_epoch:1657238400,day:{maxtemp_c:28,maxtemp_f:82.4,mintemp_c:10.1,mintemp_f:50.2,avgtemp_c:18.1,avgtemp_f:64.5,maxwind_mph:10.1,maxwind_kph:16.2,totalprecip_mm:0,totalprecip_in:0,avgvis_km:10,avgvis_miles:6,avghumidity:64,daily_will_it_rain:0,daily_chance_of_rain:0,daily_will_it_snow:0,daily_chance_of_snow:0,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},uv:5},astro:{sunrise:"05:39 AM",sunset:"09:56 PM",moonrise:"03:49 PM",moonset:"01:39 AM",moon_phase:"First Quarter",moon_illumination:"63"},hour:[{time_epoch:1657231200,time:"2022-07-08 00:00",temp_c:11.6,temp_f:52.9,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:5.8,wind_kph:9.4,wind_degree:349,wind_dir:"N",pressure_mb:1031,pressure_in:30.44,precip_mm:0,precip_in:0,humidity:86,cloud:4,feelslike_c:10.7,feelslike_f:51.3,windchill_c:10.7,windchill_f:51.3,heatindex_c:11.6,heatindex_f:52.9,dewpoint_c:9.3,dewpoint_f:48.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:11.6,gust_kph:18.7,uv:1},{time_epoch:1657234800,time:"2022-07-08 01:00",temp_c:11.2,temp_f:52.2,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:5.8,wind_kph:9.4,wind_degree:345,wind_dir:"NNW",pressure_mb:1031,pressure_in:30.45,precip_mm:0,precip_in:0,humidity:87,cloud:5,feelslike_c:10.2,feelslike_f:50.4,windchill_c:10.2,windchill_f:50.4,heatindex_c:11.2,heatindex_f:52.2,dewpoint_c:9.1,dewpoint_f:48.4,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:11.9,gust_kph:19.1,uv:1},{time_epoch:1657238400,time:"2022-07-08 02:00",temp_c:10.9,temp_f:51.6,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:5.4,wind_kph:8.6,wind_degree:347,wind_dir:"NNW",pressure_mb:1031,pressure_in:30.45,precip_mm:0,precip_in:0,humidity:88,cloud:5,feelslike_c:9.9,feelslike_f:49.8,windchill_c:9.9,windchill_f:49.8,heatindex_c:10.9,heatindex_f:51.6,dewpoint_c:9,dewpoint_f:48.2,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:11,gust_kph:17.6,uv:1},{time_epoch:1657242e3,time:"2022-07-08 03:00",temp_c:10.8,temp_f:51.4,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:4.5,wind_kph:7.2,wind_degree:356,wind_dir:"N",pressure_mb:1031,pressure_in:30.45,precip_mm:0,precip_in:0,humidity:89,cloud:5,feelslike_c:10.1,feelslike_f:50.2,windchill_c:10.1,windchill_f:50.2,heatindex_c:10.8,heatindex_f:51.4,dewpoint_c:9,dewpoint_f:48.2,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:8.9,gust_kph:14.4,uv:1},{time_epoch:1657245600,time:"2022-07-08 04:00",temp_c:10.4,temp_f:50.7,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:3.4,wind_kph:5.4,wind_degree:7,wind_dir:"N",pressure_mb:1031,pressure_in:30.45,precip_mm:0,precip_in:0,humidity:89,cloud:6,feelslike_c:10.1,feelslike_f:50.2,windchill_c:10.1,windchill_f:50.2,heatindex_c:10.4,heatindex_f:50.7,dewpoint_c:8.7,dewpoint_f:47.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:6.9,gust_kph:11.2,uv:1},{time_epoch:1657249200,time:"2022-07-08 05:00",temp_c:10.1,temp_f:50.2,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:2.2,wind_kph:3.6,wind_degree:5,wind_dir:"N",pressure_mb:1031,pressure_in:30.45,precip_mm:0,precip_in:0,humidity:89,cloud:4,feelslike_c:10.4,feelslike_f:50.7,windchill_c:10.4,windchill_f:50.7,heatindex_c:10.1,heatindex_f:50.2,dewpoint_c:8.4,dewpoint_f:47.1,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:4.7,gust_kph:7.6,uv:1},{time_epoch:1657252800,time:"2022-07-08 06:00",temp_c:11.7,temp_f:53.1,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:2,wind_kph:3.2,wind_degree:352,wind_dir:"N",pressure_mb:1032,pressure_in:30.46,precip_mm:0,precip_in:0,humidity:85,cloud:6,feelslike_c:12.3,feelslike_f:54.1,windchill_c:12.3,windchill_f:54.1,heatindex_c:11.7,heatindex_f:53.1,dewpoint_c:9.3,dewpoint_f:48.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:3.4,gust_kph:5.4,uv:4},{time_epoch:1657256400,time:"2022-07-08 07:00",temp_c:13.6,temp_f:56.5,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:3.6,wind_kph:5.8,wind_degree:1,wind_dir:"N",pressure_mb:1032,pressure_in:30.46,precip_mm:0,precip_in:0,humidity:78,cloud:4,feelslike_c:13.7,feelslike_f:56.7,windchill_c:13.7,windchill_f:56.7,heatindex_c:13.6,heatindex_f:56.5,dewpoint_c:9.8,dewpoint_f:49.6,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:4.7,gust_kph:7.6,uv:4},{time_epoch:165726e4,time:"2022-07-08 08:00",temp_c:15.5,temp_f:59.9,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:4.7,wind_kph:7.6,wind_degree:12,wind_dir:"NNE",pressure_mb:1032,pressure_in:30.47,precip_mm:0,precip_in:0,humidity:70,cloud:5,feelslike_c:15.5,feelslike_f:59.9,windchill_c:15.5,windchill_f:59.9,heatindex_c:15.5,heatindex_f:59.9,dewpoint_c:10.1,dewpoint_f:50.2,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:5.8,gust_kph:9.4,uv:5},{time_epoch:1657263600,time:"2022-07-08 09:00",temp_c:17.3,temp_f:63.1,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:4.9,wind_kph:7.9,wind_degree:10,wind_dir:"N",pressure_mb:1032,pressure_in:30.47,precip_mm:0,precip_in:0,humidity:61,cloud:12,feelslike_c:17.3,feelslike_f:63.1,windchill_c:17.3,windchill_f:63.1,heatindex_c:17.3,heatindex_f:63.1,dewpoint_c:9.8,dewpoint_f:49.6,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:5.6,gust_kph:9,uv:5},{time_epoch:1657267200,time:"2022-07-08 10:00",temp_c:19,temp_f:66.2,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:5.4,wind_kph:8.6,wind_degree:14,wind_dir:"NNE",pressure_mb:1032,pressure_in:30.47,precip_mm:0,precip_in:0,humidity:55,cloud:7,feelslike_c:19,feelslike_f:66.2,windchill_c:19,windchill_f:66.2,heatindex_c:19,heatindex_f:66.2,dewpoint_c:9.6,dewpoint_f:49.3,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:6.3,gust_kph:10.1,uv:5},{time_epoch:1657270800,time:"2022-07-08 11:00",temp_c:21.3,temp_f:70.3,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:5.1,wind_kph:8.3,wind_degree:9,wind_dir:"N",pressure_mb:1031,pressure_in:30.45,precip_mm:0,precip_in:0,humidity:50,cloud:6,feelslike_c:21.3,feelslike_f:70.3,windchill_c:21.3,windchill_f:70.3,heatindex_c:24.3,heatindex_f:75.7,dewpoint_c:10.4,dewpoint_f:50.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:5.8,gust_kph:9.4,uv:6},{time_epoch:1657274400,time:"2022-07-08 12:00",temp_c:22.9,temp_f:73.2,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:5.4,wind_kph:8.6,wind_degree:1,wind_dir:"N",pressure_mb:1031,pressure_in:30.44,precip_mm:0,precip_in:0,humidity:47,cloud:6,feelslike_c:24.6,feelslike_f:76.3,windchill_c:22.9,windchill_f:73.2,heatindex_c:24.6,heatindex_f:76.3,dewpoint_c:11,dewpoint_f:51.8,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:6.3,gust_kph:10.1,uv:6},{time_epoch:1657278e3,time:"2022-07-08 13:00",temp_c:24.1,temp_f:75.4,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:6,wind_kph:9.7,wind_degree:353,wind_dir:"N",pressure_mb:1031,pressure_in:30.43,precip_mm:0,precip_in:0,humidity:45,cloud:6,feelslike_c:25.1,feelslike_f:77.2,windchill_c:24.1,windchill_f:75.4,heatindex_c:25.1,heatindex_f:77.2,dewpoint_c:11.5,dewpoint_f:52.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:6.9,gust_kph:11.2,uv:6},{time_epoch:1657281600,time:"2022-07-08 14:00",temp_c:25.1,temp_f:77.2,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:6.5,wind_kph:10.4,wind_degree:349,wind_dir:"N",pressure_mb:1030,pressure_in:30.42,precip_mm:0,precip_in:0,humidity:43,cloud:6,feelslike_c:25.6,feelslike_f:78.1,windchill_c:25.1,windchill_f:77.2,heatindex_c:25.6,heatindex_f:78.1,dewpoint_c:11.6,dewpoint_f:52.9,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:7.4,gust_kph:11.9,uv:7},{time_epoch:1657285200,time:"2022-07-08 15:00",temp_c:28,temp_f:82.4,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:7.4,wind_kph:11.9,wind_degree:350,wind_dir:"N",pressure_mb:1030,pressure_in:30.41,precip_mm:0,precip_in:0,humidity:42,cloud:4,feelslike_c:28,feelslike_f:82.4,windchill_c:28,windchill_f:82.4,heatindex_c:28,heatindex_f:82.4,dewpoint_c:13.7,dewpoint_f:56.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:8.5,gust_kph:13.7,uv:7},{time_epoch:1657288800,time:"2022-07-08 16:00",temp_c:25.6,temp_f:78.1,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:8.9,wind_kph:14.4,wind_degree:356,wind_dir:"N",pressure_mb:1029,pressure_in:30.4,precip_mm:0,precip_in:0,humidity:41,cloud:5,feelslike_c:25.8,feelslike_f:78.4,windchill_c:25.6,windchill_f:78.1,heatindex_c:25.8,heatindex_f:78.4,dewpoint_c:11.5,dewpoint_f:52.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:10.3,gust_kph:16.6,uv:7},{time_epoch:1657292400,time:"2022-07-08 17:00",temp_c:24.7,temp_f:76.5,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:10.1,wind_kph:16.2,wind_degree:359,wind_dir:"N",pressure_mb:1029,pressure_in:30.39,precip_mm:0,precip_in:0,humidity:43,cloud:3,feelslike_c:25.3,feelslike_f:77.5,windchill_c:24.7,windchill_f:76.5,heatindex_c:25.3,heatindex_f:77.5,dewpoint_c:11.2,dewpoint_f:52.2,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:11.9,gust_kph:19.1,uv:6},{time_epoch:1657296e3,time:"2022-07-08 18:00",temp_c:24,temp_f:75.2,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:9.8,wind_kph:15.8,wind_degree:0,wind_dir:"N",pressure_mb:1029,pressure_in:30.39,precip_mm:0,precip_in:0,humidity:46,cloud:1,feelslike_c:25,feelslike_f:77,windchill_c:24,windchill_f:75.2,heatindex_c:25,heatindex_f:77,dewpoint_c:11.5,dewpoint_f:52.7,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:12.1,gust_kph:19.4,uv:6},{time_epoch:1657299600,time:"2022-07-08 19:00",temp_c:24.1,temp_f:75.4,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:8.3,wind_kph:13.3,wind_degree:2,wind_dir:"N",pressure_mb:1029,pressure_in:30.39,precip_mm:0,precip_in:0,humidity:51,cloud:0,feelslike_c:25.3,feelslike_f:77.5,windchill_c:24.1,windchill_f:75.4,heatindex_c:25.3,heatindex_f:77.5,dewpoint_c:13.4,dewpoint_f:56.1,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:9.6,gust_kph:15.5,uv:6},{time_epoch:1657303200,time:"2022-07-08 20:00",temp_c:20.7,temp_f:69.3,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:7.2,wind_kph:11.5,wind_degree:2,wind_dir:"N",pressure_mb:1029,pressure_in:30.39,precip_mm:0,precip_in:0,humidity:59,cloud:0,feelslike_c:20.7,feelslike_f:69.3,windchill_c:20.7,windchill_f:69.3,heatindex_c:20.7,heatindex_f:69.3,dewpoint_c:12.4,dewpoint_f:54.3,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:11.6,gust_kph:18.7,uv:6},{time_epoch:1657306800,time:"2022-07-08 21:00",temp_c:18.3,temp_f:64.9,is_day:1,condition:{text:"Sunny",icon:"//cdn.weatherapi.com/weather/64x64/day/113.png",code:1e3},wind_mph:6.9,wind_kph:11.2,wind_degree:3,wind_dir:"N",pressure_mb:1029,pressure_in:30.4,precip_mm:0,precip_in:0,humidity:64,cloud:5,feelslike_c:18.3,feelslike_f:64.9,windchill_c:18.3,windchill_f:64.9,heatindex_c:18.3,heatindex_f:64.9,dewpoint_c:11.4,dewpoint_f:52.5,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:13.4,gust_kph:21.6,uv:5},{time_epoch:1657310400,time:"2022-07-08 22:00",temp_c:16.9,temp_f:62.4,is_day:0,condition:{text:"Clear",icon:"//cdn.weatherapi.com/weather/64x64/night/113.png",code:1e3},wind_mph:5.8,wind_kph:9.4,wind_degree:0,wind_dir:"N",pressure_mb:1029,pressure_in:30.39,precip_mm:0,precip_in:0,humidity:68,cloud:15,feelslike_c:16.9,feelslike_f:62.4,windchill_c:16.9,windchill_f:62.4,heatindex_c:16.9,heatindex_f:62.4,dewpoint_c:11,dewpoint_f:51.8,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:11.9,gust_kph:19.1,uv:1},{time_epoch:1657314e3,time:"2022-07-08 23:00",temp_c:16,temp_f:60.8,is_day:0,condition:{text:"Partly cloudy",icon:"//cdn.weatherapi.com/weather/64x64/night/116.png",code:1003},wind_mph:4.7,wind_kph:7.6,wind_degree:356,wind_dir:"N",pressure_mb:1029,pressure_in:30.39,precip_mm:0,precip_in:0,humidity:72,cloud:32,feelslike_c:16,feelslike_f:60.8,windchill_c:16,windchill_f:60.8,heatindex_c:16,heatindex_f:60.8,dewpoint_c:10.9,dewpoint_f:51.6,will_it_rain:0,chance_of_rain:0,will_it_snow:0,chance_of_snow:0,vis_km:10,vis_miles:6,gust_mph:9.8,gust_kph:15.8,uv:1}]}]}};class AT{static getCurrentWeather(){return sl.current}static getForecast(e=0){return e>=sl.forecast.forecastday.length?sl.forecast.forecastday[sl.forecast.forecastday.length-1]:sl.forecast.forecastday[e]}}function Fy(t){let e,n,r=t[0].day.mintemp_c+"",i,o,s=t[0].day.maxtemp_c+"",a,c,l,u,d,g;return{c(){e=Pt("div"),n=Pt("span"),i=mn(r),o=mn("-"),a=mn(s),c=mn("\xB0C"),l=en(),u=Pt("div"),d=Pt("div"),g=mn("\u{1F324}"),this.h()},l(p){e=Nt(p,"DIV",{class:!0});var y=Lt(e);n=Nt(y,"SPAN",{class:!0});var w=Lt(n);i=yn(w,r),o=yn(w,"-"),a=yn(w,s),c=yn(w,"\xB0C"),w.forEach(De),l=tn(y),u=Nt(y,"DIV",{class:!0});var E=Lt(u);d=Nt(E,"DIV",{class:!0});var b=Lt(d);g=yn(b,"\u{1F324}"),b.forEach(De),E.forEach(De),y.forEach(De),this.h()},h(){it(n,"class","text-lg"),it(d,"class","absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2"),it(u,"class","absolute h-6 aspect-square rounded-full bg-blue-700 -right-1 -top-1"),it(e,"class","bg-blue-200 rounded-md min-h-4 p-3 select-none relative")},m(p,y){At(p,e,y),Me(e,n),Me(n,i),Me(n,o),Me(n,a),Me(n,c),Me(e,l),Me(e,u),Me(u,d),Me(d,g)},p(p,y){y&1&&r!==(r=p[0].day.mintemp_c+"")&&ki(i,r),y&1&&s!==(s=p[0].day.maxtemp_c+"")&&ki(a,s)},d(p){p&&De(e)}}}function xT(t){let e,n=t[0]&&Fy(t);return{c(){n&&n.c(),e=Oo()},l(r){n&&n.l(r),e=Oo()},m(r,i){n&&n.m(r,i),At(r,e,i)},p(r,[i]){r[0]?n?n.p(r,i):(n=Fy(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:uo,o:uo,d(r){n&&n.d(r),r&&De(e)}}}function IT(t,e,n){let{day:r}=e,i;return cw(()=>{const s=ua.Now.plainDateISO().until(r).days;n(0,i=AT.getForecast(s))}),t.$$set=o=>{"day"in o&&n(1,r=o.day)},[i,r]}class RT extends ho{constructor(e){super(),po(this,e,IT,xT,go,{day:1})}}function Dy(t,e,n){const r=t.slice();return r[11]=e[n],r}function Cy(t,e,n){const r=t.slice();return r[14]=e[n],r}function Py(t){let e,n;return e=new RT({props:{day:t[11]}}),{c(){Cn(e.$$.fragment)},l(r){Pn(e.$$.fragment,r)},m(r,i){Nn(e,r,i),n=!0},p(r,i){const o={};i&1&&(o.day=r[11]),e.$set(o)},i(r){n||(Le(e.$$.fragment,r),n=!0)},o(r){Je(e.$$.fragment,r),n=!1},d(r){On(e,r)}}}function kT(t){let e,n;return e=new Aa({props:{filled:!0,$$slots:{default:[DT]},$$scope:{ctx:t}}}),e.$on("click",Os.new),{c(){Cn(e.$$.fragment)},l(r){Pn(e.$$.fragment,r)},m(r,i){Nn(e,r,i),n=!0},p(r,i){const o={};i&131072&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(Le(e.$$.fragment,r),n=!0)},o(r){Je(e.$$.fragment,r),n=!1},d(r){On(e,r)}}}function FT(t){let e,n,r=t[1][t[11].toString()],i=[];for(let s=0;s<r.length;s+=1)i[s]=Ny(Cy(t,r,s));const o=s=>Je(i[s],1,1,()=>{i[s]=null});return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=Oo()},l(s){for(let a=0;a<i.length;a+=1)i[a].l(s);e=Oo()},m(s,a){for(let c=0;c<i.length;c+=1)i[c].m(s,a);At(s,e,a),n=!0},p(s,a){if(a&3){r=s[1][s[11].toString()];let c;for(c=0;c<r.length;c+=1){const l=Cy(s,r,c);i[c]?(i[c].p(l,a),Le(i[c],1)):(i[c]=Ny(l),i[c].c(),Le(i[c],1),i[c].m(e.parentNode,e))}for(Po(),c=r.length;c<i.length;c+=1)o(c);No()}},i(s){if(!n){for(let a=0;a<r.length;a+=1)Le(i[a]);n=!0}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)Je(i[a]);n=!1},d(s){Cg(i,s),s&&De(e)}}}function DT(t){let e;return{c(){e=mn("Create event")},l(n){e=yn(n,"Create event")},m(n,r){At(n,e,r)},d(n){n&&De(e)}}}function Ny(t){let e,n;function r(){return t[6](t[14])}return e=new lT({props:{event:t[14]}}),e.$on("click",r),{c(){Cn(e.$$.fragment)},l(i){Pn(e.$$.fragment,i)},m(i,o){Nn(e,i,o),n=!0},p(i,o){t=i;const s={};o&3&&(s.event=t[14]),e.$set(s)},i(i){n||(Le(e.$$.fragment,i),n=!0)},o(i){Je(e.$$.fragment,i),n=!1},d(i){On(e,i)}}}function Oy(t){let e,n,r,i=t[4][t[11].dayOfWeek-1]+"",o,s,a=vy.DateTimeFormat("gb-GB").format(t[11])+"",c,l,u,d=t[11].until(t[3]).days<=0,g,p,y,w,E,b,S=d&&Py(t);const R=[FT,kT],F=[];function M(P,D){return D&3&&(p=null),p==null&&(p=P[11].toString()in P[1]),p?0:1}return y=M(t,-1),w=F[y]=R[y](t),{c(){e=Pt("div"),n=Pt("div"),r=Pt("span"),o=mn(i),s=en(),c=mn(a),l=en(),u=Pt("div"),S&&S.c(),g=en(),w.c(),E=en(),this.h()},l(P){e=Nt(P,"DIV",{class:!0});var D=Lt(e);n=Nt(D,"DIV",{class:!0});var Y=Lt(n);r=Nt(Y,"SPAN",{class:!0});var X=Lt(r);o=yn(X,i),X.forEach(De),s=tn(Y),c=yn(Y,a),Y.forEach(De),l=tn(D),u=Nt(D,"DIV",{class:!0});var $=Lt(u);S&&S.l($),g=tn($),w.l($),$.forEach(De),E=tn(D),D.forEach(De),this.h()},h(){it(r,"class","font-lg"),it(n,"class","py-2 svelte-9qm4p1"),In(n,"today",t[11].equals(t[3])),it(u,"class","flex flex-col gap-4 my-4"),it(e,"class","grow max-w-xs")},m(P,D){At(P,e,D),Me(e,n),Me(n,r),Me(r,o),Me(n,s),Me(n,c),Me(e,l),Me(e,u),S&&S.m(u,null),Me(u,g),F[y].m(u,null),Me(e,E),b=!0},p(P,D){(!b||D&1)&&i!==(i=P[4][P[11].dayOfWeek-1]+"")&&ki(o,i),(!b||D&1)&&a!==(a=vy.DateTimeFormat("gb-GB").format(P[11])+"")&&ki(c,a),D&9&&In(n,"today",P[11].equals(P[3])),D&1&&(d=P[11].until(P[3]).days<=0),d?S?(S.p(P,D),D&1&&Le(S,1)):(S=Py(P),S.c(),Le(S,1),S.m(u,g)):S&&(Po(),Je(S,1,1,()=>{S=null}),No());let Y=y;y=M(P,D),y===Y?F[y].p(P,D):(Po(),Je(F[Y],1,1,()=>{F[Y]=null}),No(),w=F[y],w?w.p(P,D):(w=F[y]=R[y](P),w.c()),Le(w,1),w.m(u,null))},i(P){b||(Le(S),Le(w),b=!0)},o(P){Je(S),Je(w),b=!1},d(P){P&&De(e),S&&S.d(),F[y].d()}}}function CT(t){let e,n,r,i;e=new Aa({props:{filled:!0,destructive:!0,$$slots:{default:[NT]},$$scope:{ctx:t}}}),e.$on("click",Os.reset);function o(){return t[9](t[10])}return r=new Aa({props:{filled:!0,focused:!0,$$slots:{default:[OT]},$$scope:{ctx:t}}}),r.$on("click",o),{c(){Cn(e.$$.fragment),n=en(),Cn(r.$$.fragment)},l(s){Pn(e.$$.fragment,s),n=tn(s),Pn(r.$$.fragment,s)},m(s,a){Nn(e,s,a),At(s,n,a),Nn(r,s,a),i=!0},p(s,a){t=s;const c={};a&131072&&(c.$$scope={dirty:a,ctx:t}),e.$set(c);const l={};a&131072&&(l.$$scope={dirty:a,ctx:t}),r.$set(l)},i(s){i||(Le(e.$$.fragment,s),Le(r.$$.fragment,s),i=!0)},o(s){Je(e.$$.fragment,s),Je(r.$$.fragment,s),i=!1},d(s){On(e,s),s&&De(n),On(r,s)}}}function PT(t){let e,n,r,i;function o(){return t[7](t[10])}e=new Aa({props:{filled:!0,destructive:!0,$$slots:{default:[MT]},$$scope:{ctx:t}}}),e.$on("click",o);function s(){return t[8](t[10])}return r=new Aa({props:{filled:!0,focused:!0,$$slots:{default:[LT]},$$scope:{ctx:t}}}),r.$on("click",s),{c(){Cn(e.$$.fragment),n=en(),Cn(r.$$.fragment)},l(a){Pn(e.$$.fragment,a),n=tn(a),Pn(r.$$.fragment,a)},m(a,c){Nn(e,a,c),At(a,n,c),Nn(r,a,c),i=!0},p(a,c){t=a;const l={};c&131072&&(l.$$scope={dirty:c,ctx:t}),e.$set(l);const u={};c&131072&&(u.$$scope={dirty:c,ctx:t}),r.$set(u)},i(a){i||(Le(e.$$.fragment,a),Le(r.$$.fragment,a),i=!0)},o(a){Je(e.$$.fragment,a),Je(r.$$.fragment,a),i=!1},d(a){On(e,a),a&&De(n),On(r,a)}}}function NT(t){let e;return{c(){e=mn("Cancel")},l(n){e=yn(n,"Cancel")},m(n,r){At(n,e,r)},d(n){n&&De(e)}}}function OT(t){let e;return{c(){e=mn("Create Event")},l(n){e=yn(n,"Create Event")},m(n,r){At(n,e,r)},d(n){n&&De(e)}}}function MT(t){let e;return{c(){e=mn("Delete Event")},l(n){e=yn(n,"Delete Event")},m(n,r){At(n,e,r)},d(n){n&&De(e)}}}function LT(t){let e;return{c(){e=mn("Update Event")},l(n){e=yn(n,"Update Event")},m(n,r){At(n,e,r)},d(n){n&&De(e)}}}function UT(t){let e,n,r,i;const o=[PT,CT],s=[];function a(c,l){return c[2].editMode?0:1}return e=a(t),n=s[e]=o[e](t),{c(){n.c(),r=Oo()},l(c){n.l(c),r=Oo()},m(c,l){s[e].m(c,l),At(c,r,l),i=!0},p(c,l){let u=e;e=a(c),e===u?s[e].p(c,l):(Po(),Je(s[u],1,1,()=>{s[u]=null}),No(),n=s[e],n?n.p(c,l):(n=s[e]=o[e](c),n.c()),Le(n,1),n.m(r.parentNode,r))},i(c){i||(Le(n),i=!0)},o(c){Je(n),i=!1},d(c){s[e].d(c),c&&De(r)}}}function jT(t){let e,n;return e=new bT({props:{$$slots:{default:[UT,({submit:r})=>({10:r}),({submit:r})=>r?1024:0]},$$scope:{ctx:t}}}),{c(){Cn(e.$$.fragment)},l(r){Pn(e.$$.fragment,r)},m(r,i){Nn(e,r,i),n=!0},p(r,i){const o={};i&132100&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(Le(e.$$.fragment,r),n=!0)},o(r){Je(e.$$.fragment,r),n=!1},d(r){On(e,r)}}}function $T(t){let e,n,r,i,o=t[0],s=[];for(let c=0;c<o.length;c+=1)s[c]=Oy(Dy(t,o,c));const a=c=>Je(s[c],1,1,()=>{s[c]=null});return r=new TT({props:{visible:t[2].visible,$$slots:{default:[jT]},$$scope:{ctx:t}}}),r.$on("close",Os.reset),{c(){e=Pt("div");for(let c=0;c<s.length;c+=1)s[c].c();n=en(),Cn(r.$$.fragment),this.h()},l(c){e=Nt(c,"DIV",{class:!0});var l=Lt(e);for(let u=0;u<s.length;u+=1)s[u].l(l);l.forEach(De),n=tn(c),Pn(r.$$.fragment,c),this.h()},h(){it(e,"class","m-4 flex gap-3 container mx-auto")},m(c,l){At(c,e,l);for(let u=0;u<s.length;u+=1)s[u].m(e,null);At(c,n,l),Nn(r,c,l),i=!0},p(c,[l]){if(l&27){o=c[0];let d;for(d=0;d<o.length;d+=1){const g=Dy(c,o,d);s[d]?(s[d].p(g,l),Le(s[d],1)):(s[d]=Oy(g),s[d].c(),Le(s[d],1),s[d].m(e,null))}for(Po(),d=o.length;d<s.length;d+=1)a(d);No()}const u={};l&4&&(u.visible=c[2].visible),l&131076&&(u.$$scope={dirty:l,ctx:c}),r.$set(u)},i(c){if(!i){for(let l=0;l<o.length;l+=1)Le(s[l]);Le(r.$$.fragment,c),i=!0}},o(c){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)Je(s[l]);Je(r.$$.fragment,c),i=!1},d(c){c&&De(e),Cg(s,c),c&&De(n),On(r,c)}}}function BT(t,e,n){let r,i;Ep(t,tT,p=>n(1,r=p)),Ep(t,Os,p=>n(2,i=p));let{startOfWeek:o}=e;const s=ua.Now.plainDateISO(),a=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];let c=[];const l=p=>Os.edit(p),u=p=>p(El.deleteEvent),d=p=>p(El.updateEvent),g=p=>p(El.addEvent);return t.$$set=p=>{"startOfWeek"in p&&n(5,o=p.startOfWeek)},t.$$.update=()=>{t.$$.dirty&32&&o&&n(0,c=a.map((p,y)=>o.add({days:y})))},[c,r,i,s,a,o,l,u,d,g]}class HT extends ho{constructor(e){super(),po(this,e,BT,$T,go,{startOfWeek:5})}}function KT(t){let e,n,r=t[0][0]+"",i,o,s=t[1][t[1].length-1][0]+"",a,c,l;return{c(){e=Pt("div"),n=Pt("span"),i=mn(r),o=en(),a=mn(s),this.h()},l(u){e=Nt(u,"DIV",{class:!0});var d=Lt(e);n=Nt(d,"SPAN",{class:!0});var g=Lt(n);i=yn(g,r),o=tn(g),a=yn(g,s),g.forEach(De),d.forEach(De),this.h()},h(){it(n,"class","w-full text-center"),it(e,"class","rounded-full bg-green-600 text-green-100 h-12 w-12 flex items-center cursor-pointer")},m(u,d){At(u,e,d),Me(e,n),Me(n,i),Me(n,o),Me(n,a),c||(l=Co(e,"click",t[3]),c=!0)},p(u,[d]){d&1&&r!==(r=u[0][0]+"")&&ki(i,r),d&2&&s!==(s=u[1][u[1].length-1][0]+"")&&ki(a,s)},i:uo,o:uo,d(u){u&&De(e),c=!1,l()}}}function WT(t,e,n){let r,{firstname:i}=e,{lastname:o}=e;function s(a){ba.call(this,t,a)}return t.$$set=a=>{"firstname"in a&&n(0,i=a.firstname),"lastname"in a&&n(2,o=a.lastname)},t.$$.update=()=>{t.$$.dirty&4&&n(1,r=o.split(" "))},[i,r,o,s]}class qT extends ho{constructor(e){super(),po(this,e,WT,KT,go,{firstname:0,lastname:2})}}const VT=t=>({}),My=t=>({});function Ly(t){let e;const n=t[3].icon,r=Oa(n,t,t[2],My);return{c(){r&&r.c()},l(i){r&&r.l(i)},m(i,o){r&&r.m(i,o),e=!0},p(i,o){r&&r.p&&(!e||o&4)&&Ca(r,n,i,i[2],e?Na(n,i[2],o,VT):Pa(i[2]),My)},i(i){e||(Le(r,i),e=!0)},o(i){Je(r,i),e=!1},d(i){r&&r.d(i)}}}function zT(t){let e,n,r,i,o,s=t[1].icon&&Ly(t);const a=t[3].default,c=Oa(a,t,t[2],null);return{c(){e=Pt("div"),s&&s.c(),n=en(),c&&c.c(),this.h()},l(l){e=Nt(l,"DIV",{class:!0});var u=Lt(e);s&&s.l(u),n=tn(u),c&&c.l(u),u.forEach(De),this.h()},h(){it(e,"class","rounded-full p-2 h-min flex gap-4 items-center cursor-pointer svelte-k6w3fr"),In(e,"filled",t[0])},m(l,u){At(l,e,u),s&&s.m(e,null),Me(e,n),c&&c.m(e,null),r=!0,i||(o=Co(e,"click",t[4]),i=!0)},p(l,[u]){l[1].icon?s?(s.p(l,u),u&2&&Le(s,1)):(s=Ly(l),s.c(),Le(s,1),s.m(e,n)):s&&(Po(),Je(s,1,1,()=>{s=null}),No()),c&&c.p&&(!r||u&4)&&Ca(c,a,l,l[2],r?Na(a,l[2],u,null):Pa(l[2]),null),u&1&&In(e,"filled",l[0])},i(l){r||(Le(s),Le(c,l),r=!0)},o(l){Je(s),Je(c,l),r=!1},d(l){l&&De(e),s&&s.d(),c&&c.d(l),i=!1,o()}}}function GT(t,e,n){let{$$slots:r={},$$scope:i}=e;const o=Pg(r);let{filled:s=!1}=e;function a(c){ba.call(this,t,c)}return t.$$set=c=>{"filled"in c&&n(0,s=c.filled),"$$scope"in c&&n(2,i=c.$$scope)},[s,o,i,r,a]}class Uy extends ho{constructor(e){super(),po(this,e,GT,zT,go,{filled:0})}}var Vt=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function YT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function lf(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}),e}var ia={},xa={},su={exports:{}},uc=typeof Reflect=="object"?Reflect:null,jy=uc&&typeof uc.apply=="function"?uc.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},rd;uc&&typeof uc.ownKeys=="function"?rd=uc.ownKeys:Object.getOwnPropertySymbols?rd=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:rd=function(e){return Object.getOwnPropertyNames(e)};function JT(t){console&&console.warn&&console.warn(t)}var mv=Number.isNaN||function(e){return e!==e};function Gt(){Gt.init.call(this)}su.exports=Gt;su.exports.once=eA;Gt.EventEmitter=Gt;Gt.prototype._events=void 0;Gt.prototype._eventsCount=0;Gt.prototype._maxListeners=void 0;var $y=10;function uf(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Gt,"defaultMaxListeners",{enumerable:!0,get:function(){return $y},set:function(t){if(typeof t!="number"||t<0||mv(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");$y=t}});Gt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Gt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||mv(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function yv(t){return t._maxListeners===void 0?Gt.defaultMaxListeners:t._maxListeners}Gt.prototype.getMaxListeners=function(){return yv(this)};Gt.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(n.length>0&&(s=n[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(c===void 0)return!1;if(typeof c=="function")jy(c,this,n);else for(var l=c.length,u=Ev(c,l),r=0;r<l;++r)jy(u[r],this,n);return!0};function _v(t,e,n,r){var i,o,s;if(uf(n),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),s===void 0)s=o[e]=n,++t._eventsCount;else if(typeof s=="function"?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),i=yv(t),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,JT(a)}return t}Gt.prototype.addListener=function(e,n){return _v(this,e,n,!1)};Gt.prototype.on=Gt.prototype.addListener;Gt.prototype.prependListener=function(e,n){return _v(this,e,n,!0)};function ZT(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function wv(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=ZT.bind(r);return i.listener=n,r.wrapFn=i,i}Gt.prototype.once=function(e,n){return uf(n),this.on(e,wv(this,e,n)),this};Gt.prototype.prependOnceListener=function(e,n){return uf(n),this.prependListener(e,wv(this,e,n)),this};Gt.prototype.removeListener=function(e,n){var r,i,o,s,a;if(uf(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===n||r[s].listener===n){a=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():QT(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};Gt.prototype.off=Gt.prototype.removeListener;Gt.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function vv(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?XT(i):Ev(i,i.length)}Gt.prototype.listeners=function(e){return vv(this,e,!0)};Gt.prototype.rawListeners=function(e){return vv(this,e,!1)};Gt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):bv.call(t,e)};Gt.prototype.listenerCount=bv;function bv(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Gt.prototype.eventNames=function(){return this._eventsCount>0?rd(this._events):[]};function Ev(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function QT(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function XT(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function eA(t,e){return new Promise(function(n,r){function i(s){t.removeListener(e,o),r(s)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}Sv(t,e,o,{once:!0}),e!=="error"&&tA(t,i,{once:!0})})}function tA(t,e,n){typeof t.on=="function"&&Sv(t,"error",e,n)}function Sv(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(o){r.once&&t.removeEventListener(e,i),n(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Kt={},_i={};Object.defineProperty(_i,"__esModule",{value:!0});_i.DEFAULT_SCOPES=_i.REFRESH_BEFORE_EXPIRATION_SECONDS=_i.EVENTS=_i.PREFERRED_SIGNING_ALG=_i.SOLID_CLIENT_AUTHN_KEY_PREFIX=void 0;_i.SOLID_CLIENT_AUTHN_KEY_PREFIX="solidClientAuthn:";_i.PREFERRED_SIGNING_ALG=["ES256","RS256"];_i.EVENTS={ERROR:"error",LOGIN:"login",LOGOUT:"logout",NEW_REFRESH_TOKEN:"newRefreshToken",SESSION_EXPIRED:"sessionExpired",SESSION_EXTENDED:"sessionExtended",SESSION_RESTORED:"sessionRestore",TIMEOUT_SET:"timeoutSet"};_i.REFRESH_BEFORE_EXPIRATION_SECONDS=5;const nA="openid",rA="offline_access",iA="webid";_i.DEFAULT_SCOPES=[nA,rA,iA].join(" ");var u0={},df={};Object.defineProperty(df,"__esModule",{value:!0});class Xo extends Error{constructor(e,n,r=!0){super(typeof e=="string"?Xo.substituteParams(e,n):Xo.appendErrorIri(Xo.lookupErrorIri(e,n),e,r))}httpResponse(e,n=!0){return this.message=Xo.appendHttpResponseDetails(this.message,e,n),this.httpErrorResponse=e,this}hasHttpResponse(){return this.httpErrorResponse!==void 0}getHttpResponse(){return this.httpErrorResponse}getHttpStatusCode(){if(this.httpErrorResponse===void 0)throw new Xo("This InruptError was not provided with a HTTP response - so we can't get its HTTP Status Code.");return this.httpErrorResponse.status}getHttpStatusText(){if(this.httpErrorResponse===void 0)throw new Xo("This InruptError was not provided with a HTTP response - so we can't get its HTTP Status Text!");return this.httpErrorResponse.statusText}static determineIfVocabTerm(e){return e.strict!==void 0}static lookupErrorIri(e,n){if(Xo.determineIfVocabTerm(e)){const r=n===void 0?e.message:e.messageParams(...n);return r===void 0?`Looked up error message IRI [${e.value}], but found no message value.`:r}return`Error message looked up at: [${e.value}]${n===void 0?"":`, with params [${n.toString()}]`}`}static appendHttpResponseDetails(e,n,r){return r&&typeof n!="undefined"?`${e} HTTP details: status code [${n.status}], status text [${n.statusText}].`:e}static appendErrorIri(e,n,r){return r?`${e} Error IRI: [${n.value}].`:e}static substituteParams(e,n){let r=e;if(n!==void 0){const i=e.split("{{").length-1;if(i!==n.length)throw new Error(`Setting parameters on message [${e}], but it requires [${i}] params and we received [${n.length}].`);for(let o=0;o<n.length;o+=1){const s=`{{${o}}}`;r=r.replace(s,n[o])}}return r}}df.default=Xo;var oA=Vt&&Vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(u0,"__esModule",{value:!0});const sA=oA(df);class aA{constructor(e){this.handleables=e}async getProperHandler(e){const n=await Promise.all(this.handleables.map(r=>r.canHandle(...e)));for(let r=0;r<n.length;r+=1)if(n[r])return this.handleables[r];return null}async canHandle(...e){return await this.getProperHandler(e)!==null}async handle(...e){const n=await this.getProperHandler(e);if(n)return n.handle(...e);throw new sA.default(`[${this.constructor.name}] cannot find a suitable handler for: ${e.map(r=>{try{return JSON.stringify(r)}catch{return r.toString()}}).join(", ")}`)}}u0.default=aA;var Rc={},kc={exports:{}};(function(t,e){var n=typeof self!="undefined"?self:Vt,r=function(){function o(){this.fetch=!1,this.DOMException=n.DOMException}return o.prototype=n,new o}();(function(o){(function(s){var a={searchParams:"URLSearchParams"in o,iterable:"Symbol"in o&&"iterator"in Symbol,blob:"FileReader"in o&&"Blob"in o&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in o,arrayBuffer:"ArrayBuffer"in o};function c(re){return re&&DataView.prototype.isPrototypeOf(re)}if(a.arrayBuffer)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(re){return re&&l.indexOf(Object.prototype.toString.call(re))>-1};function d(re){if(typeof re!="string"&&(re=String(re)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(re))throw new TypeError("Invalid character in header field name");return re.toLowerCase()}function g(re){return typeof re!="string"&&(re=String(re)),re}function p(re){var se={next:function(){var we=re.shift();return{done:we===void 0,value:we}}};return a.iterable&&(se[Symbol.iterator]=function(){return se}),se}function y(re){this.map={},re instanceof y?re.forEach(function(se,we){this.append(we,se)},this):Array.isArray(re)?re.forEach(function(se){this.append(se[0],se[1])},this):re&&Object.getOwnPropertyNames(re).forEach(function(se){this.append(se,re[se])},this)}y.prototype.append=function(re,se){re=d(re),se=g(se);var we=this.map[re];this.map[re]=we?we+", "+se:se},y.prototype.delete=function(re){delete this.map[d(re)]},y.prototype.get=function(re){return re=d(re),this.has(re)?this.map[re]:null},y.prototype.has=function(re){return this.map.hasOwnProperty(d(re))},y.prototype.set=function(re,se){this.map[d(re)]=g(se)},y.prototype.forEach=function(re,se){for(var we in this.map)this.map.hasOwnProperty(we)&&re.call(se,this.map[we],we,this)},y.prototype.keys=function(){var re=[];return this.forEach(function(se,we){re.push(we)}),p(re)},y.prototype.values=function(){var re=[];return this.forEach(function(se){re.push(se)}),p(re)},y.prototype.entries=function(){var re=[];return this.forEach(function(se,we){re.push([we,se])}),p(re)},a.iterable&&(y.prototype[Symbol.iterator]=y.prototype.entries);function w(re){if(re.bodyUsed)return Promise.reject(new TypeError("Already read"));re.bodyUsed=!0}function E(re){return new Promise(function(se,we){re.onload=function(){se(re.result)},re.onerror=function(){we(re.error)}})}function b(re){var se=new FileReader,we=E(se);return se.readAsArrayBuffer(re),we}function S(re){var se=new FileReader,we=E(se);return se.readAsText(re),we}function R(re){for(var se=new Uint8Array(re),we=new Array(se.length),Ce=0;Ce<se.length;Ce++)we[Ce]=String.fromCharCode(se[Ce]);return we.join("")}function F(re){if(re.slice)return re.slice(0);var se=new Uint8Array(re.byteLength);return se.set(new Uint8Array(re)),se.buffer}function M(){return this.bodyUsed=!1,this._initBody=function(re){this._bodyInit=re,re?typeof re=="string"?this._bodyText=re:a.blob&&Blob.prototype.isPrototypeOf(re)?this._bodyBlob=re:a.formData&&FormData.prototype.isPrototypeOf(re)?this._bodyFormData=re:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(re)?this._bodyText=re.toString():a.arrayBuffer&&a.blob&&c(re)?(this._bodyArrayBuffer=F(re.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(re)||u(re))?this._bodyArrayBuffer=F(re):this._bodyText=re=Object.prototype.toString.call(re):this._bodyText="",this.headers.get("content-type")||(typeof re=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(re)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var re=w(this);if(re)return re;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?w(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(b)}),this.text=function(){var re=w(this);if(re)return re;if(this._bodyBlob)return S(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(R(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(X)}),this.json=function(){return this.text().then(JSON.parse)},this}var P=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function D(re){var se=re.toUpperCase();return P.indexOf(se)>-1?se:re}function Y(re,se){se=se||{};var we=se.body;if(re instanceof Y){if(re.bodyUsed)throw new TypeError("Already read");this.url=re.url,this.credentials=re.credentials,se.headers||(this.headers=new y(re.headers)),this.method=re.method,this.mode=re.mode,this.signal=re.signal,!we&&re._bodyInit!=null&&(we=re._bodyInit,re.bodyUsed=!0)}else this.url=String(re);if(this.credentials=se.credentials||this.credentials||"same-origin",(se.headers||!this.headers)&&(this.headers=new y(se.headers)),this.method=D(se.method||this.method||"GET"),this.mode=se.mode||this.mode||null,this.signal=se.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&we)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(we)}Y.prototype.clone=function(){return new Y(this,{body:this._bodyInit})};function X(re){var se=new FormData;return re.trim().split("&").forEach(function(we){if(we){var Ce=we.split("="),Ze=Ce.shift().replace(/\+/g," "),Ee=Ce.join("=").replace(/\+/g," ");se.append(decodeURIComponent(Ze),decodeURIComponent(Ee))}}),se}function $(re){var se=new y,we=re.replace(/\r?\n[\t ]+/g," ");return we.split(/\r?\n/).forEach(function(Ce){var Ze=Ce.split(":"),Ee=Ze.shift().trim();if(Ee){var Ve=Ze.join(":").trim();se.append(Ee,Ve)}}),se}M.call(Y.prototype);function te(re,se){se||(se={}),this.type="default",this.status=se.status===void 0?200:se.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in se?se.statusText:"OK",this.headers=new y(se.headers),this.url=se.url||"",this._initBody(re)}M.call(te.prototype),te.prototype.clone=function(){return new te(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new y(this.headers),url:this.url})},te.error=function(){var re=new te(null,{status:0,statusText:""});return re.type="error",re};var _e=[301,302,303,307,308];te.redirect=function(re,se){if(_e.indexOf(se)===-1)throw new RangeError("Invalid status code");return new te(null,{status:se,headers:{location:re}})},s.DOMException=o.DOMException;try{new s.DOMException}catch{s.DOMException=function(se,we){this.message=se,this.name=we;var Ce=Error(se);this.stack=Ce.stack},s.DOMException.prototype=Object.create(Error.prototype),s.DOMException.prototype.constructor=s.DOMException}function Ae(re,se){return new Promise(function(we,Ce){var Ze=new Y(re,se);if(Ze.signal&&Ze.signal.aborted)return Ce(new s.DOMException("Aborted","AbortError"));var Ee=new XMLHttpRequest;function Ve(){Ee.abort()}Ee.onload=function(){var Ge={status:Ee.status,statusText:Ee.statusText,headers:$(Ee.getAllResponseHeaders()||"")};Ge.url="responseURL"in Ee?Ee.responseURL:Ge.headers.get("X-Request-URL");var tt="response"in Ee?Ee.response:Ee.responseText;we(new te(tt,Ge))},Ee.onerror=function(){Ce(new TypeError("Network request failed"))},Ee.ontimeout=function(){Ce(new TypeError("Network request failed"))},Ee.onabort=function(){Ce(new s.DOMException("Aborted","AbortError"))},Ee.open(Ze.method,Ze.url,!0),Ze.credentials==="include"?Ee.withCredentials=!0:Ze.credentials==="omit"&&(Ee.withCredentials=!1),"responseType"in Ee&&a.blob&&(Ee.responseType="blob"),Ze.headers.forEach(function(Ge,tt){Ee.setRequestHeader(tt,Ge)}),Ze.signal&&(Ze.signal.addEventListener("abort",Ve),Ee.onreadystatechange=function(){Ee.readyState===4&&Ze.signal.removeEventListener("abort",Ve)}),Ee.send(typeof Ze._bodyInit=="undefined"?null:Ze._bodyInit)})}return Ae.polyfill=!0,o.fetch||(o.fetch=Ae,o.Headers=y,o.Request=Y,o.Response=te),s.Headers=y,s.Request=Y,s.Response=te,s.fetch=Ae,Object.defineProperty(s,"__esModule",{value:!0}),s})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;e=i.fetch,e.default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,t.exports=e})(kc,kc.exports);var cA=YT(kc.exports),lA=cS({__proto__:null,default:cA},[kc.exports]),ct=crypto;const Ei=t=>t instanceof CryptoKey,uA=async(t,e)=>{const n=`SHA-${t.slice(-3)}`;return new Uint8Array(await ct.subtle.digest(n,e))};var Tv=uA;const zn=new TextEncoder,Yi=new TextDecoder,Cd=2**32;function Wo(...t){const e=t.reduce((i,{length:o})=>i+o,0),n=new Uint8Array(e);let r=0;return t.forEach(i=>{n.set(i,r),r+=i.length}),n}function dA(t,e){return Wo(zn.encode(t),new Uint8Array([0]),e)}function qp(t,e,n){if(e<0||e>=Cd)throw new RangeError(`value must be >= 0 and <= ${Cd-1}. Received ${e}`);t.set([e>>>24,e>>>16,e>>>8,e&255],n)}function Av(t){const e=Math.floor(t/Cd),n=t%Cd,r=new Uint8Array(8);return qp(r,e,0),qp(r,n,4),r}function d0(t){const e=new Uint8Array(4);return qp(e,t),e}function Ih(t){return Wo(d0(t.length),t)}async function fA(t,e,n){const r=Math.ceil((e>>3)/32),i=new Uint8Array(r*32);for(let o=0;o<r;o++){const s=new Uint8Array(4+t.length+n.length);s.set(d0(o+1)),s.set(t,4),s.set(n,4+t.length),i.set(await Tv("sha256",s),o*32)}return i.slice(0,e>>3)}const f0=t=>{let e=t;typeof e=="string"&&(e=zn.encode(e));const n=32768,r=[];for(let i=0;i<e.length;i+=n)r.push(String.fromCharCode.apply(null,e.subarray(i,i+n)));return btoa(r.join(""))},rr=t=>f0(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),xv=t=>{const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n},mr=t=>{let e=t;e instanceof Uint8Array&&(e=Yi.decode(e)),e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return xv(e)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}};class Hr extends Error{constructor(e){var n;super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,(n=Error.captureStackTrace)===null||n===void 0||n.call(Error,this,this.constructor)}static get code(){return"ERR_JOSE_GENERIC"}}class Ri extends Hr{constructor(e,n="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=n,this.reason=r}static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}}class Vp extends Hr{constructor(e,n="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_EXPIRED",this.claim=n,this.reason=r}static get code(){return"ERR_JWT_EXPIRED"}}class Pd extends Hr{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}}class kt extends Hr{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}}class Bl extends Hr{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}}class ze extends Hr{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}}class Qt extends Hr{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}}class yi extends Hr{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}}class Iv extends Hr{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}}class Nd extends Hr{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}}class h0 extends Hr{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}}class Rv extends Hr{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}}class kv extends Hr{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}}class p0 extends Hr{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}var hA=Object.freeze(Object.defineProperty({__proto__:null,JOSEError:Hr,JWTClaimValidationFailed:Ri,JWTExpired:Vp,JOSEAlgNotAllowed:Pd,JOSENotSupported:kt,JWEDecryptionFailed:Bl,JWEInvalid:ze,JWSInvalid:Qt,JWTInvalid:yi,JWKInvalid:Iv,JWKSInvalid:Nd,JWKSNoMatchingKey:h0,JWKSMultipleMatchingKeys:Rv,JWKSTimeout:kv,JWSSignatureVerificationFailed:p0},Symbol.toStringTag,{value:"Module"})),ff=ct.getRandomValues.bind(ct);function Fv(t){switch(t){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new kt(`Unsupported JWE Algorithm: ${t}`)}}var Dv=t=>ff(new Uint8Array(Fv(t)>>3));const pA=(t,e)=>{if(e.length<<3!==Fv(t))throw new ze("Invalid Initialization Vector length")};var Cv=pA;const gA=(t,e)=>{if(t.length<<3!==e)throw new ze("Invalid Content Encryption Key length")};var Od=gA;const mA=(t,e)=>{if(!(t instanceof Uint8Array))throw new TypeError("First argument must be a buffer");if(!(e instanceof Uint8Array))throw new TypeError("Second argument must be a buffer");if(t.length!==e.length)throw new TypeError("Input buffers must have the same length");const n=t.length;let r=0,i=-1;for(;++i<n;)r|=t[i]^e[i];return r===0};var yA=mA;function Ua(){return typeof WebSocketPair=="function"}function jr(t,e="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${e} must be ${t}`)}function Ro(t,e){return t.name===e}function id(t){return parseInt(t.name.slice(4),10)}function _A(t){switch(t){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function Pv(t,e){if(e.length&&!e.some(n=>t.usages.includes(n))){let n="CryptoKey does not support this operation, its usages must include ";if(e.length>2){const r=e.pop();n+=`one of ${e.join(", ")}, or ${r}.`}else e.length===2?n+=`one of ${e[0]} or ${e[1]}.`:n+=`${e[0]}.`;throw new TypeError(n)}}function wA(t,e,...n){switch(e){case"HS256":case"HS384":case"HS512":{if(!Ro(t.algorithm,"HMAC"))throw jr("HMAC");const r=parseInt(e.slice(2),10);if(id(t.algorithm.hash)!==r)throw jr(`SHA-${r}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!Ro(t.algorithm,"RSASSA-PKCS1-v1_5"))throw jr("RSASSA-PKCS1-v1_5");const r=parseInt(e.slice(2),10);if(id(t.algorithm.hash)!==r)throw jr(`SHA-${r}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!Ro(t.algorithm,"RSA-PSS"))throw jr("RSA-PSS");const r=parseInt(e.slice(2),10);if(id(t.algorithm.hash)!==r)throw jr(`SHA-${r}`,"algorithm.hash");break}case(Ua()&&"EdDSA"):{if(!Ro(t.algorithm,"NODE-ED25519"))throw jr("NODE-ED25519");break}case"ES256":case"ES384":case"ES512":{if(!Ro(t.algorithm,"ECDSA"))throw jr("ECDSA");const r=_A(e);if(t.algorithm.namedCurve!==r)throw jr(r,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}Pv(t,n)}function Ms(t,e,...n){switch(e){case"A128GCM":case"A192GCM":case"A256GCM":{if(!Ro(t.algorithm,"AES-GCM"))throw jr("AES-GCM");const r=parseInt(e.slice(1,4),10);if(t.algorithm.length!==r)throw jr(r,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!Ro(t.algorithm,"AES-KW"))throw jr("AES-KW");const r=parseInt(e.slice(1,4),10);if(t.algorithm.length!==r)throw jr(r,"algorithm.length");break}case"ECDH":if(!Ro(t.algorithm,"ECDH"))throw jr("ECDH");break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!Ro(t.algorithm,"PBKDF2"))throw jr("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!Ro(t.algorithm,"RSA-OAEP"))throw jr("RSA-OAEP");const r=parseInt(e.slice(9),10)||1;if(id(t.algorithm.hash)!==r)throw jr(`SHA-${r}`,"algorithm.hash");break}default:throw new TypeError("CryptoKey does not support this operation")}Pv(t,n)}var Or=(t,...e)=>{let n="Key must be ";if(e.length>2){const r=e.pop();n+=`one of type ${e.join(", ")}, or ${r}.`}else e.length===2?n+=`one of type ${e[0]} or ${e[1]}.`:n+=`of type ${e[0]}.`;return t==null?n+=` Received ${t}`:typeof t=="function"&&t.name?n+=` Received function ${t.name}`:typeof t=="object"&&t!=null&&t.constructor&&t.constructor.name&&(n+=` Received an instance of ${t.constructor.name}`),n},Nv=t=>Ei(t);const jn=["CryptoKey"];async function vA(t,e,n,r,i,o){if(!(e instanceof Uint8Array))throw new TypeError(Or(e,"Uint8Array"));const s=parseInt(t.slice(1,4),10),a=await ct.subtle.importKey("raw",e.subarray(s>>3),"AES-CBC",!1,["decrypt"]),c=await ct.subtle.importKey("raw",e.subarray(0,s>>3),{hash:`SHA-${s<<1}`,name:"HMAC"},!1,["sign"]),l=Wo(o,r,n,Av(o.length<<3)),u=new Uint8Array((await ct.subtle.sign("HMAC",c,l)).slice(0,s>>3));let d;try{d=yA(i,u)}catch{}if(!d)throw new Bl;let g;try{g=new Uint8Array(await ct.subtle.decrypt({iv:r,name:"AES-CBC"},a,n))}catch{}if(!g)throw new Bl;return g}async function bA(t,e,n,r,i,o){let s;e instanceof Uint8Array?s=await ct.subtle.importKey("raw",e,"AES-GCM",!1,["decrypt"]):(Ms(e,t,"decrypt"),s=e);try{return new Uint8Array(await ct.subtle.decrypt({additionalData:o,iv:r,name:"AES-GCM",tagLength:128},s,Wo(n,i)))}catch{throw new Bl}}const EA=async(t,e,n,r,i,o)=>{if(!Ei(e)&&!(e instanceof Uint8Array))throw new TypeError(Or(e,...jn,"Uint8Array"));switch(Cv(t,r),t){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return e instanceof Uint8Array&&Od(e,parseInt(t.slice(-3),10)),vA(t,e,n,r,i,o);case"A128GCM":case"A192GCM":case"A256GCM":return e instanceof Uint8Array&&Od(e,parseInt(t.slice(1,4),10)),bA(t,e,n,r,i,o);default:throw new kt("Unsupported JWE Content Encryption Algorithm")}};var Ov=EA;const SA=async()=>{throw new kt('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `inflateRaw` decrypt option to provide Inflate Raw implementation.')},TA=async()=>{throw new kt('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `deflateRaw` encrypt option to provide Deflate Raw implementation.')},AA=(...t)=>{const e=t.filter(Boolean);if(e.length===0||e.length===1)return!0;let n;for(const r of e){const i=Object.keys(r);if(!n||n.size===0){n=new Set(i);continue}for(const o of i){if(n.has(o))return!1;n.add(o)}}return!0};var au=AA;function xA(t){return typeof t=="object"&&t!==null}function Nr(t){if(!xA(t)||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}const IA=[{hash:"SHA-256",name:"HMAC"},!0,["sign"]];var hf=IA;function Mv(t,e){if(t.algorithm.length!==parseInt(e.slice(1,4),10))throw new TypeError(`Invalid key size for alg: ${e}`)}function Lv(t,e,n){if(Ei(t))return Ms(t,e,n),t;if(t instanceof Uint8Array)return ct.subtle.importKey("raw",t,"AES-KW",!0,[n]);throw new TypeError(Or(t,...jn,"Uint8Array"))}const zp=async(t,e,n)=>{const r=await Lv(e,t,"wrapKey");Mv(r,t);const i=await ct.subtle.importKey("raw",n,...hf);return new Uint8Array(await ct.subtle.wrapKey("raw",i,r,"AES-KW"))},Gp=async(t,e,n)=>{const r=await Lv(e,t,"unwrapKey");Mv(r,t);const i=await ct.subtle.unwrapKey("raw",n,r,"AES-KW",...hf);return new Uint8Array(await ct.subtle.exportKey("raw",i))};async function Uv(t,e,n,r,i=new Uint8Array(0),o=new Uint8Array(0)){if(!Ei(t))throw new TypeError(Or(t,...jn));if(Ms(t,"ECDH"),!Ei(e))throw new TypeError(Or(e,...jn));Ms(e,"ECDH","deriveBits");const s=Wo(Ih(zn.encode(n)),Ih(i),Ih(o),d0(r)),a=new Uint8Array(await ct.subtle.deriveBits({name:"ECDH",public:t},e,Math.ceil(parseInt(e.algorithm.namedCurve.slice(-3),10)/8)<<3));return fA(a,r,s)}async function RA(t){if(!Ei(t))throw new TypeError(Or(t,...jn));return ct.subtle.generateKey(t.algorithm,!0,["deriveBits"])}function jv(t){if(!Ei(t))throw new TypeError(Or(t,...jn));return["P-256","P-384","P-521"].includes(t.algorithm.namedCurve)}function kA(t){if(!(t instanceof Uint8Array)||t.length<8)throw new ze("PBES2 Salt Input must be 8 or more octets")}function FA(t,e){if(t instanceof Uint8Array)return ct.subtle.importKey("raw",t,"PBKDF2",!1,["deriveBits"]);if(Ei(t))return Ms(t,e,"deriveBits","deriveKey"),t;throw new TypeError(Or(t,...jn,"Uint8Array"))}async function $v(t,e,n,r){kA(t);const i=dA(e,t),o=parseInt(e.slice(13,16),10),s={hash:`SHA-${e.slice(8,11)}`,iterations:n,name:"PBKDF2",salt:i},a={length:o,name:"AES-KW"},c=await FA(r,e);if(c.usages.includes("deriveBits"))return new Uint8Array(await ct.subtle.deriveBits(s,c,o));if(c.usages.includes("deriveKey"))return ct.subtle.deriveKey(s,c,a,!1,["wrapKey","unwrapKey"]);throw new TypeError('PBKDF2 key "usages" must include "deriveBits" or "deriveKey"')}const DA=async(t,e,n,r=2048,i=ff(new Uint8Array(16)))=>{const o=await $v(i,t,r,e);return{encryptedKey:await zp(t.slice(-6),o,n),p2c:r,p2s:rr(i)}},CA=async(t,e,n,r,i)=>{const o=await $v(i,t,r,e);return Gp(t.slice(-6),o,n)};function Md(t){switch(t){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new kt(`alg ${t} is not supported either by JOSE or your javascript runtime`)}}var pf=(t,e)=>{if(t.startsWith("RS")||t.startsWith("PS")){const{modulusLength:n}=e.algorithm;if(typeof n!="number"||n<2048)throw new TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)}};const PA=async(t,e,n)=>{if(!Ei(e))throw new TypeError(Or(e,...jn));if(Ms(e,t,"encrypt","wrapKey"),pf(t,e),e.usages.includes("encrypt"))return new Uint8Array(await ct.subtle.encrypt(Md(t),e,n));if(e.usages.includes("wrapKey")){const r=await ct.subtle.importKey("raw",n,...hf);return new Uint8Array(await ct.subtle.wrapKey("raw",r,e,Md(t)))}throw new TypeError('RSA-OAEP key "usages" must include "encrypt" or "wrapKey" for this operation')},NA=async(t,e,n)=>{if(!Ei(e))throw new TypeError(Or(e,...jn));if(Ms(e,t,"decrypt","unwrapKey"),pf(t,e),e.usages.includes("decrypt"))return new Uint8Array(await ct.subtle.decrypt(Md(t),e,n));if(e.usages.includes("unwrapKey")){const r=await ct.subtle.unwrapKey("raw",n,e,Md(t),...hf);return new Uint8Array(await ct.subtle.exportKey("raw",r))}throw new TypeError('RSA-OAEP key "usages" must include "decrypt" or "unwrapKey" for this operation')};function g0(t){switch(t){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new kt(`Unsupported JWE Algorithm: ${t}`)}}var aa=t=>ff(new Uint8Array(g0(t)>>3)),Bv=(t,e)=>{const n=(t.match(/.{1,64}/g)||[]).join(`
`);return`-----BEGIN ${e}-----
${n}
-----END ${e}-----`};const Hv=async(t,e,n)=>{if(!Ei(n))throw new TypeError(Or(n,...jn));if(!n.extractable)throw new TypeError("CryptoKey is not extractable");if(n.type!==t)throw new TypeError(`key is not a ${t} key`);return Bv(f0(new Uint8Array(await ct.subtle.exportKey(e,n))),`${t.toUpperCase()} KEY`)},OA=t=>Hv("public","spki",t),MA=t=>Hv("private","pkcs8",t),gl=(t,e,n=0)=>{n===0&&(e.unshift(e.length),e.unshift(6));let r=t.indexOf(e[0],n);if(r===-1)return!1;const i=t.subarray(r,r+e.length);return i.length!==e.length?!1:i.every((o,s)=>o===e[s])||gl(t,e,r+1)},By=t=>{switch(!0){case gl(t,[42,134,72,206,61,3,1,7]):return"P-256";case gl(t,[43,129,4,0,34]):return"P-384";case gl(t,[43,129,4,0,35]):return"P-521";case(Ua()&&gl(t,[43,101,112])):return"Ed25519";default:throw new kt("Invalid or unsupported EC Key Curve or OKP Key Sub Type")}},Kv=async(t,e,n,r,i)=>{var o;let s,a;const c=new Uint8Array(atob(n.replace(t,"")).split("").map(u=>u.charCodeAt(0))),l=e==="spki";switch(r){case"PS256":case"PS384":case"PS512":s={name:"RSA-PSS",hash:`SHA-${r.slice(-3)}`},a=l?["verify"]:["sign"];break;case"RS256":case"RS384":case"RS512":s={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${r.slice(-3)}`},a=l?["verify"]:["sign"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":s={name:"RSA-OAEP",hash:`SHA-${parseInt(r.slice(-3),10)||1}`},a=l?["encrypt","wrapKey"]:["decrypt","unwrapKey"];break;case"ES256":s={name:"ECDSA",namedCurve:"P-256"},a=l?["verify"]:["sign"];break;case"ES384":s={name:"ECDSA",namedCurve:"P-384"},a=l?["verify"]:["sign"];break;case"ES512":s={name:"ECDSA",namedCurve:"P-521"},a=l?["verify"]:["sign"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":s={name:"ECDH",namedCurve:By(c)},a=l?[]:["deriveBits"];break;case(Ua()&&"EdDSA"):const u=By(c).toUpperCase();s={name:`NODE-${u}`,namedCurve:`NODE-${u}`},a=l?["verify"]:["sign"];break;default:throw new kt('Invalid or unsupported "alg" (Algorithm) value')}return ct.subtle.importKey(e,c,s,(o=i==null?void 0:i.extractable)!==null&&o!==void 0?o:!1,a)},LA=(t,e,n)=>Kv(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,"pkcs8",t,e,n),Wv=(t,e,n)=>Kv(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,"spki",t,e,n);function UA(t){let e,n;switch(t.kty){case"oct":{switch(t.alg){case"HS256":case"HS384":case"HS512":e={name:"HMAC",hash:`SHA-${t.alg.slice(-3)}`},n=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":throw new kt(`${t.alg} keys cannot be imported as CryptoKey instances`);case"A128GCM":case"A192GCM":case"A256GCM":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":e={name:"AES-GCM"},n=["encrypt","decrypt"];break;case"A128KW":case"A192KW":case"A256KW":e={name:"AES-KW"},n=["wrapKey","unwrapKey"];break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":e={name:"PBKDF2"},n=["deriveBits"];break;default:throw new kt('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"RSA":{switch(t.alg){case"PS256":case"PS384":case"PS512":e={name:"RSA-PSS",hash:`SHA-${t.alg.slice(-3)}`},n=t.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":e={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${t.alg.slice(-3)}`},n=t.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":e={name:"RSA-OAEP",hash:`SHA-${parseInt(t.alg.slice(-3),10)||1}`},n=t.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new kt('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(t.alg){case"ES256":e={name:"ECDSA",namedCurve:"P-256"},n=t.d?["sign"]:["verify"];break;case"ES384":e={name:"ECDSA",namedCurve:"P-384"},n=t.d?["sign"]:["verify"];break;case"ES512":e={name:"ECDSA",namedCurve:"P-521"},n=t.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":e={name:"ECDH",namedCurve:t.crv},n=t.d?["deriveBits"]:[];break;default:throw new kt('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case(Ua()&&"OKP"):if(t.alg!=="EdDSA")throw new kt('Invalid or unsupported JWK "alg" (Algorithm) Parameter value');switch(t.crv){case"Ed25519":e={name:"NODE-ED25519",namedCurve:"NODE-ED25519"},n=t.d?["sign"]:["verify"];break;default:throw new kt('Invalid or unsupported JWK "crv" (Subtype of Key Pair) Parameter value')}break;default:throw new kt('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:e,keyUsages:n}}const jA=async t=>{var e,n;const{algorithm:r,keyUsages:i}=UA(t),o=[r,(e=t.ext)!==null&&e!==void 0?e:!1,(n=t.key_ops)!==null&&n!==void 0?n:i];if(r.name==="PBKDF2")return ct.subtle.importKey("raw",mr(t.k),...o);const s={...t};return delete s.alg,ct.subtle.importKey("jwk",s,...o)};var Hy=jA;function Ky(t){let e=[],n=0;for(;n<t.length;){let r=qv(t.subarray(n));e.push(r),n+=r.byteLength}return e}function qv(t){let e=0,n=t[0]&31;if(e++,n===31){for(n=0;t[e]>=128;)n=n*128+t[e]-128,e++;n=n*128+t[e]-128,e++}let r=0;if(t[e]<128)r=t[e],e++;else{let o=t[e]&127;e++,r=0;for(let s=0;s<o;s++)r=r*256+t[e],e++}if(r===128){for(r=0;t[e+r]!==0||t[e+r+1]!==0;)r++;const o=e+r+2;return{byteLength:o,contents:t.subarray(e,e+r),raw:t.subarray(0,o)}}const i=e+r;return{byteLength:i,contents:t.subarray(e,i),raw:t.subarray(0,i)}}function $A(t){const e=Ky(Ky(qv(t).contents)[0].contents);return f0(e[e[0].raw[0]===160?6:5].raw)}function BA(t){const e=t.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g,""),n=xv(e);return Bv($A(n),"PUBLIC KEY")}async function HA(t,e,n){if(typeof t!="string"||t.indexOf("-----BEGIN PUBLIC KEY-----")!==0)throw new TypeError('"spki" must be SPKI formatted string');return Wv(t,e,n)}async function KA(t,e,n){if(typeof t!="string"||t.indexOf("-----BEGIN CERTIFICATE-----")!==0)throw new TypeError('"x509" must be X.509 formatted string');const r=BA(t);return Wv(r,e,n)}async function WA(t,e,n){if(typeof t!="string"||t.indexOf("-----BEGIN PRIVATE KEY-----")!==0)throw new TypeError('"pkcs8" must be PCKS8 formatted string');return LA(t,e,n)}async function gf(t,e,n){if(!Nr(t))throw new TypeError("JWK must be an object");if(e||(e=t.alg),typeof e!="string"||!e)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');switch(t.kty){case"oct":if(typeof t.k!="string"||!t.k)throw new TypeError('missing "k" (Key Value) Parameter value');return n!=null||(n=t.ext!==!0),n?Hy({...t,alg:e,ext:!1}):mr(t.k);case"RSA":if(t.oth!==void 0)throw new kt('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return Hy({...t,alg:e});default:throw new kt('Unsupported "kty" (Key Type) Parameter value')}}const qA=t=>{if(!(t instanceof Uint8Array)){if(!Nv(t))throw new TypeError(Or(t,...jn,"Uint8Array"));if(t.type!=="secret")throw new TypeError(`${jn.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}},VA=(t,e)=>{if(!Nv(t))throw new TypeError(Or(t,...jn));if(t.type==="secret")throw new TypeError(`${jn.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if(e==="sign"&&t.type==="public")throw new TypeError(`${jn.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if(e==="decrypt"&&t.type==="public")throw new TypeError(`${jn.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&e==="verify"&&t.type==="private")throw new TypeError(`${jn.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&e==="encrypt"&&t.type==="private")throw new TypeError(`${jn.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)},zA=(t,e,n)=>{t.startsWith("HS")||t==="dir"||t.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(t)?qA(e):VA(e,n)};var mf=zA;async function GA(t,e,n,r,i){if(!(n instanceof Uint8Array))throw new TypeError(Or(n,"Uint8Array"));const o=parseInt(t.slice(1,4),10),s=await ct.subtle.importKey("raw",n.subarray(o>>3),"AES-CBC",!1,["encrypt"]),a=await ct.subtle.importKey("raw",n.subarray(0,o>>3),{hash:`SHA-${o<<1}`,name:"HMAC"},!1,["sign"]),c=new Uint8Array(await ct.subtle.encrypt({iv:r,name:"AES-CBC"},s,e)),l=Wo(i,r,c,Av(i.length<<3)),u=new Uint8Array((await ct.subtle.sign("HMAC",a,l)).slice(0,o>>3));return{ciphertext:c,tag:u}}async function YA(t,e,n,r,i){let o;n instanceof Uint8Array?o=await ct.subtle.importKey("raw",n,"AES-GCM",!1,["encrypt"]):(Ms(n,t,"encrypt"),o=n);const s=new Uint8Array(await ct.subtle.encrypt({additionalData:i,iv:r,name:"AES-GCM",tagLength:128},o,e)),a=s.slice(-16);return{ciphertext:s.slice(0,-16),tag:a}}const JA=async(t,e,n,r,i)=>{if(!Ei(n)&&!(n instanceof Uint8Array))throw new TypeError(Or(n,...jn,"Uint8Array"));switch(Cv(t,r),t){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return n instanceof Uint8Array&&Od(n,parseInt(t.slice(-3),10)),GA(t,e,n,r,i);case"A128GCM":case"A192GCM":case"A256GCM":return n instanceof Uint8Array&&Od(n,parseInt(t.slice(1,4),10)),YA(t,e,n,r,i);default:throw new kt("Unsupported JWE Content Encryption Algorithm")}};var Yp=JA;async function ZA(t,e,n,r){const i=t.slice(0,7);r||(r=Dv(i));const{ciphertext:o,tag:s}=await Yp(i,n,e,r,new Uint8Array(0));return{encryptedKey:o,iv:rr(r),tag:rr(s)}}async function QA(t,e,n,r,i){const o=t.slice(0,7);return Ov(o,e,n,r,i,new Uint8Array(0))}async function XA(t,e,n,r){switch(mf(t,e,"decrypt"),t){case"dir":{if(n!==void 0)throw new ze("Encountered unexpected JWE Encrypted Key");return e}case"ECDH-ES":if(n!==void 0)throw new ze("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!Nr(r.epk))throw new ze('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!jv(e))throw new kt("ECDH with the provided key is not allowed or not supported by your javascript runtime");const i=await gf(r.epk,t);let o,s;if(r.apu!==void 0){if(typeof r.apu!="string")throw new ze('JOSE Header "apu" (Agreement PartyUInfo) invalid');o=mr(r.apu)}if(r.apv!==void 0){if(typeof r.apv!="string")throw new ze('JOSE Header "apv" (Agreement PartyVInfo) invalid');s=mr(r.apv)}const a=await Uv(i,e,t==="ECDH-ES"?r.enc:t,t==="ECDH-ES"?g0(r.enc):parseInt(t.slice(-5,-2),10),o,s);if(t==="ECDH-ES")return a;if(n===void 0)throw new ze("JWE Encrypted Key missing");return Gp(t.slice(-6),a,n)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(n===void 0)throw new ze("JWE Encrypted Key missing");return NA(t,e,n)}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(n===void 0)throw new ze("JWE Encrypted Key missing");if(typeof r.p2c!="number")throw new ze('JOSE Header "p2c" (PBES2 Count) missing or invalid');if(typeof r.p2s!="string")throw new ze('JOSE Header "p2s" (PBES2 Salt) missing or invalid');return CA(t,e,n,r.p2c,mr(r.p2s))}case"A128KW":case"A192KW":case"A256KW":{if(n===void 0)throw new ze("JWE Encrypted Key missing");return Gp(t,e,n)}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{if(n===void 0)throw new ze("JWE Encrypted Key missing");if(typeof r.iv!="string")throw new ze('JOSE Header "iv" (Initialization Vector) missing or invalid');if(typeof r.tag!="string")throw new ze('JOSE Header "tag" (Authentication Tag) missing or invalid');const i=mr(r.iv),o=mr(r.tag);return QA(t,e,n,i,o)}default:throw new kt('Invalid or unsupported "alg" (JWE Algorithm) header value')}}function cu(t,e,n,r,i){if(i.crit!==void 0&&r.crit===void 0)throw new t('"crit" (Critical) Header Parameter MUST be integrity protected');if(!r||r.crit===void 0)return new Set;if(!Array.isArray(r.crit)||r.crit.length===0||r.crit.some(s=>typeof s!="string"||s.length===0))throw new t('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let o;n!==void 0?o=new Map([...Object.entries(n),...e.entries()]):o=e;for(const s of r.crit){if(!o.has(s))throw new kt(`Extension Header Parameter "${s}" is not recognized`);if(i[s]===void 0)throw new t(`Extension Header Parameter "${s}" is missing`);if(o.get(s)&&r[s]===void 0)throw new t(`Extension Header Parameter "${s}" MUST be integrity protected`)}return new Set(r.crit)}const ex=(t,e)=>{if(e!==void 0&&(!Array.isArray(e)||e.some(n=>typeof n!="string")))throw new TypeError(`"${t}" option must be an array of strings`);if(!!e)return new Set(e)};var Jp=ex;async function m0(t,e,n){var r;if(!Nr(t))throw new ze("Flattened JWE must be an object");if(t.protected===void 0&&t.header===void 0&&t.unprotected===void 0)throw new ze("JOSE Header missing");if(typeof t.iv!="string")throw new ze("JWE Initialization Vector missing or incorrect type");if(typeof t.ciphertext!="string")throw new ze("JWE Ciphertext missing or incorrect type");if(typeof t.tag!="string")throw new ze("JWE Authentication Tag missing or incorrect type");if(t.protected!==void 0&&typeof t.protected!="string")throw new ze("JWE Protected Header incorrect type");if(t.encrypted_key!==void 0&&typeof t.encrypted_key!="string")throw new ze("JWE Encrypted Key incorrect type");if(t.aad!==void 0&&typeof t.aad!="string")throw new ze("JWE AAD incorrect type");if(t.header!==void 0&&!Nr(t.header))throw new ze("JWE Shared Unprotected Header incorrect type");if(t.unprotected!==void 0&&!Nr(t.unprotected))throw new ze("JWE Per-Recipient Unprotected Header incorrect type");let i;if(t.protected){const R=mr(t.protected);try{i=JSON.parse(Yi.decode(R))}catch{throw new ze("JWE Protected Header is invalid")}}if(!au(i,t.header,t.unprotected))throw new ze("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");const o={...i,...t.header,...t.unprotected};if(cu(ze,new Map,n==null?void 0:n.crit,i,o),o.zip!==void 0){if(!i||!i.zip)throw new ze('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if(o.zip!=="DEF")throw new kt('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}const{alg:s,enc:a}=o;if(typeof s!="string"||!s)throw new ze("missing JWE Algorithm (alg) in JWE Header");if(typeof a!="string"||!a)throw new ze("missing JWE Encryption Algorithm (enc) in JWE Header");const c=n&&Jp("keyManagementAlgorithms",n.keyManagementAlgorithms),l=n&&Jp("contentEncryptionAlgorithms",n.contentEncryptionAlgorithms);if(c&&!c.has(s))throw new Pd('"alg" (Algorithm) Header Parameter not allowed');if(l&&!l.has(a))throw new Pd('"enc" (Encryption Algorithm) Header Parameter not allowed');let u;t.encrypted_key!==void 0&&(u=mr(t.encrypted_key));let d=!1;typeof e=="function"&&(e=await e(i,t),d=!0);let g;try{g=await XA(s,e,u,o)}catch(R){if(R instanceof TypeError)throw R;g=aa(a)}const p=mr(t.iv),y=mr(t.tag),w=zn.encode((r=t.protected)!==null&&r!==void 0?r:"");let E;t.aad!==void 0?E=Wo(w,zn.encode("."),zn.encode(t.aad)):E=w;let b=await Ov(a,g,mr(t.ciphertext),p,y,E);o.zip==="DEF"&&(b=await((n==null?void 0:n.inflateRaw)||SA)(b));const S={plaintext:b};return t.protected!==void 0&&(S.protectedHeader=i),t.aad!==void 0&&(S.additionalAuthenticatedData=mr(t.aad)),t.unprotected!==void 0&&(S.sharedUnprotectedHeader=t.unprotected),t.header!==void 0&&(S.unprotectedHeader=t.header),d?{...S,key:e}:S}async function Vv(t,e,n){if(t instanceof Uint8Array&&(t=Yi.decode(t)),typeof t!="string")throw new ze("Compact JWE must be a string or Uint8Array");const{0:r,1:i,2:o,3:s,4:a,length:c}=t.split(".");if(c!==5)throw new ze("Invalid Compact JWE");const l=await m0({ciphertext:s,iv:o||void 0,protected:r||void 0,tag:a||void 0,encrypted_key:i||void 0},e,n),u={plaintext:l.plaintext,protectedHeader:l.protectedHeader};return typeof e=="function"?{...u,key:l.key}:u}async function tx(t,e,n){if(!Nr(t))throw new ze("General JWE must be an object");if(!Array.isArray(t.recipients)||!t.recipients.every(Nr))throw new ze("JWE Recipients missing or incorrect type");if(!t.recipients.length)throw new ze("JWE Recipients has no members");for(const r of t.recipients)try{return await m0({aad:t.aad,ciphertext:t.ciphertext,encrypted_key:r.encrypted_key,header:r.header,iv:t.iv,protected:t.protected,tag:t.tag,unprotected:t.unprotected},e,n)}catch{}throw new Bl}const nx=async t=>{if(t instanceof Uint8Array)return{kty:"oct",k:rr(t)};if(!Ei(t))throw new TypeError(Or(t,...jn,"Uint8Array"));if(!t.extractable)throw new TypeError("non-extractable CryptoKey cannot be exported as a JWK");const{ext:e,key_ops:n,alg:r,use:i,...o}=await ct.subtle.exportKey("jwk",t);return o};var rx=nx;async function ix(t){return OA(t)}async function ox(t){return MA(t)}async function zv(t){return rx(t)}async function Gv(t,e,n,r,i={}){let o,s,a;switch(mf(t,n,"encrypt"),t){case"dir":{a=n;break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!jv(n))throw new kt("ECDH with the provided key is not allowed or not supported by your javascript runtime");const{apu:c,apv:l}=i;let{epk:u}=i;u||(u=(await RA(n)).privateKey);const{x:d,y:g,crv:p,kty:y}=await zv(u),w=await Uv(n,u,t==="ECDH-ES"?e:t,t==="ECDH-ES"?g0(e):parseInt(t.slice(-5,-2),10),c,l);if(s={epk:{x:d,crv:p,kty:y}},y==="EC"&&(s.epk.y=g),c&&(s.apu=rr(c)),l&&(s.apv=rr(l)),t==="ECDH-ES"){a=w;break}a=r||aa(e);const E=t.slice(-6);o=await zp(E,w,a);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{a=r||aa(e),o=await PA(t,n,a);break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{a=r||aa(e);const{p2c:c,p2s:l}=i;({encryptedKey:o,...s}=await DA(t,n,a,c,l));break}case"A128KW":case"A192KW":case"A256KW":{a=r||aa(e),o=await zp(t,n,a);break}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{a=r||aa(e);const{iv:c}=i;({encryptedKey:o,...s}=await ZA(t,n,a,c));break}default:throw new kt('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:a,encryptedKey:o,parameters:s}}const Yv=Symbol();class Ld{constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("plaintext must be an instance of Uint8Array");this._plaintext=e}setKeyManagementParameters(e){if(this._keyManagementParameters)throw new TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._sharedUnprotectedHeader)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}setContentEncryptionKey(e){if(this._cek)throw new TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw new TypeError("setInitializationVector can only be called once");return this._iv=e,this}async encrypt(e,n){if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new ze("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!au(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new ze("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");const r={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if(cu(ze,new Map,n==null?void 0:n.crit,this._protectedHeader,r),r.zip!==void 0){if(!this._protectedHeader||!this._protectedHeader.zip)throw new ze('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if(r.zip!=="DEF")throw new kt('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}const{alg:i,enc:o}=r;if(typeof i!="string"||!i)throw new ze('JWE "alg" (Algorithm) Header Parameter missing or invalid');if(typeof o!="string"||!o)throw new ze('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');let s;if(i==="dir"){if(this._cek)throw new TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if(i==="ECDH-ES"&&this._cek)throw new TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");let a;{let y;({cek:a,encryptedKey:s,parameters:y}=await Gv(i,o,e,this._cek,this._keyManagementParameters)),y&&(n&&Yv in n?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...y}:this.setUnprotectedHeader(y):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...y}:this.setProtectedHeader(y))}this._iv||(this._iv=Dv(o));let c,l,u;this._protectedHeader?l=zn.encode(rr(JSON.stringify(this._protectedHeader))):l=zn.encode(""),this._aad?(u=rr(this._aad),c=Wo(l,zn.encode("."),zn.encode(u))):c=l;let d,g;if(r.zip==="DEF"){const y=await((n==null?void 0:n.deflateRaw)||TA)(this._plaintext);({ciphertext:d,tag:g}=await Yp(o,y,a,this._iv,c))}else({ciphertext:d,tag:g}=await Yp(o,this._plaintext,a,this._iv,c));const p={ciphertext:rr(d),iv:rr(this._iv),tag:rr(g)};return s&&(p.encrypted_key=rr(s)),u&&(p.aad=u),this._protectedHeader&&(p.protected=Yi.decode(l)),this._sharedUnprotectedHeader&&(p.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(p.header=this._unprotectedHeader),p}}class sx{constructor(e,n,r){this.parent=e,this.key=n,this.options=r}setUnprotectedHeader(e){if(this.unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addRecipient(...e){return this.parent.addRecipient(...e)}encrypt(...e){return this.parent.encrypt(...e)}done(){return this.parent}}class ax{constructor(e){this._recipients=[],this._plaintext=e}addRecipient(e,n){const r=new sx(this,e,{crit:n==null?void 0:n.crit});return this._recipients.push(r),r}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}async encrypt(e){var n,r,i;if(!this._recipients.length)throw new ze("at least one recipient must be added");if(e={deflateRaw:e==null?void 0:e.deflateRaw},this._recipients.length===1){const[c]=this._recipients,l=await new Ld(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(c.unprotectedHeader).encrypt(c.key,{...c.options,...e});let u={ciphertext:l.ciphertext,iv:l.iv,recipients:[{}],tag:l.tag};return l.aad&&(u.aad=l.aad),l.protected&&(u.protected=l.protected),l.unprotected&&(u.unprotected=l.unprotected),l.encrypted_key&&(u.recipients[0].encrypted_key=l.encrypted_key),l.header&&(u.recipients[0].header=l.header),u}let o;for(let c=0;c<this._recipients.length;c++){const l=this._recipients[c];if(!au(this._protectedHeader,this._unprotectedHeader,l.unprotectedHeader))throw new ze("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");const u={...this._protectedHeader,...this._unprotectedHeader,...l.unprotectedHeader},{alg:d}=u;if(typeof d!="string"||!d)throw new ze('JWE "alg" (Algorithm) Header Parameter missing or invalid');if(d==="dir"||d==="ECDH-ES")throw new ze('"dir" and "ECDH-ES" alg may only be used with a single recipient');if(typeof u.enc!="string"||!u.enc)throw new ze('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(!o)o=u.enc;else if(o!==u.enc)throw new ze('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients');if(cu(ze,new Map,l.options.crit,this._protectedHeader,u),u.zip!==void 0&&(!this._protectedHeader||!this._protectedHeader.zip))throw new ze('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}const s=aa(o);let a={ciphertext:"",iv:"",recipients:[],tag:""};for(let c=0;c<this._recipients.length;c++){const l=this._recipients[c],u={};a.recipients.push(u);const g={...this._protectedHeader,...this._unprotectedHeader,...l.unprotectedHeader}.alg.startsWith("PBES2")?2048+c:void 0;if(c===0){const w=await new Ld(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(s).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(l.unprotectedHeader).setKeyManagementParameters({p2c:g}).encrypt(l.key,{...l.options,...e,[Yv]:!0});a.ciphertext=w.ciphertext,a.iv=w.iv,a.tag=w.tag,w.aad&&(a.aad=w.aad),w.protected&&(a.protected=w.protected),w.unprotected&&(a.unprotected=w.unprotected),u.encrypted_key=w.encrypted_key,w.header&&(u.header=w.header);continue}const{encryptedKey:p,parameters:y}=await Gv(((n=l.unprotectedHeader)===null||n===void 0?void 0:n.alg)||((r=this._protectedHeader)===null||r===void 0?void 0:r.alg)||((i=this._unprotectedHeader)===null||i===void 0?void 0:i.alg),o,l.key,s,{p2c:g});u.encrypted_key=rr(p),(l.unprotectedHeader||y)&&(u.header={...l.unprotectedHeader,...y})}return a}}function Jv(t,e){const n=`SHA-${t.slice(-3)}`;switch(t){case"HS256":case"HS384":case"HS512":return{hash:n,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:n,name:"RSA-PSS",saltLength:t.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:n,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:n,name:"ECDSA",namedCurve:e.namedCurve};case(Ua()&&"EdDSA"):const{namedCurve:r}=e;return{name:r,namedCurve:r};default:throw new kt(`alg ${t} is not supported either by JOSE or your javascript runtime`)}}function Zv(t,e,n){if(Ei(e))return wA(e,t,n),e;if(e instanceof Uint8Array){if(!t.startsWith("HS"))throw new TypeError(Or(e,...jn));return ct.subtle.importKey("raw",e,{hash:`SHA-${t.slice(-3)}`,name:"HMAC"},!1,[n])}throw new TypeError(Or(e,...jn,"Uint8Array"))}const cx=async(t,e,n,r)=>{const i=await Zv(t,e,"verify");pf(t,i);const o=Jv(t,i.algorithm);try{return await ct.subtle.verify(o,i,n,r)}catch{return!1}};var lx=cx;async function y0(t,e,n){var r;if(!Nr(t))throw new Qt("Flattened JWS must be an object");if(t.protected===void 0&&t.header===void 0)throw new Qt('Flattened JWS must have either of the "protected" or "header" members');if(t.protected!==void 0&&typeof t.protected!="string")throw new Qt("JWS Protected Header incorrect type");if(t.payload===void 0)throw new Qt("JWS Payload missing");if(typeof t.signature!="string")throw new Qt("JWS Signature missing or incorrect type");if(t.header!==void 0&&!Nr(t.header))throw new Qt("JWS Unprotected Header incorrect type");let i={};if(t.protected){const E=mr(t.protected);try{i=JSON.parse(Yi.decode(E))}catch{throw new Qt("JWS Protected Header is invalid")}}if(!au(i,t.header))throw new Qt("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const o={...i,...t.header},s=cu(Qt,new Map([["b64",!0]]),n==null?void 0:n.crit,i,o);let a=!0;if(s.has("b64")&&(a=i.b64,typeof a!="boolean"))throw new Qt('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:c}=o;if(typeof c!="string"||!c)throw new Qt('JWS "alg" (Algorithm) Header Parameter missing or invalid');const l=n&&Jp("algorithms",n.algorithms);if(l&&!l.has(c))throw new Pd('"alg" (Algorithm) Header Parameter not allowed');if(a){if(typeof t.payload!="string")throw new Qt("JWS Payload must be a string")}else if(typeof t.payload!="string"&&!(t.payload instanceof Uint8Array))throw new Qt("JWS Payload must be a string or an Uint8Array instance");let u=!1;typeof e=="function"&&(e=await e(i,t),u=!0),mf(c,e,"verify");const d=Wo(zn.encode((r=t.protected)!==null&&r!==void 0?r:""),zn.encode("."),typeof t.payload=="string"?zn.encode(t.payload):t.payload),g=mr(t.signature);if(!await lx(c,e,g,d))throw new p0;let y;a?y=mr(t.payload):typeof t.payload=="string"?y=zn.encode(t.payload):y=t.payload;const w={payload:y};return t.protected!==void 0&&(w.protectedHeader=i),t.header!==void 0&&(w.unprotectedHeader=t.header),u?{...w,key:e}:w}async function Qv(t,e,n){if(t instanceof Uint8Array&&(t=Yi.decode(t)),typeof t!="string")throw new Qt("Compact JWS must be a string or Uint8Array");const{0:r,1:i,2:o,length:s}=t.split(".");if(s!==3)throw new Qt("Invalid Compact JWS");const a=await y0({payload:i,protected:r,signature:o},e,n),c={payload:a.payload,protectedHeader:a.protectedHeader};return typeof e=="function"?{...c,key:a.key}:c}async function ux(t,e,n){if(!Nr(t))throw new Qt("General JWS must be an object");if(!Array.isArray(t.signatures)||!t.signatures.every(Nr))throw new Qt("JWS Signatures missing or incorrect type");for(const r of t.signatures)try{return await y0({header:r.header,payload:t.payload,protected:r.protected,signature:r.signature},e,n)}catch{}throw new p0}var od=t=>Math.floor(t.getTime()/1e3);const Xv=60,e1=Xv*60,_0=e1*24,dx=_0*7,fx=_0*365.25,hx=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;var Ud=t=>{const e=hx.exec(t);if(!e)throw new TypeError("Invalid time period format");const n=parseFloat(e[1]);switch(e[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(n);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(n*Xv);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(n*e1);case"day":case"days":case"d":return Math.round(n*_0);case"week":case"weeks":case"w":return Math.round(n*dx);default:return Math.round(n*fx)}};const Wy=t=>t.toLowerCase().replace(/^application\//,""),px=(t,e)=>typeof t=="string"?e.includes(t):Array.isArray(t)?e.some(Set.prototype.has.bind(new Set(t))):!1;var w0=(t,e,n={})=>{const{typ:r}=n;if(r&&(typeof t.typ!="string"||Wy(t.typ)!==Wy(r)))throw new Ri('unexpected "typ" JWT header value',"typ","check_failed");let i;try{i=JSON.parse(Yi.decode(e))}catch{}if(!Nr(i))throw new yi("JWT Claims Set must be a top-level JSON object");const{issuer:o}=n;if(o&&!(Array.isArray(o)?o:[o]).includes(i.iss))throw new Ri('unexpected "iss" claim value',"iss","check_failed");const{subject:s}=n;if(s&&i.sub!==s)throw new Ri('unexpected "sub" claim value',"sub","check_failed");const{audience:a}=n;if(a&&!px(i.aud,typeof a=="string"?[a]:a))throw new Ri('unexpected "aud" claim value',"aud","check_failed");let c;switch(typeof n.clockTolerance){case"string":c=Ud(n.clockTolerance);break;case"number":c=n.clockTolerance;break;case"undefined":c=0;break;default:throw new TypeError("Invalid clockTolerance option type")}const{currentDate:l}=n,u=od(l||new Date);if((i.iat!==void 0||n.maxTokenAge)&&typeof i.iat!="number")throw new Ri('"iat" claim must be a number',"iat","invalid");if(i.nbf!==void 0){if(typeof i.nbf!="number")throw new Ri('"nbf" claim must be a number',"nbf","invalid");if(i.nbf>u+c)throw new Ri('"nbf" claim timestamp check failed',"nbf","check_failed")}if(i.exp!==void 0){if(typeof i.exp!="number")throw new Ri('"exp" claim must be a number',"exp","invalid");if(i.exp<=u-c)throw new Vp('"exp" claim timestamp check failed',"exp","check_failed")}if(n.maxTokenAge){const d=u-i.iat,g=typeof n.maxTokenAge=="number"?n.maxTokenAge:Ud(n.maxTokenAge);if(d-c>g)throw new Vp('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(d<0-c)throw new Ri('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return i};async function gx(t,e,n){var r;const i=await Qv(t,e,n);if(((r=i.protectedHeader.crit)===null||r===void 0?void 0:r.includes("b64"))&&i.protectedHeader.b64===!1)throw new yi("JWTs MUST NOT use unencoded payload");const s={payload:w0(i.protectedHeader,i.payload,n),protectedHeader:i.protectedHeader};return typeof e=="function"?{...s,key:i.key}:s}async function mx(t,e,n){const r=await Vv(t,e,n),i=w0(r.protectedHeader,r.plaintext,n),{protectedHeader:o}=r;if(o.iss!==void 0&&o.iss!==i.iss)throw new Ri('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(o.sub!==void 0&&o.sub!==i.sub)throw new Ri('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(o.aud!==void 0&&JSON.stringify(o.aud)!==JSON.stringify(i.aud))throw new Ri('replicated "aud" claim header parameter mismatch',"aud","mismatch");const s={payload:i,protectedHeader:o};return typeof e=="function"?{...s,key:r.key}:s}class t1{constructor(e){this._flattened=new Ld(e)}setContentEncryptionKey(e){return this._flattened.setContentEncryptionKey(e),this}setInitializationVector(e){return this._flattened.setInitializationVector(e),this}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}setKeyManagementParameters(e){return this._flattened.setKeyManagementParameters(e),this}async encrypt(e,n){const r=await this._flattened.encrypt(e,n);return[r.protected,r.encrypted_key,r.iv,r.ciphertext,r.tag].join(".")}}const yx=async(t,e,n)=>{const r=await Zv(t,e,"sign");pf(t,r);const i=await ct.subtle.sign(Jv(t,r.algorithm),r,n);return new Uint8Array(i)};var _x=yx;class v0{constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,n){if(!this._protectedHeader&&!this._unprotectedHeader)throw new Qt("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!au(this._protectedHeader,this._unprotectedHeader))throw new Qt("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const r={...this._protectedHeader,...this._unprotectedHeader},i=cu(Qt,new Map([["b64",!0]]),n==null?void 0:n.crit,this._protectedHeader,r);let o=!0;if(i.has("b64")&&(o=this._protectedHeader.b64,typeof o!="boolean"))throw new Qt('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:s}=r;if(typeof s!="string"||!s)throw new Qt('JWS "alg" (Algorithm) Header Parameter missing or invalid');mf(s,e,"sign");let a=this._payload;o&&(a=zn.encode(rr(a)));let c;this._protectedHeader?c=zn.encode(rr(JSON.stringify(this._protectedHeader))):c=zn.encode("");const l=Wo(c,zn.encode("."),a),u=await _x(s,e,l),d={signature:rr(u),payload:""};return o&&(d.payload=Yi.decode(a)),this._unprotectedHeader&&(d.header=this._unprotectedHeader),this._protectedHeader&&(d.protected=Yi.decode(c)),d}}class n1{constructor(e){this._flattened=new v0(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,n){const r=await this._flattened.sign(e,n);if(r.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}class wx{constructor(e,n,r){this.parent=e,this.key=n,this.options=r}setProtectedHeader(e){if(this.protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this.protectedHeader=e,this}setUnprotectedHeader(e){if(this.unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addSignature(...e){return this.parent.addSignature(...e)}sign(...e){return this.parent.sign(...e)}done(){return this.parent}}class vx{constructor(e){this._signatures=[],this._payload=e}addSignature(e,n){const r=new wx(this,e,n);return this._signatures.push(r),r}async sign(){if(!this._signatures.length)throw new Qt("at least one signature must be added");const e={signatures:[],payload:""};for(let n=0;n<this._signatures.length;n++){const r=this._signatures[n],i=new v0(this._payload);i.setProtectedHeader(r.protectedHeader),i.setUnprotectedHeader(r.unprotectedHeader);const{payload:o,...s}=await i.sign(r.key,r.options);if(n===0)e.payload=o;else if(e.payload!==o)throw new Qt("inconsistent use of JWS Unencoded Payload Option (RFC7797)");e.signatures.push(s)}return e}}class b0{constructor(e){if(!Nr(e))throw new TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return typeof e=="number"?this._payload={...this._payload,nbf:e}:this._payload={...this._payload,nbf:od(new Date)+Ud(e)},this}setExpirationTime(e){return typeof e=="number"?this._payload={...this._payload,exp:e}:this._payload={...this._payload,exp:od(new Date)+Ud(e)},this}setIssuedAt(e){return typeof e=="undefined"?this._payload={...this._payload,iat:od(new Date)}:this._payload={...this._payload,iat:e},this}}class bx extends b0{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,n){var r;const i=new n1(zn.encode(JSON.stringify(this._payload)));if(i.setProtectedHeader(this._protectedHeader),Array.isArray((r=this._protectedHeader)===null||r===void 0?void 0:r.crit)&&this._protectedHeader.crit.includes("b64")&&this._protectedHeader.b64===!1)throw new yi("JWTs MUST NOT use unencoded payload");return i.sign(e,n)}}class Ex extends b0{setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setKeyManagementParameters(e){if(this._keyManagementParameters)throw new TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setContentEncryptionKey(e){if(this._cek)throw new TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw new TypeError("setInitializationVector can only be called once");return this._iv=e,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(e,n){const r=new t1(zn.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),r.setProtectedHeader(this._protectedHeader),this._iv&&r.setInitializationVector(this._iv),this._cek&&r.setContentEncryptionKey(this._cek),this._keyManagementParameters&&r.setKeyManagementParameters(this._keyManagementParameters),r.encrypt(e,n)}}const _s=(t,e)=>{if(typeof t!="string"||!t)throw new Iv(`${e} missing or invalid`)};async function Sx(t,e="sha256"){if(!Nr(t))throw new TypeError("JWK must be an object");if(e!=="sha256"&&e!=="sha384"&&e!=="sha512")throw new TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');let n;switch(t.kty){case"EC":_s(t.crv,'"crv" (Curve) Parameter'),_s(t.x,'"x" (X Coordinate) Parameter'),_s(t.y,'"y" (Y Coordinate) Parameter'),n={crv:t.crv,kty:t.kty,x:t.x,y:t.y};break;case"OKP":_s(t.crv,'"crv" (Subtype of Key Pair) Parameter'),_s(t.x,'"x" (Public Key) Parameter'),n={crv:t.crv,kty:t.kty,x:t.x};break;case"RSA":_s(t.e,'"e" (Exponent) Parameter'),_s(t.n,'"n" (Modulus) Parameter'),n={e:t.e,kty:t.kty,n:t.n};break;case"oct":_s(t.k,'"k" (Key Value) Parameter'),n={k:t.k,kty:t.kty};break;default:throw new kt('"kty" (Key Type) Parameter missing or unsupported')}const r=zn.encode(JSON.stringify(n));return rr(await Tv(e,r))}async function Tx(t,e){const n={...t,...e.header};if(!Nr(n.jwk))throw new Qt('"jwk" (JSON Web Key) Header Parameter must be a JSON object');const r=await gf({...n.jwk,ext:!0},n.alg,!0);if(r instanceof Uint8Array||r.type!=="public")throw new Qt('"jwk" (JSON Web Key) Header Parameter must be a public key');return r}function Ax(t){switch(typeof t=="string"&&t.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new kt('Unsupported "alg" value for a JSON Web Key Set')}}function r1(t){return t&&typeof t=="object"&&Array.isArray(t.keys)&&t.keys.every(xx)}function xx(t){return Nr(t)}function Ix(t){return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}class Zp{constructor(e){if(this._cached=new WeakMap,!r1(e))throw new Nd("JSON Web Key Set malformed");this._jwks=Ix(e)}async getKey(e,n){const{alg:r,kid:i}={...e,...n.header},o=Ax(r),s=this._jwks.keys.filter(u=>{let d=o===u.kty;if(d&&typeof i=="string"&&(d=i===u.kid),d&&typeof u.alg=="string"&&(d=r===u.alg),d&&typeof u.use=="string"&&(d=u.use==="sig"),d&&Array.isArray(u.key_ops)&&(d=u.key_ops.includes("verify")),d&&r==="EdDSA"&&(d=u.crv==="Ed25519"||u.crv==="Ed448"),d)switch(r){case"ES256":d=u.crv==="P-256";break;case"ES256K":d=u.crv==="secp256k1";break;case"ES384":d=u.crv==="P-384";break;case"ES512":d=u.crv==="P-521";break}return d}),{0:a,length:c}=s;if(c===0)throw new h0;if(c!==1)throw new Rv;const l=this._cached.get(a)||this._cached.set(a,{}).get(a);if(l[r]===void 0){const u=await gf({...a,ext:!0},r);if(u instanceof Uint8Array||u.type!=="public")throw new Nd("JSON Web Key Set members must be public keys");l[r]=u}return l[r]}}function Rx(t){return Zp.prototype.getKey.bind(new Zp(t))}const kx=async(t,e,n)=>{let r,i,o=!1;typeof AbortController=="function"&&(r=new AbortController,i=setTimeout(()=>{o=!0,r.abort()},e));const s=await fetch(t.href,{signal:r?r.signal:void 0,redirect:"manual",headers:n.headers}).catch(a=>{throw o?new kv:a});if(i!==void 0&&clearTimeout(i),s.status!==200)throw new Hr("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await s.json()}catch{throw new Hr("Failed to parse the JSON Web Key Set HTTP response as JSON")}};var Fx=kx;class qy extends Zp{constructor(e,n){if(super({keys:[]}),this._jwks=void 0,!(e instanceof URL))throw new TypeError("url must be an instance of URL");this._url=new URL(e.href),this._options={agent:n==null?void 0:n.agent,headers:n==null?void 0:n.headers},this._timeoutDuration=typeof(n==null?void 0:n.timeoutDuration)=="number"?n==null?void 0:n.timeoutDuration:5e3,this._cooldownDuration=typeof(n==null?void 0:n.cooldownDuration)=="number"?n==null?void 0:n.cooldownDuration:3e4,this._cacheMaxAge=typeof(n==null?void 0:n.cacheMaxAge)=="number"?n==null?void 0:n.cacheMaxAge:6e5}coolingDown(){return typeof this._jwksTimestamp=="number"?Date.now()<this._jwksTimestamp+this._cooldownDuration:!1}fresh(){return typeof this._jwksTimestamp=="number"?Date.now()<this._jwksTimestamp+this._cacheMaxAge:!1}async getKey(e,n){(!this._jwks||!this.fresh())&&await this.reload();try{return await super.getKey(e,n)}catch(r){if(r instanceof h0&&this.coolingDown()===!1)return await this.reload(),super.getKey(e,n);throw r}}async reload(){if(this._pendingFetch&&Ua())return new Promise(e=>{const n=()=>{this._pendingFetch===void 0?e():setTimeout(n,5)};n()});this._pendingFetch||(this._pendingFetch=Fx(this._url,this._timeoutDuration,this._options).then(e=>{if(!r1(e))throw new Nd("JSON Web Key Set malformed");this._jwks={keys:e.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(e=>{throw this._pendingFetch=void 0,e})),await this._pendingFetch}}function Dx(t,e){return qy.prototype.getKey.bind(new qy(t,e))}class Cx extends b0{encode(){const e=rr(JSON.stringify({alg:"none"})),n=rr(JSON.stringify(this._payload));return`${e}.${n}.`}static decode(e,n){if(typeof e!="string")throw new yi("Unsecured JWT must be a string");const{0:r,1:i,2:o,length:s}=e.split(".");if(s!==3||o!=="")throw new yi("Invalid Unsecured JWT");let a;try{if(a=JSON.parse(Yi.decode(mr(r))),a.alg!=="none")throw new Error}catch{throw new yi("Invalid Unsecured JWT")}return{payload:w0(a,mr(i),n),header:a}}}const Px=rr,E0=mr;var Nx=Object.freeze(Object.defineProperty({__proto__:null,encode:Px,decode:E0},Symbol.toStringTag,{value:"Module"}));function Ox(t){let e;if(typeof t=="string"){const n=t.split(".");(n.length===3||n.length===5)&&([e]=n)}else if(typeof t=="object"&&t)if("protected"in t)e=t.protected;else throw new TypeError("Token does not contain a Protected Header");try{if(typeof e!="string"||!e)throw new Error;const n=JSON.parse(Yi.decode(E0(e)));if(!Nr(n))throw new Error;return n}catch{throw new TypeError("Invalid Token or Protected Header formatting")}}function Mx(t){if(typeof t!="string")throw new yi("JWTs must use Compact JWS serialization, JWT must be a string");const{1:e,length:n}=t.split(".");if(n===5)throw new yi("Only JWTs using Compact JWS serialization can be decoded");if(n!==3)throw new yi("Invalid JWT");if(!e)throw new yi("JWTs must contain a payload");let r;try{r=E0(e)}catch{throw new yi("Failed to parse the base64url encoded payload")}let i;try{i=JSON.parse(Yi.decode(r))}catch{throw new yi("Failed to parse the decoded payload as JSON")}if(!Nr(i))throw new yi("Invalid JWT Claims Set");return i}async function Lx(t,e){var n;let r,i,o;switch(t){case"HS256":case"HS384":case"HS512":r=parseInt(t.slice(-3),10),i={name:"HMAC",hash:`SHA-${r}`,length:r},o=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r=parseInt(t.slice(-3),10),ff(new Uint8Array(r>>3));case"A128KW":case"A192KW":case"A256KW":r=parseInt(t.slice(1,4),10),i={name:"AES-KW",length:r},o=["wrapKey","unwrapKey"];break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":r=parseInt(t.slice(1,4),10),i={name:"AES-GCM",length:r},o=["encrypt","decrypt"];break;default:throw new kt('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return ct.subtle.generateKey(i,(n=e==null?void 0:e.extractable)!==null&&n!==void 0?n:!1,o)}function Rh(t){var e;const n=(e=t==null?void 0:t.modulusLength)!==null&&e!==void 0?e:2048;if(typeof n!="number"||n<2048)throw new kt("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return n}async function Ux(t,e){var n,r;let i,o;switch(t){case"PS256":case"PS384":case"PS512":i={name:"RSA-PSS",hash:`SHA-${t.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:Rh(e)},o=["sign","verify"];break;case"RS256":case"RS384":case"RS512":i={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${t.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:Rh(e)},o=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":i={name:"RSA-OAEP",hash:`SHA-${parseInt(t.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:Rh(e)},o=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":i={name:"ECDSA",namedCurve:"P-256"},o=["sign","verify"];break;case"ES384":i={name:"ECDSA",namedCurve:"P-384"},o=["sign","verify"];break;case"ES512":i={name:"ECDSA",namedCurve:"P-521"},o=["sign","verify"];break;case(Ua()&&"EdDSA"):switch(e==null?void 0:e.crv){case void 0:case"Ed25519":i={name:"NODE-ED25519",namedCurve:"NODE-ED25519"},o=["sign","verify"];break;default:throw new kt("Invalid or unsupported crv option provided")}break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":i={name:"ECDH",namedCurve:(n=e==null?void 0:e.crv)!==null&&n!==void 0?n:"P-256"},o=["deriveKey","deriveBits"];break;default:throw new kt('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return ct.subtle.generateKey(i,(r=e==null?void 0:e.extractable)!==null&&r!==void 0?r:!1,o)}async function jx(t,e){return Ux(t,e)}async function $x(t,e){return Lx(t,e)}var Bx=Object.freeze(Object.defineProperty({__proto__:null,errors:hA,base64url:Nx,compactDecrypt:Vv,flattenedDecrypt:m0,generalDecrypt:tx,GeneralEncrypt:ax,compactVerify:Qv,flattenedVerify:y0,generalVerify:ux,jwtVerify:gx,jwtDecrypt:mx,CompactEncrypt:t1,FlattenedEncrypt:Ld,CompactSign:n1,FlattenedSign:v0,GeneralSign:vx,SignJWT:bx,EncryptJWT:Ex,calculateJwkThumbprint:Sx,EmbeddedJWK:Tx,createLocalJWKSet:Rx,createRemoteJWKSet:Dx,UnsecuredJWT:Cx,exportPKCS8:ox,exportSPKI:ix,exportJWK:zv,importSPKI:HA,importPKCS8:WA,importX509:KA,importJWK:gf,decodeProtectedHeader:Ox,decodeJwt:Mx,generateKeyPair:jx,generateSecret:$x},Symbol.toStringTag,{value:"Module"})),S0=lf(Bx);Object.defineProperty(Rc,"__esModule",{value:!0});Rc.getWebidFromTokenPayload=Rc.fetchJwks=void 0;const Hx=kc.exports,Vy=S0;async function i1(t,e){const n=await(0,Hx.fetch)(t);if(n.status!==200)throw new Error(`Could not fetch JWKS for [${e}] at [${t}]: ${n.status} ${n.statusText}`);let r;try{r=(await n.json()).keys[0]}catch(i){throw new Error(`Malformed JWKS for [${e}] at [${t}]: ${i.message}`)}return r}Rc.fetchJwks=i1;async function Kx(t,e,n,r){const i=await i1(e,n);let o;try{const{payload:s}=await(0,Vy.jwtVerify)(t,await(0,Vy.importJWK)(i),{issuer:n,audience:r});o=s}catch(s){throw new Error(`Token verification failed: ${s.stack}`)}if(typeof o.webid=="string")return o.webid;if(typeof o.sub!="string")throw new Error(`The token ${JSON.stringify(o)} is invalid: it has no 'webid' claim and no 'sub' claim.`);try{return new URL(o.sub),o.sub}catch(s){throw new Error(`The token has no 'webid' claim, and its 'sub' claim of [${o.sub}] is invalid as a URL - error [${s}].`)}}Rc.getWebidFromTokenPayload=Kx;var yf={};Object.defineProperty(yf,"__esModule",{value:!0});yf.isSupportedTokenType=void 0;function Wx(t){return typeof t=="string"&&["DPoP","Bearer"].includes(t)}yf.isSupportedTokenType=Wx;var _f={};Object.defineProperty(_f,"__esModule",{value:!0});_f.USER_SESSION_PREFIX=void 0;_f.USER_SESSION_PREFIX="solidClientAuthenticationUser";var Fc={};Object.defineProperty(Fc,"__esModule",{value:!0});Fc.handleRegistration=Fc.determineSigningAlg=void 0;function zy(t){try{return new URL(t),!0}catch{return!1}}function qx(t,e){var n;return(n=e.find(r=>t.includes(r)))!==null&&n!==void 0?n:null}Fc.determineSigningAlg=qx;function Vx(t,e){return t.clientId!==void 0&&!zy(t.clientId)?"static":e.scopesSupported.includes("webid")&&t.clientId!==void 0&&zy(t.clientId)?"solid-oidc":"dynamic"}async function zx(t,e,n,r){const i=Vx(t,e);return i==="dynamic"?r.getClient({sessionId:t.sessionId,clientName:t.clientName,redirectUrl:t.redirectUrl},e):(await n.setForUser(t.sessionId,{clientId:t.clientId}),t.clientSecret&&await n.setForUser(t.sessionId,{clientSecret:t.clientSecret}),t.clientName&&await n.setForUser(t.sessionId,{clientName:t.clientName}),{clientId:t.clientId,clientSecret:t.clientSecret,clientName:t.clientName,clientType:i})}Fc.handleRegistration=zx;var Fo={},Gx=Vt&&Vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Fo,"__esModule",{value:!0});Fo.saveSessionInfoToStorage=Fo.loadOidcContextFromStorage=Fo.getSessionIdFromOauthState=void 0;const Yx=S0,kh=Gx(df);async function Jx(t,e){return t.getForUser(e,"sessionId")}Fo.getSessionIdFromOauthState=Jx;async function Zx(t,e,n){try{const[r,i,o,s]=await Promise.all([e.getForUser(t,"issuer",{errorIfNull:!0}),e.getForUser(t,"codeVerifier"),e.getForUser(t,"redirectUrl"),e.getForUser(t,"dpop",{errorIfNull:!0})]);await e.deleteForUser(t,"codeVerifier");const a=await n.fetchConfig(r);return{codeVerifier:i,redirectUrl:o,issuerConfig:a,dpop:s==="true"}}catch(r){throw new Error(`Failed to retrieve OIDC context from storage associated with session [${t}]: ${r}`)}}Fo.loadOidcContextFromStorage=Zx;async function Qx(t,e,n,r,i,o,s){i!==void 0&&await t.setForUser(e,{refreshToken:i},{secure:o}),n!==void 0&&await t.setForUser(e,{webId:n},{secure:o}),r!==void 0&&await t.setForUser(e,{isLoggedIn:r},{secure:o}),s!==void 0&&await t.setForUser(e,{publicKey:JSON.stringify(s.publicKey),privateKey:JSON.stringify(await(0,Yx.exportJWK)(s.privateKey))},{secure:o})}Fo.saveSessionInfoToStorage=Qx;class Xx{constructor(e,n){this.secureStorage=e,this.insecureStorage=n}getKey(e){return`solidClientAuthenticationUser:${e}`}async getUserData(e,n){const r=await(n?this.secureStorage:this.insecureStorage).get(this.getKey(e));if(r===void 0)return{};try{return JSON.parse(r)}catch{throw new kh.default(`Data for user [${e}] in [${n?"secure":"unsecure"}] storage is corrupted - expected valid JSON, but got: ${r}`)}}async setUserData(e,n,r){await(r?this.secureStorage:this.insecureStorage).set(this.getKey(e),JSON.stringify(n))}async get(e,n){const r=await(n!=null&&n.secure?this.secureStorage:this.insecureStorage).get(e);if(r===void 0&&(n==null?void 0:n.errorIfNull))throw new kh.default(`[${e}] is not stored`);return r}async set(e,n,r){return(r!=null&&r.secure?this.secureStorage:this.insecureStorage).set(e,n)}async delete(e,n){return(n!=null&&n.secure?this.secureStorage:this.insecureStorage).delete(e)}async getForUser(e,n,r){const i=await this.getUserData(e,r==null?void 0:r.secure);let o;if((!i||!i[n])&&(o=void 0),o=i[n],o===void 0&&(r==null?void 0:r.errorIfNull))throw new kh.default(`Field [${n}] for user [${e}] is not stored`);return o||void 0}async setForUser(e,n,r){let i;try{i=await this.getUserData(e,r==null?void 0:r.secure)}catch{i={}}await this.setUserData(e,{...i,...n},r==null?void 0:r.secure)}async deleteForUser(e,n,r){const i=await this.getUserData(e,r==null?void 0:r.secure);delete i[n],await this.setUserData(e,i,r==null?void 0:r.secure)}async deleteAllUserData(e,n){await(n!=null&&n.secure?this.secureStorage:this.insecureStorage).delete(this.getKey(e))}}Fo.default=Xx;var T0={};Object.defineProperty(T0,"__esModule",{value:!0});class eI{constructor(){this.map={}}async get(e){return this.map[e]||void 0}async set(e,n){this.map[e]=n}async delete(e){delete this.map[e]}}T0.default=eI;var A0={};Object.defineProperty(A0,"__esModule",{value:!0});class tI extends Error{constructor(e){super(e)}}A0.default=tI;var x0={};Object.defineProperty(x0,"__esModule",{value:!0});class nI extends Error{constructor(e){super(`[${e}] is not implemented`)}}x0.default=nI;var lu={};Object.defineProperty(lu,"__esModule",{value:!0});lu.InvalidResponseError=void 0;class rI extends Error{constructor(e){super(`Invalid response from OIDC provider: missing fields ${e}`),this.missingFields=e}}lu.InvalidResponseError=rI;var uu={};Object.defineProperty(uu,"__esModule",{value:!0});uu.OidcProviderError=void 0;class iI extends Error{constructor(e,n,r){super(e),this.error=n,this.errorDescription=r}}uu.OidcProviderError=iI;var Ia={},Ku,oI=new Uint8Array(16);function o1(){if(!Ku&&(Ku=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Ku))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ku(oI)}var sI=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function wf(t){return typeof t=="string"&&sI.test(t)}var Lr=[];for(var Fh=0;Fh<256;++Fh)Lr.push((Fh+256).toString(16).substr(1));function vf(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(Lr[t[e+0]]+Lr[t[e+1]]+Lr[t[e+2]]+Lr[t[e+3]]+"-"+Lr[t[e+4]]+Lr[t[e+5]]+"-"+Lr[t[e+6]]+Lr[t[e+7]]+"-"+Lr[t[e+8]]+Lr[t[e+9]]+"-"+Lr[t[e+10]]+Lr[t[e+11]]+Lr[t[e+12]]+Lr[t[e+13]]+Lr[t[e+14]]+Lr[t[e+15]]).toLowerCase();if(!wf(n))throw TypeError("Stringified UUID is invalid");return n}var Gy,Dh,Ch=0,Ph=0;function aI(t,e,n){var r=e&&n||0,i=e||new Array(16);t=t||{};var o=t.node||Gy,s=t.clockseq!==void 0?t.clockseq:Dh;if(o==null||s==null){var a=t.random||(t.rng||o1)();o==null&&(o=Gy=[a[0]|1,a[1],a[2],a[3],a[4],a[5]]),s==null&&(s=Dh=(a[6]<<8|a[7])&16383)}var c=t.msecs!==void 0?t.msecs:Date.now(),l=t.nsecs!==void 0?t.nsecs:Ph+1,u=c-Ch+(l-Ph)/1e4;if(u<0&&t.clockseq===void 0&&(s=s+1&16383),(u<0||c>Ch)&&t.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ch=c,Ph=l,Dh=s,c+=122192928e5;var d=((c&268435455)*1e4+l)%4294967296;i[r++]=d>>>24&255,i[r++]=d>>>16&255,i[r++]=d>>>8&255,i[r++]=d&255;var g=c/4294967296*1e4&268435455;i[r++]=g>>>8&255,i[r++]=g&255,i[r++]=g>>>24&15|16,i[r++]=g>>>16&255,i[r++]=s>>>8|128,i[r++]=s&255;for(var p=0;p<6;++p)i[r+p]=o[p];return e||vf(i)}function s1(t){if(!wf(t))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=e&255,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=e&255,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=e&255,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=e&255,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=e&255,n}function cI(t){t=unescape(encodeURIComponent(t));for(var e=[],n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}var lI="6ba7b810-9dad-11d1-80b4-00c04fd430c8",uI="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function a1(t,e,n){function r(i,o,s,a){if(typeof i=="string"&&(i=cI(i)),typeof o=="string"&&(o=s1(o)),o.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var c=new Uint8Array(16+i.length);if(c.set(o),c.set(i,o.length),c=n(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,s){a=a||0;for(var l=0;l<16;++l)s[a+l]=c[l];return s}return vf(c)}try{r.name=t}catch{}return r.DNS=lI,r.URL=uI,r}function dI(t){if(typeof t=="string"){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var n=0;n<e.length;++n)t[n]=e.charCodeAt(n)}return fI(hI(pI(t),t.length*8))}function fI(t){for(var e=[],n=t.length*32,r="0123456789abcdef",i=0;i<n;i+=8){var o=t[i>>5]>>>i%32&255,s=parseInt(r.charAt(o>>>4&15)+r.charAt(o&15),16);e.push(s)}return e}function c1(t){return(t+64>>>9<<4)+14+1}function hI(t,e){t[e>>5]|=128<<e%32,t[c1(e)-1]=e;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,s=0;s<t.length;s+=16){var a=n,c=r,l=i,u=o;n=Vr(n,r,i,o,t[s],7,-680876936),o=Vr(o,n,r,i,t[s+1],12,-389564586),i=Vr(i,o,n,r,t[s+2],17,606105819),r=Vr(r,i,o,n,t[s+3],22,-1044525330),n=Vr(n,r,i,o,t[s+4],7,-176418897),o=Vr(o,n,r,i,t[s+5],12,1200080426),i=Vr(i,o,n,r,t[s+6],17,-1473231341),r=Vr(r,i,o,n,t[s+7],22,-45705983),n=Vr(n,r,i,o,t[s+8],7,1770035416),o=Vr(o,n,r,i,t[s+9],12,-1958414417),i=Vr(i,o,n,r,t[s+10],17,-42063),r=Vr(r,i,o,n,t[s+11],22,-1990404162),n=Vr(n,r,i,o,t[s+12],7,1804603682),o=Vr(o,n,r,i,t[s+13],12,-40341101),i=Vr(i,o,n,r,t[s+14],17,-1502002290),r=Vr(r,i,o,n,t[s+15],22,1236535329),n=zr(n,r,i,o,t[s+1],5,-165796510),o=zr(o,n,r,i,t[s+6],9,-1069501632),i=zr(i,o,n,r,t[s+11],14,643717713),r=zr(r,i,o,n,t[s],20,-373897302),n=zr(n,r,i,o,t[s+5],5,-701558691),o=zr(o,n,r,i,t[s+10],9,38016083),i=zr(i,o,n,r,t[s+15],14,-660478335),r=zr(r,i,o,n,t[s+4],20,-405537848),n=zr(n,r,i,o,t[s+9],5,568446438),o=zr(o,n,r,i,t[s+14],9,-1019803690),i=zr(i,o,n,r,t[s+3],14,-187363961),r=zr(r,i,o,n,t[s+8],20,1163531501),n=zr(n,r,i,o,t[s+13],5,-1444681467),o=zr(o,n,r,i,t[s+2],9,-51403784),i=zr(i,o,n,r,t[s+7],14,1735328473),r=zr(r,i,o,n,t[s+12],20,-1926607734),n=Gr(n,r,i,o,t[s+5],4,-378558),o=Gr(o,n,r,i,t[s+8],11,-2022574463),i=Gr(i,o,n,r,t[s+11],16,1839030562),r=Gr(r,i,o,n,t[s+14],23,-35309556),n=Gr(n,r,i,o,t[s+1],4,-1530992060),o=Gr(o,n,r,i,t[s+4],11,1272893353),i=Gr(i,o,n,r,t[s+7],16,-155497632),r=Gr(r,i,o,n,t[s+10],23,-1094730640),n=Gr(n,r,i,o,t[s+13],4,681279174),o=Gr(o,n,r,i,t[s],11,-358537222),i=Gr(i,o,n,r,t[s+3],16,-722521979),r=Gr(r,i,o,n,t[s+6],23,76029189),n=Gr(n,r,i,o,t[s+9],4,-640364487),o=Gr(o,n,r,i,t[s+12],11,-421815835),i=Gr(i,o,n,r,t[s+15],16,530742520),r=Gr(r,i,o,n,t[s+2],23,-995338651),n=Yr(n,r,i,o,t[s],6,-198630844),o=Yr(o,n,r,i,t[s+7],10,1126891415),i=Yr(i,o,n,r,t[s+14],15,-1416354905),r=Yr(r,i,o,n,t[s+5],21,-57434055),n=Yr(n,r,i,o,t[s+12],6,1700485571),o=Yr(o,n,r,i,t[s+3],10,-1894986606),i=Yr(i,o,n,r,t[s+10],15,-1051523),r=Yr(r,i,o,n,t[s+1],21,-2054922799),n=Yr(n,r,i,o,t[s+8],6,1873313359),o=Yr(o,n,r,i,t[s+15],10,-30611744),i=Yr(i,o,n,r,t[s+6],15,-1560198380),r=Yr(r,i,o,n,t[s+13],21,1309151649),n=Yr(n,r,i,o,t[s+4],6,-145523070),o=Yr(o,n,r,i,t[s+11],10,-1120210379),i=Yr(i,o,n,r,t[s+2],15,718787259),r=Yr(r,i,o,n,t[s+9],21,-343485551),n=Is(n,a),r=Is(r,c),i=Is(i,l),o=Is(o,u)}return[n,r,i,o]}function pI(t){if(t.length===0)return[];for(var e=t.length*8,n=new Uint32Array(c1(e)),r=0;r<e;r+=8)n[r>>5]|=(t[r/8]&255)<<r%32;return n}function Is(t,e){var n=(t&65535)+(e&65535),r=(t>>16)+(e>>16)+(n>>16);return r<<16|n&65535}function gI(t,e){return t<<e|t>>>32-e}function bf(t,e,n,r,i,o){return Is(gI(Is(Is(e,t),Is(r,o)),i),n)}function Vr(t,e,n,r,i,o,s){return bf(e&n|~e&r,t,e,i,o,s)}function zr(t,e,n,r,i,o,s){return bf(e&r|n&~r,t,e,i,o,s)}function Gr(t,e,n,r,i,o,s){return bf(e^n^r,t,e,i,o,s)}function Yr(t,e,n,r,i,o,s){return bf(n^(e|~r),t,e,i,o,s)}var mI=a1("v3",48,dI),yI=mI;function _I(t,e,n){t=t||{};var r=t.random||(t.rng||o1)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return vf(r)}function wI(t,e,n,r){switch(t){case 0:return e&n^~e&r;case 1:return e^n^r;case 2:return e&n^e&r^n&r;case 3:return e^n^r}}function Nh(t,e){return t<<e|t>>>32-e}function vI(t){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){var r=unescape(encodeURIComponent(t));t=[];for(var i=0;i<r.length;++i)t.push(r.charCodeAt(i))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var o=t.length/4+2,s=Math.ceil(o/16),a=new Array(s),c=0;c<s;++c){for(var l=new Uint32Array(16),u=0;u<16;++u)l[u]=t[c*64+u*4]<<24|t[c*64+u*4+1]<<16|t[c*64+u*4+2]<<8|t[c*64+u*4+3];a[c]=l}a[s-1][14]=(t.length-1)*8/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=(t.length-1)*8&4294967295;for(var d=0;d<s;++d){for(var g=new Uint32Array(80),p=0;p<16;++p)g[p]=a[d][p];for(var y=16;y<80;++y)g[y]=Nh(g[y-3]^g[y-8]^g[y-14]^g[y-16],1);for(var w=n[0],E=n[1],b=n[2],S=n[3],R=n[4],F=0;F<80;++F){var M=Math.floor(F/20),P=Nh(w,5)+wI(M,E,b,S)+R+e[M]+g[F]>>>0;R=S,S=b,b=Nh(E,30)>>>0,E=w,w=P}n[0]=n[0]+w>>>0,n[1]=n[1]+E>>>0,n[2]=n[2]+b>>>0,n[3]=n[3]+S>>>0,n[4]=n[4]+R>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,n[0]&255,n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,n[1]&255,n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,n[2]&255,n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,n[3]&255,n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,n[4]&255]}var bI=a1("v5",80,vI),EI=bI,SI="00000000-0000-0000-0000-000000000000";function TI(t){if(!wf(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)}var AI=Object.freeze(Object.defineProperty({__proto__:null,v1:aI,v3:yI,v4:_I,v5:EI,NIL:SI,version:TI,validate:wf,stringify:vf,parse:s1},Symbol.toStringTag,{value:"Module"})),I0=lf(AI);Object.defineProperty(Ia,"__esModule",{value:!0});Ia.generateDpopKeyPair=Ia.createDpopHeader=void 0;const Qp=S0,xI=I0,Xp=_i;function II(t){const e=new URL(t);return new URL(e.pathname,e.origin).toString()}async function RI(t,e,n){return new Qp.SignJWT({htu:II(t),htm:e.toUpperCase(),jti:(0,xI.v4)()}).setProtectedHeader({alg:Xp.PREFERRED_SIGNING_ALG[0],jwk:n.publicKey,typ:"dpop+jwt"}).setIssuedAt().sign(n.privateKey,{})}Ia.createDpopHeader=RI;async function kI(){const{privateKey:t,publicKey:e}=await(0,Qp.generateKeyPair)(Xp.PREFERRED_SIGNING_ALG[0]),n={privateKey:t,publicKey:await(0,Qp.exportJWK)(e)};return[n.publicKey.alg]=Xp.PREFERRED_SIGNING_ALG,n}Ia.generateDpopKeyPair=kI;var l1={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.buildAuthenticatedFetch=t.DEFAULT_EXPIRATION_TIME_SECONDS=void 0;const e=kc.exports,n=_i,r=Ia,i=uu,o=lu;t.DEFAULT_EXPIRATION_TIME_SECONDS=600;function s(p){return[401,403].includes(p)}async function a(p,y,w,E){var b;const S=new e.Headers(E==null?void 0:E.headers);return S.set("Authorization",`DPoP ${y}`),S.set("DPoP",await(0,r.createDpopHeader)(p,(b=E==null?void 0:E.method)!==null&&b!==void 0?b:"get",w)),{...E,headers:S}}async function c(p,y,w,E){if(w!==void 0)return a(p,y,w,E);const b=new e.Headers(E==null?void 0:E.headers);return b.set("Authorization",`Bearer ${y}`),{...E,headers:b}}async function l(p,y,w,E,b){return p(w,await c(w.toString(),y,b,E))}async function u(p,y,w){var E;const b=await p.tokenRefresher.refresh(p.sessionId,p.refreshToken,y);return w==null||w.emit(n.EVENTS.SESSION_EXTENDED,(E=b.expiresIn)!==null&&E!==void 0?E:t.DEFAULT_EXPIRATION_TIME_SECONDS),typeof b.refreshToken=="string"&&(w==null||w.emit(n.EVENTS.NEW_REFRESH_TOKEN,b.refreshToken)),{accessToken:b.accessToken,refreshToken:b.refreshToken,expiresIn:b.expiresIn}}const d=p=>p!==void 0?p-n.REFRESH_BEFORE_EXPIRATION_SECONDS>0?p-n.REFRESH_BEFORE_EXPIRATION_SECONDS:p:t.DEFAULT_EXPIRATION_TIME_SECONDS;async function g(p,y,w){var E;let b=y,S;const R=w==null?void 0:w.refreshOptions;if(R!==void 0){const F=async()=>{var M,P,D,Y;try{const{accessToken:X,refreshToken:$,expiresIn:te}=await u(R,w.dpopKey,w.eventEmitter);b=X,$!==void 0&&(R.refreshToken=$),clearTimeout(S),S=setTimeout(F,d(te)*1e3),(M=w.eventEmitter)===null||M===void 0||M.emit(n.EVENTS.TIMEOUT_SET,S)}catch(X){X instanceof i.OidcProviderError&&((P=w==null?void 0:w.eventEmitter)===null||P===void 0||P.emit(n.EVENTS.ERROR,X.error,X.errorDescription),(D=w==null?void 0:w.eventEmitter)===null||D===void 0||D.emit(n.EVENTS.SESSION_EXPIRED)),X instanceof o.InvalidResponseError&&X.missingFields.includes("access_token")&&((Y=w==null?void 0:w.eventEmitter)===null||Y===void 0||Y.emit(n.EVENTS.SESSION_EXPIRED))}};S=setTimeout(F,d(w.expiresIn)*1e3),(E=w.eventEmitter)===null||E===void 0||E.emit(n.EVENTS.TIMEOUT_SET,S)}else if(w!==void 0&&w.eventEmitter!==void 0){const F=setTimeout(()=>{w.eventEmitter.emit(n.EVENTS.SESSION_EXPIRED)},d(w.expiresIn)*1e3);w.eventEmitter.emit(n.EVENTS.TIMEOUT_SET,F)}return async(F,M)=>{let P=await l(p,b,F,M,w==null?void 0:w.dpopKey);const D=!P.ok&&!s(P.status);return P.ok||D||P.url!==F&&(w==null?void 0:w.dpopKey)!==void 0&&(P=await l(p,b,P.url,M,w.dpopKey)),P}}t.buildAuthenticatedFetch=g})(l1);var u1={};(function(t){var e=Vt&&Vt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(t,"__esModule",{value:!0}),t.mockStorageUtility=t.mockStorage=t.StorageUtilityMock=t.StorageUtilityGetResponse=void 0;const n=e(Fo);t.StorageUtilityGetResponse="getResponse",t.StorageUtilityMock={get:async(o,s)=>t.StorageUtilityGetResponse,set:async(o,s)=>{},delete:async o=>{},getForUser:async(o,s,a)=>t.StorageUtilityGetResponse,setForUser:async(o,s,a)=>{},deleteForUser:async(o,s,a)=>{},deleteAllUserData:async(o,s)=>{}};const r=o=>{const s=o;return{get:async a=>{if(s[a]!==void 0)return typeof s[a]=="string"?s[a]:JSON.stringify(s[a])},set:async(a,c)=>{s[a]=c},delete:async a=>{delete s[a]}}};t.mockStorage=r;const i=(o,s=!1)=>s?new n.default((0,t.mockStorage)(o),(0,t.mockStorage)({})):new n.default((0,t.mockStorage)({}),(0,t.mockStorage)(o));t.mockStorageUtility=i})(u1);(function(t){var e=Vt&&Vt.__createBinding||(Object.create?function(S,R,F,M){M===void 0&&(M=F);var P=Object.getOwnPropertyDescriptor(R,F);(!P||("get"in P?!R.__esModule:P.writable||P.configurable))&&(P={enumerable:!0,get:function(){return R[F]}}),Object.defineProperty(S,M,P)}:function(S,R,F,M){M===void 0&&(M=F),S[M]=R[F]}),n=Vt&&Vt.__exportStar||function(S,R){for(var F in S)F!=="default"&&!Object.prototype.hasOwnProperty.call(R,F)&&e(R,S,F)},r=Vt&&Vt.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(t,"__esModule",{value:!0}),t.StorageUtilityGetResponse=t.StorageUtilityMock=t.mockStorageUtility=t.mockStorage=t.buildAuthenticatedFetch=t.generateDpopKeyPair=t.createDpopHeader=t.OidcProviderError=t.InvalidResponseError=t.NotImplementedError=t.ConfigurationError=t.InMemoryStorage=t.getSessionIdFromOauthState=t.saveSessionInfoToStorage=t.loadOidcContextFromStorage=t.StorageUtility=t.determineSigningAlg=t.handleRegistration=t.USER_SESSION_PREFIX=t.isSupportedTokenType=t.fetchJwks=t.getWebidFromTokenPayload=t.AggregateHandler=void 0,n(_i,t);var i=u0;Object.defineProperty(t,"AggregateHandler",{enumerable:!0,get:function(){return r(i).default}});var o=Rc;Object.defineProperty(t,"getWebidFromTokenPayload",{enumerable:!0,get:function(){return o.getWebidFromTokenPayload}}),Object.defineProperty(t,"fetchJwks",{enumerable:!0,get:function(){return o.fetchJwks}});var s=yf;Object.defineProperty(t,"isSupportedTokenType",{enumerable:!0,get:function(){return s.isSupportedTokenType}});var a=_f;Object.defineProperty(t,"USER_SESSION_PREFIX",{enumerable:!0,get:function(){return a.USER_SESSION_PREFIX}});var c=Fc;Object.defineProperty(t,"handleRegistration",{enumerable:!0,get:function(){return c.handleRegistration}}),Object.defineProperty(t,"determineSigningAlg",{enumerable:!0,get:function(){return c.determineSigningAlg}});var l=Fo;Object.defineProperty(t,"StorageUtility",{enumerable:!0,get:function(){return r(l).default}}),Object.defineProperty(t,"loadOidcContextFromStorage",{enumerable:!0,get:function(){return l.loadOidcContextFromStorage}}),Object.defineProperty(t,"saveSessionInfoToStorage",{enumerable:!0,get:function(){return l.saveSessionInfoToStorage}}),Object.defineProperty(t,"getSessionIdFromOauthState",{enumerable:!0,get:function(){return l.getSessionIdFromOauthState}});var u=T0;Object.defineProperty(t,"InMemoryStorage",{enumerable:!0,get:function(){return r(u).default}});var d=A0;Object.defineProperty(t,"ConfigurationError",{enumerable:!0,get:function(){return r(d).default}});var g=x0;Object.defineProperty(t,"NotImplementedError",{enumerable:!0,get:function(){return r(g).default}});var p=lu;Object.defineProperty(t,"InvalidResponseError",{enumerable:!0,get:function(){return p.InvalidResponseError}});var y=uu;Object.defineProperty(t,"OidcProviderError",{enumerable:!0,get:function(){return y.OidcProviderError}});var w=Ia;Object.defineProperty(t,"createDpopHeader",{enumerable:!0,get:function(){return w.createDpopHeader}}),Object.defineProperty(t,"generateDpopKeyPair",{enumerable:!0,get:function(){return w.generateDpopKeyPair}});var E=l1;Object.defineProperty(t,"buildAuthenticatedFetch",{enumerable:!0,get:function(){return E.buildAuthenticatedFetch}});var b=u1;Object.defineProperty(t,"mockStorage",{enumerable:!0,get:function(){return b.mockStorage}}),Object.defineProperty(t,"mockStorageUtility",{enumerable:!0,get:function(){return b.mockStorageUtility}}),Object.defineProperty(t,"StorageUtilityMock",{enumerable:!0,get:function(){return b.StorageUtilityMock}}),Object.defineProperty(t,"StorageUtilityGetResponse",{enumerable:!0,get:function(){return b.StorageUtilityGetResponse}})})(Kt);var du={},R0={};Object.defineProperty(R0,"__esModule",{value:!0});const FI=Kt;class DI extends FI.StorageUtility{constructor(e,n){super(e,n)}}R0.default=DI;var k0={},gi={exports:{}};(function(t,e){(function(r,i){t.exports=i()})(Vt,function(){return function(n){var r={};function i(o){if(r[o])return r[o].exports;var s=r[o]={i:o,l:!1,exports:{}};return n[o].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=n,i.c=r,i.d=function(o,s,a){i.o(o,s)||Object.defineProperty(o,s,{enumerable:!0,get:a})},i.r=function(o){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},i.t=function(o,s){if(1&s&&(o=i(o)),8&s||4&s&&typeof o=="object"&&o&&o.__esModule)return o;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:o}),2&s&&typeof o!="string")for(var c in o)i.d(a,c,function(l){return o[l]}.bind(null,c));return a},i.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(s,"a",s),s},i.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},i.p="",i(i.s=22)}([function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function l(u,d){for(var g=0;g<d.length;g++){var p=d[g];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(u,p.key,p)}}return function(u,d,g){return d&&l(u.prototype,d),g&&l(u,g),u}}(),s={debug:function(){},info:function(){},warn:function(){},error:function(){}},a=void 0,c=void 0;(r.Log=function(){function l(){(function(d,g){if(!(d instanceof g))throw new TypeError("Cannot call a class as a function")})(this,l)}return l.reset=function(){c=3,a=s},l.debug=function(){if(c>=4){for(var d=arguments.length,g=Array(d),p=0;p<d;p++)g[p]=arguments[p];a.debug.apply(a,Array.from(g))}},l.info=function(){if(c>=3){for(var d=arguments.length,g=Array(d),p=0;p<d;p++)g[p]=arguments[p];a.info.apply(a,Array.from(g))}},l.warn=function(){if(c>=2){for(var d=arguments.length,g=Array(d),p=0;p<d;p++)g[p]=arguments[p];a.warn.apply(a,Array.from(g))}},l.error=function(){if(c>=1){for(var d=arguments.length,g=Array(d),p=0;p<d;p++)g[p]=arguments[p];a.error.apply(a,Array.from(g))}},o(l,null,[{key:"NONE",get:function(){return 0}},{key:"ERROR",get:function(){return 1}},{key:"WARN",get:function(){return 2}},{key:"INFO",get:function(){return 3}},{key:"DEBUG",get:function(){return 4}},{key:"level",get:function(){return c},set:function(d){if(!(0<=d&&d<=4))throw new Error("Invalid log level");c=d}},{key:"logger",get:function(){return a},set:function(d){if(!d.debug&&d.info&&(d.debug=d.info),!(d.debug&&d.info&&d.warn&&d.error))throw new Error("Invalid logger");a=d}}]),l}()).reset()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function l(u,d){for(var g=0;g<d.length;g++){var p=d[g];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(u,p.key,p)}}return function(u,d,g){return d&&l(u.prototype,d),g&&l(u,g),u}}(),s={setInterval:function(l){function u(d,g){return l.apply(this,arguments)}return u.toString=function(){return l.toString()},u}(function(l,u){return setInterval(l,u)}),clearInterval:function(l){function u(d){return l.apply(this,arguments)}return u.toString=function(){return l.toString()},u}(function(l){return clearInterval(l)})},a=!1,c=null;r.Global=function(){function l(){(function(d,g){if(!(d instanceof g))throw new TypeError("Cannot call a class as a function")})(this,l)}return l._testing=function(){a=!0},l.setXMLHttpRequest=function(d){c=d},o(l,null,[{key:"location",get:function(){if(!a)return location}},{key:"localStorage",get:function(){if(!a&&typeof window!="undefined")return localStorage}},{key:"sessionStorage",get:function(){if(!a&&typeof window!="undefined")return sessionStorage}},{key:"XMLHttpRequest",get:function(){if(!a&&typeof window!="undefined")return c||XMLHttpRequest}},{key:"timer",get:function(){if(!a)return s}}]),l}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.MetadataService=void 0;var o=function(){function u(d,g){for(var p=0;p<g.length;p++){var y=g[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(d,y.key,y)}}return function(d,g,p){return g&&u(d.prototype,g),p&&u(d,p),d}}(),s=i(0),a=i(7);function c(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}var l=".well-known/openid-configuration";r.MetadataService=function(){function u(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a.JsonService;if(c(this,u),!d)throw s.Log.error("MetadataService: No settings passed to MetadataService"),new Error("settings");this._settings=d,this._jsonService=new g(["application/jwk-set+json"])}return u.prototype.resetSigningKeys=function(){this._settings=this._settings||{},this._settings.signingKeys=void 0},u.prototype.getMetadata=function(){var g=this;return this._settings.metadata?(s.Log.debug("MetadataService.getMetadata: Returning metadata from settings"),Promise.resolve(this._settings.metadata)):this.metadataUrl?(s.Log.debug("MetadataService.getMetadata: getting metadata from",this.metadataUrl),this._jsonService.getJson(this.metadataUrl).then(function(p){s.Log.debug("MetadataService.getMetadata: json received");var y=g._settings.metadataSeed||{};return g._settings.metadata=Object.assign({},y,p),g._settings.metadata})):(s.Log.error("MetadataService.getMetadata: No authority or metadataUrl configured on settings"),Promise.reject(new Error("No authority or metadataUrl configured on settings")))},u.prototype.getIssuer=function(){return this._getMetadataProperty("issuer")},u.prototype.getAuthorizationEndpoint=function(){return this._getMetadataProperty("authorization_endpoint")},u.prototype.getUserInfoEndpoint=function(){return this._getMetadataProperty("userinfo_endpoint")},u.prototype.getTokenEndpoint=function(){var g=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return this._getMetadataProperty("token_endpoint",g)},u.prototype.getCheckSessionIframe=function(){return this._getMetadataProperty("check_session_iframe",!0)},u.prototype.getEndSessionEndpoint=function(){return this._getMetadataProperty("end_session_endpoint",!0)},u.prototype.getRevocationEndpoint=function(){return this._getMetadataProperty("revocation_endpoint",!0)},u.prototype.getKeysEndpoint=function(){return this._getMetadataProperty("jwks_uri",!0)},u.prototype._getMetadataProperty=function(g){var p=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return s.Log.debug("MetadataService.getMetadataProperty for: "+g),this.getMetadata().then(function(y){if(s.Log.debug("MetadataService.getMetadataProperty: metadata recieved"),y[g]===void 0){if(p===!0)return void s.Log.warn("MetadataService.getMetadataProperty: Metadata does not contain optional property "+g);throw s.Log.error("MetadataService.getMetadataProperty: Metadata does not contain property "+g),new Error("Metadata does not contain property "+g)}return y[g]})},u.prototype.getSigningKeys=function(){var g=this;return this._settings.signingKeys?(s.Log.debug("MetadataService.getSigningKeys: Returning signingKeys from settings"),Promise.resolve(this._settings.signingKeys)):this._getMetadataProperty("jwks_uri").then(function(p){return s.Log.debug("MetadataService.getSigningKeys: jwks_uri received",p),g._jsonService.getJson(p).then(function(y){if(s.Log.debug("MetadataService.getSigningKeys: key set received",y),!y.keys)throw s.Log.error("MetadataService.getSigningKeys: Missing keys on keyset"),new Error("Missing keys on keyset");return g._settings.signingKeys=y.keys,g._settings.signingKeys})})},o(u,[{key:"metadataUrl",get:function(){return this._metadataUrl||(this._settings.metadataUrl?this._metadataUrl=this._settings.metadataUrl:(this._metadataUrl=this._settings.authority,this._metadataUrl&&this._metadataUrl.indexOf(l)<0&&(this._metadataUrl[this._metadataUrl.length-1]!=="/"&&(this._metadataUrl+="/"),this._metadataUrl+=l))),this._metadataUrl}}]),u}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.UrlUtility=void 0;var o=i(0),s=i(1);r.UrlUtility=function(){function a(){(function(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")})(this,a)}return a.addQueryParam=function(l,u,d){return l.indexOf("?")<0&&(l+="?"),l[l.length-1]!=="?"&&(l+="&"),l+=encodeURIComponent(u),l+="=",l+=encodeURIComponent(d)},a.parseUrlFragment=function(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#",d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:s.Global;typeof l!="string"&&(l=d.location.href);var g=l.lastIndexOf(u);g>=0&&(l=l.substr(g+1)),u==="?"&&(g=l.indexOf("#"))>=0&&(l=l.substr(0,g));for(var p,y={},w=/([^&=]+)=([^&]*)/g,E=0;p=w.exec(l);)if(y[decodeURIComponent(p[1])]=decodeURIComponent(p[2].replace(/\+/g," ")),E++>50)return o.Log.error("UrlUtility.parseUrlFragment: response exceeded expected number of parameters",l),{error:"Response exceeded expected number of parameters"};for(var b in y)return y;return{}},a}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.JoseUtil=void 0;var o=i(26),s=function(c){return c&&c.__esModule?c:{default:c}}(i(33));r.JoseUtil=(0,s.default)({jws:o.jws,KeyUtil:o.KeyUtil,X509:o.X509,crypto:o.crypto,hextob64u:o.hextob64u,b64tohex:o.b64tohex,AllowedSigningAlgs:o.AllowedSigningAlgs})},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.OidcClientSettings=void 0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},s=function(){function b(S,R){for(var F=0;F<R.length;F++){var M=R[F];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(S,M.key,M)}}return function(S,R,F){return R&&b(S.prototype,R),F&&b(S,F),S}}(),a=i(0),c=i(23),l=i(6),u=i(24),d=i(2);function g(b,S){if(!(b instanceof S))throw new TypeError("Cannot call a class as a function")}var p=".well-known/openid-configuration",y="id_token",w="openid",E="client_secret_post";r.OidcClientSettings=function(){function b(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},R=S.authority,F=S.metadataUrl,M=S.metadata,P=S.signingKeys,D=S.metadataSeed,Y=S.client_id,X=S.client_secret,$=S.response_type,te=$===void 0?y:$,_e=S.scope,Ae=_e===void 0?w:_e,re=S.redirect_uri,se=S.post_logout_redirect_uri,we=S.client_authentication,Ce=we===void 0?E:we,Ze=S.prompt,Ee=S.display,Ve=S.max_age,Ge=S.ui_locales,tt=S.acr_values,rn=S.resource,St=S.response_mode,cn=S.filterProtocolClaims,_r=cn===void 0||cn,Fn=S.loadUserInfo,ln=Fn===void 0||Fn,vn=S.staleStateAge,Mt=vn===void 0?900:vn,Q=S.clockSkew,N=Q===void 0?300:Q,O=S.clockService,z=O===void 0?new c.ClockService:O,ee=S.userInfoJwtIssuer,de=ee===void 0?"OP":ee,me=S.mergeClaims,Oe=me!==void 0&&me,nt=S.stateStore,xt=nt===void 0?new l.WebStorageStateStore:nt,ht=S.ResponseValidatorCtor,pt=ht===void 0?u.ResponseValidator:ht,wr=S.MetadataServiceCtor,Si=wr===void 0?d.MetadataService:wr,ke=S.extraQueryParams,un=ke===void 0?{}:ke,L=S.extraTokenParams,x=L===void 0?{}:L;g(this,b),this._authority=R,this._metadataUrl=F,this._metadata=M,this._metadataSeed=D,this._signingKeys=P,this._client_id=Y,this._client_secret=X,this._response_type=te,this._scope=Ae,this._redirect_uri=re,this._post_logout_redirect_uri=se,this._client_authentication=Ce,this._prompt=Ze,this._display=Ee,this._max_age=Ve,this._ui_locales=Ge,this._acr_values=tt,this._resource=rn,this._response_mode=St,this._filterProtocolClaims=!!_r,this._loadUserInfo=!!ln,this._staleStateAge=Mt,this._clockSkew=N,this._clockService=z,this._userInfoJwtIssuer=de,this._mergeClaims=!!Oe,this._stateStore=xt,this._validator=new pt(this),this._metadataService=new Si(this),this._extraQueryParams=(un===void 0?"undefined":o(un))==="object"?un:{},this._extraTokenParams=(x===void 0?"undefined":o(x))==="object"?x:{}}return b.prototype.getEpochTime=function(){return this._clockService.getEpochTime()},s(b,[{key:"client_id",get:function(){return this._client_id},set:function(R){if(this._client_id)throw a.Log.error("OidcClientSettings.set_client_id: client_id has already been assigned."),new Error("client_id has already been assigned.");this._client_id=R}},{key:"client_secret",get:function(){return this._client_secret}},{key:"response_type",get:function(){return this._response_type}},{key:"scope",get:function(){return this._scope}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"post_logout_redirect_uri",get:function(){return this._post_logout_redirect_uri}},{key:"client_authentication",get:function(){return this._client_authentication}},{key:"prompt",get:function(){return this._prompt}},{key:"display",get:function(){return this._display}},{key:"max_age",get:function(){return this._max_age}},{key:"ui_locales",get:function(){return this._ui_locales}},{key:"acr_values",get:function(){return this._acr_values}},{key:"resource",get:function(){return this._resource}},{key:"response_mode",get:function(){return this._response_mode}},{key:"authority",get:function(){return this._authority},set:function(R){if(this._authority)throw a.Log.error("OidcClientSettings.set_authority: authority has already been assigned."),new Error("authority has already been assigned.");this._authority=R}},{key:"metadataUrl",get:function(){return this._metadataUrl||(this._metadataUrl=this.authority,this._metadataUrl&&this._metadataUrl.indexOf(p)<0&&(this._metadataUrl[this._metadataUrl.length-1]!=="/"&&(this._metadataUrl+="/"),this._metadataUrl+=p)),this._metadataUrl}},{key:"metadata",get:function(){return this._metadata},set:function(R){this._metadata=R}},{key:"metadataSeed",get:function(){return this._metadataSeed},set:function(R){this._metadataSeed=R}},{key:"signingKeys",get:function(){return this._signingKeys},set:function(R){this._signingKeys=R}},{key:"filterProtocolClaims",get:function(){return this._filterProtocolClaims}},{key:"loadUserInfo",get:function(){return this._loadUserInfo}},{key:"staleStateAge",get:function(){return this._staleStateAge}},{key:"clockSkew",get:function(){return this._clockSkew}},{key:"userInfoJwtIssuer",get:function(){return this._userInfoJwtIssuer}},{key:"mergeClaims",get:function(){return this._mergeClaims}},{key:"stateStore",get:function(){return this._stateStore}},{key:"validator",get:function(){return this._validator}},{key:"metadataService",get:function(){return this._metadataService}},{key:"extraQueryParams",get:function(){return this._extraQueryParams},set:function(R){(R===void 0?"undefined":o(R))==="object"?this._extraQueryParams=R:this._extraQueryParams={}}},{key:"extraTokenParams",get:function(){return this._extraTokenParams},set:function(R){(R===void 0?"undefined":o(R))==="object"?this._extraTokenParams=R:this._extraTokenParams={}}}]),b}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.WebStorageStateStore=void 0;var o=i(0),s=i(1);function a(c,l){if(!(c instanceof l))throw new TypeError("Cannot call a class as a function")}r.WebStorageStateStore=function(){function c(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=l.prefix,d=u===void 0?"oidc.":u,g=l.store,p=g===void 0?s.Global.localStorage:g;a(this,c),this._store=p,this._prefix=d}return c.prototype.set=function(u,d){return o.Log.debug("WebStorageStateStore.set",u),u=this._prefix+u,this._store.setItem(u,d),Promise.resolve()},c.prototype.get=function(u){o.Log.debug("WebStorageStateStore.get",u),u=this._prefix+u;var d=this._store.getItem(u);return Promise.resolve(d)},c.prototype.remove=function(u){o.Log.debug("WebStorageStateStore.remove",u),u=this._prefix+u;var d=this._store.getItem(u);return this._store.removeItem(u),Promise.resolve(d)},c.prototype.getAllKeys=function(){o.Log.debug("WebStorageStateStore.getAllKeys");for(var u=[],d=0;d<this._store.length;d++){var g=this._store.key(d);g.indexOf(this._prefix)===0&&u.push(g.substr(this._prefix.length))}return Promise.resolve(u)},c}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.JsonService=void 0;var o=i(0),s=i(1);function a(c,l){if(!(c instanceof l))throw new TypeError("Cannot call a class as a function")}r.JsonService=function(){function c(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s.Global.XMLHttpRequest,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;a(this,c),l&&Array.isArray(l)?this._contentTypes=l.slice():this._contentTypes=[],this._contentTypes.push("application/json"),d&&this._contentTypes.push("application/jwt"),this._XMLHttpRequest=u,this._jwtHandler=d}return c.prototype.getJson=function(u,d){var g=this;if(!u)throw o.Log.error("JsonService.getJson: No url passed"),new Error("url");return o.Log.debug("JsonService.getJson, url: ",u),new Promise(function(p,y){var w=new g._XMLHttpRequest;w.open("GET",u);var E=g._contentTypes,b=g._jwtHandler;w.onload=function(){if(o.Log.debug("JsonService.getJson: HTTP response received, status",w.status),w.status===200){var S=w.getResponseHeader("Content-Type");if(S){var R=E.find(function(F){if(S.startsWith(F))return!0});if(R=="application/jwt")return void b(w).then(p,y);if(R)try{return void p(JSON.parse(w.responseText))}catch(F){return o.Log.error("JsonService.getJson: Error parsing JSON response",F.message),void y(F)}}y(Error("Invalid response Content-Type: "+S+", from URL: "+u))}else y(Error(w.statusText+" ("+w.status+")"))},w.onerror=function(){o.Log.error("JsonService.getJson: network error"),y(Error("Network Error"))},d&&(o.Log.debug("JsonService.getJson: token passed, setting Authorization header"),w.setRequestHeader("Authorization","Bearer "+d)),w.send()})},c.prototype.postForm=function(u,d,g){var p=this;if(!u)throw o.Log.error("JsonService.postForm: No url passed"),new Error("url");return o.Log.debug("JsonService.postForm, url: ",u),new Promise(function(y,w){var E=new p._XMLHttpRequest;E.open("POST",u);var b=p._contentTypes;E.onload=function(){if(o.Log.debug("JsonService.postForm: HTTP response received, status",E.status),E.status!==200){if(E.status===400&&(P=E.getResponseHeader("Content-Type"))&&b.find(function(D){if(P.startsWith(D))return!0}))try{var M=JSON.parse(E.responseText);if(M&&M.error)return o.Log.error("JsonService.postForm: Error from server: ",M.error),void w(new Error(M.error))}catch(D){return o.Log.error("JsonService.postForm: Error parsing JSON response",D.message),void w(D)}w(Error(E.statusText+" ("+E.status+")"))}else{var P;if((P=E.getResponseHeader("Content-Type"))&&b.find(function(D){if(P.startsWith(D))return!0}))try{return void y(JSON.parse(E.responseText))}catch(D){return o.Log.error("JsonService.postForm: Error parsing JSON response",D.message),void w(D)}w(Error("Invalid response Content-Type: "+P+", from URL: "+u))}},E.onerror=function(){o.Log.error("JsonService.postForm: network error"),w(Error("Network Error"))};var S="";for(var R in d){var F=d[R];F&&(S.length>0&&(S+="&"),S+=encodeURIComponent(R),S+="=",S+=encodeURIComponent(F))}E.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),g!==void 0&&E.setRequestHeader("Authorization","Basic "+btoa(g)),E.send(S)})},c}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.SigninRequest=void 0;var o=i(0),s=i(3),a=i(13);r.SigninRequest=function(){function c(l){var u=l.url,d=l.client_id,g=l.redirect_uri,p=l.response_type,y=l.scope,w=l.authority,E=l.data,b=l.prompt,S=l.display,R=l.max_age,F=l.ui_locales,M=l.id_token_hint,P=l.login_hint,D=l.acr_values,Y=l.resource,X=l.response_mode,$=l.request,te=l.request_uri,_e=l.extraQueryParams,Ae=l.request_type,re=l.client_secret,se=l.extraTokenParams,we=l.skipUserInfo;if(function(rn,St){if(!(rn instanceof St))throw new TypeError("Cannot call a class as a function")}(this,c),!u)throw o.Log.error("SigninRequest.ctor: No url passed"),new Error("url");if(!d)throw o.Log.error("SigninRequest.ctor: No client_id passed"),new Error("client_id");if(!g)throw o.Log.error("SigninRequest.ctor: No redirect_uri passed"),new Error("redirect_uri");if(!p)throw o.Log.error("SigninRequest.ctor: No response_type passed"),new Error("response_type");if(!y)throw o.Log.error("SigninRequest.ctor: No scope passed"),new Error("scope");if(!w)throw o.Log.error("SigninRequest.ctor: No authority passed"),new Error("authority");var Ce=c.isOidc(p),Ze=c.isCode(p);X||(X=c.isCode(p)?"query":null),this.state=new a.SigninState({nonce:Ce,data:E,client_id:d,authority:w,redirect_uri:g,code_verifier:Ze,request_type:Ae,response_mode:X,client_secret:re,scope:y,extraTokenParams:se,skipUserInfo:we}),u=s.UrlUtility.addQueryParam(u,"client_id",d),u=s.UrlUtility.addQueryParam(u,"redirect_uri",g),u=s.UrlUtility.addQueryParam(u,"response_type",p),u=s.UrlUtility.addQueryParam(u,"scope",y),u=s.UrlUtility.addQueryParam(u,"state",this.state.id),Ce&&(u=s.UrlUtility.addQueryParam(u,"nonce",this.state.nonce)),Ze&&(u=s.UrlUtility.addQueryParam(u,"code_challenge",this.state.code_challenge),u=s.UrlUtility.addQueryParam(u,"code_challenge_method","S256"));var Ee={prompt:b,display:S,max_age:R,ui_locales:F,id_token_hint:M,login_hint:P,acr_values:D,resource:Y,request:$,request_uri:te,response_mode:X};for(var Ve in Ee)Ee[Ve]&&(u=s.UrlUtility.addQueryParam(u,Ve,Ee[Ve]));for(var Ge in _e)u=s.UrlUtility.addQueryParam(u,Ge,_e[Ge]);this.url=u}return c.isOidc=function(u){return!!u.split(/\s+/g).filter(function(d){return d==="id_token"})[0]},c.isOAuth=function(u){return!!u.split(/\s+/g).filter(function(d){return d==="token"})[0]},c.isCode=function(u){return!!u.split(/\s+/g).filter(function(d){return d==="code"})[0]},c}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.State=void 0;var o=function(){function l(u,d){for(var g=0;g<d.length;g++){var p=d[g];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(u,p.key,p)}}return function(u,d,g){return d&&l(u.prototype,d),g&&l(u,g),u}}(),s=i(0),a=function(u){return u&&u.__esModule?u:{default:u}}(i(14));function c(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}r.State=function(){function l(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=u.id,g=u.data,p=u.created,y=u.request_type;c(this,l),this._id=d||(0,a.default)(),this._data=g,this._created=typeof p=="number"&&p>0?p:parseInt(Date.now()/1e3),this._request_type=y}return l.prototype.toStorageString=function(){return s.Log.debug("State.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})},l.fromStorageString=function(d){return s.Log.debug("State.fromStorageString"),new l(JSON.parse(d))},l.clearStaleState=function(d,g){var p=Date.now()/1e3-g;return d.getAllKeys().then(function(y){s.Log.debug("State.clearStaleState: got keys",y);for(var w=[],E=function(F){var M=y[F];S=d.get(M).then(function(P){var D=!1;if(P)try{var Y=l.fromStorageString(P);s.Log.debug("State.clearStaleState: got item from key: ",M,Y.created),Y.created<=p&&(D=!0)}catch(X){s.Log.error("State.clearStaleState: Error parsing state for key",M,X.message),D=!0}else s.Log.debug("State.clearStaleState: no item in storage for key: ",M),D=!0;if(D)return s.Log.debug("State.clearStaleState: removed item for key: ",M),d.remove(M)}),w.push(S)},b=0;b<y.length;b++){var S;E(b)}return s.Log.debug("State.clearStaleState: waiting on promise count:",w.length),Promise.all(w)})},o(l,[{key:"id",get:function(){return this._id}},{key:"data",get:function(){return this._data}},{key:"created",get:function(){return this._created}},{key:"request_type",get:function(){return this._request_type}}]),l}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.OidcClient=void 0;var o=function(){function E(b,S){for(var R=0;R<S.length;R++){var F=S[R];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(b,F.key,F)}}return function(b,S,R){return S&&E(b.prototype,S),R&&E(b,R),b}}(),s=i(0),a=i(5),c=i(12),l=i(8),u=i(34),d=i(35),g=i(36),p=i(13),y=i(9);function w(E,b){if(!(E instanceof b))throw new TypeError("Cannot call a class as a function")}r.OidcClient=function(){function E(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};w(this,E),b instanceof a.OidcClientSettings?this._settings=b:this._settings=new a.OidcClientSettings(b)}return E.prototype.createSigninRequest=function(){var S=this,R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},F=R.response_type,M=R.scope,P=R.redirect_uri,D=R.data,Y=R.state,X=R.prompt,$=R.display,te=R.max_age,_e=R.ui_locales,Ae=R.id_token_hint,re=R.login_hint,se=R.acr_values,we=R.resource,Ce=R.request,Ze=R.request_uri,Ee=R.response_mode,Ve=R.extraQueryParams,Ge=R.extraTokenParams,tt=R.request_type,rn=R.skipUserInfo,St=arguments[1];s.Log.debug("OidcClient.createSigninRequest");var cn=this._settings.client_id;F=F||this._settings.response_type,M=M||this._settings.scope,P=P||this._settings.redirect_uri,X=X||this._settings.prompt,$=$||this._settings.display,te=te||this._settings.max_age,_e=_e||this._settings.ui_locales,se=se||this._settings.acr_values,we=we||this._settings.resource,Ee=Ee||this._settings.response_mode,Ve=Ve||this._settings.extraQueryParams,Ge=Ge||this._settings.extraTokenParams;var _r=this._settings.authority;return l.SigninRequest.isCode(F)&&F!=="code"?Promise.reject(new Error("OpenID Connect hybrid flow is not supported")):this._metadataService.getAuthorizationEndpoint().then(function(Fn){s.Log.debug("OidcClient.createSigninRequest: Received authorization endpoint",Fn);var ln=new l.SigninRequest({url:Fn,client_id:cn,redirect_uri:P,response_type:F,scope:M,data:D||Y,authority:_r,prompt:X,display:$,max_age:te,ui_locales:_e,id_token_hint:Ae,login_hint:re,acr_values:se,resource:we,request:Ce,request_uri:Ze,extraQueryParams:Ve,extraTokenParams:Ge,request_type:tt,response_mode:Ee,client_secret:S._settings.client_secret,skipUserInfo:rn}),vn=ln.state;return(St=St||S._stateStore).set(vn.id,vn.toStorageString()).then(function(){return ln})})},E.prototype.readSigninResponseState=function(S,R){var F=arguments.length>2&&arguments[2]!==void 0&&arguments[2];s.Log.debug("OidcClient.readSigninResponseState");var M=this._settings.response_mode==="query"||!this._settings.response_mode&&l.SigninRequest.isCode(this._settings.response_type),P=M?"?":"#",D=new u.SigninResponse(S,P);if(!D.state)return s.Log.error("OidcClient.readSigninResponseState: No state in response"),Promise.reject(new Error("No state in response"));R=R||this._stateStore;var Y=F?R.remove.bind(R):R.get.bind(R);return Y(D.state).then(function(X){if(!X)throw s.Log.error("OidcClient.readSigninResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:p.SigninState.fromStorageString(X),response:D}})},E.prototype.processSigninResponse=function(S,R){var F=this;return s.Log.debug("OidcClient.processSigninResponse"),this.readSigninResponseState(S,R,!0).then(function(M){var P=M.state,D=M.response;return s.Log.debug("OidcClient.processSigninResponse: Received state from storage; validating response"),F._validator.validateSigninResponse(P,D)})},E.prototype.createSignoutRequest=function(){var S=this,R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},F=R.id_token_hint,M=R.data,P=R.state,D=R.post_logout_redirect_uri,Y=R.extraQueryParams,X=R.request_type,$=arguments[1];return s.Log.debug("OidcClient.createSignoutRequest"),D=D||this._settings.post_logout_redirect_uri,Y=Y||this._settings.extraQueryParams,this._metadataService.getEndSessionEndpoint().then(function(te){if(!te)throw s.Log.error("OidcClient.createSignoutRequest: No end session endpoint url returned"),new Error("no end session endpoint");s.Log.debug("OidcClient.createSignoutRequest: Received end session endpoint",te);var _e=new d.SignoutRequest({url:te,id_token_hint:F,post_logout_redirect_uri:D,data:M||P,extraQueryParams:Y,request_type:X}),Ae=_e.state;return Ae&&(s.Log.debug("OidcClient.createSignoutRequest: Signout request has state to persist"),($=$||S._stateStore).set(Ae.id,Ae.toStorageString())),_e})},E.prototype.readSignoutResponseState=function(S,R){var F=arguments.length>2&&arguments[2]!==void 0&&arguments[2];s.Log.debug("OidcClient.readSignoutResponseState");var M=new g.SignoutResponse(S);if(!M.state)return s.Log.debug("OidcClient.readSignoutResponseState: No state in response"),M.error?(s.Log.warn("OidcClient.readSignoutResponseState: Response was error: ",M.error),Promise.reject(new c.ErrorResponse(M))):Promise.resolve({state:void 0,response:M});var P=M.state;R=R||this._stateStore;var D=F?R.remove.bind(R):R.get.bind(R);return D(P).then(function(Y){if(!Y)throw s.Log.error("OidcClient.readSignoutResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:y.State.fromStorageString(Y),response:M}})},E.prototype.processSignoutResponse=function(S,R){var F=this;return s.Log.debug("OidcClient.processSignoutResponse"),this.readSignoutResponseState(S,R,!0).then(function(M){var P=M.state,D=M.response;return P?(s.Log.debug("OidcClient.processSignoutResponse: Received state from storage; validating response"),F._validator.validateSignoutResponse(P,D)):(s.Log.debug("OidcClient.processSignoutResponse: No state from storage; skipping validating response"),D)})},E.prototype.clearStaleState=function(S){return s.Log.debug("OidcClient.clearStaleState"),S=S||this._stateStore,y.State.clearStaleState(S,this.settings.staleStateAge)},o(E,[{key:"_stateStore",get:function(){return this.settings.stateStore}},{key:"_validator",get:function(){return this.settings.validator}},{key:"_metadataService",get:function(){return this.settings.metadataService}},{key:"settings",get:function(){return this._settings}},{key:"metadataService",get:function(){return this._metadataService}}]),E}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.TokenClient=void 0;var o=i(7),s=i(2),a=i(0);function c(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}r.TokenClient=function(){function l(u){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o.JsonService,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:s.MetadataService;if(c(this,l),!u)throw a.Log.error("TokenClient.ctor: No settings passed"),new Error("settings");this._settings=u,this._jsonService=new d,this._metadataService=new g(this._settings)}return l.prototype.exchangeCode=function(){var d=this,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(g=Object.assign({},g)).grant_type=g.grant_type||"authorization_code",g.client_id=g.client_id||this._settings.client_id,g.client_secret=g.client_secret||this._settings.client_secret,g.redirect_uri=g.redirect_uri||this._settings.redirect_uri;var p=void 0,y=g._client_authentication||this._settings._client_authentication;return delete g._client_authentication,g.code?g.redirect_uri?g.code_verifier?g.client_id?g.client_secret||y!="client_secret_basic"?(y=="client_secret_basic"&&(p=g.client_id+":"+g.client_secret,delete g.client_id,delete g.client_secret),this._metadataService.getTokenEndpoint(!1).then(function(w){return a.Log.debug("TokenClient.exchangeCode: Received token endpoint"),d._jsonService.postForm(w,g,p).then(function(E){return a.Log.debug("TokenClient.exchangeCode: response received"),E})})):(a.Log.error("TokenClient.exchangeCode: No client_secret passed"),Promise.reject(new Error("A client_secret is required"))):(a.Log.error("TokenClient.exchangeCode: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(a.Log.error("TokenClient.exchangeCode: No code_verifier passed"),Promise.reject(new Error("A code_verifier is required"))):(a.Log.error("TokenClient.exchangeCode: No redirect_uri passed"),Promise.reject(new Error("A redirect_uri is required"))):(a.Log.error("TokenClient.exchangeCode: No code passed"),Promise.reject(new Error("A code is required")))},l.prototype.exchangeRefreshToken=function(){var d=this,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(g=Object.assign({},g)).grant_type=g.grant_type||"refresh_token",g.client_id=g.client_id||this._settings.client_id,g.client_secret=g.client_secret||this._settings.client_secret;var p=void 0,y=g._client_authentication||this._settings._client_authentication;return delete g._client_authentication,g.refresh_token?g.client_id?(y=="client_secret_basic"&&(p=g.client_id+":"+g.client_secret,delete g.client_id,delete g.client_secret),this._metadataService.getTokenEndpoint(!1).then(function(w){return a.Log.debug("TokenClient.exchangeRefreshToken: Received token endpoint"),d._jsonService.postForm(w,g,p).then(function(E){return a.Log.debug("TokenClient.exchangeRefreshToken: response received"),E})})):(a.Log.error("TokenClient.exchangeRefreshToken: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(a.Log.error("TokenClient.exchangeRefreshToken: No refresh_token passed"),Promise.reject(new Error("A refresh_token is required")))},l}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.ErrorResponse=void 0;var o=i(0);function s(c,l){if(!(c instanceof l))throw new TypeError("Cannot call a class as a function")}function a(c,l){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!l||typeof l!="object"&&typeof l!="function"?c:l}r.ErrorResponse=function(c){function l(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=u.error,g=u.error_description,p=u.error_uri,y=u.state,w=u.session_state;if(s(this,l),!d)throw o.Log.error("No error passed to ErrorResponse"),new Error("error");var E=a(this,c.call(this,g||d));return E.name="ErrorResponse",E.error=d,E.error_description=g,E.error_uri=p,E.state=y,E.session_state=w,E}return function(d,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);d.prototype=Object.create(g&&g.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(d,g):d.__proto__=g)}(l,c),l}(Error)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.SigninState=void 0;var o=function(){function g(p,y){for(var w=0;w<y.length;w++){var E=y[w];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(p,E.key,E)}}return function(p,y,w){return y&&g(p.prototype,y),w&&g(p,w),p}}(),s=i(0),a=i(9),c=i(4),l=function(p){return p&&p.__esModule?p:{default:p}}(i(14));function u(g,p){if(!(g instanceof p))throw new TypeError("Cannot call a class as a function")}function d(g,p){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!p||typeof p!="object"&&typeof p!="function"?g:p}r.SigninState=function(g){function p(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},w=y.nonce,E=y.authority,b=y.client_id,S=y.redirect_uri,R=y.code_verifier,F=y.response_mode,M=y.client_secret,P=y.scope,D=y.extraTokenParams,Y=y.skipUserInfo;u(this,p);var X=d(this,g.call(this,arguments[0]));if(w===!0?X._nonce=(0,l.default)():w&&(X._nonce=w),R===!0?X._code_verifier=(0,l.default)()+(0,l.default)()+(0,l.default)():R&&(X._code_verifier=R),X.code_verifier){var $=c.JoseUtil.hashString(X.code_verifier,"SHA256");X._code_challenge=c.JoseUtil.hexToBase64Url($)}return X._redirect_uri=S,X._authority=E,X._client_id=b,X._response_mode=F,X._client_secret=M,X._scope=P,X._extraTokenParams=D,X._skipUserInfo=Y,X}return function(w,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);w.prototype=Object.create(E&&E.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(w,E):w.__proto__=E)}(p,g),p.prototype.toStorageString=function(){return s.Log.debug("SigninState.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,nonce:this.nonce,code_verifier:this.code_verifier,redirect_uri:this.redirect_uri,authority:this.authority,client_id:this.client_id,response_mode:this.response_mode,client_secret:this.client_secret,scope:this.scope,extraTokenParams:this.extraTokenParams,skipUserInfo:this.skipUserInfo})},p.fromStorageString=function(w){return s.Log.debug("SigninState.fromStorageString"),new p(JSON.parse(w))},o(p,[{key:"nonce",get:function(){return this._nonce}},{key:"authority",get:function(){return this._authority}},{key:"client_id",get:function(){return this._client_id}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"code_verifier",get:function(){return this._code_verifier}},{key:"code_challenge",get:function(){return this._code_challenge}},{key:"response_mode",get:function(){return this._response_mode}},{key:"client_secret",get:function(){return this._client_secret}},{key:"scope",get:function(){return this._scope}},{key:"extraTokenParams",get:function(){return this._extraTokenParams}},{key:"skipUserInfo",get:function(){return this._skipUserInfo}}]),p}(a.State)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return(o!="undefined"&&o!==null&&o.getRandomValues!==void 0?s:a)().replace(/-/g,"")};var o=typeof window!="undefined"?window.crypto||window.msCrypto:null;function s(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(c){return(c^o.getRandomValues(new Uint8Array(1))[0]&15>>c/4).toString(16)})}function a(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(c){return(c^16*Math.random()>>c/4).toString(16)})}n.exports=r.default},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.User=void 0;var o=function(){function a(c,l){for(var u=0;u<l.length;u++){var d=l[u];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}return function(c,l,u){return l&&a(c.prototype,l),u&&a(c,u),c}}(),s=i(0);r.User=function(){function a(c){var l=c.id_token,u=c.session_state,d=c.access_token,g=c.refresh_token,p=c.token_type,y=c.scope,w=c.profile,E=c.expires_at,b=c.state;(function(R,F){if(!(R instanceof F))throw new TypeError("Cannot call a class as a function")})(this,a),this.id_token=l,this.session_state=u,this.access_token=d,this.refresh_token=g,this.token_type=p,this.scope=y,this.profile=w,this.expires_at=E,this.state=b}return a.prototype.toStorageString=function(){return s.Log.debug("User.toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})},a.fromStorageString=function(l){return s.Log.debug("User.fromStorageString"),new a(JSON.parse(l))},o(a,[{key:"expires_in",get:function(){if(this.expires_at){var l=parseInt(Date.now()/1e3);return this.expires_at-l}},set:function(l){var u=parseInt(l);if(typeof u=="number"&&u>0){var d=parseInt(Date.now()/1e3);this.expires_at=d+u}}},{key:"expired",get:function(){var l=this.expires_in;if(l!==void 0)return l<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}}]),a}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.AccessTokenEvents=void 0;var o=i(0),s=i(46);function a(c,l){if(!(c instanceof l))throw new TypeError("Cannot call a class as a function")}r.AccessTokenEvents=function(){function c(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=l.accessTokenExpiringNotificationTime,d=u===void 0?60:u,g=l.accessTokenExpiringTimer,p=g===void 0?new s.Timer("Access token expiring"):g,y=l.accessTokenExpiredTimer,w=y===void 0?new s.Timer("Access token expired"):y;a(this,c),this._accessTokenExpiringNotificationTime=d,this._accessTokenExpiring=p,this._accessTokenExpired=w}return c.prototype.load=function(u){if(u.access_token&&u.expires_in!==void 0){var d=u.expires_in;if(o.Log.debug("AccessTokenEvents.load: access token present, remaining duration:",d),d>0){var g=d-this._accessTokenExpiringNotificationTime;g<=0&&(g=1),o.Log.debug("AccessTokenEvents.load: registering expiring timer in:",g),this._accessTokenExpiring.init(g)}else o.Log.debug("AccessTokenEvents.load: canceling existing expiring timer becase we're past expiration."),this._accessTokenExpiring.cancel();var p=d+1;o.Log.debug("AccessTokenEvents.load: registering expired timer in:",p),this._accessTokenExpired.init(p)}else this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},c.prototype.unload=function(){o.Log.debug("AccessTokenEvents.unload: canceling existing access token timers"),this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},c.prototype.addAccessTokenExpiring=function(u){this._accessTokenExpiring.addHandler(u)},c.prototype.removeAccessTokenExpiring=function(u){this._accessTokenExpiring.removeHandler(u)},c.prototype.addAccessTokenExpired=function(u){this._accessTokenExpired.addHandler(u)},c.prototype.removeAccessTokenExpired=function(u){this._accessTokenExpired.removeHandler(u)},c}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.Event=void 0;var o=i(0);r.Event=function(){function s(a){(function(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")})(this,s),this._name=a,this._callbacks=[]}return s.prototype.addHandler=function(c){this._callbacks.push(c)},s.prototype.removeHandler=function(c){var l=this._callbacks.findIndex(function(u){return u===c});l>=0&&this._callbacks.splice(l,1)},s.prototype.raise=function(){o.Log.debug("Event: Raising event: "+this._name);for(var c=0;c<this._callbacks.length;c++){var l;(l=this._callbacks)[c].apply(l,arguments)}},s}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.SessionMonitor=void 0;var o=function(){function u(d,g){for(var p=0;p<g.length;p++){var y=g[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(d,y.key,y)}}return function(d,g,p){return g&&u(d.prototype,g),p&&u(d,p),d}}(),s=i(0),a=i(19),c=i(1);function l(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}r.SessionMonitor=function(){function u(d){var g=this,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a.CheckSessionIFrame,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:c.Global.timer;if(l(this,u),!d)throw s.Log.error("SessionMonitor.ctor: No user manager passed to SessionMonitor"),new Error("userManager");this._userManager=d,this._CheckSessionIFrameCtor=p,this._timer=y,this._userManager.events.addUserLoaded(this._start.bind(this)),this._userManager.events.addUserUnloaded(this._stop.bind(this)),Promise.resolve(this._userManager.getUser().then(function(w){w?g._start(w):g._settings.monitorAnonymousSession&&g._userManager.querySessionStatus().then(function(E){var b={session_state:E.session_state};E.sub&&E.sid&&(b.profile={sub:E.sub,sid:E.sid}),g._start(b)}).catch(function(E){s.Log.error("SessionMonitor ctor: error from querySessionStatus:",E.message)})}).catch(function(w){s.Log.error("SessionMonitor ctor: error from getUser:",w.message)}))}return u.prototype._start=function(g){var p=this,y=g.session_state;y&&(g.profile?(this._sub=g.profile.sub,this._sid=g.profile.sid,s.Log.debug("SessionMonitor._start: session_state:",y,", sub:",this._sub)):(this._sub=void 0,this._sid=void 0,s.Log.debug("SessionMonitor._start: session_state:",y,", anonymous user")),this._checkSessionIFrame?this._checkSessionIFrame.start(y):this._metadataService.getCheckSessionIframe().then(function(w){if(w){s.Log.debug("SessionMonitor._start: Initializing check session iframe");var E=p._client_id,b=p._checkSessionInterval,S=p._stopCheckSessionOnError;p._checkSessionIFrame=new p._CheckSessionIFrameCtor(p._callback.bind(p),E,w,b,S),p._checkSessionIFrame.load().then(function(){p._checkSessionIFrame.start(y)})}else s.Log.warn("SessionMonitor._start: No check session iframe found in the metadata")}).catch(function(w){s.Log.error("SessionMonitor._start: Error from getCheckSessionIframe:",w.message)}))},u.prototype._stop=function(){var g=this;if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&(s.Log.debug("SessionMonitor._stop"),this._checkSessionIFrame.stop()),this._settings.monitorAnonymousSession)var p=this._timer.setInterval(function(){g._timer.clearInterval(p),g._userManager.querySessionStatus().then(function(y){var w={session_state:y.session_state};y.sub&&y.sid&&(w.profile={sub:y.sub,sid:y.sid}),g._start(w)}).catch(function(y){s.Log.error("SessionMonitor: error from querySessionStatus:",y.message)})},1e3)},u.prototype._callback=function(){var g=this;this._userManager.querySessionStatus().then(function(p){var y=!0;p?p.sub===g._sub?(y=!1,g._checkSessionIFrame.start(p.session_state),p.sid===g._sid?s.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, restarting check session iframe; session_state:",p.session_state):(s.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, session state has changed, restarting check session iframe; session_state:",p.session_state),g._userManager.events._raiseUserSessionChanged())):s.Log.debug("SessionMonitor._callback: Different subject signed into OP:",p.sub):s.Log.debug("SessionMonitor._callback: Subject no longer signed into OP"),y&&(g._sub?(s.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed out event"),g._userManager.events._raiseUserSignedOut()):(s.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed in event"),g._userManager.events._raiseUserSignedIn()))}).catch(function(p){g._sub&&(s.Log.debug("SessionMonitor._callback: Error calling queryCurrentSigninSession; raising signed out event",p.message),g._userManager.events._raiseUserSignedOut())})},o(u,[{key:"_settings",get:function(){return this._userManager.settings}},{key:"_metadataService",get:function(){return this._userManager.metadataService}},{key:"_client_id",get:function(){return this._settings.client_id}},{key:"_checkSessionInterval",get:function(){return this._settings.checkSessionInterval}},{key:"_stopCheckSessionOnError",get:function(){return this._settings.stopCheckSessionOnError}}]),u}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.CheckSessionIFrame=void 0;var o=i(0);function s(a,c){if(!(a instanceof c))throw new TypeError("Cannot call a class as a function")}r.CheckSessionIFrame=function(){function a(c,l,u,d){var g=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];s(this,a),this._callback=c,this._client_id=l,this._url=u,this._interval=d||2e3,this._stopOnError=g;var p=u.indexOf("/",u.indexOf("//")+2);this._frame_origin=u.substr(0,p),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.width=0,this._frame.height=0,this._frame.src=u}return a.prototype.load=function(){var l=this;return new Promise(function(u){l._frame.onload=function(){u()},window.document.body.appendChild(l._frame),l._boundMessageEvent=l._message.bind(l),window.addEventListener("message",l._boundMessageEvent,!1)})},a.prototype._message=function(l){l.origin===this._frame_origin&&l.source===this._frame.contentWindow&&(l.data==="error"?(o.Log.error("CheckSessionIFrame: error message from check session op iframe"),this._stopOnError&&this.stop()):l.data==="changed"?(o.Log.debug("CheckSessionIFrame: changed message from check session op iframe"),this.stop(),this._callback()):o.Log.debug("CheckSessionIFrame: "+l.data+" message from check session op iframe"))},a.prototype.start=function(l){var u=this;if(this._session_state!==l){o.Log.debug("CheckSessionIFrame.start"),this.stop(),this._session_state=l;var d=function(){u._frame.contentWindow.postMessage(u._client_id+" "+u._session_state,u._frame_origin)};d(),this._timer=window.setInterval(d,this._interval)}},a.prototype.stop=function(){this._session_state=null,this._timer&&(o.Log.debug("CheckSessionIFrame.stop"),window.clearInterval(this._timer),this._timer=null)},a}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.TokenRevocationClient=void 0;var o=i(0),s=i(2),a=i(1);function c(d,g){if(!(d instanceof g))throw new TypeError("Cannot call a class as a function")}var l="access_token",u="refresh_token";r.TokenRevocationClient=function(){function d(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a.Global.XMLHttpRequest,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:s.MetadataService;if(c(this,d),!g)throw o.Log.error("TokenRevocationClient.ctor: No settings provided"),new Error("No settings provided.");this._settings=g,this._XMLHttpRequestCtor=p,this._metadataService=new y(this._settings)}return d.prototype.revoke=function(p,y){var w=this,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"access_token";if(!p)throw o.Log.error("TokenRevocationClient.revoke: No token provided"),new Error("No token provided.");if(E!==l&&E!=u)throw o.Log.error("TokenRevocationClient.revoke: Invalid token type"),new Error("Invalid token type.");return this._metadataService.getRevocationEndpoint().then(function(b){if(b){o.Log.debug("TokenRevocationClient.revoke: Revoking "+E);var S=w._settings.client_id,R=w._settings.client_secret;return w._revoke(b,S,R,p,E)}if(y)throw o.Log.error("TokenRevocationClient.revoke: Revocation not supported"),new Error("Revocation not supported")})},d.prototype._revoke=function(p,y,w,E,b){var S=this;return new Promise(function(R,F){var M=new S._XMLHttpRequestCtor;M.open("POST",p),M.onload=function(){o.Log.debug("TokenRevocationClient.revoke: HTTP response received, status",M.status),M.status===200?R():F(Error(M.statusText+" ("+M.status+")"))},M.onerror=function(){o.Log.debug("TokenRevocationClient.revoke: Network Error."),F("Network Error")};var P="client_id="+encodeURIComponent(y);w&&(P+="&client_secret="+encodeURIComponent(w)),P+="&token_type_hint="+encodeURIComponent(b),P+="&token="+encodeURIComponent(E),M.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),M.send(P)})},d}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.CordovaPopupWindow=void 0;var o=function(){function a(c,l){for(var u=0;u<l.length;u++){var d=l[u];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}return function(c,l,u){return l&&a(c.prototype,l),u&&a(c,u),c}}(),s=i(0);r.CordovaPopupWindow=function(){function a(c){var l=this;(function(d,g){if(!(d instanceof g))throw new TypeError("Cannot call a class as a function")})(this,a),this._promise=new Promise(function(u,d){l._resolve=u,l._reject=d}),this.features=c.popupWindowFeatures||"location=no,toolbar=no,zoom=no",this.target=c.popupWindowTarget||"_blank",this.redirect_uri=c.startUrl,s.Log.debug("CordovaPopupWindow.ctor: redirect_uri: "+this.redirect_uri)}return a.prototype._isInAppBrowserInstalled=function(l){return["cordova-plugin-inappbrowser","cordova-plugin-inappbrowser.inappbrowser","org.apache.cordova.inappbrowser"].some(function(u){return l.hasOwnProperty(u)})},a.prototype.navigate=function(l){if(l&&l.url){if(!window.cordova)return this._error("cordova is undefined");var u=window.cordova.require("cordova/plugin_list").metadata;if(this._isInAppBrowserInstalled(u)===!1)return this._error("InAppBrowser plugin not found");this._popup=cordova.InAppBrowser.open(l.url,this.target,this.features),this._popup?(s.Log.debug("CordovaPopupWindow.navigate: popup successfully created"),this._exitCallbackEvent=this._exitCallback.bind(this),this._loadStartCallbackEvent=this._loadStartCallback.bind(this),this._popup.addEventListener("exit",this._exitCallbackEvent,!1),this._popup.addEventListener("loadstart",this._loadStartCallbackEvent,!1)):this._error("Error opening popup window")}else this._error("No url provided");return this.promise},a.prototype._loadStartCallback=function(l){l.url.indexOf(this.redirect_uri)===0&&this._success({url:l.url})},a.prototype._exitCallback=function(l){this._error(l)},a.prototype._success=function(l){this._cleanup(),s.Log.debug("CordovaPopupWindow: Successful response from cordova popup window"),this._resolve(l)},a.prototype._error=function(l){this._cleanup(),s.Log.error(l),this._reject(new Error(l))},a.prototype.close=function(){this._cleanup()},a.prototype._cleanup=function(){this._popup&&(s.Log.debug("CordovaPopupWindow: cleaning up popup"),this._popup.removeEventListener("exit",this._exitCallbackEvent,!1),this._popup.removeEventListener("loadstart",this._loadStartCallbackEvent,!1),this._popup.close()),this._popup=null},o(a,[{key:"promise",get:function(){return this._promise}}]),a}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(0),s=i(10),a=i(5),c=i(6),l=i(37),u=i(38),d=i(16),g=i(2),p=i(48),y=i(49),w=i(19),E=i(20),b=i(18),S=i(1),R=i(15),F=i(50);r.default={Version:F.Version,Log:o.Log,OidcClient:s.OidcClient,OidcClientSettings:a.OidcClientSettings,WebStorageStateStore:c.WebStorageStateStore,InMemoryWebStorage:l.InMemoryWebStorage,UserManager:u.UserManager,AccessTokenEvents:d.AccessTokenEvents,MetadataService:g.MetadataService,CordovaPopupNavigator:p.CordovaPopupNavigator,CordovaIFrameNavigator:y.CordovaIFrameNavigator,CheckSessionIFrame:w.CheckSessionIFrame,TokenRevocationClient:E.TokenRevocationClient,SessionMonitor:b.SessionMonitor,Global:S.Global,User:R.User},n.exports=r.default},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.ClockService=function(){function o(){(function(a,c){if(!(a instanceof c))throw new TypeError("Cannot call a class as a function")})(this,o)}return o.prototype.getEpochTime=function(){return Promise.resolve(Date.now()/1e3|0)},o}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.ResponseValidator=void 0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},s=i(0),a=i(2),c=i(25),l=i(11),u=i(12),d=i(4);function g(y,w){if(!(y instanceof w))throw new TypeError("Cannot call a class as a function")}var p=["nonce","at_hash","iat","nbf","exp","aud","iss","c_hash"];r.ResponseValidator=function(){function y(w){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a.MetadataService,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:c.UserInfoService,S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:d.JoseUtil,R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:l.TokenClient;if(g(this,y),!w)throw s.Log.error("ResponseValidator.ctor: No settings passed to ResponseValidator"),new Error("settings");this._settings=w,this._metadataService=new E(this._settings),this._userInfoService=new b(this._settings),this._joseUtil=S,this._tokenClient=new R(this._settings)}return y.prototype.validateSigninResponse=function(E,b){var S=this;return s.Log.debug("ResponseValidator.validateSigninResponse"),this._processSigninParams(E,b).then(function(R){return s.Log.debug("ResponseValidator.validateSigninResponse: state processed"),S._validateTokens(E,R).then(function(F){return s.Log.debug("ResponseValidator.validateSigninResponse: tokens validated"),S._processClaims(E,F).then(function(M){return s.Log.debug("ResponseValidator.validateSigninResponse: claims processed"),M})})})},y.prototype.validateSignoutResponse=function(E,b){return E.id!==b.state?(s.Log.error("ResponseValidator.validateSignoutResponse: State does not match"),Promise.reject(new Error("State does not match"))):(s.Log.debug("ResponseValidator.validateSignoutResponse: state validated"),b.state=E.data,b.error?(s.Log.warn("ResponseValidator.validateSignoutResponse: Response was error",b.error),Promise.reject(new u.ErrorResponse(b))):Promise.resolve(b))},y.prototype._processSigninParams=function(E,b){if(E.id!==b.state)return s.Log.error("ResponseValidator._processSigninParams: State does not match"),Promise.reject(new Error("State does not match"));if(!E.client_id)return s.Log.error("ResponseValidator._processSigninParams: No client_id on state"),Promise.reject(new Error("No client_id on state"));if(!E.authority)return s.Log.error("ResponseValidator._processSigninParams: No authority on state"),Promise.reject(new Error("No authority on state"));if(this._settings.authority){if(this._settings.authority&&this._settings.authority!==E.authority)return s.Log.error("ResponseValidator._processSigninParams: authority mismatch on settings vs. signin state"),Promise.reject(new Error("authority mismatch on settings vs. signin state"))}else this._settings.authority=E.authority;if(this._settings.client_id){if(this._settings.client_id&&this._settings.client_id!==E.client_id)return s.Log.error("ResponseValidator._processSigninParams: client_id mismatch on settings vs. signin state"),Promise.reject(new Error("client_id mismatch on settings vs. signin state"))}else this._settings.client_id=E.client_id;return s.Log.debug("ResponseValidator._processSigninParams: state validated"),b.state=E.data,b.error?(s.Log.warn("ResponseValidator._processSigninParams: Response was error",b.error),Promise.reject(new u.ErrorResponse(b))):E.nonce&&!b.id_token?(s.Log.error("ResponseValidator._processSigninParams: Expecting id_token in response"),Promise.reject(new Error("No id_token in response"))):!E.nonce&&b.id_token?(s.Log.error("ResponseValidator._processSigninParams: Not expecting id_token in response"),Promise.reject(new Error("Unexpected id_token in response"))):E.code_verifier&&!b.code?(s.Log.error("ResponseValidator._processSigninParams: Expecting code in response"),Promise.reject(new Error("No code in response"))):!E.code_verifier&&b.code?(s.Log.error("ResponseValidator._processSigninParams: Not expecting code in response"),Promise.reject(new Error("Unexpected code in response"))):(b.scope||(b.scope=E.scope),Promise.resolve(b))},y.prototype._processClaims=function(E,b){var S=this;if(b.isOpenIdConnect){if(s.Log.debug("ResponseValidator._processClaims: response is OIDC, processing claims"),b.profile=this._filterProtocolClaims(b.profile),E.skipUserInfo!==!0&&this._settings.loadUserInfo&&b.access_token)return s.Log.debug("ResponseValidator._processClaims: loading user info"),this._userInfoService.getClaims(b.access_token).then(function(R){return s.Log.debug("ResponseValidator._processClaims: user info claims received from user info endpoint"),R.sub!==b.profile.sub?(s.Log.error("ResponseValidator._processClaims: sub from user info endpoint does not match sub in id_token"),Promise.reject(new Error("sub from user info endpoint does not match sub in id_token"))):(b.profile=S._mergeClaims(b.profile,R),s.Log.debug("ResponseValidator._processClaims: user info claims received, updated profile:",b.profile),b)});s.Log.debug("ResponseValidator._processClaims: not loading user info")}else s.Log.debug("ResponseValidator._processClaims: response is not OIDC, not processing claims");return Promise.resolve(b)},y.prototype._mergeClaims=function(E,b){var S=Object.assign({},E);for(var R in b){var F=b[R];Array.isArray(F)||(F=[F]);for(var M=0;M<F.length;M++){var P=F[M];S[R]?Array.isArray(S[R])?S[R].indexOf(P)<0&&S[R].push(P):S[R]!==P&&((P===void 0?"undefined":o(P))==="object"&&this._settings.mergeClaims?S[R]=this._mergeClaims(S[R],P):S[R]=[S[R],P]):S[R]=P}}return S},y.prototype._filterProtocolClaims=function(E){s.Log.debug("ResponseValidator._filterProtocolClaims, incoming claims:",E);var b=Object.assign({},E);return this._settings._filterProtocolClaims?(p.forEach(function(S){delete b[S]}),s.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims filtered",b)):s.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims not filtered"),b},y.prototype._validateTokens=function(E,b){return b.code?(s.Log.debug("ResponseValidator._validateTokens: Validating code"),this._processCode(E,b)):b.id_token?b.access_token?(s.Log.debug("ResponseValidator._validateTokens: Validating id_token and access_token"),this._validateIdTokenAndAccessToken(E,b)):(s.Log.debug("ResponseValidator._validateTokens: Validating id_token"),this._validateIdToken(E,b)):(s.Log.debug("ResponseValidator._validateTokens: No code to process or id_token to validate"),Promise.resolve(b))},y.prototype._processCode=function(E,b){var S=this,R={client_id:E.client_id,client_secret:E.client_secret,code:b.code,redirect_uri:E.redirect_uri,code_verifier:E.code_verifier};return E.extraTokenParams&&o(E.extraTokenParams)==="object"&&Object.assign(R,E.extraTokenParams),this._tokenClient.exchangeCode(R).then(function(F){for(var M in F)b[M]=F[M];return b.id_token?(s.Log.debug("ResponseValidator._processCode: token response successful, processing id_token"),S._validateIdTokenAttributes(E,b)):(s.Log.debug("ResponseValidator._processCode: token response successful, returning response"),b)})},y.prototype._validateIdTokenAttributes=function(E,b){var S=this;return this._metadataService.getIssuer().then(function(R){var F=E.client_id,M=S._settings.clockSkew;return s.Log.debug("ResponseValidator._validateIdTokenAttributes: Validaing JWT attributes; using clock skew (in seconds) of: ",M),S._settings.getEpochTime().then(function(P){return S._joseUtil.validateJwtAttributes(b.id_token,R,F,M,P).then(function(D){return E.nonce&&E.nonce!==D.nonce?(s.Log.error("ResponseValidator._validateIdTokenAttributes: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):D.sub?(b.profile=D,b):(s.Log.error("ResponseValidator._validateIdTokenAttributes: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))})})})},y.prototype._validateIdTokenAndAccessToken=function(E,b){var S=this;return this._validateIdToken(E,b).then(function(R){return S._validateAccessToken(R)})},y.prototype._getSigningKeyForJwt=function(E){var b=this;return this._metadataService.getSigningKeys().then(function(S){var R=E.header.kid;if(!S)return s.Log.error("ResponseValidator._validateIdToken: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));s.Log.debug("ResponseValidator._validateIdToken: Received signing keys");var F=void 0;if(R)F=S.filter(function(M){return M.kid===R})[0];else{if((S=b._filterByAlg(S,E.header.alg)).length>1)return s.Log.error("ResponseValidator._validateIdToken: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));F=S[0]}return Promise.resolve(F)})},y.prototype._getSigningKeyForJwtWithSingleRetry=function(E){var b=this;return this._getSigningKeyForJwt(E).then(function(S){return S?Promise.resolve(S):(b._metadataService.resetSigningKeys(),b._getSigningKeyForJwt(E))})},y.prototype._validateIdToken=function(E,b){var S=this;if(!E.nonce)return s.Log.error("ResponseValidator._validateIdToken: No nonce on state"),Promise.reject(new Error("No nonce on state"));var R=this._joseUtil.parseJwt(b.id_token);return R&&R.header&&R.payload?E.nonce!==R.payload.nonce?(s.Log.error("ResponseValidator._validateIdToken: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):this._metadataService.getIssuer().then(function(F){return s.Log.debug("ResponseValidator._validateIdToken: Received issuer"),S._getSigningKeyForJwtWithSingleRetry(R).then(function(M){if(!M)return s.Log.error("ResponseValidator._validateIdToken: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var P=E.client_id,D=S._settings.clockSkew;return s.Log.debug("ResponseValidator._validateIdToken: Validaing JWT; using clock skew (in seconds) of: ",D),S._joseUtil.validateJwt(b.id_token,M,F,P,D).then(function(){return s.Log.debug("ResponseValidator._validateIdToken: JWT validation successful"),R.payload.sub?(b.profile=R.payload,b):(s.Log.error("ResponseValidator._validateIdToken: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))})})}):(s.Log.error("ResponseValidator._validateIdToken: Failed to parse id_token",R),Promise.reject(new Error("Failed to parse id_token")))},y.prototype._filterByAlg=function(E,b){var S=null;if(b.startsWith("RS"))S="RSA";else if(b.startsWith("PS"))S="PS";else{if(!b.startsWith("ES"))return s.Log.debug("ResponseValidator._filterByAlg: alg not supported: ",b),[];S="EC"}return s.Log.debug("ResponseValidator._filterByAlg: Looking for keys that match kty: ",S),E=E.filter(function(R){return R.kty===S}),s.Log.debug("ResponseValidator._filterByAlg: Number of keys that match kty: ",S,E.length),E},y.prototype._validateAccessToken=function(E){if(!E.profile)return s.Log.error("ResponseValidator._validateAccessToken: No profile loaded from id_token"),Promise.reject(new Error("No profile loaded from id_token"));if(!E.profile.at_hash)return s.Log.error("ResponseValidator._validateAccessToken: No at_hash in id_token"),Promise.reject(new Error("No at_hash in id_token"));if(!E.id_token)return s.Log.error("ResponseValidator._validateAccessToken: No id_token"),Promise.reject(new Error("No id_token"));var b=this._joseUtil.parseJwt(E.id_token);if(!b||!b.header)return s.Log.error("ResponseValidator._validateAccessToken: Failed to parse id_token",b),Promise.reject(new Error("Failed to parse id_token"));var S=b.header.alg;if(!S||S.length!==5)return s.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",S),Promise.reject(new Error("Unsupported alg: "+S));var R=S.substr(2,3);if(!R)return s.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",S,R),Promise.reject(new Error("Unsupported alg: "+S));if((R=parseInt(R))!==256&&R!==384&&R!==512)return s.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",S,R),Promise.reject(new Error("Unsupported alg: "+S));var F="sha"+R,M=this._joseUtil.hashString(E.access_token,F);if(!M)return s.Log.error("ResponseValidator._validateAccessToken: access_token hash failed:",F),Promise.reject(new Error("Failed to validate at_hash"));var P=M.substr(0,M.length/2),D=this._joseUtil.hexToBase64Url(P);return D!==E.profile.at_hash?(s.Log.error("ResponseValidator._validateAccessToken: Failed to validate at_hash",D,E.profile.at_hash),Promise.reject(new Error("Failed to validate at_hash"))):(s.Log.debug("ResponseValidator._validateAccessToken: success"),Promise.resolve(E))},y}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.UserInfoService=void 0;var o=i(7),s=i(2),a=i(0),c=i(4);function l(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}r.UserInfoService=function(){function u(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o.JsonService,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:s.MetadataService,y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:c.JoseUtil;if(l(this,u),!d)throw a.Log.error("UserInfoService.ctor: No settings passed"),new Error("settings");this._settings=d,this._jsonService=new g(void 0,void 0,this._getClaimsFromJwt.bind(this)),this._metadataService=new p(this._settings),this._joseUtil=y}return u.prototype.getClaims=function(g){var p=this;return g?this._metadataService.getUserInfoEndpoint().then(function(y){return a.Log.debug("UserInfoService.getClaims: received userinfo url",y),p._jsonService.getJson(y,g).then(function(w){return a.Log.debug("UserInfoService.getClaims: claims received",w),w})}):(a.Log.error("UserInfoService.getClaims: No token passed"),Promise.reject(new Error("A token is required")))},u.prototype._getClaimsFromJwt=function(g){var p=this;try{var y=this._joseUtil.parseJwt(g.responseText);if(!y||!y.header||!y.payload)return a.Log.error("UserInfoService._getClaimsFromJwt: Failed to parse JWT",y),Promise.reject(new Error("Failed to parse id_token"));var w=y.header.kid,E=void 0;switch(this._settings.userInfoJwtIssuer){case"OP":E=this._metadataService.getIssuer();break;case"ANY":E=Promise.resolve(y.payload.iss);break;default:E=Promise.resolve(this._settings.userInfoJwtIssuer)}return E.then(function(b){return a.Log.debug("UserInfoService._getClaimsFromJwt: Received issuer:"+b),p._metadataService.getSigningKeys().then(function(S){if(!S)return a.Log.error("UserInfoService._getClaimsFromJwt: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));a.Log.debug("UserInfoService._getClaimsFromJwt: Received signing keys");var R=void 0;if(w)R=S.filter(function(P){return P.kid===w})[0];else{if((S=p._filterByAlg(S,y.header.alg)).length>1)return a.Log.error("UserInfoService._getClaimsFromJwt: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));R=S[0]}if(!R)return a.Log.error("UserInfoService._getClaimsFromJwt: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var F=p._settings.client_id,M=p._settings.clockSkew;return a.Log.debug("UserInfoService._getClaimsFromJwt: Validaing JWT; using clock skew (in seconds) of: ",M),p._joseUtil.validateJwt(g.responseText,R,b,F,M,void 0,!0).then(function(){return a.Log.debug("UserInfoService._getClaimsFromJwt: JWT validation successful"),y.payload})})})}catch(b){return a.Log.error("UserInfoService._getClaimsFromJwt: Error parsing JWT response",b.message),void reject(b)}},u.prototype._filterByAlg=function(g,p){var y=null;if(p.startsWith("RS"))y="RSA";else if(p.startsWith("PS"))y="PS";else{if(!p.startsWith("ES"))return a.Log.debug("UserInfoService._filterByAlg: alg not supported: ",p),[];y="EC"}return a.Log.debug("UserInfoService._filterByAlg: Looking for keys that match kty: ",y),g=g.filter(function(w){return w.kty===y}),a.Log.debug("UserInfoService._filterByAlg: Number of keys that match kty: ",y,g.length),g},u}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.AllowedSigningAlgs=r.b64tohex=r.hextob64u=r.crypto=r.X509=r.KeyUtil=r.jws=void 0;var o=i(27);r.jws=o.jws,r.KeyUtil=o.KEYUTIL,r.X509=o.X509,r.crypto=o.crypto,r.hextob64u=o.hextob64u,r.b64tohex=o.b64tohex,r.AllowedSigningAlgs=["RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"]},function(n,r,i){(function(o){Object.defineProperty(r,"__esModule",{value:!0});var s,a,c,l,u,d,g,p,y,w,E,b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},S={userAgent:!1},R={},F=F||(s=Math,c=(a={}).lib={},l=c.Base=function(){function h(){}return{extend:function(m){h.prototype=this;var v=new h;return m&&v.mixIn(m),v.hasOwnProperty("init")||(v.init=function(){v.$super.init.apply(this,arguments)}),v.init.prototype=v,v.$super=this,v},create:function(){var m=this.extend();return m.init.apply(m,arguments),m},init:function(){},mixIn:function(m){for(var v in m)m.hasOwnProperty(v)&&(this[v]=m[v]);m.hasOwnProperty("toString")&&(this.toString=m.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),u=c.WordArray=l.extend({init:function(f,m){f=this.words=f||[],this.sigBytes=m!=null?m:4*f.length},toString:function(f){return(f||g).stringify(this)},concat:function(f){var m=this.words,v=f.words,A=this.sigBytes,C=f.sigBytes;if(this.clamp(),A%4)for(var j=0;j<C;j++){var K=v[j>>>2]>>>24-j%4*8&255;m[A+j>>>2]|=K<<24-(A+j)%4*8}else for(j=0;j<C;j+=4)m[A+j>>>2]=v[j>>>2];return this.sigBytes+=C,this},clamp:function(){var f=this.words,m=this.sigBytes;f[m>>>2]&=4294967295<<32-m%4*8,f.length=s.ceil(m/4)},clone:function(){var f=l.clone.call(this);return f.words=this.words.slice(0),f},random:function(f){for(var m=[],v=0;v<f;v+=4)m.push(4294967296*s.random()|0);return new u.init(m,f)}}),d=a.enc={},g=d.Hex={stringify:function(f){for(var m=f.words,v=f.sigBytes,A=[],C=0;C<v;C++){var j=m[C>>>2]>>>24-C%4*8&255;A.push((j>>>4).toString(16)),A.push((15&j).toString(16))}return A.join("")},parse:function(f){for(var m=f.length,v=[],A=0;A<m;A+=2)v[A>>>3]|=parseInt(f.substr(A,2),16)<<24-A%8*4;return new u.init(v,m/2)}},p=d.Latin1={stringify:function(f){for(var m=f.words,v=f.sigBytes,A=[],C=0;C<v;C++){var j=m[C>>>2]>>>24-C%4*8&255;A.push(String.fromCharCode(j))}return A.join("")},parse:function(f){for(var m=f.length,v=[],A=0;A<m;A++)v[A>>>2]|=(255&f.charCodeAt(A))<<24-A%4*8;return new u.init(v,m)}},y=d.Utf8={stringify:function(f){try{return decodeURIComponent(escape(p.stringify(f)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(f){return p.parse(unescape(encodeURIComponent(f)))}},w=c.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(f){typeof f=="string"&&(f=y.parse(f)),this._data.concat(f),this._nDataBytes+=f.sigBytes},_process:function(f){var m=this._data,v=m.words,A=m.sigBytes,C=this.blockSize,j=A/(4*C),K=(j=f?s.ceil(j):s.max((0|j)-this._minBufferSize,0))*C,B=s.min(4*K,A);if(K){for(var H=0;H<K;H+=C)this._doProcessBlock(v,H);var W=v.splice(0,K);m.sigBytes-=B}return new u.init(W,B)},clone:function(){var f=l.clone.call(this);return f._data=this._data.clone(),f},_minBufferSize:0}),c.Hasher=w.extend({cfg:l.extend(),init:function(f){this.cfg=this.cfg.extend(f),this.reset()},reset:function(){w.reset.call(this),this._doReset()},update:function(f){return this._append(f),this._process(),this},finalize:function(f){return f&&this._append(f),this._doFinalize()},blockSize:16,_createHelper:function(f){return function(m,v){return new f.init(v).finalize(m)}},_createHmacHelper:function(f){return function(m,v){return new E.HMAC.init(f,v).finalize(m)}}}),E=a.algo={},a);(function(h){var f,m=(f=F).lib,v=m.Base,A=m.WordArray;(f=f.x64={}).Word=v.extend({init:function(j,K){this.high=j,this.low=K}}),f.WordArray=v.extend({init:function(j,K){j=this.words=j||[],this.sigBytes=K!=null?K:8*j.length},toX32:function(){for(var j=this.words,K=j.length,B=[],H=0;H<K;H++){var W=j[H];B.push(W.high),B.push(W.low)}return A.create(B,this.sigBytes)},clone:function(){for(var j=v.clone.call(this),K=j.words=this.words.slice(0),B=K.length,H=0;H<B;H++)K[H]=K[H].clone();return j}})})(),function(){var h=F,f=h.lib.WordArray;h.enc.Base64={stringify:function(v){var A=v.words,C=v.sigBytes,j=this._map;v.clamp(),v=[];for(var K=0;K<C;K+=3)for(var B=(A[K>>>2]>>>24-K%4*8&255)<<16|(A[K+1>>>2]>>>24-(K+1)%4*8&255)<<8|A[K+2>>>2]>>>24-(K+2)%4*8&255,H=0;4>H&&K+.75*H<C;H++)v.push(j.charAt(B>>>6*(3-H)&63));if(A=j.charAt(64))for(;v.length%4;)v.push(A);return v.join("")},parse:function(v){var A=v.length,C=this._map;(j=C.charAt(64))&&(j=v.indexOf(j))!=-1&&(A=j);for(var j=[],K=0,B=0;B<A;B++)if(B%4){var H=C.indexOf(v.charAt(B-1))<<B%4*2,W=C.indexOf(v.charAt(B))>>>6-B%4*2;j[K>>>2]|=(H|W)<<24-K%4*8,K++}return f.create(j,K)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(h){for(var f=F,m=(A=f.lib).WordArray,v=A.Hasher,A=f.algo,C=[],j=[],K=function(he){return 4294967296*(he-(0|he))|0},B=2,H=0;64>H;){var W;e:{W=B;for(var V=h.sqrt(W),Z=2;Z<=V;Z++)if(!(W%Z)){W=!1;break e}W=!0}W&&(8>H&&(C[H]=K(h.pow(B,.5))),j[H]=K(h.pow(B,1/3)),H++),B++}var ne=[];A=A.SHA256=v.extend({_doReset:function(){this._hash=new m.init(C.slice(0))},_doProcessBlock:function(he,pe){for(var U=this._hash.words,q=U[0],G=U[1],J=U[2],le=U[3],ge=U[4],Re=U[5],ye=U[6],mt=U[7],xe=0;64>xe;xe++){if(16>xe)ne[xe]=0|he[pe+xe];else{var qe=ne[xe-15],on=ne[xe-2];ne[xe]=((qe<<25|qe>>>7)^(qe<<14|qe>>>18)^qe>>>3)+ne[xe-7]+((on<<15|on>>>17)^(on<<13|on>>>19)^on>>>10)+ne[xe-16]}qe=mt+((ge<<26|ge>>>6)^(ge<<21|ge>>>11)^(ge<<7|ge>>>25))+(ge&Re^~ge&ye)+j[xe]+ne[xe],on=((q<<30|q>>>2)^(q<<19|q>>>13)^(q<<10|q>>>22))+(q&G^q&J^G&J),mt=ye,ye=Re,Re=ge,ge=le+qe|0,le=J,J=G,G=q,q=qe+on|0}U[0]=U[0]+q|0,U[1]=U[1]+G|0,U[2]=U[2]+J|0,U[3]=U[3]+le|0,U[4]=U[4]+ge|0,U[5]=U[5]+Re|0,U[6]=U[6]+ye|0,U[7]=U[7]+mt|0},_doFinalize:function(){var he=this._data,pe=he.words,U=8*this._nDataBytes,q=8*he.sigBytes;return pe[q>>>5]|=128<<24-q%32,pe[14+(q+64>>>9<<4)]=h.floor(U/4294967296),pe[15+(q+64>>>9<<4)]=U,he.sigBytes=4*pe.length,this._process(),this._hash},clone:function(){var he=v.clone.call(this);return he._hash=this._hash.clone(),he}}),f.SHA256=v._createHelper(A),f.HmacSHA256=v._createHmacHelper(A)}(Math),function(){function h(){return v.create.apply(v,arguments)}for(var f=F,m=f.lib.Hasher,v=(C=f.x64).Word,A=C.WordArray,C=f.algo,j=[h(1116352408,3609767458),h(1899447441,602891725),h(3049323471,3964484399),h(3921009573,2173295548),h(961987163,4081628472),h(1508970993,3053834265),h(2453635748,2937671579),h(2870763221,3664609560),h(3624381080,2734883394),h(310598401,1164996542),h(607225278,1323610764),h(1426881987,3590304994),h(1925078388,4068182383),h(2162078206,991336113),h(2614888103,633803317),h(3248222580,3479774868),h(3835390401,2666613458),h(4022224774,944711139),h(264347078,2341262773),h(604807628,2007800933),h(770255983,1495990901),h(1249150122,1856431235),h(1555081692,3175218132),h(1996064986,2198950837),h(2554220882,3999719339),h(2821834349,766784016),h(2952996808,2566594879),h(3210313671,3203337956),h(3336571891,1034457026),h(3584528711,2466948901),h(113926993,3758326383),h(338241895,168717936),h(666307205,1188179964),h(773529912,1546045734),h(1294757372,1522805485),h(1396182291,2643833823),h(1695183700,2343527390),h(1986661051,1014477480),h(2177026350,1206759142),h(2456956037,344077627),h(2730485921,1290863460),h(2820302411,3158454273),h(3259730800,3505952657),h(3345764771,106217008),h(3516065817,3606008344),h(3600352804,1432725776),h(4094571909,1467031594),h(275423344,851169720),h(430227734,3100823752),h(506948616,1363258195),h(659060556,3750685593),h(883997877,3785050280),h(958139571,3318307427),h(1322822218,3812723403),h(1537002063,2003034995),h(1747873779,3602036899),h(1955562222,1575990012),h(2024104815,1125592928),h(2227730452,2716904306),h(2361852424,442776044),h(2428436474,593698344),h(2756734187,3733110249),h(3204031479,2999351573),h(3329325298,3815920427),h(3391569614,3928383900),h(3515267271,566280711),h(3940187606,3454069534),h(4118630271,4000239992),h(116418474,1914138554),h(174292421,2731055270),h(289380356,3203993006),h(460393269,320620315),h(685471733,587496836),h(852142971,1086792851),h(1017036298,365543100),h(1126000580,2618297676),h(1288033470,3409855158),h(1501505948,4234509866),h(1607167915,987167468),h(1816402316,1246189591)],K=[],B=0;80>B;B++)K[B]=h();C=C.SHA512=m.extend({_doReset:function(){this._hash=new A.init([new v.init(1779033703,4089235720),new v.init(3144134277,2227873595),new v.init(1013904242,4271175723),new v.init(2773480762,1595750129),new v.init(1359893119,2917565137),new v.init(2600822924,725511199),new v.init(528734635,4215389547),new v.init(1541459225,327033209)])},_doProcessBlock:function(W,V){for(var Z=(G=this._hash.words)[0],ne=G[1],ce=G[2],he=G[3],pe=G[4],U=G[5],q=G[6],G=G[7],J=Z.high,le=Z.low,ge=ne.high,Re=ne.low,ye=ce.high,mt=ce.low,xe=he.high,qe=he.low,on=pe.high,bn=pe.low,hn=U.high,hi=U.low,qr=q.high,ni=q.low,Kn=G.high,dr=G.low,Mr=J,ri=le,Yc=ge,za=Re,Jc=ye,Ga=mt,yh=xe,Zc=qe,eo=on,Mi=bn,Lu=hn,Qc=hi,Uu=qr,Xc=ni,_h=Kn,el=dr,to=0;80>to;to++){var Js=K[to];if(16>to)var Yo=Js.high=0|W[V+2*to],En=Js.low=0|W[V+2*to+1];else{Yo=((En=(Yo=K[to-15]).high)>>>1|(Jo=Yo.low)<<31)^(En>>>8|Jo<<24)^En>>>7;var Jo=(Jo>>>1|En<<31)^(Jo>>>8|En<<24)^(Jo>>>7|En<<25),Ya=((En=(Ya=K[to-2]).high)>>>19|(fr=Ya.low)<<13)^(En<<3|fr>>>29)^En>>>6,fr=(fr>>>19|En<<13)^(fr<<3|En>>>29)^(fr>>>6|En<<26),wh=(En=K[to-7]).high,Zs=(Qs=K[to-16]).high,Qs=Qs.low;Yo=(Yo=(Yo=Yo+wh+((En=Jo+En.low)>>>0<Jo>>>0?1:0))+Ya+((En=En+fr)>>>0<fr>>>0?1:0))+Zs+((En=En+Qs)>>>0<Qs>>>0?1:0),Js.high=Yo,Js.low=En}wh=eo&Lu^~eo&Uu,Qs=Mi&Qc^~Mi&Xc,Js=Mr&Yc^Mr&Jc^Yc&Jc;var nS=ri&za^ri&Ga^za&Ga,rS=(Jo=(Mr>>>28|ri<<4)^(Mr<<30|ri>>>2)^(Mr<<25|ri>>>7),Ya=(ri>>>28|Mr<<4)^(ri<<30|Mr>>>2)^(ri<<25|Mr>>>7),(fr=j[to]).high),cy=fr.low;Zs=_h+((eo>>>14|Mi<<18)^(eo>>>18|Mi<<14)^(eo<<23|Mi>>>9))+((fr=el+((Mi>>>14|eo<<18)^(Mi>>>18|eo<<14)^(Mi<<23|eo>>>9)))>>>0<el>>>0?1:0),_h=Uu,el=Xc,Uu=Lu,Xc=Qc,Lu=eo,Qc=Mi,eo=yh+(Zs=(Zs=(Zs=Zs+wh+((fr=fr+Qs)>>>0<Qs>>>0?1:0))+rS+((fr=fr+cy)>>>0<cy>>>0?1:0))+Yo+((fr=fr+En)>>>0<En>>>0?1:0))+((Mi=Zc+fr|0)>>>0<Zc>>>0?1:0)|0,yh=Jc,Zc=Ga,Jc=Yc,Ga=za,Yc=Mr,za=ri,Mr=Zs+(Js=Jo+Js+((En=Ya+nS)>>>0<Ya>>>0?1:0))+((ri=fr+En|0)>>>0<fr>>>0?1:0)|0}le=Z.low=le+ri,Z.high=J+Mr+(le>>>0<ri>>>0?1:0),Re=ne.low=Re+za,ne.high=ge+Yc+(Re>>>0<za>>>0?1:0),mt=ce.low=mt+Ga,ce.high=ye+Jc+(mt>>>0<Ga>>>0?1:0),qe=he.low=qe+Zc,he.high=xe+yh+(qe>>>0<Zc>>>0?1:0),bn=pe.low=bn+Mi,pe.high=on+eo+(bn>>>0<Mi>>>0?1:0),hi=U.low=hi+Qc,U.high=hn+Lu+(hi>>>0<Qc>>>0?1:0),ni=q.low=ni+Xc,q.high=qr+Uu+(ni>>>0<Xc>>>0?1:0),dr=G.low=dr+el,G.high=Kn+_h+(dr>>>0<el>>>0?1:0)},_doFinalize:function(){var W=this._data,V=W.words,Z=8*this._nDataBytes,ne=8*W.sigBytes;return V[ne>>>5]|=128<<24-ne%32,V[30+(ne+128>>>10<<5)]=Math.floor(Z/4294967296),V[31+(ne+128>>>10<<5)]=Z,W.sigBytes=4*V.length,this._process(),this._hash.toX32()},clone:function(){var W=m.clone.call(this);return W._hash=this._hash.clone(),W},blockSize:32}),f.SHA512=m._createHelper(C),f.HmacSHA512=m._createHmacHelper(C)}(),function(){var h=F,f=(A=h.x64).Word,m=A.WordArray,v=(A=h.algo).SHA512,A=A.SHA384=v.extend({_doReset:function(){this._hash=new m.init([new f.init(3418070365,3238371032),new f.init(1654270250,914150663),new f.init(2438529370,812702999),new f.init(355462360,4144912697),new f.init(1731405415,4290775857),new f.init(2394180231,1750603025),new f.init(3675008525,1694076839),new f.init(1203062813,3204075428)])},_doFinalize:function(){var j=v._doFinalize.call(this);return j.sigBytes-=16,j}});h.SHA384=v._createHelper(A),h.HmacSHA384=v._createHmacHelper(A)}();/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */var M,P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function D(h){var f,m,v="";for(f=0;f+3<=h.length;f+=3)m=parseInt(h.substring(f,f+3),16),v+=P.charAt(m>>6)+P.charAt(63&m);for(f+1==h.length?(m=parseInt(h.substring(f,f+1),16),v+=P.charAt(m<<2)):f+2==h.length&&(m=parseInt(h.substring(f,f+2),16),v+=P.charAt(m>>2)+P.charAt((3&m)<<4)),"=";(3&v.length)>0;)v+="=";return v}function Y(h){var f,m,v,A="",C=0;for(f=0;f<h.length&&h.charAt(f)!="=";++f)(v=P.indexOf(h.charAt(f)))<0||(C==0?(A+=se(v>>2),m=3&v,C=1):C==1?(A+=se(m<<2|v>>4),m=15&v,C=2):C==2?(A+=se(m),A+=se(v>>2),m=3&v,C=3):(A+=se(m<<2|v>>4),A+=se(15&v),C=0));return C==1&&(A+=se(m<<2)),A}function X(h){var f,m=Y(h),v=new Array;for(f=0;2*f<m.length;++f)v[f]=parseInt(m.substring(2*f,2*f+2),16);return v}function $(h,f,m){h!=null&&(typeof h=="number"?this.fromNumber(h,f,m):f==null&&typeof h!="string"?this.fromString(h,256):this.fromString(h,f))}function te(){return new $(null)}S.appName=="Microsoft Internet Explorer"?($.prototype.am=function(f,m,v,A,C,j){for(var K=32767&m,B=m>>15;--j>=0;){var H=32767&this[f],W=this[f++]>>15,V=B*H+W*K;C=((H=K*H+((32767&V)<<15)+v[A]+(1073741823&C))>>>30)+(V>>>15)+B*W+(C>>>30),v[A++]=1073741823&H}return C},M=30):S.appName!="Netscape"?($.prototype.am=function(f,m,v,A,C,j){for(;--j>=0;){var K=m*this[f++]+v[A]+C;C=Math.floor(K/67108864),v[A++]=67108863&K}return C},M=26):($.prototype.am=function(f,m,v,A,C,j){for(var K=16383&m,B=m>>14;--j>=0;){var H=16383&this[f],W=this[f++]>>14,V=B*H+W*K;C=((H=K*H+((16383&V)<<14)+v[A]+C)>>28)+(V>>14)+B*W,v[A++]=268435455&H}return C},M=28),$.prototype.DB=M,$.prototype.DM=(1<<M)-1,$.prototype.DV=1<<M,$.prototype.FV=Math.pow(2,52),$.prototype.F1=52-M,$.prototype.F2=2*M-52;var _e,Ae,re=new Array;for(_e="0".charCodeAt(0),Ae=0;Ae<=9;++Ae)re[_e++]=Ae;for(_e="a".charCodeAt(0),Ae=10;Ae<36;++Ae)re[_e++]=Ae;for(_e="A".charCodeAt(0),Ae=10;Ae<36;++Ae)re[_e++]=Ae;function se(h){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(h)}function we(h,f){var m=re[h.charCodeAt(f)];return m==null?-1:m}function Ce(h){var f=te();return f.fromInt(h),f}function Ze(h){var f,m=1;return(f=h>>>16)!=0&&(h=f,m+=16),(f=h>>8)!=0&&(h=f,m+=8),(f=h>>4)!=0&&(h=f,m+=4),(f=h>>2)!=0&&(h=f,m+=2),(f=h>>1)!=0&&(h=f,m+=1),m}function Ee(h){this.m=h}function Ve(h){this.m=h,this.mp=h.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<h.DB-15)-1,this.mt2=2*h.t}function Ge(h,f){return h&f}function tt(h,f){return h|f}function rn(h,f){return h^f}function St(h,f){return h&~f}function cn(h){if(h==0)return-1;var f=0;return(65535&h)==0&&(h>>=16,f+=16),(255&h)==0&&(h>>=8,f+=8),(15&h)==0&&(h>>=4,f+=4),(3&h)==0&&(h>>=2,f+=2),(1&h)==0&&++f,f}function _r(h){for(var f=0;h!=0;)h&=h-1,++f;return f}function Fn(){}function ln(h){return h}function vn(h){this.r2=te(),this.q3=te(),$.ONE.dlShiftTo(2*h.t,this.r2),this.mu=this.r2.divide(h),this.m=h}Ee.prototype.convert=function(f){return f.s<0||f.compareTo(this.m)>=0?f.mod(this.m):f},Ee.prototype.revert=function(f){return f},Ee.prototype.reduce=function(f){f.divRemTo(this.m,null,f)},Ee.prototype.mulTo=function(f,m,v){f.multiplyTo(m,v),this.reduce(v)},Ee.prototype.sqrTo=function(f,m){f.squareTo(m),this.reduce(m)},Ve.prototype.convert=function(f){var m=te();return f.abs().dlShiftTo(this.m.t,m),m.divRemTo(this.m,null,m),f.s<0&&m.compareTo($.ZERO)>0&&this.m.subTo(m,m),m},Ve.prototype.revert=function(f){var m=te();return f.copyTo(m),this.reduce(m),m},Ve.prototype.reduce=function(f){for(;f.t<=this.mt2;)f[f.t++]=0;for(var m=0;m<this.m.t;++m){var v=32767&f[m],A=v*this.mpl+((v*this.mph+(f[m]>>15)*this.mpl&this.um)<<15)&f.DM;for(f[v=m+this.m.t]+=this.m.am(0,A,f,m,0,this.m.t);f[v]>=f.DV;)f[v]-=f.DV,f[++v]++}f.clamp(),f.drShiftTo(this.m.t,f),f.compareTo(this.m)>=0&&f.subTo(this.m,f)},Ve.prototype.mulTo=function(f,m,v){f.multiplyTo(m,v),this.reduce(v)},Ve.prototype.sqrTo=function(f,m){f.squareTo(m),this.reduce(m)},$.prototype.copyTo=function(f){for(var m=this.t-1;m>=0;--m)f[m]=this[m];f.t=this.t,f.s=this.s},$.prototype.fromInt=function(f){this.t=1,this.s=f<0?-1:0,f>0?this[0]=f:f<-1?this[0]=f+this.DV:this.t=0},$.prototype.fromString=function(f,m){var v;if(m==16)v=4;else if(m==8)v=3;else if(m==256)v=8;else if(m==2)v=1;else if(m==32)v=5;else{if(m!=4)return void this.fromRadix(f,m);v=2}this.t=0,this.s=0;for(var A=f.length,C=!1,j=0;--A>=0;){var K=v==8?255&f[A]:we(f,A);K<0?f.charAt(A)=="-"&&(C=!0):(C=!1,j==0?this[this.t++]=K:j+v>this.DB?(this[this.t-1]|=(K&(1<<this.DB-j)-1)<<j,this[this.t++]=K>>this.DB-j):this[this.t-1]|=K<<j,(j+=v)>=this.DB&&(j-=this.DB))}v==8&&(128&f[0])!=0&&(this.s=-1,j>0&&(this[this.t-1]|=(1<<this.DB-j)-1<<j)),this.clamp(),C&&$.ZERO.subTo(this,this)},$.prototype.clamp=function(){for(var f=this.s&this.DM;this.t>0&&this[this.t-1]==f;)--this.t},$.prototype.dlShiftTo=function(f,m){var v;for(v=this.t-1;v>=0;--v)m[v+f]=this[v];for(v=f-1;v>=0;--v)m[v]=0;m.t=this.t+f,m.s=this.s},$.prototype.drShiftTo=function(f,m){for(var v=f;v<this.t;++v)m[v-f]=this[v];m.t=Math.max(this.t-f,0),m.s=this.s},$.prototype.lShiftTo=function(f,m){var v,A=f%this.DB,C=this.DB-A,j=(1<<C)-1,K=Math.floor(f/this.DB),B=this.s<<A&this.DM;for(v=this.t-1;v>=0;--v)m[v+K+1]=this[v]>>C|B,B=(this[v]&j)<<A;for(v=K-1;v>=0;--v)m[v]=0;m[K]=B,m.t=this.t+K+1,m.s=this.s,m.clamp()},$.prototype.rShiftTo=function(f,m){m.s=this.s;var v=Math.floor(f/this.DB);if(v>=this.t)m.t=0;else{var A=f%this.DB,C=this.DB-A,j=(1<<A)-1;m[0]=this[v]>>A;for(var K=v+1;K<this.t;++K)m[K-v-1]|=(this[K]&j)<<C,m[K-v]=this[K]>>A;A>0&&(m[this.t-v-1]|=(this.s&j)<<C),m.t=this.t-v,m.clamp()}},$.prototype.subTo=function(f,m){for(var v=0,A=0,C=Math.min(f.t,this.t);v<C;)A+=this[v]-f[v],m[v++]=A&this.DM,A>>=this.DB;if(f.t<this.t){for(A-=f.s;v<this.t;)A+=this[v],m[v++]=A&this.DM,A>>=this.DB;A+=this.s}else{for(A+=this.s;v<f.t;)A-=f[v],m[v++]=A&this.DM,A>>=this.DB;A-=f.s}m.s=A<0?-1:0,A<-1?m[v++]=this.DV+A:A>0&&(m[v++]=A),m.t=v,m.clamp()},$.prototype.multiplyTo=function(f,m){var v=this.abs(),A=f.abs(),C=v.t;for(m.t=C+A.t;--C>=0;)m[C]=0;for(C=0;C<A.t;++C)m[C+v.t]=v.am(0,A[C],m,C,0,v.t);m.s=0,m.clamp(),this.s!=f.s&&$.ZERO.subTo(m,m)},$.prototype.squareTo=function(f){for(var m=this.abs(),v=f.t=2*m.t;--v>=0;)f[v]=0;for(v=0;v<m.t-1;++v){var A=m.am(v,m[v],f,2*v,0,1);(f[v+m.t]+=m.am(v+1,2*m[v],f,2*v+1,A,m.t-v-1))>=m.DV&&(f[v+m.t]-=m.DV,f[v+m.t+1]=1)}f.t>0&&(f[f.t-1]+=m.am(v,m[v],f,2*v,0,1)),f.s=0,f.clamp()},$.prototype.divRemTo=function(f,m,v){var A=f.abs();if(!(A.t<=0)){var C=this.abs();if(C.t<A.t)return m!=null&&m.fromInt(0),void(v!=null&&this.copyTo(v));v==null&&(v=te());var j=te(),K=this.s,B=f.s,H=this.DB-Ze(A[A.t-1]);H>0?(A.lShiftTo(H,j),C.lShiftTo(H,v)):(A.copyTo(j),C.copyTo(v));var W=j.t,V=j[W-1];if(V!=0){var Z=V*(1<<this.F1)+(W>1?j[W-2]>>this.F2:0),ne=this.FV/Z,ce=(1<<this.F1)/Z,he=1<<this.F2,pe=v.t,U=pe-W,q=m==null?te():m;for(j.dlShiftTo(U,q),v.compareTo(q)>=0&&(v[v.t++]=1,v.subTo(q,v)),$.ONE.dlShiftTo(W,q),q.subTo(j,j);j.t<W;)j[j.t++]=0;for(;--U>=0;){var G=v[--pe]==V?this.DM:Math.floor(v[pe]*ne+(v[pe-1]+he)*ce);if((v[pe]+=j.am(0,G,v,U,0,W))<G)for(j.dlShiftTo(U,q),v.subTo(q,v);v[pe]<--G;)v.subTo(q,v)}m!=null&&(v.drShiftTo(W,m),K!=B&&$.ZERO.subTo(m,m)),v.t=W,v.clamp(),H>0&&v.rShiftTo(H,v),K<0&&$.ZERO.subTo(v,v)}}},$.prototype.invDigit=function(){if(this.t<1)return 0;var f=this[0];if((1&f)==0)return 0;var m=3&f;return(m=(m=(m=(m=m*(2-(15&f)*m)&15)*(2-(255&f)*m)&255)*(2-((65535&f)*m&65535))&65535)*(2-f*m%this.DV)%this.DV)>0?this.DV-m:-m},$.prototype.isEven=function(){return(this.t>0?1&this[0]:this.s)==0},$.prototype.exp=function(f,m){if(f>4294967295||f<1)return $.ONE;var v=te(),A=te(),C=m.convert(this),j=Ze(f)-1;for(C.copyTo(v);--j>=0;)if(m.sqrTo(v,A),(f&1<<j)>0)m.mulTo(A,C,v);else{var K=v;v=A,A=K}return m.revert(v)},$.prototype.toString=function(f){if(this.s<0)return"-"+this.negate().toString(f);var m;if(f==16)m=4;else if(f==8)m=3;else if(f==2)m=1;else if(f==32)m=5;else{if(f!=4)return this.toRadix(f);m=2}var v,A=(1<<m)-1,C=!1,j="",K=this.t,B=this.DB-K*this.DB%m;if(K-- >0)for(B<this.DB&&(v=this[K]>>B)>0&&(C=!0,j=se(v));K>=0;)B<m?(v=(this[K]&(1<<B)-1)<<m-B,v|=this[--K]>>(B+=this.DB-m)):(v=this[K]>>(B-=m)&A,B<=0&&(B+=this.DB,--K)),v>0&&(C=!0),C&&(j+=se(v));return C?j:"0"},$.prototype.negate=function(){var f=te();return $.ZERO.subTo(this,f),f},$.prototype.abs=function(){return this.s<0?this.negate():this},$.prototype.compareTo=function(f){var m=this.s-f.s;if(m!=0)return m;var v=this.t;if((m=v-f.t)!=0)return this.s<0?-m:m;for(;--v>=0;)if((m=this[v]-f[v])!=0)return m;return 0},$.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+Ze(this[this.t-1]^this.s&this.DM)},$.prototype.mod=function(f){var m=te();return this.abs().divRemTo(f,null,m),this.s<0&&m.compareTo($.ZERO)>0&&f.subTo(m,m),m},$.prototype.modPowInt=function(f,m){var v;return v=f<256||m.isEven()?new Ee(m):new Ve(m),this.exp(f,v)},$.ZERO=Ce(0),$.ONE=Ce(1),Fn.prototype.convert=ln,Fn.prototype.revert=ln,Fn.prototype.mulTo=function(f,m,v){f.multiplyTo(m,v)},Fn.prototype.sqrTo=function(f,m){f.squareTo(m)},vn.prototype.convert=function(f){if(f.s<0||f.t>2*this.m.t)return f.mod(this.m);if(f.compareTo(this.m)<0)return f;var m=te();return f.copyTo(m),this.reduce(m),m},vn.prototype.revert=function(f){return f},vn.prototype.reduce=function(f){for(f.drShiftTo(this.m.t-1,this.r2),f.t>this.m.t+1&&(f.t=this.m.t+1,f.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);f.compareTo(this.r2)<0;)f.dAddOffset(1,this.m.t+1);for(f.subTo(this.r2,f);f.compareTo(this.m)>=0;)f.subTo(this.m,f)},vn.prototype.mulTo=function(f,m,v){f.multiplyTo(m,v),this.reduce(v)},vn.prototype.sqrTo=function(f,m){f.squareTo(m),this.reduce(m)};var Mt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Q=(1<<26)/Mt[Mt.length-1];/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */function N(){this.i=0,this.j=0,this.S=new Array}$.prototype.chunkSize=function(f){return Math.floor(Math.LN2*this.DB/Math.log(f))},$.prototype.toRadix=function(f){if(f==null&&(f=10),this.signum()==0||f<2||f>36)return"0";var m=this.chunkSize(f),v=Math.pow(f,m),A=Ce(v),C=te(),j=te(),K="";for(this.divRemTo(A,C,j);C.signum()>0;)K=(v+j.intValue()).toString(f).substr(1)+K,C.divRemTo(A,C,j);return j.intValue().toString(f)+K},$.prototype.fromRadix=function(f,m){this.fromInt(0),m==null&&(m=10);for(var v=this.chunkSize(m),A=Math.pow(m,v),C=!1,j=0,K=0,B=0;B<f.length;++B){var H=we(f,B);H<0?f.charAt(B)=="-"&&this.signum()==0&&(C=!0):(K=m*K+H,++j>=v&&(this.dMultiply(A),this.dAddOffset(K,0),j=0,K=0))}j>0&&(this.dMultiply(Math.pow(m,j)),this.dAddOffset(K,0)),C&&$.ZERO.subTo(this,this)},$.prototype.fromNumber=function(f,m,v){if(typeof m=="number")if(f<2)this.fromInt(1);else for(this.fromNumber(f,v),this.testBit(f-1)||this.bitwiseTo($.ONE.shiftLeft(f-1),tt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(m);)this.dAddOffset(2,0),this.bitLength()>f&&this.subTo($.ONE.shiftLeft(f-1),this);else{var A=new Array,C=7&f;A.length=1+(f>>3),m.nextBytes(A),C>0?A[0]&=(1<<C)-1:A[0]=0,this.fromString(A,256)}},$.prototype.bitwiseTo=function(f,m,v){var A,C,j=Math.min(f.t,this.t);for(A=0;A<j;++A)v[A]=m(this[A],f[A]);if(f.t<this.t){for(C=f.s&this.DM,A=j;A<this.t;++A)v[A]=m(this[A],C);v.t=this.t}else{for(C=this.s&this.DM,A=j;A<f.t;++A)v[A]=m(C,f[A]);v.t=f.t}v.s=m(this.s,f.s),v.clamp()},$.prototype.changeBit=function(f,m){var v=$.ONE.shiftLeft(f);return this.bitwiseTo(v,m,v),v},$.prototype.addTo=function(f,m){for(var v=0,A=0,C=Math.min(f.t,this.t);v<C;)A+=this[v]+f[v],m[v++]=A&this.DM,A>>=this.DB;if(f.t<this.t){for(A+=f.s;v<this.t;)A+=this[v],m[v++]=A&this.DM,A>>=this.DB;A+=this.s}else{for(A+=this.s;v<f.t;)A+=f[v],m[v++]=A&this.DM,A>>=this.DB;A+=f.s}m.s=A<0?-1:0,A>0?m[v++]=A:A<-1&&(m[v++]=this.DV+A),m.t=v,m.clamp()},$.prototype.dMultiply=function(f){this[this.t]=this.am(0,f-1,this,0,0,this.t),++this.t,this.clamp()},$.prototype.dAddOffset=function(f,m){if(f!=0){for(;this.t<=m;)this[this.t++]=0;for(this[m]+=f;this[m]>=this.DV;)this[m]-=this.DV,++m>=this.t&&(this[this.t++]=0),++this[m]}},$.prototype.multiplyLowerTo=function(f,m,v){var A,C=Math.min(this.t+f.t,m);for(v.s=0,v.t=C;C>0;)v[--C]=0;for(A=v.t-this.t;C<A;++C)v[C+this.t]=this.am(0,f[C],v,C,0,this.t);for(A=Math.min(f.t,m);C<A;++C)this.am(0,f[C],v,C,0,m-C);v.clamp()},$.prototype.multiplyUpperTo=function(f,m,v){--m;var A=v.t=this.t+f.t-m;for(v.s=0;--A>=0;)v[A]=0;for(A=Math.max(m-this.t,0);A<f.t;++A)v[this.t+A-m]=this.am(m-A,f[A],v,0,0,this.t+A-m);v.clamp(),v.drShiftTo(1,v)},$.prototype.modInt=function(f){if(f<=0)return 0;var m=this.DV%f,v=this.s<0?f-1:0;if(this.t>0)if(m==0)v=this[0]%f;else for(var A=this.t-1;A>=0;--A)v=(m*v+this[A])%f;return v},$.prototype.millerRabin=function(f){var m=this.subtract($.ONE),v=m.getLowestSetBit();if(v<=0)return!1;var A=m.shiftRight(v);(f=f+1>>1)>Mt.length&&(f=Mt.length);for(var C=te(),j=0;j<f;++j){C.fromInt(Mt[Math.floor(Math.random()*Mt.length)]);var K=C.modPow(A,this);if(K.compareTo($.ONE)!=0&&K.compareTo(m)!=0){for(var B=1;B++<v&&K.compareTo(m)!=0;)if((K=K.modPowInt(2,this)).compareTo($.ONE)==0)return!1;if(K.compareTo(m)!=0)return!1}}return!0},$.prototype.clone=function(){var f=te();return this.copyTo(f),f},$.prototype.intValue=function(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},$.prototype.byteValue=function(){return this.t==0?this.s:this[0]<<24>>24},$.prototype.shortValue=function(){return this.t==0?this.s:this[0]<<16>>16},$.prototype.signum=function(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1},$.prototype.toByteArray=function(){var f=this.t,m=new Array;m[0]=this.s;var v,A=this.DB-f*this.DB%8,C=0;if(f-- >0)for(A<this.DB&&(v=this[f]>>A)!=(this.s&this.DM)>>A&&(m[C++]=v|this.s<<this.DB-A);f>=0;)A<8?(v=(this[f]&(1<<A)-1)<<8-A,v|=this[--f]>>(A+=this.DB-8)):(v=this[f]>>(A-=8)&255,A<=0&&(A+=this.DB,--f)),(128&v)!=0&&(v|=-256),C==0&&(128&this.s)!=(128&v)&&++C,(C>0||v!=this.s)&&(m[C++]=v);return m},$.prototype.equals=function(f){return this.compareTo(f)==0},$.prototype.min=function(f){return this.compareTo(f)<0?this:f},$.prototype.max=function(f){return this.compareTo(f)>0?this:f},$.prototype.and=function(f){var m=te();return this.bitwiseTo(f,Ge,m),m},$.prototype.or=function(f){var m=te();return this.bitwiseTo(f,tt,m),m},$.prototype.xor=function(f){var m=te();return this.bitwiseTo(f,rn,m),m},$.prototype.andNot=function(f){var m=te();return this.bitwiseTo(f,St,m),m},$.prototype.not=function(){for(var f=te(),m=0;m<this.t;++m)f[m]=this.DM&~this[m];return f.t=this.t,f.s=~this.s,f},$.prototype.shiftLeft=function(f){var m=te();return f<0?this.rShiftTo(-f,m):this.lShiftTo(f,m),m},$.prototype.shiftRight=function(f){var m=te();return f<0?this.lShiftTo(-f,m):this.rShiftTo(f,m),m},$.prototype.getLowestSetBit=function(){for(var f=0;f<this.t;++f)if(this[f]!=0)return f*this.DB+cn(this[f]);return this.s<0?this.t*this.DB:-1},$.prototype.bitCount=function(){for(var f=0,m=this.s&this.DM,v=0;v<this.t;++v)f+=_r(this[v]^m);return f},$.prototype.testBit=function(f){var m=Math.floor(f/this.DB);return m>=this.t?this.s!=0:(this[m]&1<<f%this.DB)!=0},$.prototype.setBit=function(f){return this.changeBit(f,tt)},$.prototype.clearBit=function(f){return this.changeBit(f,St)},$.prototype.flipBit=function(f){return this.changeBit(f,rn)},$.prototype.add=function(f){var m=te();return this.addTo(f,m),m},$.prototype.subtract=function(f){var m=te();return this.subTo(f,m),m},$.prototype.multiply=function(f){var m=te();return this.multiplyTo(f,m),m},$.prototype.divide=function(f){var m=te();return this.divRemTo(f,m,null),m},$.prototype.remainder=function(f){var m=te();return this.divRemTo(f,null,m),m},$.prototype.divideAndRemainder=function(f){var m=te(),v=te();return this.divRemTo(f,m,v),new Array(m,v)},$.prototype.modPow=function(f,m){var v,A,C=f.bitLength(),j=Ce(1);if(C<=0)return j;v=C<18?1:C<48?3:C<144?4:C<768?5:6,A=C<8?new Ee(m):m.isEven()?new vn(m):new Ve(m);var K=new Array,B=3,H=v-1,W=(1<<v)-1;if(K[1]=A.convert(this),v>1){var V=te();for(A.sqrTo(K[1],V);B<=W;)K[B]=te(),A.mulTo(V,K[B-2],K[B]),B+=2}var Z,ne,ce=f.t-1,he=!0,pe=te();for(C=Ze(f[ce])-1;ce>=0;){for(C>=H?Z=f[ce]>>C-H&W:(Z=(f[ce]&(1<<C+1)-1)<<H-C,ce>0&&(Z|=f[ce-1]>>this.DB+C-H)),B=v;(1&Z)==0;)Z>>=1,--B;if((C-=B)<0&&(C+=this.DB,--ce),he)K[Z].copyTo(j),he=!1;else{for(;B>1;)A.sqrTo(j,pe),A.sqrTo(pe,j),B-=2;B>0?A.sqrTo(j,pe):(ne=j,j=pe,pe=ne),A.mulTo(pe,K[Z],j)}for(;ce>=0&&(f[ce]&1<<C)==0;)A.sqrTo(j,pe),ne=j,j=pe,pe=ne,--C<0&&(C=this.DB-1,--ce)}return A.revert(j)},$.prototype.modInverse=function(f){var m=f.isEven();if(this.isEven()&&m||f.signum()==0)return $.ZERO;for(var v=f.clone(),A=this.clone(),C=Ce(1),j=Ce(0),K=Ce(0),B=Ce(1);v.signum()!=0;){for(;v.isEven();)v.rShiftTo(1,v),m?(C.isEven()&&j.isEven()||(C.addTo(this,C),j.subTo(f,j)),C.rShiftTo(1,C)):j.isEven()||j.subTo(f,j),j.rShiftTo(1,j);for(;A.isEven();)A.rShiftTo(1,A),m?(K.isEven()&&B.isEven()||(K.addTo(this,K),B.subTo(f,B)),K.rShiftTo(1,K)):B.isEven()||B.subTo(f,B),B.rShiftTo(1,B);v.compareTo(A)>=0?(v.subTo(A,v),m&&C.subTo(K,C),j.subTo(B,j)):(A.subTo(v,A),m&&K.subTo(C,K),B.subTo(j,B))}return A.compareTo($.ONE)!=0?$.ZERO:B.compareTo(f)>=0?B.subtract(f):B.signum()<0?(B.addTo(f,B),B.signum()<0?B.add(f):B):B},$.prototype.pow=function(f){return this.exp(f,new Fn)},$.prototype.gcd=function(f){var m=this.s<0?this.negate():this.clone(),v=f.s<0?f.negate():f.clone();if(m.compareTo(v)<0){var A=m;m=v,v=A}var C=m.getLowestSetBit(),j=v.getLowestSetBit();if(j<0)return m;for(C<j&&(j=C),j>0&&(m.rShiftTo(j,m),v.rShiftTo(j,v));m.signum()>0;)(C=m.getLowestSetBit())>0&&m.rShiftTo(C,m),(C=v.getLowestSetBit())>0&&v.rShiftTo(C,v),m.compareTo(v)>=0?(m.subTo(v,m),m.rShiftTo(1,m)):(v.subTo(m,v),v.rShiftTo(1,v));return j>0&&v.lShiftTo(j,v),v},$.prototype.isProbablePrime=function(f){var m,v=this.abs();if(v.t==1&&v[0]<=Mt[Mt.length-1]){for(m=0;m<Mt.length;++m)if(v[0]==Mt[m])return!0;return!1}if(v.isEven())return!1;for(m=1;m<Mt.length;){for(var A=Mt[m],C=m+1;C<Mt.length&&A<Q;)A*=Mt[C++];for(A=v.modInt(A);m<C;)if(A%Mt[m++]==0)return!1}return v.millerRabin(f)},$.prototype.square=function(){var f=te();return this.squareTo(f),f},N.prototype.init=function(f){var m,v,A;for(m=0;m<256;++m)this.S[m]=m;for(v=0,m=0;m<256;++m)v=v+this.S[m]+f[m%f.length]&255,A=this.S[m],this.S[m]=this.S[v],this.S[v]=A;this.i=0,this.j=0},N.prototype.next=function(){var f;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,f=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=f,this.S[f+this.S[this.i]&255]};var O,z,ee;/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */function de(){(function(f){z[ee++]^=255&f,z[ee++]^=f>>8&255,z[ee++]^=f>>16&255,z[ee++]^=f>>24&255,ee>=256&&(ee-=256)})(new Date().getTime())}if(z==null){var me;if(z=new Array,ee=0,R!==void 0&&(R.crypto!==void 0||R.msCrypto!==void 0)){var Oe=R.crypto||R.msCrypto;if(Oe.getRandomValues){var nt=new Uint8Array(32);for(Oe.getRandomValues(nt),me=0;me<32;++me)z[ee++]=nt[me]}else if(S.appName=="Netscape"&&S.appVersion<"5"){var xt=R.crypto.random(32);for(me=0;me<xt.length;++me)z[ee++]=255&xt.charCodeAt(me)}}for(;ee<256;)me=Math.floor(65536*Math.random()),z[ee++]=me>>>8,z[ee++]=255&me;ee=0,de()}function ht(){if(O==null){for(de(),(O=function(){return new N}()).init(z),ee=0;ee<z.length;++ee)z[ee]=0;ee=0}return O.next()}function pt(){}/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */function wr(h,f){return new $(h,f)}function Si(h,f,m){for(var v="",A=0;v.length<f;)v+=m(String.fromCharCode.apply(String,h.concat([(4278190080&A)>>24,(16711680&A)>>16,(65280&A)>>8,255&A]))),A+=1;return v}function ke(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */function un(h,f){this.x=f,this.q=h}function L(h,f,m,v){this.curve=h,this.x=f,this.y=m,this.z=v==null?$.ONE:v,this.zinv=null}function x(h,f,m){this.q=h,this.a=this.fromBigInteger(f),this.b=this.fromBigInteger(m),this.infinity=new L(this,null,null)}pt.prototype.nextBytes=function(f){var m;for(m=0;m<f.length;++m)f[m]=ht()},ke.prototype.doPublic=function(f){return f.modPowInt(this.e,this.n)},ke.prototype.setPublic=function(f,m){if(this.isPublic=!0,this.isPrivate=!1,typeof f!="string")this.n=f,this.e=m;else{if(!(f!=null&&m!=null&&f.length>0&&m.length>0))throw"Invalid RSA public key";this.n=wr(f,16),this.e=parseInt(m,16)}},ke.prototype.encrypt=function(f){var m=function(j,K){if(K<j.length+11)throw"Message too long for RSA";for(var B=new Array,H=j.length-1;H>=0&&K>0;){var W=j.charCodeAt(H--);W<128?B[--K]=W:W>127&&W<2048?(B[--K]=63&W|128,B[--K]=W>>6|192):(B[--K]=63&W|128,B[--K]=W>>6&63|128,B[--K]=W>>12|224)}B[--K]=0;for(var V=new pt,Z=new Array;K>2;){for(Z[0]=0;Z[0]==0;)V.nextBytes(Z);B[--K]=Z[0]}return B[--K]=2,B[--K]=0,new $(B)}(f,this.n.bitLength()+7>>3);if(m==null)return null;var v=this.doPublic(m);if(v==null)return null;var A=v.toString(16);return(1&A.length)==0?A:"0"+A},ke.prototype.encryptOAEP=function(f,m,v){var A=function(B,H,W,V){var Z=I.crypto.MessageDigest,ne=I.crypto.Util,ce=null;if(W||(W="sha1"),typeof W=="string"&&(ce=Z.getCanonicalAlgName(W),V=Z.getHashLength(ce),W=function(ye){return Oi(ne.hashHex(_o(ye),ce))}),B.length+2*V+2>H)throw"Message too long for RSA";var he,pe="";for(he=0;he<H-B.length-2*V-2;he+=1)pe+="\0";var U=W("")+pe+""+B,q=new Array(V);new pt().nextBytes(q);var G=Si(q,U.length,W),J=[];for(he=0;he<U.length;he+=1)J[he]=U.charCodeAt(he)^G.charCodeAt(he);var le=Si(J,q.length,W),ge=[0];for(he=0;he<q.length;he+=1)ge[he+1]=q[he]^le.charCodeAt(he);return new $(ge.concat(J))}(f,this.n.bitLength()+7>>3,m,v);if(A==null)return null;var C=this.doPublic(A);if(C==null)return null;var j=C.toString(16);return(1&j.length)==0?j:"0"+j},ke.prototype.type="RSA",un.prototype.equals=function(f){return f==this||this.q.equals(f.q)&&this.x.equals(f.x)},un.prototype.toBigInteger=function(){return this.x},un.prototype.negate=function(){return new un(this.q,this.x.negate().mod(this.q))},un.prototype.add=function(f){return new un(this.q,this.x.add(f.toBigInteger()).mod(this.q))},un.prototype.subtract=function(f){return new un(this.q,this.x.subtract(f.toBigInteger()).mod(this.q))},un.prototype.multiply=function(f){return new un(this.q,this.x.multiply(f.toBigInteger()).mod(this.q))},un.prototype.square=function(){return new un(this.q,this.x.square().mod(this.q))},un.prototype.divide=function(f){return new un(this.q,this.x.multiply(f.toBigInteger().modInverse(this.q)).mod(this.q))},L.prototype.getX=function(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},L.prototype.getY=function(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},L.prototype.equals=function(f){return f==this||(this.isInfinity()?f.isInfinity():f.isInfinity()?this.isInfinity():!!f.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(f.z)).mod(this.curve.q).equals($.ZERO)&&f.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(f.z)).mod(this.curve.q).equals($.ZERO))},L.prototype.isInfinity=function(){return this.x==null&&this.y==null||this.z.equals($.ZERO)&&!this.y.toBigInteger().equals($.ZERO)},L.prototype.negate=function(){return new L(this.curve,this.x,this.y.negate(),this.z)},L.prototype.add=function(f){if(this.isInfinity())return f;if(f.isInfinity())return this;var m=f.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(f.z)).mod(this.curve.q),v=f.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(f.z)).mod(this.curve.q);if($.ZERO.equals(v))return $.ZERO.equals(m)?this.twice():this.curve.getInfinity();var A=new $("3"),C=this.x.toBigInteger(),j=this.y.toBigInteger(),K=(f.x.toBigInteger(),f.y.toBigInteger(),v.square()),B=K.multiply(v),H=C.multiply(K),W=m.square().multiply(this.z),V=W.subtract(H.shiftLeft(1)).multiply(f.z).subtract(B).multiply(v).mod(this.curve.q),Z=H.multiply(A).multiply(m).subtract(j.multiply(B)).subtract(W.multiply(m)).multiply(f.z).add(m.multiply(B)).mod(this.curve.q),ne=B.multiply(this.z).multiply(f.z).mod(this.curve.q);return new L(this.curve,this.curve.fromBigInteger(V),this.curve.fromBigInteger(Z),ne)},L.prototype.twice=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var f=new $("3"),m=this.x.toBigInteger(),v=this.y.toBigInteger(),A=v.multiply(this.z),C=A.multiply(v).mod(this.curve.q),j=this.curve.a.toBigInteger(),K=m.square().multiply(f);$.ZERO.equals(j)||(K=K.add(this.z.square().multiply(j)));var B=(K=K.mod(this.curve.q)).square().subtract(m.shiftLeft(3).multiply(C)).shiftLeft(1).multiply(A).mod(this.curve.q),H=K.multiply(f).multiply(m).subtract(C.shiftLeft(1)).shiftLeft(2).multiply(C).subtract(K.square().multiply(K)).mod(this.curve.q),W=A.square().multiply(A).shiftLeft(3).mod(this.curve.q);return new L(this.curve,this.curve.fromBigInteger(B),this.curve.fromBigInteger(H),W)},L.prototype.multiply=function(f){if(this.isInfinity())return this;if(f.signum()==0)return this.curve.getInfinity();var m,v=f,A=v.multiply(new $("3")),C=this.negate(),j=this,K=this.curve.q.subtract(f),B=K.multiply(new $("3")),H=new L(this.curve,this.x,this.y),W=H.negate();for(m=A.bitLength()-2;m>0;--m){j=j.twice();var V=A.testBit(m);V!=v.testBit(m)&&(j=j.add(V?this:C))}for(m=B.bitLength()-2;m>0;--m){H=H.twice();var Z=B.testBit(m);Z!=K.testBit(m)&&(H=H.add(Z?H:W))}return j},L.prototype.multiplyTwo=function(f,m,v){var A;A=f.bitLength()>v.bitLength()?f.bitLength()-1:v.bitLength()-1;for(var C=this.curve.getInfinity(),j=this.add(m);A>=0;)C=C.twice(),f.testBit(A)?C=v.testBit(A)?C.add(j):C.add(this):v.testBit(A)&&(C=C.add(m)),--A;return C},x.prototype.getQ=function(){return this.q},x.prototype.getA=function(){return this.a},x.prototype.getB=function(){return this.b},x.prototype.equals=function(f){return f==this||this.q.equals(f.q)&&this.a.equals(f.a)&&this.b.equals(f.b)},x.prototype.getInfinity=function(){return this.infinity},x.prototype.fromBigInteger=function(f){return new un(this.q,f)},x.prototype.decodePointHex=function(f){switch(parseInt(f.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var m=(f.length-2)/2,v=f.substr(2,m),A=f.substr(m+2,m);return new L(this,this.fromBigInteger(new $(v,16)),this.fromBigInteger(new $(A,16)));default:return null}},un.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},L.prototype.getEncoded=function(h){var f=function(j,K){var B=j.toByteArrayUnsigned();if(K<B.length)B=B.slice(B.length-K);else for(;K>B.length;)B.unshift(0);return B},m=this.getX().toBigInteger(),v=this.getY().toBigInteger(),A=f(m,32);return h?v.isEven()?A.unshift(2):A.unshift(3):(A.unshift(4),A=A.concat(f(v,32))),A},L.decodeFrom=function(h,f){f[0];var m=f.length-1,v=f.slice(1,1+m/2),A=f.slice(1+m/2,1+m);v.unshift(0),A.unshift(0);var C=new $(v),j=new $(A);return new L(h,h.fromBigInteger(C),h.fromBigInteger(j))},L.decodeFromHex=function(h,f){f.substr(0,2);var m=f.length-2,v=f.substr(2,m/2),A=f.substr(2+m/2,m/2),C=new $(v,16),j=new $(A,16);return new L(h,h.fromBigInteger(C),h.fromBigInteger(j))},L.prototype.add2D=function(h){if(this.isInfinity())return h;if(h.isInfinity())return this;if(this.x.equals(h.x))return this.y.equals(h.y)?this.twice():this.curve.getInfinity();var f=h.x.subtract(this.x),m=h.y.subtract(this.y).divide(f),v=m.square().subtract(this.x).subtract(h.x),A=m.multiply(this.x.subtract(v)).subtract(this.y);return new L(this.curve,v,A)},L.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var h=this.curve.fromBigInteger($.valueOf(2)),f=this.curve.fromBigInteger($.valueOf(3)),m=this.x.square().multiply(f).add(this.curve.a).divide(this.y.multiply(h)),v=m.square().subtract(this.x.multiply(h)),A=m.multiply(this.x.subtract(v)).subtract(this.y);return new L(this.curve,v,A)},L.prototype.multiply2D=function(h){if(this.isInfinity())return this;if(h.signum()==0)return this.curve.getInfinity();var f,m=h,v=m.multiply(new $("3")),A=this.negate(),C=this;for(f=v.bitLength()-2;f>0;--f){C=C.twice();var j=v.testBit(f);j!=m.testBit(f)&&(C=C.add2D(j?this:A))}return C},L.prototype.isOnCurve=function(){var h=this.getX().toBigInteger(),f=this.getY().toBigInteger(),m=this.curve.getA().toBigInteger(),v=this.curve.getB().toBigInteger(),A=this.curve.getQ(),C=f.multiply(f).mod(A),j=h.multiply(h).multiply(h).add(m.multiply(h)).add(v).mod(A);return C.equals(j)},L.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},L.prototype.validate=function(){var h=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var f=this.getX().toBigInteger(),m=this.getY().toBigInteger();if(f.compareTo($.ONE)<0||f.compareTo(h.subtract($.ONE))>0)throw new Error("x coordinate out of bounds");if(m.compareTo($.ONE)<0||m.compareTo(h.subtract($.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(h).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};/*! Mike Samuel (c) 2009 | code.google.com/p/json-sans-eval
 */var k=function(){var h=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),f=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),m={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function v(j,K,B){return K?m[K]:String.fromCharCode(parseInt(B,16))}var A=new String(""),C=Object.hasOwnProperty;return function(j,K){var B,H,W=j.match(h),V=W[0],Z=!1;V==="{"?B={}:V==="["?B=[]:(B=[],Z=!0);for(var ne=[B],ce=1-Z,he=W.length;ce<he;++ce){var pe;switch((V=W[ce]).charCodeAt(0)){default:(pe=ne[0])[H||pe.length]=+V,H=void 0;break;case 34:if((V=V.substring(1,V.length-1)).indexOf("\\")!==-1&&(V=V.replace(f,v)),pe=ne[0],!H){if(!(pe instanceof Array)){H=V||A;break}H=pe.length}pe[H]=V,H=void 0;break;case 91:pe=ne[0],ne.unshift(pe[H||pe.length]=[]),H=void 0;break;case 93:ne.shift();break;case 102:(pe=ne[0])[H||pe.length]=!1,H=void 0;break;case 110:(pe=ne[0])[H||pe.length]=null,H=void 0;break;case 116:(pe=ne[0])[H||pe.length]=!0,H=void 0;break;case 123:pe=ne[0],ne.unshift(pe[H||pe.length]={}),H=void 0;break;case 125:ne.shift()}}if(Z){if(ne.length!==1)throw new Error;B=B[0]}else if(ne.length)throw new Error;return K&&(B=function U(q,G){var J=q[G];if(J&&(J===void 0?"undefined":b(J))==="object"){var le=null;for(var ge in J)if(C.call(J,ge)&&J!==q){var Re=U(J,ge);Re!==void 0?J[ge]=Re:(le||(le=[]),le.push(ge))}if(le)for(var ye=le.length;--ye>=0;)delete J[le[ye]]}return K.call(q,G,J)}({"":B},"")),B}}();I!==void 0&&I||(r.KJUR=I={}),I.asn1!==void 0&&I.asn1||(I.asn1={}),I.asn1.ASN1Util=new function(){this.integerToByteHex=function(h){var f=h.toString(16);return f.length%2==1&&(f="0"+f),f},this.bigIntToMinTwosComplementsHex=function(h){var f=h.toString(16);if(f.substr(0,1)!="-")f.length%2==1?f="0"+f:f.match(/^[0-7]/)||(f="00"+f);else{var m=f.substr(1).length;m%2==1?m+=1:f.match(/^[0-7]/)||(m+=2);for(var v="",A=0;A<m;A++)v+="f";f=new $(v,16).xor(h).add($.ONE).toString(16).replace(/^-/,"")}return f},this.getPEMStringFromHex=function(h,f){return fi(h,f)},this.newObject=function(h){var f=I.asn1,m=f.ASN1Object,v=f.DERBoolean,A=f.DERInteger,C=f.DERBitString,j=f.DEROctetString,K=f.DERNull,B=f.DERObjectIdentifier,H=f.DEREnumerated,W=f.DERUTF8String,V=f.DERNumericString,Z=f.DERPrintableString,ne=f.DERTeletexString,ce=f.DERIA5String,he=f.DERUTCTime,pe=f.DERGeneralizedTime,U=f.DERVisibleString,q=f.DERBMPString,G=f.DERSequence,J=f.DERSet,le=f.DERTaggedObject,ge=f.ASN1Util.newObject;if(h instanceof f.ASN1Object)return h;var Re=Object.keys(h);if(Re.length!=1)throw new Error("key of param shall be only one.");var ye=Re[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+ye+":")==-1)throw new Error("undefined key: "+ye);if(ye=="bool")return new v(h[ye]);if(ye=="int")return new A(h[ye]);if(ye=="bitstr")return new C(h[ye]);if(ye=="octstr")return new j(h[ye]);if(ye=="null")return new K(h[ye]);if(ye=="oid")return new B(h[ye]);if(ye=="enum")return new H(h[ye]);if(ye=="utf8str")return new W(h[ye]);if(ye=="numstr")return new V(h[ye]);if(ye=="prnstr")return new Z(h[ye]);if(ye=="telstr")return new ne(h[ye]);if(ye=="ia5str")return new ce(h[ye]);if(ye=="utctime")return new he(h[ye]);if(ye=="gentime")return new pe(h[ye]);if(ye=="visstr")return new U(h[ye]);if(ye=="bmpstr")return new q(h[ye]);if(ye=="asn1")return new m(h[ye]);if(ye=="seq"){for(var mt=h[ye],xe=[],qe=0;qe<mt.length;qe++){var on=ge(mt[qe]);xe.push(on)}return new G({array:xe})}if(ye=="set"){for(mt=h[ye],xe=[],qe=0;qe<mt.length;qe++)on=ge(mt[qe]),xe.push(on);return new J({array:xe})}if(ye=="tag"){var bn=h[ye];if(Object.prototype.toString.call(bn)==="[object Array]"&&bn.length==3){var hn=ge(bn[2]);return new le({tag:bn[0],explicit:bn[1],obj:hn})}return new le(bn)}},this.jsonToASN1HEX=function(h){return this.newObject(h).getEncodedHex()}},I.asn1.ASN1Util.oidHexToInt=function(h){for(var f="",m=parseInt(h.substr(0,2),16),v=(f=Math.floor(m/40)+"."+m%40,""),A=2;A<h.length;A+=2){var C=("00000000"+parseInt(h.substr(A,2),16).toString(2)).slice(-8);v+=C.substr(1,7),C.substr(0,1)=="0"&&(f=f+"."+new $(v,2).toString(10),v="")}return f},I.asn1.ASN1Util.oidIntToHex=function(h){var f=function(B){var H=B.toString(16);return H.length==1&&(H="0"+H),H},m=function(B){var H="",W=new $(B,10).toString(2),V=7-W.length%7;V==7&&(V=0);for(var Z="",ne=0;ne<V;ne++)Z+="0";for(W=Z+W,ne=0;ne<W.length-1;ne+=7){var ce=W.substr(ne,7);ne!=W.length-7&&(ce="1"+ce),H+=f(parseInt(ce,2))}return H};if(!h.match(/^[0-9.]+$/))throw"malformed oid string: "+h;var v="",A=h.split("."),C=40*parseInt(A[0])+parseInt(A[1]);v+=f(C),A.splice(0,2);for(var j=0;j<A.length;j++)v+=m(A[j]);return v},I.asn1.ASN1Object=function(h){this.params=null,this.getLengthHexFromValue=function(){if(this.hV===void 0||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+0+",v="+this.hV);var f=this.hV.length/2,m=f.toString(16);if(m.length%2==1&&(m="0"+m),f<128)return m;var v=m.length/2;if(v>15)throw"ASN.1 length too long to represent by 8x: n = "+f.toString(16);return(128+v).toString(16)+m},this.getEncodedHex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(f){this.params=f},h!=null&&h.tlv!=null&&(this.hTLV=h.tlv,this.isModified=!1)},I.asn1.DERAbstractString=function(h){I.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(f){this.hTLV=null,this.isModified=!0,this.s=f,this.hV=hh(this.s).toLowerCase()},this.setStringHex=function(f){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=f},this.getFreshValueHex=function(){return this.hV},h!==void 0&&(typeof h=="string"?this.setString(h):h.str!==void 0?this.setString(h.str):h.hex!==void 0&&this.setStringHex(h.hex))},Ln(I.asn1.DERAbstractString,I.asn1.ASN1Object),I.asn1.DERAbstractTime=function(h){I.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(f){var m=f.getTime()+6e4*f.getTimezoneOffset();return new Date(m)},this.formatDate=function(f,m,v){var A=this.zeroPadding,C=this.localDateToUTC(f),j=String(C.getFullYear());m=="utc"&&(j=j.substr(2,2));var K=j+A(String(C.getMonth()+1),2)+A(String(C.getDate()),2)+A(String(C.getHours()),2)+A(String(C.getMinutes()),2)+A(String(C.getSeconds()),2);if(v===!0){var B=C.getMilliseconds();if(B!=0){var H=A(String(B),3);K=K+"."+(H=H.replace(/[0]+$/,""))}}return K+"Z"},this.zeroPadding=function(f,m){return f.length>=m?f:new Array(m-f.length+1).join("0")+f},this.getString=function(){return this.s},this.setString=function(f){this.hTLV=null,this.isModified=!0,this.s=f,this.hV=Dt(f)},this.setByDateValue=function(f,m,v,A,C,j){var K=new Date(Date.UTC(f,m-1,v,A,C,j,0));this.setByDate(K)},this.getFreshValueHex=function(){return this.hV}},Ln(I.asn1.DERAbstractTime,I.asn1.ASN1Object),I.asn1.DERAbstractStructured=function(h){I.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(f){this.hTLV=null,this.isModified=!0,this.asn1Array=f},this.appendASN1Object=function(f){this.hTLV=null,this.isModified=!0,this.asn1Array.push(f)},this.asn1Array=new Array,h!==void 0&&h.array!==void 0&&(this.asn1Array=h.array)},Ln(I.asn1.DERAbstractStructured,I.asn1.ASN1Object),I.asn1.DERBoolean=function(h){I.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=h==0?"010100":"0101ff"},Ln(I.asn1.DERBoolean,I.asn1.ASN1Object),I.asn1.DERInteger=function(h){I.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(f){this.hTLV=null,this.isModified=!0,this.hV=I.asn1.ASN1Util.bigIntToMinTwosComplementsHex(f)},this.setByInteger=function(f){var m=new $(String(f),10);this.setByBigInteger(m)},this.setValueHex=function(f){this.hV=f},this.getFreshValueHex=function(){return this.hV},h!==void 0&&(h.bigint!==void 0?this.setByBigInteger(h.bigint):h.int!==void 0?this.setByInteger(h.int):typeof h=="number"?this.setByInteger(h):h.hex!==void 0&&this.setValueHex(h.hex))},Ln(I.asn1.DERInteger,I.asn1.ASN1Object),I.asn1.DERBitString=function(h){if(h!==void 0&&h.obj!==void 0){var f=I.asn1.ASN1Util.newObject(h.obj);h.hex="00"+f.getEncodedHex()}I.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(m){this.hTLV=null,this.isModified=!0,this.hV=m},this.setUnusedBitsAndHexValue=function(m,v){if(m<0||7<m)throw"unused bits shall be from 0 to 7: u = "+m;var A="0"+m;this.hTLV=null,this.isModified=!0,this.hV=A+v},this.setByBinaryString=function(m){var v=8-(m=m.replace(/0+$/,"")).length%8;v==8&&(v=0);for(var A=0;A<=v;A++)m+="0";var C="";for(A=0;A<m.length-1;A+=8){var j=m.substr(A,8),K=parseInt(j,2).toString(16);K.length==1&&(K="0"+K),C+=K}this.hTLV=null,this.isModified=!0,this.hV="0"+v+C},this.setByBooleanArray=function(m){for(var v="",A=0;A<m.length;A++)m[A]==1?v+="1":v+="0";this.setByBinaryString(v)},this.newFalseArray=function(m){for(var v=new Array(m),A=0;A<m;A++)v[A]=!1;return v},this.getFreshValueHex=function(){return this.hV},h!==void 0&&(typeof h=="string"&&h.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(h):h.hex!==void 0?this.setHexValueIncludingUnusedBits(h.hex):h.bin!==void 0?this.setByBinaryString(h.bin):h.array!==void 0&&this.setByBooleanArray(h.array))},Ln(I.asn1.DERBitString,I.asn1.ASN1Object),I.asn1.DEROctetString=function(h){if(h!==void 0&&h.obj!==void 0){var f=I.asn1.ASN1Util.newObject(h.obj);h.hex=f.getEncodedHex()}I.asn1.DEROctetString.superclass.constructor.call(this,h),this.hT="04"},Ln(I.asn1.DEROctetString,I.asn1.DERAbstractString),I.asn1.DERNull=function(){I.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},Ln(I.asn1.DERNull,I.asn1.ASN1Object),I.asn1.DERObjectIdentifier=function(h){I.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(f){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=f},this.setValueOidString=function(f){var m=function(A){var C=function(Z){var ne=Z.toString(16);return ne.length==1&&(ne="0"+ne),ne},j=function(Z){var ne="",ce=parseInt(Z,10).toString(2),he=7-ce.length%7;he==7&&(he=0);for(var pe="",U=0;U<he;U++)pe+="0";for(ce=pe+ce,U=0;U<ce.length-1;U+=7){var q=ce.substr(U,7);U!=ce.length-7&&(q="1"+q),ne+=C(parseInt(q,2))}return ne};try{if(!A.match(/^[0-9.]+$/))return null;var K="",B=A.split("."),H=40*parseInt(B[0],10)+parseInt(B[1],10);K+=C(H),B.splice(0,2);for(var W=0;W<B.length;W++)K+=j(B[W]);return K}catch{return null}}(f);if(m==null)throw new Error("malformed oid string: "+f);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=m},this.setValueName=function(f){var m=I.asn1.x509.OID.name2oid(f);if(m==="")throw new Error("DERObjectIdentifier oidName undefined: "+f);this.setValueOidString(m)},this.setValueNameOrOid=function(f){f.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(f):this.setValueName(f)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(f){typeof f=="string"?this.setValueNameOrOid(f):f.oid!==void 0?this.setValueNameOrOid(f.oid):f.name!==void 0?this.setValueNameOrOid(f.name):f.hex!==void 0&&this.setValueHex(f.hex)},h!==void 0&&this.setByParam(h)},Ln(I.asn1.DERObjectIdentifier,I.asn1.ASN1Object),I.asn1.DEREnumerated=function(h){I.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(f){this.hTLV=null,this.isModified=!0,this.hV=I.asn1.ASN1Util.bigIntToMinTwosComplementsHex(f)},this.setByInteger=function(f){var m=new $(String(f),10);this.setByBigInteger(m)},this.setValueHex=function(f){this.hV=f},this.getFreshValueHex=function(){return this.hV},h!==void 0&&(h.int!==void 0?this.setByInteger(h.int):typeof h=="number"?this.setByInteger(h):h.hex!==void 0&&this.setValueHex(h.hex))},Ln(I.asn1.DEREnumerated,I.asn1.ASN1Object),I.asn1.DERUTF8String=function(h){I.asn1.DERUTF8String.superclass.constructor.call(this,h),this.hT="0c"},Ln(I.asn1.DERUTF8String,I.asn1.DERAbstractString),I.asn1.DERNumericString=function(h){I.asn1.DERNumericString.superclass.constructor.call(this,h),this.hT="12"},Ln(I.asn1.DERNumericString,I.asn1.DERAbstractString),I.asn1.DERPrintableString=function(h){I.asn1.DERPrintableString.superclass.constructor.call(this,h),this.hT="13"},Ln(I.asn1.DERPrintableString,I.asn1.DERAbstractString),I.asn1.DERTeletexString=function(h){I.asn1.DERTeletexString.superclass.constructor.call(this,h),this.hT="14"},Ln(I.asn1.DERTeletexString,I.asn1.DERAbstractString),I.asn1.DERIA5String=function(h){I.asn1.DERIA5String.superclass.constructor.call(this,h),this.hT="16"},Ln(I.asn1.DERIA5String,I.asn1.DERAbstractString),I.asn1.DERVisibleString=function(h){I.asn1.DERIA5String.superclass.constructor.call(this,h),this.hT="1a"},Ln(I.asn1.DERVisibleString,I.asn1.DERAbstractString),I.asn1.DERBMPString=function(h){I.asn1.DERBMPString.superclass.constructor.call(this,h),this.hT="1e"},Ln(I.asn1.DERBMPString,I.asn1.DERAbstractString),I.asn1.DERUTCTime=function(h){I.asn1.DERUTCTime.superclass.constructor.call(this,h),this.hT="17",this.setByDate=function(f){this.hTLV=null,this.isModified=!0,this.date=f,this.s=this.formatDate(this.date,"utc"),this.hV=Dt(this.s)},this.getFreshValueHex=function(){return this.date===void 0&&this.s===void 0&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=Dt(this.s)),this.hV},h!==void 0&&(h.str!==void 0?this.setString(h.str):typeof h=="string"&&h.match(/^[0-9]{12}Z$/)?this.setString(h):h.hex!==void 0?this.setStringHex(h.hex):h.date!==void 0&&this.setByDate(h.date))},Ln(I.asn1.DERUTCTime,I.asn1.DERAbstractTime),I.asn1.DERGeneralizedTime=function(h){I.asn1.DERGeneralizedTime.superclass.constructor.call(this,h),this.hT="18",this.withMillis=!1,this.setByDate=function(f){this.hTLV=null,this.isModified=!0,this.date=f,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=Dt(this.s)},this.getFreshValueHex=function(){return this.date===void 0&&this.s===void 0&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=Dt(this.s)),this.hV},h!==void 0&&(h.str!==void 0?this.setString(h.str):typeof h=="string"&&h.match(/^[0-9]{14}Z$/)?this.setString(h):h.hex!==void 0?this.setStringHex(h.hex):h.date!==void 0&&this.setByDate(h.date),h.millis===!0&&(this.withMillis=!0))},Ln(I.asn1.DERGeneralizedTime,I.asn1.DERAbstractTime),I.asn1.DERSequence=function(h){I.asn1.DERSequence.superclass.constructor.call(this,h),this.hT="30",this.getFreshValueHex=function(){for(var f="",m=0;m<this.asn1Array.length;m++)f+=this.asn1Array[m].getEncodedHex();return this.hV=f,this.hV}},Ln(I.asn1.DERSequence,I.asn1.DERAbstractStructured),I.asn1.DERSet=function(h){I.asn1.DERSet.superclass.constructor.call(this,h),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var f=new Array,m=0;m<this.asn1Array.length;m++){var v=this.asn1Array[m];f.push(v.getEncodedHex())}return this.sortFlag==1&&f.sort(),this.hV=f.join(""),this.hV},h!==void 0&&h.sortflag!==void 0&&h.sortflag==0&&(this.sortFlag=!1)},Ln(I.asn1.DERSet,I.asn1.DERAbstractStructured),I.asn1.DERTaggedObject=function(h){I.asn1.DERTaggedObject.superclass.constructor.call(this);var f=I.asn1;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(m,v,A){this.hT=v,this.isExplicit=m,this.asn1Object=A,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=A.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,v),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(m){m.tag!=null&&(this.hT=m.tag),m.explicit!=null&&(this.isExplicit=m.explicit),m.tage!=null&&(this.hT=m.tage,this.isExplicit=!0),m.tagi!=null&&(this.hT=m.tagi,this.isExplicit=!1),m.obj!=null&&(m.obj instanceof f.ASN1Object?(this.asn1Object=m.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)):b(m.obj)=="object"&&(this.asn1Object=f.ASN1Util.newObject(m.obj),this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},h!=null&&this.setByParam(h)},Ln(I.asn1.DERTaggedObject,I.asn1.ASN1Object);var I,ie,fe,oe=new function(){};function at(h){for(var f=new Array,m=0;m<h.length;m++)f[m]=h.charCodeAt(m);return f}function dn(h){for(var f="",m=0;m<h.length;m++)f+=String.fromCharCode(h[m]);return f}function $t(h){for(var f="",m=0;m<h.length;m++){var v=h[m].toString(16);v.length==1&&(v="0"+v),f+=v}return f}function Dt(h){return $t(at(h))}function Ct(h){return h=(h=(h=h.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function Gc(h){return h.length%4==2?h+="==":h.length%4==3&&(h+="="),h=(h=h.replace(/-/g,"+")).replace(/_/g,"/")}function cr(h){return h.length%2==1&&(h="0"+h),Ct(D(h))}function fn(h){return Y(Gc(h))}function hh(h){return Nu(Mu(h))}function lr(h){return decodeURIComponent(Ou(h))}function Oi(h){for(var f="",m=0;m<h.length-1;m+=2)f+=String.fromCharCode(parseInt(h.substr(m,2),16));return f}function _o(h){for(var f="",m=0;m<h.length;m++)f+=("0"+h.charCodeAt(m).toString(16)).slice(-2);return f}function Jm(h){return D(h)}function Zm(h){var f=Jm(h).replace(/(.{64})/g,`$1\r
`);return f=f.replace(/\r\n$/,"")}function Qm(h){return Y(h.replace(/[^0-9A-Za-z\/+=]*/g,""))}function fi(h,f){return"-----BEGIN "+f+`-----\r
`+Zm(h)+`\r
-----END `+f+`-----\r
`}function wo(h,f){if(h.indexOf("-----BEGIN ")==-1)throw"can't find PEM header: "+f;return Qm(h=f!==void 0?(h=h.replace(new RegExp("^[^]*-----BEGIN "+f+"-----"),"")).replace(new RegExp("-----END "+f+"-----[^]*$"),""):(h=h.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function ph(h){var f,m,v,A,C,j,K,B,H,W,V;if(V=h.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return B=V[1],f=parseInt(B),B.length===2&&(50<=f&&f<100?f=1900+f:0<=f&&f<50&&(f=2e3+f)),m=parseInt(V[2])-1,v=parseInt(V[3]),A=parseInt(V[4]),C=parseInt(V[5]),j=parseInt(V[6]),K=0,(H=V[7])!==""&&(W=(H.substr(1)+"00").substr(0,3),K=parseInt(W)),Date.UTC(f,m,v,A,C,j,K);throw"unsupported zulu format: "+h}function Xm(h){return~~(ph(h)/1e3)}function Nu(h){return h.replace(/%/g,"")}function Ou(h){return h.replace(/(..)/g,"%$1")}function ey(h){var f="malformed IPv6 address";if(!h.match(/^[0-9A-Fa-f:]+$/))throw f;var m=(h=h.toLowerCase()).split(":").length-1;if(m<2)throw f;var v=":".repeat(7-m+2),A=(h=h.replace("::",v)).split(":");if(A.length!=8)throw f;for(var C=0;C<8;C++)A[C]=("0000"+A[C]).slice(-4);return A.join("")}function ty(h){if(!h.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var f=(h=h.toLowerCase()).match(/.{1,4}/g),m=0;m<8;m++)f[m]=f[m].replace(/^0+/,""),f[m]==""&&(f[m]="0");var v=(h=":"+f.join(":")+":").match(/:(0:){2,}/g);if(v===null)return h.slice(1,-1);var A="";for(m=0;m<v.length;m++)v[m].length>A.length&&(A=v[m]);return(h=h.replace(A,"::")).slice(1,-1)}function gh(h){var f="malformed hex value";if(!h.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw f;if(h.length!=8)return h.length==32?ty(h):h;try{return parseInt(h.substr(0,2),16)+"."+parseInt(h.substr(2,2),16)+"."+parseInt(h.substr(4,2),16)+"."+parseInt(h.substr(6,2),16)}catch{throw f}}function ny(h){return h.match(/.{4}/g).map(function(m){var v=parseInt(m.substr(0,2),16),A=parseInt(m.substr(2),16);if(v==0&A<128)return String.fromCharCode(A);if(v<8){var C=128|63&A;return lr((192|(7&v)<<3|(192&A)>>6).toString(16)+C.toString(16))}C=128|(15&v)<<2|(192&A)>>6;var j=128|63&A;return lr((224|(240&v)>>4).toString(16)+C.toString(16)+j.toString(16))}).join("")}function Mu(h){for(var f=encodeURIComponent(h),m="",v=0;v<f.length;v++)f[v]=="%"?(m+=f.substr(v,3),v+=2):m=m+"%"+Dt(f[v]);return m}function ry(h){return!(h.length%2!=0||!h.match(/^[0-9a-f]+$/)&&!h.match(/^[0-9A-F]+$/))}function mh(h){return h.length%2==1?"0"+h:h.substr(0,1)>"7"?"00"+h:h}oe.getLblen=function(h,f){if(h.substr(f+2,1)!="8")return 1;var m=parseInt(h.substr(f+3,1));return m==0?-1:0<m&&m<10?m+1:-2},oe.getL=function(h,f){var m=oe.getLblen(h,f);return m<1?"":h.substr(f+2,2*m)},oe.getVblen=function(h,f){var m;return(m=oe.getL(h,f))==""?-1:(m.substr(0,1)==="8"?new $(m.substr(2),16):new $(m,16)).intValue()},oe.getVidx=function(h,f){var m=oe.getLblen(h,f);return m<0?m:f+2*(m+1)},oe.getV=function(h,f){var m=oe.getVidx(h,f),v=oe.getVblen(h,f);return h.substr(m,2*v)},oe.getTLV=function(h,f){return h.substr(f,2)+oe.getL(h,f)+oe.getV(h,f)},oe.getTLVblen=function(h,f){return 2+2*oe.getLblen(h,f)+2*oe.getVblen(h,f)},oe.getNextSiblingIdx=function(h,f){return oe.getVidx(h,f)+2*oe.getVblen(h,f)},oe.getChildIdx=function(h,f){var m,v,A,C=oe,j=[];m=C.getVidx(h,f),v=2*C.getVblen(h,f),h.substr(f,2)=="03"&&(m+=2,v-=2),A=0;for(var K=m;A<=v;){var B=C.getTLVblen(h,K);if((A+=B)<=v&&j.push(K),K+=B,A>=v)break}return j},oe.getNthChildIdx=function(h,f,m){return oe.getChildIdx(h,f)[m]},oe.getIdxbyList=function(h,f,m,v){var A,C,j=oe;return m.length==0?v!==void 0&&h.substr(f,2)!==v?-1:f:(A=m.shift())>=(C=j.getChildIdx(h,f)).length?-1:j.getIdxbyList(h,C[A],m,v)},oe.getIdxbyListEx=function(h,f,m,v){var A,C,j=oe;if(m.length==0)return v!==void 0&&h.substr(f,2)!==v?-1:f;A=m.shift(),C=j.getChildIdx(h,f);for(var K=0,B=0;B<C.length;B++){var H=h.substr(C[B],2);if(typeof A=="number"&&!j.isContextTag(H)&&K==A||typeof A=="string"&&j.isContextTag(H,A))return j.getIdxbyListEx(h,C[B],m,v);j.isContextTag(H)||K++}return-1},oe.getTLVbyList=function(h,f,m,v){var A=oe,C=A.getIdxbyList(h,f,m,v);return C==-1||C>=h.length?null:A.getTLV(h,C)},oe.getTLVbyListEx=function(h,f,m,v){var A=oe,C=A.getIdxbyListEx(h,f,m,v);return C==-1?null:A.getTLV(h,C)},oe.getVbyList=function(h,f,m,v,A){var C,j,K=oe;return(C=K.getIdxbyList(h,f,m,v))==-1||C>=h.length?null:(j=K.getV(h,C),A===!0&&(j=j.substr(2)),j)},oe.getVbyListEx=function(h,f,m,v,A){var C,j,K=oe;return(C=K.getIdxbyListEx(h,f,m,v))==-1?null:(j=K.getV(h,C),h.substr(C,2)=="03"&&A!==!1&&(j=j.substr(2)),j)},oe.getInt=function(h,f,m){m==null&&(m=-1);try{var v=h.substr(f,2);if(v!="02"&&v!="03")return m;var A=oe.getV(h,f);return v=="02"?parseInt(A,16):function(j){try{var K=j.substr(0,2);if(K=="00")return parseInt(j.substr(2),16);var B=parseInt(K,16),H=j.substr(2),W=parseInt(H,16).toString(2);return W=="0"&&(W="00000000"),W=W.slice(0,0-B),parseInt(W,2)}catch{return-1}}(A)}catch{return m}},oe.getOID=function(h,f,m){m==null&&(m=null);try{return h.substr(f,2)!="06"?m:function(A){if(!ry(A))return null;try{var C=[],j=A.substr(0,2),K=parseInt(j,16);C[0]=new String(Math.floor(K/40)),C[1]=new String(K%40);for(var B=A.substr(2),H=[],W=0;W<B.length/2;W++)H.push(parseInt(B.substr(2*W,2),16));var V=[],Z="";for(W=0;W<H.length;W++)128&H[W]?Z+=iy((127&H[W]).toString(2),7):(Z+=iy((127&H[W]).toString(2),7),V.push(new String(parseInt(Z,2))),Z="");var ne=C.join(".");return V.length>0&&(ne=ne+"."+V.join(".")),ne}catch{return null}}(oe.getV(h,f))}catch{return m}},oe.getOIDName=function(h,f,m){m==null&&(m=null);try{var v=oe.getOID(h,f,m);if(v==m)return m;var A=I.asn1.x509.OID.oid2name(v);return A==""?v:A}catch{return m}},oe.getString=function(h,f,m){m==null&&(m=null);try{return Oi(oe.getV(h,f))}catch{return m}},oe.hextooidstr=function(h){var f=function(Z,ne){return Z.length>=ne?Z:new Array(ne-Z.length+1).join("0")+Z},m=[],v=h.substr(0,2),A=parseInt(v,16);m[0]=new String(Math.floor(A/40)),m[1]=new String(A%40);for(var C=h.substr(2),j=[],K=0;K<C.length/2;K++)j.push(parseInt(C.substr(2*K,2),16));var B=[],H="";for(K=0;K<j.length;K++)128&j[K]?H+=f((127&j[K]).toString(2),7):(H+=f((127&j[K]).toString(2),7),B.push(new String(parseInt(H,2))),H="");var W=m.join(".");return B.length>0&&(W=W+"."+B.join(".")),W},oe.dump=function(h,f,m,v){var A=oe,C=A.getV,j=A.dump,K=A.getChildIdx,B=h;h instanceof I.asn1.ASN1Object&&(B=h.getEncodedHex());var H=function(ye,mt){return ye.length<=2*mt?ye:ye.substr(0,mt)+"..(total "+ye.length/2+"bytes).."+ye.substr(ye.length-mt,mt)};f===void 0&&(f={ommit_long_octet:32}),m===void 0&&(m=0),v===void 0&&(v="");var W,V=f.ommit_long_octet;if((W=B.substr(m,2))=="01")return(Z=C(B,m))=="00"?v+`BOOLEAN FALSE
`:v+`BOOLEAN TRUE
`;if(W=="02")return v+"INTEGER "+H(Z=C(B,m),V)+`
`;if(W=="03"){var Z=C(B,m);if(A.isASN1HEX(Z.substr(2))){var ne=v+`BITSTRING, encapsulates
`;return ne+=j(Z.substr(2),f,0,v+"  ")}return v+"BITSTRING "+H(Z,V)+`
`}if(W=="04")return Z=C(B,m),A.isASN1HEX(Z)?(ne=v+`OCTETSTRING, encapsulates
`,ne+=j(Z,f,0,v+"  ")):v+"OCTETSTRING "+H(Z,V)+`
`;if(W=="05")return v+`NULL
`;if(W=="06"){var ce=C(B,m),he=I.asn1.ASN1Util.oidHexToInt(ce),pe=I.asn1.x509.OID.oid2name(he),U=he.replace(/\./g," ");return pe!=""?v+"ObjectIdentifier "+pe+" ("+U+`)
`:v+"ObjectIdentifier ("+U+`)
`}if(W=="0a")return v+"ENUMERATED "+parseInt(C(B,m))+`
`;if(W=="0c")return v+"UTF8String '"+lr(C(B,m))+`'
`;if(W=="13")return v+"PrintableString '"+lr(C(B,m))+`'
`;if(W=="14")return v+"TeletexString '"+lr(C(B,m))+`'
`;if(W=="16")return v+"IA5String '"+lr(C(B,m))+`'
`;if(W=="17")return v+"UTCTime "+lr(C(B,m))+`
`;if(W=="18")return v+"GeneralizedTime "+lr(C(B,m))+`
`;if(W=="1a")return v+"VisualString '"+lr(C(B,m))+`'
`;if(W=="1e")return v+"BMPString '"+ny(C(B,m))+`'
`;if(W=="30"){if(B.substr(m,4)=="3000")return v+`SEQUENCE {}
`;ne=v+`SEQUENCE
`;var q=f;if(((le=K(B,m)).length==2||le.length==3)&&B.substr(le[0],2)=="06"&&B.substr(le[le.length-1],2)=="04"){pe=A.oidname(C(B,le[0]));var G=JSON.parse(JSON.stringify(f));G.x509ExtName=pe,q=G}for(var J=0;J<le.length;J++)ne+=j(B,q,le[J],v+"  ");return ne}if(W=="31"){ne=v+`SET
`;var le=K(B,m);for(J=0;J<le.length;J++)ne+=j(B,f,le[J],v+"  ");return ne}if((128&(W=parseInt(W,16)))!=0){var ge=31&W;if((32&W)!=0){for(ne=v+"["+ge+`]
`,le=K(B,m),J=0;J<le.length;J++)ne+=j(B,f,le[J],v+"  ");return ne}if(Z=C(B,m),oe.isASN1HEX(Z)){var ne=v+"["+ge+`]
`;return ne+=j(Z,f,0,v+"  ")}return(Z.substr(0,8)=="68747470"||f.x509ExtName==="subjectAltName"&&ge==2)&&(Z=lr(Z)),ne=v+"["+ge+"] "+Z+`
`}return v+"UNKNOWN("+W+") "+C(B,m)+`
`},oe.isContextTag=function(h,f){var m,v;h=h.toLowerCase();try{m=parseInt(h,16)}catch{return-1}if(f===void 0)return(192&m)==128;try{return f.match(/^\[[0-9]+\]$/)!=null&&!((v=parseInt(f.substr(1,f.length-1),10))>31)&&(192&m)==128&&(31&m)==v}catch{return!1}},oe.isASN1HEX=function(h){var f=oe;if(h.length%2==1)return!1;var m=f.getVblen(h,0),v=h.substr(0,2),A=f.getL(h,0);return h.length-v.length-A.length==2*m},oe.checkStrictDER=function(h,f,m,v,A){var C=oe;if(m===void 0){if(typeof h!="string")throw new Error("not hex string");if(h=h.toLowerCase(),!I.lang.String.isHex(h))throw new Error("not hex string");m=h.length,A=(v=h.length/2)<128?1:Math.ceil(v.toString(16))+1}if(C.getL(h,f).length>2*A)throw new Error("L of TLV too long: idx="+f);var j=C.getVblen(h,f);if(j>v)throw new Error("value of L too long than hex: idx="+f);var K=C.getTLV(h,f),B=K.length-2-C.getL(h,f).length;if(B!==2*j)throw new Error("V string length and L's value not the same:"+B+"/"+2*j);if(f===0&&h.length!=K.length)throw new Error("total length and TLV length unmatch:"+h.length+"!="+K.length);var H=h.substr(f,2);if(H==="02"){var W=C.getVidx(h,f);if(h.substr(W,2)=="00"&&h.charCodeAt(W+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(H,16)){for(var V=C.getVblen(h,f),Z=0,ne=C.getChildIdx(h,f),ce=0;ce<ne.length;ce++)Z+=C.getTLV(h,ne[ce]).length,C.checkStrictDER(h,ne[ce],m,v,A);if(2*V!=Z)throw new Error("sum of children's TLV length and L unmatch: "+2*V+"!="+Z)}},oe.oidname=function(h){var f=I.asn1;I.lang.String.isHex(h)&&(h=f.ASN1Util.oidHexToInt(h));var m=f.x509.OID.oid2name(h);return m===""&&(m=h),m},I!==void 0&&I||(r.KJUR=I={}),I.lang!==void 0&&I.lang||(I.lang={}),I.lang.String=function(){},typeof o=="function"?(r.utf8tob64u=ie=function(f){return Ct(o.from(f,"utf8").toString("base64"))},r.b64utoutf8=fe=function(f){return o.from(Gc(f),"base64").toString("utf8")}):(r.utf8tob64u=ie=function(f){return cr(Nu(Mu(f)))},r.b64utoutf8=fe=function(f){return decodeURIComponent(Ou(fn(f)))}),I.lang.String.isInteger=function(h){return!!h.match(/^[0-9]+$/)||!!h.match(/^-[0-9]+$/)},I.lang.String.isHex=function(h){return ry(h)},I.lang.String.isBase64=function(h){return!(!(h=h.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||h.length%4!=0)},I.lang.String.isBase64URL=function(h){return!h.match(/[+/=]/)&&(h=Gc(h),I.lang.String.isBase64(h))},I.lang.String.isIntegerArray=function(h){return!!(h=h.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},I.lang.String.isPrintable=function(h){return h.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null},I.lang.String.isIA5=function(h){return h.match(/^[\x20-\x21\x23-\x7f]*$/)!==null},I.lang.String.isMail=function(h){return h.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};var iy=function(f,m,v){return v==null&&(v="0"),f.length>=m?f:new Array(m-f.length+1).join(v)+f};function Ln(h,f){var m=function(){};m.prototype=f.prototype,h.prototype=new m,h.prototype.constructor=h,h.superclass=f.prototype,f.prototype.constructor==Object.prototype.constructor&&(f.prototype.constructor=f)}I!==void 0&&I||(r.KJUR=I={}),I.crypto!==void 0&&I.crypto||(I.crypto={}),I.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:F.algo.MD5,sha1:F.algo.SHA1,sha224:F.algo.SHA224,sha256:F.algo.SHA256,sha384:F.algo.SHA384,sha512:F.algo.SHA512,ripemd160:F.algo.RIPEMD160},this.getDigestInfoHex=function(h,f){if(this.DIGESTINFOHEAD[f]===void 0)throw"alg not supported in Util.DIGESTINFOHEAD: "+f;return this.DIGESTINFOHEAD[f]+h},this.getPaddedDigestInfoHex=function(h,f,m){var v=this.getDigestInfoHex(h,f),A=m/4;if(v.length+22>A)throw"key is too short for SigAlg: keylen="+m+","+f;for(var C="0001",j="00"+v,K="",B=A-C.length-j.length,H=0;H<B;H+=2)K+="ff";return C+K+j},this.hashString=function(h,f){return new I.crypto.MessageDigest({alg:f}).digestString(h)},this.hashHex=function(h,f){return new I.crypto.MessageDigest({alg:f}).digestHex(h)},this.sha1=function(h){return this.hashString(h,"sha1")},this.sha256=function(h){return this.hashString(h,"sha256")},this.sha256Hex=function(h){return this.hashHex(h,"sha256")},this.sha512=function(h){return this.hashString(h,"sha512")},this.sha512Hex=function(h){return this.hashHex(h,"sha512")},this.isKey=function(h){return h instanceof ke||h instanceof I.crypto.DSA||h instanceof I.crypto.ECDSA}},I.crypto.Util.md5=function(h){return new I.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(h)},I.crypto.Util.ripemd160=function(h){return new I.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(h)},I.crypto.Util.SECURERANDOMGEN=new pt,I.crypto.Util.getRandomHexOfNbytes=function(h){var f=new Array(h);return I.crypto.Util.SECURERANDOMGEN.nextBytes(f),$t(f)},I.crypto.Util.getRandomBigIntegerOfNbytes=function(h){return new $(I.crypto.Util.getRandomHexOfNbytes(h),16)},I.crypto.Util.getRandomHexOfNbits=function(h){var f=h%8,m=new Array((h-f)/8+1);return I.crypto.Util.SECURERANDOMGEN.nextBytes(m),m[0]=(255<<f&255^255)&m[0],$t(m)},I.crypto.Util.getRandomBigIntegerOfNbits=function(h){return new $(I.crypto.Util.getRandomHexOfNbits(h),16)},I.crypto.Util.getRandomBigIntegerZeroToMax=function(h){for(var f=h.bitLength();;){var m=I.crypto.Util.getRandomBigIntegerOfNbits(f);if(h.compareTo(m)!=-1)return m}},I.crypto.Util.getRandomBigIntegerMinToMax=function(h,f){var m=h.compareTo(f);if(m==1)throw"biMin is greater than biMax";if(m==0)return h;var v=f.subtract(h);return I.crypto.Util.getRandomBigIntegerZeroToMax(v).add(h)},I.crypto.MessageDigest=function(h){this.setAlgAndProvider=function(f,m){if((f=I.crypto.MessageDigest.getCanonicalAlgName(f))!==null&&m===void 0&&(m=I.crypto.Util.DEFAULTPROVIDER[f]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(f)!=-1&&m=="cryptojs"){try{this.md=I.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[f].create()}catch(v){throw"setAlgAndProvider hash alg set fail alg="+f+"/"+v}this.updateString=function(v){this.md.update(v)},this.updateHex=function(v){var A=F.enc.Hex.parse(v);this.md.update(A)},this.digest=function(){return this.md.finalize().toString(F.enc.Hex)},this.digestString=function(v){return this.updateString(v),this.digest()},this.digestHex=function(v){return this.updateHex(v),this.digest()}}if(":sha256:".indexOf(f)!=-1&&m=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(v){throw"setAlgAndProvider hash alg set fail alg="+f+"/"+v}this.updateString=function(v){this.md.update(v)},this.updateHex=function(v){var A=sjcl.codec.hex.toBits(v);this.md.update(A)},this.digest=function(){var v=this.md.finalize();return sjcl.codec.hex.fromBits(v)},this.digestString=function(v){return this.updateString(v),this.digest()},this.digestHex=function(v){return this.updateHex(v),this.digest()}}},this.updateString=function(f){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(f){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(f){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(f){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},h!==void 0&&h.alg!==void 0&&(this.algName=h.alg,h.prov===void 0&&(this.provName=I.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},I.crypto.MessageDigest.getCanonicalAlgName=function(h){return typeof h=="string"&&(h=(h=h.toLowerCase()).replace(/-/,"")),h},I.crypto.MessageDigest.getHashLength=function(h){var f=I.crypto.MessageDigest,m=f.getCanonicalAlgName(h);if(f.HASHLENGTH[m]===void 0)throw"not supported algorithm: "+h;return f.HASHLENGTH[m]},I.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},I.crypto.Mac=function(h){this.setAlgAndProvider=function(f,m){if((f=f.toLowerCase())==null&&(f="hmacsha1"),(f=f.toLowerCase()).substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+f;m===void 0&&(m=I.crypto.Util.DEFAULTPROVIDER[f]),this.algProv=f+"/"+m;var v=f.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(v)!=-1&&m=="cryptojs"){try{var A=I.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[v];this.mac=F.algo.HMAC.create(A,this.pass)}catch(C){throw"setAlgAndProvider hash alg set fail hashAlg="+v+"/"+C}this.updateString=function(C){this.mac.update(C)},this.updateHex=function(C){var j=F.enc.Hex.parse(C);this.mac.update(j)},this.doFinal=function(){return this.mac.finalize().toString(F.enc.Hex)},this.doFinalString=function(C){return this.updateString(C),this.doFinal()},this.doFinalHex=function(C){return this.updateHex(C),this.doFinal()}}},this.updateString=function(f){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(f){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(f){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(f){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(f){if(typeof f=="string"){var m=f;return f.length%2!=1&&f.match(/^[0-9A-Fa-f]+$/)||(m=_o(f)),void(this.pass=F.enc.Hex.parse(m))}if((f===void 0?"undefined":b(f))!="object")throw"KJUR.crypto.Mac unsupported password type: "+f;if(m=null,f.hex!==void 0){if(f.hex.length%2!=0||!f.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+f.hex;m=f.hex}if(f.utf8!==void 0&&(m=hh(f.utf8)),f.rstr!==void 0&&(m=_o(f.rstr)),f.b64!==void 0&&(m=Y(f.b64)),f.b64u!==void 0&&(m=fn(f.b64u)),m==null)throw"KJUR.crypto.Mac unsupported password type: "+f;this.pass=F.enc.Hex.parse(m)},h!==void 0&&(h.pass!==void 0&&this.setPassword(h.pass),h.alg!==void 0&&(this.algName=h.alg,h.prov===void 0&&(this.provName=I.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},I.crypto.Signature=function(h){var f=null;if(this._setAlgNames=function(){var m=this.algName.match(/^(.+)with(.+)$/);m&&(this.mdAlgName=m[1].toLowerCase(),this.pubkeyAlgName=m[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(m,v){for(var A="",C=v/4-m.length,j=0;j<C;j++)A+="0";return A+m},this.setAlgAndProvider=function(m,v){if(this._setAlgNames(),v!="cryptojs/jsrsa")throw new Error("provider not supported: "+v);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new I.crypto.MessageDigest({alg:this.mdAlgName})}catch(A){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+A)}this.init=function(A,C){var j=null;try{j=C===void 0?Jn.getKey(A):Jn.getKey(A,C)}catch(K){throw"init failed:"+K}if(j.isPrivate===!0)this.prvKey=j,this.state="SIGN";else{if(j.isPublic!==!0)throw"init failed.:"+j;this.pubKey=j,this.state="VERIFY"}},this.updateString=function(A){this.md.updateString(A)},this.updateHex=function(A){this.md.updateHex(A)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&I.crypto.ECDSA!==void 0&&(this.prvKey=new I.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof ke&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof ke&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof I.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof I.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(A){return this.updateString(A),this.sign()},this.signHex=function(A){return this.updateHex(A),this.sign()},this.verify=function(A){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&I.crypto.ECDSA!==void 0&&(this.pubKey=new I.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof ke&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,A,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof ke&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,A);if(I.crypto.ECDSA!==void 0&&this.pubKey instanceof I.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,A);if(I.crypto.DSA!==void 0&&this.pubKey instanceof I.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,A);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(m,v){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(m){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(m){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(m){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(m){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(m){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=h,h!==void 0&&(h.alg!==void 0&&(this.algName=h.alg,h.prov===void 0?this.provName=I.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=h.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),h.psssaltlen!==void 0&&(this.pssSaltLen=h.psssaltlen),h.prvkeypem!==void 0)){if(h.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{f=Jn.getKey(h.prvkeypem),this.init(f)}catch(m){throw"fatal error to load pem private key: "+m}}},I.crypto.Cipher=function(h){},I.crypto.Cipher.encrypt=function(h,f,m){if(f instanceof ke&&f.isPublic){var v=I.crypto.Cipher.getAlgByKeyAndName(f,m);if(v==="RSA")return f.encrypt(h);if(v==="RSAOAEP")return f.encryptOAEP(h,"sha1");var A=v.match(/^RSAOAEP(\d+)$/);if(A!==null)return f.encryptOAEP(h,"sha"+A[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+m}throw"Cipher.encrypt: unsupported key or algorithm"},I.crypto.Cipher.decrypt=function(h,f,m){if(f instanceof ke&&f.isPrivate){var v=I.crypto.Cipher.getAlgByKeyAndName(f,m);if(v==="RSA")return f.decrypt(h);if(v==="RSAOAEP")return f.decryptOAEP(h,"sha1");var A=v.match(/^RSAOAEP(\d+)$/);if(A!==null)return f.decryptOAEP(h,"sha"+A[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+m}throw"Cipher.decrypt: unsupported key or algorithm"},I.crypto.Cipher.getAlgByKeyAndName=function(h,f){if(h instanceof ke){if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(f)!=-1)return f;if(f==null)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+f}throw"getAlgByKeyAndName: not supported algorithm name: "+f},I.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},I!==void 0&&I||(r.KJUR=I={}),I.crypto!==void 0&&I.crypto||(I.crypto={}),I.crypto.ECDSA=function(h){var f=Error,m=$,v=L,A=I.crypto.ECDSA,C=I.crypto.ECParameterDB,j=A.getName,K=oe,B=K.getVbyListEx,H=K.isASN1HEX,W=new pt;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(V){return new m(V.bitLength(),W).mod(V.subtract(m.ONE)).add(m.ONE)},this.setNamedCurve=function(V){this.ecparams=C.getByName(V),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=V},this.setPrivateKeyHex=function(V){this.isPrivate=!0,this.prvKeyHex=V},this.setPublicKeyHex=function(V){this.isPublic=!0,this.pubKeyHex=V},this.getPublicKeyXYHex=function(){var V=this.pubKeyHex;if(V.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var Z=this.ecparams.keylen/4;if(V.length!==2+2*Z)throw"malformed public key hex length";var ne={};return ne.x=V.substr(2,Z),ne.y=V.substr(2+Z),ne},this.getShortNISTPCurveName=function(){var V=this.curveName;return V==="secp256r1"||V==="NIST P-256"||V==="P-256"||V==="prime256v1"?"P-256":V==="secp384r1"||V==="NIST P-384"||V==="P-384"?"P-384":null},this.generateKeyPairHex=function(){var V=this.ecparams.n,Z=this.getBigRandom(V),ne=this.ecparams.G.multiply(Z),ce=ne.getX().toBigInteger(),he=ne.getY().toBigInteger(),pe=this.ecparams.keylen/4,U=("0000000000"+Z.toString(16)).slice(-pe),q="04"+("0000000000"+ce.toString(16)).slice(-pe)+("0000000000"+he.toString(16)).slice(-pe);return this.setPrivateKeyHex(U),this.setPublicKeyHex(q),{ecprvhex:U,ecpubhex:q}},this.signWithMessageHash=function(V){return this.signHex(V,this.prvKeyHex)},this.signHex=function(V,Z){var ne=new m(Z,16),ce=this.ecparams.n,he=new m(V.substring(0,this.ecparams.keylen/4),16);do var pe=this.getBigRandom(ce),U=this.ecparams.G.multiply(pe).getX().toBigInteger().mod(ce);while(U.compareTo(m.ZERO)<=0);var q=pe.modInverse(ce).multiply(he.add(ne.multiply(U))).mod(ce);return A.biRSSigToASN1Sig(U,q)},this.sign=function(V,Z){var ne=Z,ce=this.ecparams.n,he=m.fromByteArrayUnsigned(V);do var pe=this.getBigRandom(ce),U=this.ecparams.G.multiply(pe).getX().toBigInteger().mod(ce);while(U.compareTo($.ZERO)<=0);var q=pe.modInverse(ce).multiply(he.add(ne.multiply(U))).mod(ce);return this.serializeSig(U,q)},this.verifyWithMessageHash=function(V,Z){return this.verifyHex(V,Z,this.pubKeyHex)},this.verifyHex=function(V,Z,ne){try{var ce,he,pe=A.parseSigHex(Z);ce=pe.r,he=pe.s;var U=v.decodeFromHex(this.ecparams.curve,ne),q=new m(V.substring(0,this.ecparams.keylen/4),16);return this.verifyRaw(q,ce,he,U)}catch{return!1}},this.verify=function(V,Z,ne){var ce,he,pe;if(Bitcoin.Util.isArray(Z)){var U=this.parseSig(Z);ce=U.r,he=U.s}else{if((Z===void 0?"undefined":b(Z))!=="object"||!Z.r||!Z.s)throw"Invalid value for signature";ce=Z.r,he=Z.s}if(ne instanceof L)pe=ne;else{if(!Bitcoin.Util.isArray(ne))throw"Invalid format for pubkey value, must be byte array or ECPointFp";pe=v.decodeFrom(this.ecparams.curve,ne)}var q=m.fromByteArrayUnsigned(V);return this.verifyRaw(q,ce,he,pe)},this.verifyRaw=function(V,Z,ne,ce){var he=this.ecparams.n,pe=this.ecparams.G;if(Z.compareTo(m.ONE)<0||Z.compareTo(he)>=0||ne.compareTo(m.ONE)<0||ne.compareTo(he)>=0)return!1;var U=ne.modInverse(he),q=V.multiply(U).mod(he),G=Z.multiply(U).mod(he);return pe.multiply(q).add(ce.multiply(G)).getX().toBigInteger().mod(he).equals(Z)},this.serializeSig=function(V,Z){var ne=V.toByteArraySigned(),ce=Z.toByteArraySigned(),he=[];return he.push(2),he.push(ne.length),(he=he.concat(ne)).push(2),he.push(ce.length),(he=he.concat(ce)).unshift(he.length),he.unshift(48),he},this.parseSig=function(V){var Z;if(V[0]!=48)throw new Error("Signature not a valid DERSequence");if(V[Z=2]!=2)throw new Error("First element in signature must be a DERInteger");var ne=V.slice(Z+2,Z+2+V[Z+1]);if(V[Z+=2+V[Z+1]]!=2)throw new Error("Second element in signature must be a DERInteger");var ce=V.slice(Z+2,Z+2+V[Z+1]);return Z+=2+V[Z+1],{r:m.fromByteArrayUnsigned(ne),s:m.fromByteArrayUnsigned(ce)}},this.parseSigCompact=function(V){if(V.length!==65)throw"Signature has the wrong length";var Z=V[0]-27;if(Z<0||Z>7)throw"Invalid signature type";var ne=this.ecparams.n;return{r:m.fromByteArrayUnsigned(V.slice(1,33)).mod(ne),s:m.fromByteArrayUnsigned(V.slice(33,65)).mod(ne),i:Z}},this.readPKCS5PrvKeyHex=function(V){if(H(V)===!1)throw new Error("not ASN.1 hex string");var Z,ne,ce;try{Z=B(V,0,["[0]",0],"06"),ne=B(V,0,[1],"04");try{ce=B(V,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=j(Z),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(ce),this.setPrivateKeyHex(ne),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(V){if(H(V)===!1)throw new f("not ASN.1 hex string");var Z,ne,ce;try{B(V,0,[1,0],"06"),Z=B(V,0,[1,1],"06"),ne=B(V,0,[2,0,1],"04");try{ce=B(V,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new f("malformed PKCS#8 plain ECC private key")}if(this.curveName=j(Z),this.curveName===void 0)throw new f("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(ce),this.setPrivateKeyHex(ne),this.isPublic=!1},this.readPKCS8PubKeyHex=function(V){if(H(V)===!1)throw new f("not ASN.1 hex string");var Z,ne;try{B(V,0,[0,0],"06"),Z=B(V,0,[0,1],"06"),ne=B(V,0,[1],"03")}catch{throw new f("malformed PKCS#8 ECC public key")}if(this.curveName=j(Z),this.curveName===null)throw new f("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(ne)},this.readCertPubKeyHex=function(V,Z){if(H(V)===!1)throw new f("not ASN.1 hex string");var ne,ce;try{ne=B(V,0,[0,5,0,1],"06"),ce=B(V,0,[0,5,1],"03")}catch{throw new f("malformed X.509 certificate ECC public key")}if(this.curveName=j(ne),this.curveName===null)throw new f("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(ce)},h!==void 0&&h.curve!==void 0&&(this.curveName=h.curve),this.curveName===void 0&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),h!==void 0&&(h.prv!==void 0&&this.setPrivateKeyHex(h.prv),h.pub!==void 0&&this.setPublicKeyHex(h.pub))},I.crypto.ECDSA.parseSigHex=function(h){var f=I.crypto.ECDSA.parseSigHexInHexRS(h);return{r:new $(f.r,16),s:new $(f.s,16)}},I.crypto.ECDSA.parseSigHexInHexRS=function(h){var f=oe,m=f.getChildIdx,v=f.getV;if(f.checkStrictDER(h,0),h.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var A=m(h,0);if(A.length!=2)throw new Error("signature shall have two elements");var C=A[0],j=A[1];if(h.substr(C,2)!="02")throw new Error("1st item not ASN.1 integer");if(h.substr(j,2)!="02")throw new Error("2nd item not ASN.1 integer");return{r:v(h,C),s:v(h,j)}},I.crypto.ECDSA.asn1SigToConcatSig=function(h){var f=I.crypto.ECDSA.parseSigHexInHexRS(h),m=f.r,v=f.s;if(m.substr(0,2)=="00"&&m.length%32==2&&(m=m.substr(2)),v.substr(0,2)=="00"&&v.length%32==2&&(v=v.substr(2)),m.length%32==30&&(m="00"+m),v.length%32==30&&(v="00"+v),m.length%32!=0)throw"unknown ECDSA sig r length error";if(v.length%32!=0)throw"unknown ECDSA sig s length error";return m+v},I.crypto.ECDSA.concatSigToASN1Sig=function(h){if(h.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var f=h.substr(0,h.length/2),m=h.substr(h.length/2);return I.crypto.ECDSA.hexRSSigToASN1Sig(f,m)},I.crypto.ECDSA.hexRSSigToASN1Sig=function(h,f){var m=new $(h,16),v=new $(f,16);return I.crypto.ECDSA.biRSSigToASN1Sig(m,v)},I.crypto.ECDSA.biRSSigToASN1Sig=function(h,f){var m=I.asn1,v=new m.DERInteger({bigint:h}),A=new m.DERInteger({bigint:f});return new m.DERSequence({array:[v,A]}).getEncodedHex()},I.crypto.ECDSA.getName=function(h){return h==="2b8104001f"?"secp192k1":h==="2a8648ce3d030107"?"secp256r1":h==="2b8104000a"?"secp256k1":h==="2b81040021"?"secp224r1":h==="2b81040022"?"secp384r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(h)!==-1?"secp256r1":"|secp256k1|".indexOf(h)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(h)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(h)!==-1?"secp384r1":null},I!==void 0&&I||(r.KJUR=I={}),I.crypto!==void 0&&I.crypto||(I.crypto={}),I.crypto.ECParameterDB=new function(){var h={},f={};function m(v){return new $(v,16)}this.getByName=function(v){var A=v;if(f[A]!==void 0&&(A=f[v]),h[A]!==void 0)return h[A];throw"unregistered EC curve name: "+A},this.regist=function(v,A,C,j,K,B,H,W,V,Z,ne,ce){h[v]={};var he=m(C),pe=m(j),U=m(K),q=m(B),G=m(H),J=new x(he,pe,U),le=J.decodePointHex("04"+W+V);h[v].name=v,h[v].keylen=A,h[v].curve=J,h[v].G=le,h[v].n=q,h[v].h=G,h[v].oid=ne,h[v].info=ce;for(var ge=0;ge<Z.length;ge++)f[Z[ge]]=v}},I.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),I.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),I.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),I.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),I.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),I.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),I.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),I.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),I.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),I.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);var Jn=function(){var h=function(H,W,V){return f(F.AES,H,W,V)},f=function(H,W,V,Z){var ne=F.enc.Hex.parse(W),ce=F.enc.Hex.parse(V),he=F.enc.Hex.parse(Z),pe={};pe.key=ce,pe.iv=he,pe.ciphertext=ne;var U=H.decrypt(pe,ce,{iv:he});return F.enc.Hex.stringify(U)},m=function(H,W,V){return v(F.AES,H,W,V)},v=function(H,W,V,Z){var ne=F.enc.Hex.parse(W),ce=F.enc.Hex.parse(V),he=F.enc.Hex.parse(Z),pe=H.encrypt(ne,ce,{iv:he}),U=F.enc.Hex.parse(pe.toString());return F.enc.Base64.stringify(U)},A={"AES-256-CBC":{proc:h,eproc:m,keylen:32,ivlen:16},"AES-192-CBC":{proc:h,eproc:m,keylen:24,ivlen:16},"AES-128-CBC":{proc:h,eproc:m,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(H,W,V){return f(F.TripleDES,H,W,V)},eproc:function(H,W,V){return v(F.TripleDES,H,W,V)},keylen:24,ivlen:8},"DES-CBC":{proc:function(H,W,V){return f(F.DES,H,W,V)},eproc:function(H,W,V){return v(F.DES,H,W,V)},keylen:8,ivlen:8}},C=function(H){var W={},V=H.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));V&&(W.cipher=V[1],W.ivsalt=V[2]);var Z=H.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));Z&&(W.type=Z[1]);var ne=-1,ce=0;H.indexOf(`\r
\r
`)!=-1&&(ne=H.indexOf(`\r
\r
`),ce=2),H.indexOf(`

`)!=-1&&(ne=H.indexOf(`

`),ce=1);var he=H.indexOf("-----END");if(ne!=-1&&he!=-1){var pe=H.substring(ne+2*ce,he-ce);pe=pe.replace(/\s+/g,""),W.data=pe}return W},j=function(H,W,V){for(var Z=V.substring(0,16),ne=F.enc.Hex.parse(Z),ce=F.enc.Utf8.parse(W),he=A[H].keylen+A[H].ivlen,pe="",U=null;;){var q=F.algo.MD5.create();if(U!=null&&q.update(U),q.update(ce),q.update(ne),U=q.finalize(),(pe+=F.enc.Hex.stringify(U)).length>=2*he)break}var G={};return G.keyhex=pe.substr(0,2*A[H].keylen),G.ivhex=pe.substr(2*A[H].keylen,2*A[H].ivlen),G},K=function(H,W,V,Z){var ne=F.enc.Base64.parse(H),ce=F.enc.Hex.stringify(ne);return(0,A[W].proc)(ce,V,Z)};return{version:"1.0.0",parsePKCS5PEM:function(H){return C(H)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(H,W,V){return j(H,W,V)},decryptKeyB64:function(H,W,V,Z){return K(H,W,V,Z)},getDecryptedKeyHex:function(H,W){var V=C(H),Z=V.cipher,ne=V.ivsalt,ce=V.data,he=j(Z,W,ne).keyhex;return K(ce,Z,he,ne)},getEncryptedPKCS5PEMFromPrvKeyHex:function(H,W,V,Z,ne){var ce="";if(Z!==void 0&&Z!=null||(Z="AES-256-CBC"),A[Z]===void 0)throw new Error("KEYUTIL unsupported algorithm: "+Z);ne!==void 0&&ne!=null||(ne=function(U){var q=F.lib.WordArray.random(U);return F.enc.Hex.stringify(q)}(A[Z].ivlen).toUpperCase());var he=function(U,q,G,J){return(0,A[q].eproc)(U,G,J)}(W,Z,j(Z,V,ne).keyhex,ne);return ce="-----BEGIN "+H+` PRIVATE KEY-----\r
`,ce+=`Proc-Type: 4,ENCRYPTED\r
`,ce+="DEK-Info: "+Z+","+ne+`\r
`,ce+=`\r
`,ce+=he.replace(/(.{64})/g,`$1\r
`),ce+=`\r
-----END `+H+` PRIVATE KEY-----\r
`},parseHexOfEncryptedPKCS8:function(H){var W=oe,V=W.getChildIdx,Z=W.getV,ne={},ce=V(H,0);if(ce.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+ce.length);ne.ciphertext=Z(H,ce[1]);var he=V(H,ce[0]);if(he.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+he.length);if(Z(H,he[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var pe=V(H,he[1]);if(he.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+pe.length);var U=V(H,pe[1]);if(U.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+U.length);if(Z(H,U[0])!="2a864886f70d0307")throw"this only supports TripleDES";ne.encryptionSchemeAlg="TripleDES",ne.encryptionSchemeIV=Z(H,U[1]);var q=V(H,pe[0]);if(q.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+q.length);if(Z(H,q[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var G=V(H,q[1]);if(G.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+G.length);ne.pbkdf2Salt=Z(H,G[0]);var J=Z(H,G[1]);try{ne.pbkdf2Iter=parseInt(J,16)}catch{throw new Error("malformed format pbkdf2Iter: "+J)}return ne},getPBKDF2KeyHexFromParam:function(H,W){var V=F.enc.Hex.parse(H.pbkdf2Salt),Z=H.pbkdf2Iter,ne=F.PBKDF2(W,V,{keySize:6,iterations:Z});return F.enc.Hex.stringify(ne)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(H,W){var V=wo(H,"ENCRYPTED PRIVATE KEY"),Z=this.parseHexOfEncryptedPKCS8(V),ne=Jn.getPBKDF2KeyHexFromParam(Z,W),ce={};ce.ciphertext=F.enc.Hex.parse(Z.ciphertext);var he=F.enc.Hex.parse(ne),pe=F.enc.Hex.parse(Z.encryptionSchemeIV),U=F.TripleDES.decrypt(ce,he,{iv:pe});return F.enc.Hex.stringify(U)},getKeyFromEncryptedPKCS8PEM:function(H,W){var V=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(H,W);return this.getKeyFromPlainPrivatePKCS8Hex(V)},parsePlainPrivatePKCS8Hex:function(H){var W=oe,V=W.getChildIdx,Z=W.getV,ne={algparam:null};if(H.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var ce=V(H,0);if(ce.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(H.substr(ce[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var he=V(H,ce[1]);if(he.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(H.substr(he[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(ne.algoid=Z(H,he[0]),H.substr(he[1],2)=="06"&&(ne.algparam=Z(H,he[1])),H.substr(ce[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return ne.keyidx=W.getVidx(H,ce[2]),ne},getKeyFromPlainPrivatePKCS8PEM:function(H){var W=wo(H,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(W)},getKeyFromPlainPrivatePKCS8Hex:function(H){var W,V=this.parsePlainPrivatePKCS8Hex(H);if(V.algoid=="2a864886f70d010101")W=new ke;else if(V.algoid=="2a8648ce380401")W=new I.crypto.DSA;else{if(V.algoid!="2a8648ce3d0201")throw new Error("unsupported private key algorithm");W=new I.crypto.ECDSA}return W.readPKCS8PrvKeyHex(H),W},_getKeyFromPublicPKCS8Hex:function(H){var W,V=oe.getVbyList(H,0,[0,0],"06");if(V==="2a864886f70d010101")W=new ke;else if(V==="2a8648ce380401")W=new I.crypto.DSA;else{if(V!=="2a8648ce3d0201")throw new Error("unsupported PKCS#8 public key hex");W=new I.crypto.ECDSA}return W.readPKCS8PubKeyHex(H),W},parsePublicRawRSAKeyHex:function(H){var W=oe,V=W.getChildIdx,Z=W.getV,ne={};if(H.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var ce=V(H,0);if(ce.length!=2)throw new Error("malformed RSA key(code:002)");if(H.substr(ce[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(ne.n=Z(H,ce[0]),H.substr(ce[1],2)!="02")throw new Error("malformed RSA key(code:004)");return ne.e=Z(H,ce[1]),ne},parsePublicPKCS8Hex:function(H){var W=oe,V=W.getChildIdx,Z=W.getV,ne={algparam:null},ce=V(H,0);if(ce.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+ce.length);var he=ce[0];if(H.substr(he,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var pe=V(H,he);if(pe.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(H.substr(pe[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(ne.algoid=Z(H,pe[0]),H.substr(pe[1],2)=="06"?ne.algparam=Z(H,pe[1]):H.substr(pe[1],2)=="30"&&(ne.algparam={},ne.algparam.p=W.getVbyList(H,pe[1],[0],"02"),ne.algparam.q=W.getVbyList(H,pe[1],[1],"02"),ne.algparam.g=W.getVbyList(H,pe[1],[2],"02")),H.substr(ce[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return ne.key=Z(H,ce[1]).substr(2),ne}}}();Jn.getKey=function(h,f,m){var v=(pe=oe).getChildIdx,A=(pe.getV,pe.getVbyList),C=I.crypto,j=C.ECDSA,K=C.DSA,B=ke,H=wo,W=Jn;if(B!==void 0&&h instanceof B||j!==void 0&&h instanceof j||K!==void 0&&h instanceof K)return h;if(h.curve!==void 0&&h.xy!==void 0&&h.d===void 0)return new j({pub:h.xy,curve:h.curve});if(h.curve!==void 0&&h.d!==void 0)return new j({prv:h.d,curve:h.curve});if(h.kty===void 0&&h.n!==void 0&&h.e!==void 0&&h.d===void 0)return(qe=new B).setPublic(h.n,h.e),qe;if(h.kty===void 0&&h.n!==void 0&&h.e!==void 0&&h.d!==void 0&&h.p!==void 0&&h.q!==void 0&&h.dp!==void 0&&h.dq!==void 0&&h.co!==void 0&&h.qi===void 0)return(qe=new B).setPrivateEx(h.n,h.e,h.d,h.p,h.q,h.dp,h.dq,h.co),qe;if(h.kty===void 0&&h.n!==void 0&&h.e!==void 0&&h.d!==void 0&&h.p===void 0)return(qe=new B).setPrivate(h.n,h.e,h.d),qe;if(h.p!==void 0&&h.q!==void 0&&h.g!==void 0&&h.y!==void 0&&h.x===void 0)return(qe=new K).setPublic(h.p,h.q,h.g,h.y),qe;if(h.p!==void 0&&h.q!==void 0&&h.g!==void 0&&h.y!==void 0&&h.x!==void 0)return(qe=new K).setPrivate(h.p,h.q,h.g,h.y,h.x),qe;if(h.kty==="RSA"&&h.n!==void 0&&h.e!==void 0&&h.d===void 0)return(qe=new B).setPublic(fn(h.n),fn(h.e)),qe;if(h.kty==="RSA"&&h.n!==void 0&&h.e!==void 0&&h.d!==void 0&&h.p!==void 0&&h.q!==void 0&&h.dp!==void 0&&h.dq!==void 0&&h.qi!==void 0)return(qe=new B).setPrivateEx(fn(h.n),fn(h.e),fn(h.d),fn(h.p),fn(h.q),fn(h.dp),fn(h.dq),fn(h.qi)),qe;if(h.kty==="RSA"&&h.n!==void 0&&h.e!==void 0&&h.d!==void 0)return(qe=new B).setPrivate(fn(h.n),fn(h.e),fn(h.d)),qe;if(h.kty==="EC"&&h.crv!==void 0&&h.x!==void 0&&h.y!==void 0&&h.d===void 0){var V=(xe=new j({curve:h.crv})).ecparams.keylen/4,Z="04"+("0000000000"+fn(h.x)).slice(-V)+("0000000000"+fn(h.y)).slice(-V);return xe.setPublicKeyHex(Z),xe}if(h.kty==="EC"&&h.crv!==void 0&&h.x!==void 0&&h.y!==void 0&&h.d!==void 0){V=(xe=new j({curve:h.crv})).ecparams.keylen/4,Z="04"+("0000000000"+fn(h.x)).slice(-V)+("0000000000"+fn(h.y)).slice(-V);var ne=("0000000000"+fn(h.d)).slice(-V);return xe.setPublicKeyHex(Z),xe.setPrivateKeyHex(ne),xe}if(m==="pkcs5prv"){var ce,he=h,pe=oe;if((ce=v(he,0)).length===9)(qe=new B).readPKCS5PrvKeyHex(he);else if(ce.length===6)(qe=new K).readPKCS5PrvKeyHex(he);else{if(!(ce.length>2&&he.substr(ce[1],2)==="04"))throw new Error("unsupported PKCS#1/5 hexadecimal key");(qe=new j).readPKCS5PrvKeyHex(he)}return qe}if(m==="pkcs8prv")return qe=W.getKeyFromPlainPrivatePKCS8Hex(h);if(m==="pkcs8pub")return W._getKeyFromPublicPKCS8Hex(h);if(m==="x509pub")return ur.getPublicKeyFromCertHex(h);if(h.indexOf("-END CERTIFICATE-",0)!=-1||h.indexOf("-END X509 CERTIFICATE-",0)!=-1||h.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return ur.getPublicKeyFromCertPEM(h);if(h.indexOf("-END PUBLIC KEY-")!=-1){var U=wo(h,"PUBLIC KEY");return W._getKeyFromPublicPKCS8Hex(U)}if(h.indexOf("-END RSA PRIVATE KEY-")!=-1&&h.indexOf("4,ENCRYPTED")==-1){var q=H(h,"RSA PRIVATE KEY");return W.getKey(q,null,"pkcs5prv")}if(h.indexOf("-END DSA PRIVATE KEY-")!=-1&&h.indexOf("4,ENCRYPTED")==-1){var G=A(hn=H(h,"DSA PRIVATE KEY"),0,[1],"02"),J=A(hn,0,[2],"02"),le=A(hn,0,[3],"02"),ge=A(hn,0,[4],"02"),Re=A(hn,0,[5],"02");return(qe=new K).setPrivate(new $(G,16),new $(J,16),new $(le,16),new $(ge,16),new $(Re,16)),qe}if(h.indexOf("-END EC PRIVATE KEY-")!=-1&&h.indexOf("4,ENCRYPTED")==-1)return q=H(h,"EC PRIVATE KEY"),W.getKey(q,null,"pkcs5prv");if(h.indexOf("-END PRIVATE KEY-")!=-1)return W.getKeyFromPlainPrivatePKCS8PEM(h);if(h.indexOf("-END RSA PRIVATE KEY-")!=-1&&h.indexOf("4,ENCRYPTED")!=-1){var ye=W.getDecryptedKeyHex(h,f),mt=new ke;return mt.readPKCS5PrvKeyHex(ye),mt}if(h.indexOf("-END EC PRIVATE KEY-")!=-1&&h.indexOf("4,ENCRYPTED")!=-1){var xe,qe=A(hn=W.getDecryptedKeyHex(h,f),0,[1],"04"),on=A(hn,0,[2,0],"06"),bn=A(hn,0,[3,0],"03").substr(2);if(I.crypto.OID.oidhex2name[on]===void 0)throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+on);return(xe=new j({curve:I.crypto.OID.oidhex2name[on]})).setPublicKeyHex(bn),xe.setPrivateKeyHex(qe),xe.isPublic=!1,xe}if(h.indexOf("-END DSA PRIVATE KEY-")!=-1&&h.indexOf("4,ENCRYPTED")!=-1){var hn;return G=A(hn=W.getDecryptedKeyHex(h,f),0,[1],"02"),J=A(hn,0,[2],"02"),le=A(hn,0,[3],"02"),ge=A(hn,0,[4],"02"),Re=A(hn,0,[5],"02"),(qe=new K).setPrivate(new $(G,16),new $(J,16),new $(le,16),new $(ge,16),new $(Re,16)),qe}if(h.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return W.getKeyFromEncryptedPKCS8PEM(h,f);throw new Error("not supported argument")},Jn.generateKeypair=function(h,f){if(h=="RSA"){var m=f;(j=new ke).generate(m,"10001"),j.isPrivate=!0,j.isPublic=!0;var v=new ke,A=j.n.toString(16),C=j.e.toString(16);return v.setPublic(A,C),v.isPrivate=!1,v.isPublic=!0,(K={}).prvKeyObj=j,K.pubKeyObj=v,K}if(h=="EC"){var j,K,B=f,H=new I.crypto.ECDSA({curve:B}).generateKeyPairHex();return(j=new I.crypto.ECDSA({curve:B})).setPublicKeyHex(H.ecpubhex),j.setPrivateKeyHex(H.ecprvhex),j.isPrivate=!0,j.isPublic=!1,(v=new I.crypto.ECDSA({curve:B})).setPublicKeyHex(H.ecpubhex),v.isPrivate=!1,v.isPublic=!0,(K={}).prvKeyObj=j,K.pubKeyObj=v,K}throw new Error("unknown algorithm: "+h)},Jn.getPEM=function(h,f,m,v,A,C){var j=I,K=j.asn1,B=K.DERObjectIdentifier,H=K.DERInteger,W=K.ASN1Util.newObject,V=K.x509.SubjectPublicKeyInfo,Z=j.crypto,ne=Z.DSA,ce=Z.ECDSA,he=ke;function pe(xe){return W({seq:[{int:0},{int:{bigint:xe.n}},{int:xe.e},{int:{bigint:xe.d}},{int:{bigint:xe.p}},{int:{bigint:xe.q}},{int:{bigint:xe.dmp1}},{int:{bigint:xe.dmq1}},{int:{bigint:xe.coeff}}]})}function U(xe){return W({seq:[{int:1},{octstr:{hex:xe.prvKeyHex}},{tag:["a0",!0,{oid:{name:xe.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+xe.pubKeyHex}}]}]})}function q(xe){return W({seq:[{int:0},{int:{bigint:xe.p}},{int:{bigint:xe.q}},{int:{bigint:xe.g}},{int:{bigint:xe.y}},{int:{bigint:xe.x}}]})}if((he!==void 0&&h instanceof he||ne!==void 0&&h instanceof ne||ce!==void 0&&h instanceof ce)&&h.isPublic==1&&(f===void 0||f=="PKCS8PUB"))return fi(ge=new V(h).getEncodedHex(),"PUBLIC KEY");if(f=="PKCS1PRV"&&he!==void 0&&h instanceof he&&(m===void 0||m==null)&&h.isPrivate==1)return fi(ge=pe(h).getEncodedHex(),"RSA PRIVATE KEY");if(f=="PKCS1PRV"&&ce!==void 0&&h instanceof ce&&(m===void 0||m==null)&&h.isPrivate==1){var G=new B({name:h.curveName}).getEncodedHex(),J=U(h).getEncodedHex(),le="";return le+=fi(G,"EC PARAMETERS"),le+=fi(J,"EC PRIVATE KEY")}if(f=="PKCS1PRV"&&ne!==void 0&&h instanceof ne&&(m===void 0||m==null)&&h.isPrivate==1)return fi(ge=q(h).getEncodedHex(),"DSA PRIVATE KEY");if(f=="PKCS5PRV"&&he!==void 0&&h instanceof he&&m!==void 0&&m!=null&&h.isPrivate==1){var ge=pe(h).getEncodedHex();return v===void 0&&(v="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",ge,m,v,C)}if(f=="PKCS5PRV"&&ce!==void 0&&h instanceof ce&&m!==void 0&&m!=null&&h.isPrivate==1)return ge=U(h).getEncodedHex(),v===void 0&&(v="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",ge,m,v,C);if(f=="PKCS5PRV"&&ne!==void 0&&h instanceof ne&&m!==void 0&&m!=null&&h.isPrivate==1)return ge=q(h).getEncodedHex(),v===void 0&&(v="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",ge,m,v,C);var Re=function(qe,on){var bn=ye(qe,on);return new W({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:bn.pbkdf2Salt}},{int:bn.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:bn.encryptionSchemeIV}}]}]}]},{octstr:{hex:bn.ciphertext}}]}).getEncodedHex()},ye=function(qe,on){var bn=F.lib.WordArray.random(8),hn=F.lib.WordArray.random(8),hi=F.PBKDF2(on,bn,{keySize:6,iterations:100}),qr=F.enc.Hex.parse(qe),ni=F.TripleDES.encrypt(qr,hi,{iv:hn})+"",Kn={};return Kn.ciphertext=ni,Kn.pbkdf2Salt=F.enc.Hex.stringify(bn),Kn.pbkdf2Iter=100,Kn.encryptionSchemeAlg="DES-EDE3-CBC",Kn.encryptionSchemeIV=F.enc.Hex.stringify(hn),Kn};if(f=="PKCS8PRV"&&he!=null&&h instanceof he&&h.isPrivate==1){var mt=pe(h).getEncodedHex();return ge=W({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:mt}}]}).getEncodedHex(),m===void 0||m==null?fi(ge,"PRIVATE KEY"):fi(J=Re(ge,m),"ENCRYPTED PRIVATE KEY")}if(f=="PKCS8PRV"&&ce!==void 0&&h instanceof ce&&h.isPrivate==1)return mt=new W({seq:[{int:1},{octstr:{hex:h.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+h.pubKeyHex}}]}]}).getEncodedHex(),ge=W({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:h.curveName}}]},{octstr:{hex:mt}}]}).getEncodedHex(),m===void 0||m==null?fi(ge,"PRIVATE KEY"):fi(J=Re(ge,m),"ENCRYPTED PRIVATE KEY");if(f=="PKCS8PRV"&&ne!==void 0&&h instanceof ne&&h.isPrivate==1)return mt=new H({bigint:h.x}).getEncodedHex(),ge=W({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:h.p}},{int:{bigint:h.q}},{int:{bigint:h.g}}]}]},{octstr:{hex:mt}}]}).getEncodedHex(),m===void 0||m==null?fi(ge,"PRIVATE KEY"):fi(J=Re(ge,m),"ENCRYPTED PRIVATE KEY");throw new Error("unsupported object nor format")},Jn.getKeyFromCSRPEM=function(h){var f=wo(h,"CERTIFICATE REQUEST");return Jn.getKeyFromCSRHex(f)},Jn.getKeyFromCSRHex=function(h){var f=Jn.parseCSRHex(h);return Jn.getKey(f.p8pubkeyhex,null,"pkcs8pub")},Jn.parseCSRHex=function(h){var f=oe,m=f.getChildIdx,v=f.getTLV,A={},C=h;if(C.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var j=m(C,0);if(j.length<1)throw new Error("malformed CSR(code:002)");if(C.substr(j[0],2)!="30")throw new Error("malformed CSR(code:003)");var K=m(C,j[0]);if(K.length<3)throw new Error("malformed CSR(code:004)");return A.p8pubkeyhex=v(C,K[2]),A},Jn.getKeyID=function(h){var f=Jn,m=oe;typeof h=="string"&&h.indexOf("BEGIN ")!=-1&&(h=f.getKey(h));var v=wo(f.getPEM(h)),A=m.getIdxbyList(v,0,[1]),C=m.getV(v,A).substring(2);return I.crypto.Util.hashHex(C,"sha1")},Jn.getJWKFromKey=function(h){var f={};if(h instanceof ke&&h.isPrivate)return f.kty="RSA",f.n=cr(h.n.toString(16)),f.e=cr(h.e.toString(16)),f.d=cr(h.d.toString(16)),f.p=cr(h.p.toString(16)),f.q=cr(h.q.toString(16)),f.dp=cr(h.dmp1.toString(16)),f.dq=cr(h.dmq1.toString(16)),f.qi=cr(h.coeff.toString(16)),f;if(h instanceof ke&&h.isPublic)return f.kty="RSA",f.n=cr(h.n.toString(16)),f.e=cr(h.e.toString(16)),f;if(h instanceof I.crypto.ECDSA&&h.isPrivate){if((v=h.getShortNISTPCurveName())!=="P-256"&&v!=="P-384")throw new Error("unsupported curve name for JWT: "+v);var m=h.getPublicKeyXYHex();return f.kty="EC",f.crv=v,f.x=cr(m.x),f.y=cr(m.y),f.d=cr(h.prvKeyHex),f}if(h instanceof I.crypto.ECDSA&&h.isPublic){var v;if((v=h.getShortNISTPCurveName())!=="P-256"&&v!=="P-384")throw new Error("unsupported curve name for JWT: "+v);return m=h.getPublicKeyXYHex(),f.kty="EC",f.crv=v,f.x=cr(m.x),f.y=cr(m.y),f}throw new Error("not supported key object")},ke.getPosArrayOfChildrenFromHex=function(h){return oe.getChildIdx(h,0)},ke.getHexValueArrayOfChildrenFromHex=function(h){var f,m=oe.getV,v=m(h,(f=ke.getPosArrayOfChildrenFromHex(h))[0]),A=m(h,f[1]),C=m(h,f[2]),j=m(h,f[3]),K=m(h,f[4]),B=m(h,f[5]),H=m(h,f[6]),W=m(h,f[7]),V=m(h,f[8]);return(f=new Array).push(v,A,C,j,K,B,H,W,V),f},ke.prototype.readPrivateKeyFromPEMString=function(h){var f=wo(h),m=ke.getHexValueArrayOfChildrenFromHex(f);this.setPrivateEx(m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8])},ke.prototype.readPKCS5PrvKeyHex=function(h){var f=ke.getHexValueArrayOfChildrenFromHex(h);this.setPrivateEx(f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8])},ke.prototype.readPKCS8PrvKeyHex=function(h){var f,m,v,A,C,j,K,B,H=oe,W=H.getVbyListEx;if(H.isASN1HEX(h)===!1)throw new Error("not ASN.1 hex string");try{f=W(h,0,[2,0,1],"02"),m=W(h,0,[2,0,2],"02"),v=W(h,0,[2,0,3],"02"),A=W(h,0,[2,0,4],"02"),C=W(h,0,[2,0,5],"02"),j=W(h,0,[2,0,6],"02"),K=W(h,0,[2,0,7],"02"),B=W(h,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(f,m,v,A,C,j,K,B)},ke.prototype.readPKCS5PubKeyHex=function(h){var f=oe,m=f.getV;if(f.isASN1HEX(h)===!1)throw new Error("keyHex is not ASN.1 hex string");var v=f.getChildIdx(h,0);if(v.length!==2||h.substr(v[0],2)!=="02"||h.substr(v[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var A=m(h,v[0]),C=m(h,v[1]);this.setPublic(A,C)},ke.prototype.readPKCS8PubKeyHex=function(h){var f=oe;if(f.isASN1HEX(h)===!1)throw new Error("not ASN.1 hex string");if(f.getTLVbyListEx(h,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var m=f.getTLVbyListEx(h,0,[1,0]);this.readPKCS5PubKeyHex(m)},ke.prototype.readCertPubKeyHex=function(h,f){var m,v;(m=new ur).readCertHex(h),v=m.getPublicKeyHex(),this.readPKCS8PubKeyHex(v)};function oy(h,f){for(var m="",v=f/4-h.length,A=0;A<v;A++)m+="0";return m+h}function sy(h,f,m){for(var v="",A=0;v.length<f;)v+=Oi(m(_o(h+String.fromCharCode.apply(String,[(4278190080&A)>>24,(16711680&A)>>16,(65280&A)>>8,255&A])))),A+=1;return v}function ay(h){for(var f in I.crypto.Util.DIGESTINFOHEAD){var m=I.crypto.Util.DIGESTINFOHEAD[f],v=m.length;if(h.substring(0,v)==m)return[f,h.substring(v)]}return[]}function ur(h){var f,m=oe,v=m.getChildIdx,A=m.getV,C=m.getTLV,j=m.getVbyList,K=m.getVbyListEx,B=m.getTLVbyList,H=m.getTLVbyListEx,W=m.getIdxbyList,V=m.getIdxbyListEx,Z=m.getVidx,ne=m.getInt,ce=m.oidname,he=m.hextooidstr,pe=wo;try{f=I.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var U=B(this.hex,0,[0,0]);if(U.substr(0,2)=="a0"){var q=B(U,0,[0]),G=ne(q,0);if(G<0||2<G)throw new Error("malformed version field");return this.version=G+1,this.version}return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return K(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var U=H(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(U)},this.getAlgorithmIdentifierName=function(U){for(var q in f)if(U===f[q])return q;return ce(K(U,0,[0],"06"))},this.getIssuer=function(){return this.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return B(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return this.getIssuer().str},this.getSubject=function(){return this.getX500Name(this.getSubjectHex())},this.getSubjectHex=function(){return B(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return this.getSubject().str},this.getNotBefore=function(){var U=j(this.hex,0,[0,4+this.foffset,0]);return U=U.replace(/(..)/g,"%$1"),U=decodeURIComponent(U)},this.getNotAfter=function(){var U=j(this.hex,0,[0,4+this.foffset,1]);return U=U.replace(/(..)/g,"%$1"),U=decodeURIComponent(U)},this.getPublicKeyHex=function(){return m.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return W(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var U=this.getPublicKeyIdx();return W(this.hex,U,[1,0],"30")},this.getPublicKey=function(){return Jn.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var U=B(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(U)},this.getSignatureValueHex=function(){return j(this.hex,0,[2],"03",!0)},this.verifySignature=function(U){var q=this.getSignatureAlgorithmField(),G=this.getSignatureValueHex(),J=B(this.hex,0,[0],"30"),le=new I.crypto.Signature({alg:q});return le.init(U),le.updateHex(J),le.verify(G)},this.parseExt=function(U){var q,G,J;if(U===void 0){if(J=this.hex,this.version!==3)return-1;q=W(J,0,[0,7,0],"30"),G=v(J,q)}else{J=wo(U);var le=W(J,0,[0,3,0,0],"06");if(A(J,le)!="2a864886f70d01090e")return void(this.aExtInfo=new Array);q=W(J,0,[0,3,0,1,0],"30"),G=v(J,q),this.hex=J}this.aExtInfo=new Array;for(var ge=0;ge<G.length;ge++){var Re={critical:!1},ye=0;v(J,G[ge]).length===3&&(Re.critical=!0,ye=1),Re.oid=m.hextooidstr(j(J,G[ge],[0],"06"));var mt=W(J,G[ge],[1+ye]);Re.vidx=Z(J,mt),this.aExtInfo.push(Re)}},this.getExtInfo=function(U){var q=this.aExtInfo,G=U;if(U.match(/^[0-9.]+$/)||(G=I.asn1.x509.OID.name2oid(U)),G!==""){for(var J=0;J<q.length;J++)if(q[J].oid===G)return q[J]}},this.getExtBasicConstraints=function(U,q){if(U===void 0&&q===void 0){var G=this.getExtInfo("basicConstraints");if(G===void 0)return;U=C(this.hex,G.vidx),q=G.critical}var J={extname:"basicConstraints"};if(q&&(J.critical=!0),U==="3000")return J;if(U==="30030101ff")return J.cA=!0,J;if(U.substr(0,12)==="30060101ff02"){var le=A(U,10),ge=parseInt(le,16);return J.cA=!0,J.pathLen=ge,J}throw new Error("hExtV parse error: "+U)},this.getExtKeyUsage=function(U,q){if(U===void 0&&q===void 0){var G=this.getExtInfo("keyUsage");if(G===void 0)return;U=C(this.hex,G.vidx),q=G.critical}var J={extname:"keyUsage"};return q&&(J.critical=!0),J.names=this.getExtKeyUsageString(U).split(","),J},this.getExtKeyUsageBin=function(U){if(U===void 0){var q=this.getExtInfo("keyUsage");if(q===void 0)return"";U=C(this.hex,q.vidx)}if(U.length!=8&&U.length!=10)throw new Error("malformed key usage value: "+U);var G="000000000000000"+parseInt(U.substr(6),16).toString(2);return U.length==8&&(G=G.slice(-8)),U.length==10&&(G=G.slice(-16)),(G=G.replace(/0+$/,""))==""&&(G="0"),G},this.getExtKeyUsageString=function(U){for(var q=this.getExtKeyUsageBin(U),G=new Array,J=0;J<q.length;J++)q.substr(J,1)=="1"&&G.push(ur.KEYUSAGE_NAME[J]);return G.join(",")},this.getExtSubjectKeyIdentifier=function(U,q){if(U===void 0&&q===void 0){var G=this.getExtInfo("subjectKeyIdentifier");if(G===void 0)return;U=C(this.hex,G.vidx),q=G.critical}var J={extname:"subjectKeyIdentifier"};q&&(J.critical=!0);var le=A(U,0);return J.kid={hex:le},J},this.getExtAuthorityKeyIdentifier=function(U,q){if(U===void 0&&q===void 0){var G=this.getExtInfo("authorityKeyIdentifier");if(G===void 0)return;U=C(this.hex,G.vidx),q=G.critical}var J={extname:"authorityKeyIdentifier"};q&&(J.critical=!0);for(var le=v(U,0),ge=0;ge<le.length;ge++){var Re=U.substr(le[ge],2);if(Re==="80"&&(J.kid={hex:A(U,le[ge])}),Re==="a1"){var ye=C(U,le[ge]),mt=this.getGeneralNames(ye);J.issuer=mt[0].dn}Re==="82"&&(J.sn={hex:A(U,le[ge])})}return J},this.getExtExtKeyUsage=function(U,q){if(U===void 0&&q===void 0){var G=this.getExtInfo("extKeyUsage");if(G===void 0)return;U=C(this.hex,G.vidx),q=G.critical}var J={extname:"extKeyUsage",array:[]};q&&(J.critical=!0);for(var le=v(U,0),ge=0;ge<le.length;ge++)J.array.push(ce(A(U,le[ge])));return J},this.getExtExtKeyUsageName=function(){var U=this.getExtInfo("extKeyUsage");if(U===void 0)return U;var q=new Array,G=C(this.hex,U.vidx);if(G==="")return q;for(var J=v(G,0),le=0;le<J.length;le++)q.push(ce(A(G,J[le])));return q},this.getExtSubjectAltName=function(U,q){if(U===void 0&&q===void 0){var G=this.getExtInfo("subjectAltName");if(G===void 0)return;U=C(this.hex,G.vidx),q=G.critical}var J={extname:"subjectAltName",array:[]};return q&&(J.critical=!0),J.array=this.getGeneralNames(U),J},this.getExtIssuerAltName=function(U,q){if(U===void 0&&q===void 0){var G=this.getExtInfo("issuerAltName");if(G===void 0)return;U=C(this.hex,G.vidx),q=G.critical}var J={extname:"issuerAltName",array:[]};return q&&(J.critical=!0),J.array=this.getGeneralNames(U),J},this.getGeneralNames=function(U){for(var q=v(U,0),G=[],J=0;J<q.length;J++){var le=this.getGeneralName(C(U,q[J]));le!==void 0&&G.push(le)}return G},this.getGeneralName=function(U){var q=U.substr(0,2),G=A(U,0),J=Oi(G);return q=="81"?{rfc822:J}:q=="82"?{dns:J}:q=="86"?{uri:J}:q=="87"?{ip:gh(G)}:q=="a4"?{dn:this.getX500Name(G)}:void 0},this.getExtSubjectAltName2=function(){var U,q,G,J=this.getExtInfo("subjectAltName");if(J===void 0)return J;for(var le=new Array,ge=C(this.hex,J.vidx),Re=v(ge,0),ye=0;ye<Re.length;ye++)G=ge.substr(Re[ye],2),U=A(ge,Re[ye]),G==="81"&&(q=lr(U),le.push(["MAIL",q])),G==="82"&&(q=lr(U),le.push(["DNS",q])),G==="84"&&(q=ur.hex2dn(U,0),le.push(["DN",q])),G==="86"&&(q=lr(U),le.push(["URI",q])),G==="87"&&(q=gh(U),le.push(["IP",q]));return le},this.getExtCRLDistributionPoints=function(U,q){if(U===void 0&&q===void 0){var G=this.getExtInfo("cRLDistributionPoints");if(G===void 0)return;U=C(this.hex,G.vidx),q=G.critical}var J={extname:"cRLDistributionPoints",array:[]};q&&(J.critical=!0);for(var le=v(U,0),ge=0;ge<le.length;ge++){var Re=C(U,le[ge]);J.array.push(this.getDistributionPoint(Re))}return J},this.getDistributionPoint=function(U){for(var q={},G=v(U,0),J=0;J<G.length;J++){var le=U.substr(G[J],2),ge=C(U,G[J]);le=="a0"&&(q.dpname=this.getDistributionPointName(ge))}return q},this.getDistributionPointName=function(U){for(var q={},G=v(U,0),J=0;J<G.length;J++){var le=U.substr(G[J],2),ge=C(U,G[J]);le=="a0"&&(q.full=this.getGeneralNames(ge))}return q},this.getExtCRLDistributionPointsURI=function(){var U=this.getExtInfo("cRLDistributionPoints");if(U===void 0)return U;for(var q=new Array,G=v(this.hex,U.vidx),J=0;J<G.length;J++)try{var le=lr(j(this.hex,G[J],[0,0,0],"86"));q.push(le)}catch{}return q},this.getExtAIAInfo=function(){var U=this.getExtInfo("authorityInfoAccess");if(U===void 0)return U;for(var q={ocsp:[],caissuer:[]},G=v(this.hex,U.vidx),J=0;J<G.length;J++){var le=j(this.hex,G[J],[0],"06"),ge=j(this.hex,G[J],[1],"86");le==="2b06010505073001"&&q.ocsp.push(lr(ge)),le==="2b06010505073002"&&q.caissuer.push(lr(ge))}return q},this.getExtAuthorityInfoAccess=function(U,q){if(U===void 0&&q===void 0){var G=this.getExtInfo("authorityInfoAccess");if(G===void 0)return;U=C(this.hex,G.vidx),q=G.critical}var J={extname:"authorityInfoAccess",array:[]};q&&(J.critical=!0);for(var le=v(U,0),ge=0;ge<le.length;ge++){var Re=K(U,le[ge],[0],"06"),ye=lr(j(U,le[ge],[1],"86"));if(Re=="2b06010505073001")J.array.push({ocsp:ye});else{if(Re!="2b06010505073002")throw new Error("unknown method: "+Re);J.array.push({caissuer:ye})}}return J},this.getExtCertificatePolicies=function(U,q){if(U===void 0&&q===void 0){var G=this.getExtInfo("certificatePolicies");if(G===void 0)return;U=C(this.hex,G.vidx),q=G.critical}var J={extname:"certificatePolicies",array:[]};q&&(J.critical=!0);for(var le=v(U,0),ge=0;ge<le.length;ge++){var Re=C(U,le[ge]),ye=this.getPolicyInformation(Re);J.array.push(ye)}return J},this.getPolicyInformation=function(U){var q={},G=j(U,0,[0],"06");q.policyoid=ce(G);var J=V(U,0,[1],"30");if(J!=-1){q.array=[];for(var le=v(U,J),ge=0;ge<le.length;ge++){var Re=C(U,le[ge]),ye=this.getPolicyQualifierInfo(Re);q.array.push(ye)}}return q},this.getPolicyQualifierInfo=function(U){var q={},G=j(U,0,[0],"06");if(G==="2b06010505070201"){var J=K(U,0,[1],"16");q.cps=Oi(J)}else if(G==="2b06010505070202"){var le=B(U,0,[1],"30");q.unotice=this.getUserNotice(le)}return q},this.getUserNotice=function(U){for(var q={},G=v(U,0),J=0;J<G.length;J++){var le=C(U,G[J]);le.substr(0,2)!="30"&&(q.exptext=this.getDisplayText(le))}return q},this.getDisplayText=function(U){var q={};return q.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[U.substr(0,2)],q.str=Oi(A(U,0)),q},this.getExtCRLNumber=function(U,q){var G={extname:"cRLNumber"};if(q&&(G.critical=!0),U.substr(0,2)=="02")return G.num={hex:A(U,0)},G;throw new Error("hExtV parse error: "+U)},this.getExtCRLReason=function(U,q){var G={extname:"cRLReason"};if(q&&(G.critical=!0),U.substr(0,2)=="0a")return G.code=parseInt(A(U,0),16),G;throw new Error("hExtV parse error: "+U)},this.getExtOcspNonce=function(U,q){var G={extname:"ocspNonce"};q&&(G.critical=!0);var J=A(U,0);return G.hex=J,G},this.getExtOcspNoCheck=function(U,q){var G={extname:"ocspNoCheck"};return q&&(G.critical=!0),G},this.getExtAdobeTimeStamp=function(U,q){if(U===void 0&&q===void 0){var G=this.getExtInfo("adobeTimeStamp");if(G===void 0)return;U=C(this.hex,G.vidx),q=G.critical}var J={extname:"adobeTimeStamp"};q&&(J.critical=!0);var le=v(U,0);if(le.length>1){var ge=C(U,le[1]),Re=this.getGeneralName(ge);Re.uri!=null&&(J.uri=Re.uri)}if(le.length>2){var ye=C(U,le[2]);ye=="0101ff"&&(J.reqauth=!0),ye=="010100"&&(J.reqauth=!1)}return J},this.getX500NameRule=function(U){for(var q=null,G=[],J=0;J<U.length;J++)for(var le=U[J],ge=0;ge<le.length;ge++)G.push(le[ge]);for(J=0;J<G.length;J++){var Re=G[J],ye=Re.ds,mt=Re.value,xe=Re.type;if(ye!="prn"&&ye!="utf8"&&ye!="ia5")return"mixed";if(ye=="ia5"){if(xe!="CN")return"mixed";if(I.lang.String.isMail(mt))continue;return"mixed"}if(xe=="C"){if(ye=="prn")continue;return"mixed"}if(q==null)q=ye;else if(q!==ye)return"mixed"}return q==null?"prn":q},this.getX500Name=function(U){var q=this.getX500NameArray(U);return{array:q,str:this.dnarraytostr(q)}},this.getX500NameArray=function(U){for(var q=[],G=v(U,0),J=0;J<G.length;J++)q.push(this.getRDN(C(U,G[J])));return q},this.getRDN=function(U){for(var q=[],G=v(U,0),J=0;J<G.length;J++)q.push(this.getAttrTypeAndValue(C(U,G[J])));return q},this.getAttrTypeAndValue=function(U){var q={type:null,value:null,ds:null},G=v(U,0),J=j(U,G[0],[],"06"),le=j(U,G[1],[]),ge=I.asn1.ASN1Util.oidHexToInt(J);return q.type=I.asn1.x509.OID.oid2atype(ge),q.ds=this.HEX2STAG[U.substr(G[1],2)],q.ds!="bmp"?q.value=lr(le):q.value=ny(le),q},this.readCertPEM=function(U){this.readCertHex(pe(U))},this.readCertHex=function(U){this.hex=U,this.getVersion();try{W(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(){var U={};return U.version=this.getVersion(),U.serial={hex:this.getSerialNumberHex()},U.sigalg=this.getSignatureAlgorithmField(),U.issuer=this.getIssuer(),U.notbefore=this.getNotBefore(),U.notafter=this.getNotAfter(),U.subject=this.getSubject(),U.sbjpubkey=fi(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo.length>0&&(U.ext=this.getExtParamArray()),U.sighex=this.getSignatureValueHex(),U},this.getExtParamArray=function(U){U==null&&V(this.hex,0,[0,"[3]"])!=-1&&(U=H(this.hex,0,[0,"[3]",0],"30"));for(var q=[],G=v(U,0),J=0;J<G.length;J++){var le=C(U,G[J]),ge=this.getExtParam(le);ge!=null&&q.push(ge)}return q},this.getExtParam=function(U){var q=v(U,0).length;if(q!=2&&q!=3)throw new Error("wrong number elements in Extension: "+q+" "+U);var G=he(j(U,0,[0],"06")),J=!1;q==3&&B(U,0,[1])=="0101ff"&&(J=!0);var le=B(U,0,[q-1,0]),ge=void 0;if(G=="2.5.29.14"?ge=this.getExtSubjectKeyIdentifier(le,J):G=="2.5.29.15"?ge=this.getExtKeyUsage(le,J):G=="2.5.29.17"?ge=this.getExtSubjectAltName(le,J):G=="2.5.29.18"?ge=this.getExtIssuerAltName(le,J):G=="2.5.29.19"?ge=this.getExtBasicConstraints(le,J):G=="2.5.29.31"?ge=this.getExtCRLDistributionPoints(le,J):G=="2.5.29.32"?ge=this.getExtCertificatePolicies(le,J):G=="2.5.29.35"?ge=this.getExtAuthorityKeyIdentifier(le,J):G=="2.5.29.37"?ge=this.getExtExtKeyUsage(le,J):G=="1.3.6.1.5.5.7.1.1"?ge=this.getExtAuthorityInfoAccess(le,J):G=="2.5.29.20"?ge=this.getExtCRLNumber(le,J):G=="2.5.29.21"?ge=this.getExtCRLReason(le,J):G=="1.3.6.1.5.5.7.48.1.2"?ge=this.getExtOcspNonce(le,J):G=="1.3.6.1.5.5.7.48.1.5"?ge=this.getExtOcspNoCheck(le,J):G=="1.2.840.113583.1.1.9.1"&&(ge=this.getExtAdobeTimeStamp(le,J)),ge!=null)return ge;var Re={extname:G,extn:le};return J&&(Re.critical=!0),Re},this.findExt=function(U,q){for(var G=0;G<U.length;G++)if(U[G].extname==q)return U[G];return null},this.updateExtCDPFullURI=function(U,q){var G=this.findExt(U,"cRLDistributionPoints");if(G!=null&&G.array!=null){for(var J=G.array,le=0;le<J.length;le++)if(J[le].dpname!=null&&J[le].dpname.full!=null)for(var ge=J[le].dpname.full,Re=0;Re<ge.length;Re++){var ye=ge[le];ye.uri!=null&&(ye.uri=q)}}},this.updateExtAIAOCSP=function(U,q){var G=this.findExt(U,"authorityInfoAccess");if(G!=null&&G.array!=null)for(var J=G.array,le=0;le<J.length;le++)J[le].ocsp!=null&&(J[le].ocsp=q)},this.updateExtAIACAIssuer=function(U,q){var G=this.findExt(U,"authorityInfoAccess");if(G!=null&&G.array!=null)for(var J=G.array,le=0;le<J.length;le++)J[le].caissuer!=null&&(J[le].caissuer=q)},this.dnarraytostr=function(U){return"/"+U.map(function(q){return function(J){return J.map(function(le){return function(Re){return Re.type+"="+Re.value}(le).replace(/\+/,"\\+")}).join("+")}(q).replace(/\//,"\\/")}).join("/")},this.getInfo=function(){var U,q,G,J=function(hi){return JSON.stringify(hi.array).replace(/[\[\]\{\}\"]/g,"")},le=function(hi){for(var qr="",ni=hi.array,Kn=0;Kn<ni.length;Kn++){var dr=ni[Kn];if(qr+="    policy oid: "+dr.policyoid+`
`,dr.array!==void 0)for(var Mr=0;Mr<dr.array.length;Mr++){var ri=dr.array[Mr];ri.cps!==void 0&&(qr+="    cps: "+ri.cps+`
`)}}return qr},ge=function(hi){for(var qr="",ni=hi.array,Kn=0;Kn<ni.length;Kn++){var dr=ni[Kn];try{dr.dpname.full[0].uri!==void 0&&(qr+="    "+dr.dpname.full[0].uri+`
`)}catch{}try{dr.dname.full[0].dn.hex!==void 0&&(qr+="    "+ur.hex2dn(dr.dpname.full[0].dn.hex)+`
`)}catch{}}return qr},Re=function(hi){for(var qr="",ni=hi.array,Kn=0;Kn<ni.length;Kn++){var dr=ni[Kn];dr.caissuer!==void 0&&(qr+="    caissuer: "+dr.caissuer+`
`),dr.ocsp!==void 0&&(qr+="    ocsp: "+dr.ocsp+`
`)}return qr};if(U=`Basic Fields
`,U+="  serial number: "+this.getSerialNumberHex()+`
`,U+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,U+="  issuer: "+this.getIssuerString()+`
`,U+="  notBefore: "+this.getNotBefore()+`
`,U+="  notAfter: "+this.getNotAfter()+`
`,U+="  subject: "+this.getSubjectString()+`
`,U+=`  subject public key info: 
`,U+="    key algorithm: "+(q=this.getPublicKey()).type+`
`,q.type==="RSA"&&(U+="    n="+mh(q.n.toString(16)).substr(0,16)+`...
`,U+="    e="+mh(q.e.toString(16))+`
`),(G=this.aExtInfo)!=null){U+=`X509v3 Extensions:
`;for(var ye=0;ye<G.length;ye++){var mt=G[ye],xe=I.asn1.x509.OID.oid2name(mt.oid);xe===""&&(xe=mt.oid);var qe="";if(mt.critical===!0&&(qe="CRITICAL"),U+="  "+xe+" "+qe+`:
`,xe==="basicConstraints"){var on=this.getExtBasicConstraints();on.cA===void 0?U+=`    {}
`:(U+="    cA=true",on.pathLen!==void 0&&(U+=", pathLen="+on.pathLen),U+=`
`)}else if(xe==="keyUsage")U+="    "+this.getExtKeyUsageString()+`
`;else if(xe==="subjectKeyIdentifier")U+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(xe==="authorityKeyIdentifier"){var bn=this.getExtAuthorityKeyIdentifier();bn.kid!==void 0&&(U+="    kid="+bn.kid.hex+`
`)}else xe==="extKeyUsage"?U+="    "+this.getExtExtKeyUsage().array.join(", ")+`
`:xe==="subjectAltName"?U+="    "+J(this.getExtSubjectAltName())+`
`:xe==="cRLDistributionPoints"?U+=ge(this.getExtCRLDistributionPoints()):xe==="authorityInfoAccess"?U+=Re(this.getExtAuthorityInfoAccess()):xe==="certificatePolicies"&&(U+=le(this.getExtCertificatePolicies()))}}return U+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,U+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`},typeof h=="string"&&(h.indexOf("-----BEGIN")!=-1?this.readCertPEM(h):I.lang.String.isHex(h)&&this.readCertHex(h))}ke.prototype.sign=function(h,f){var m=function(A){return I.crypto.Util.hashString(A,f)}(h);return this.signWithMessageHash(m,f)},ke.prototype.signWithMessageHash=function(h,f){var m=wr(I.crypto.Util.getPaddedDigestInfoHex(h,f,this.n.bitLength()),16);return oy(this.doPrivate(m).toString(16),this.n.bitLength())},ke.prototype.signPSS=function(h,f,m){var v=function(C){return I.crypto.Util.hashHex(C,f)}(_o(h));return m===void 0&&(m=-1),this.signWithMessageHashPSS(v,f,m)},ke.prototype.signWithMessageHashPSS=function(h,f,m){var v,A=Oi(h),C=A.length,j=this.n.bitLength()-1,K=Math.ceil(j/8),B=function(U){return I.crypto.Util.hashHex(U,f)};if(m===-1||m===void 0)m=C;else if(m===-2)m=K-C-2;else if(m<-2)throw new Error("invalid salt length");if(K<C+m+2)throw new Error("data too long");var H="";m>0&&(H=new Array(m),new pt().nextBytes(H),H=String.fromCharCode.apply(String,H));var W=Oi(B(_o("\0\0\0\0\0\0\0\0"+A+H))),V=[];for(v=0;v<K-m-C-2;v+=1)V[v]=0;var Z=String.fromCharCode.apply(String,V)+""+H,ne=sy(W,Z.length,B),ce=[];for(v=0;v<Z.length;v+=1)ce[v]=Z.charCodeAt(v)^ne.charCodeAt(v);var he=65280>>8*K-j&255;for(ce[0]&=~he,v=0;v<C;v++)ce.push(W.charCodeAt(v));return ce.push(188),oy(this.doPrivate(new $(ce)).toString(16),this.n.bitLength())},ke.prototype.verify=function(h,f){if((f=f.toLowerCase()).match(/^[0-9a-f]+$/)==null)return!1;var m=wr(f,16),v=this.n.bitLength();if(m.bitLength()>v)return!1;var A=this.doPublic(m).toString(16);if(A.length+3!=v/4)return!1;var C=ay(A.replace(/^1f+00/,""));if(C.length==0)return!1;var j=C[0];return C[1]==function(B){return I.crypto.Util.hashString(B,j)}(h)},ke.prototype.verifyWithMessageHash=function(h,f){if(f.length!=Math.ceil(this.n.bitLength()/4))return!1;var m=wr(f,16);if(m.bitLength()>this.n.bitLength())return 0;var v=ay(this.doPublic(m).toString(16).replace(/^1f+00/,""));return v.length==0?!1:(v[0],v[1]==h)},ke.prototype.verifyPSS=function(h,f,m,v){var A=function(j){return I.crypto.Util.hashHex(j,m)}(_o(h));return v===void 0&&(v=-1),this.verifyWithMessageHashPSS(A,f,m,v)},ke.prototype.verifyWithMessageHashPSS=function(h,f,m,v){if(f.length!=Math.ceil(this.n.bitLength()/4))return!1;var A,C=new $(f,16),j=function(G){return I.crypto.Util.hashHex(G,m)},K=Oi(h),B=K.length,H=this.n.bitLength()-1,W=Math.ceil(H/8);if(v===-1||v===void 0)v=B;else if(v===-2)v=W-B-2;else if(v<-2)throw new Error("invalid salt length");if(W<B+v+2)throw new Error("data too long");var V=this.doPublic(C).toByteArray();for(A=0;A<V.length;A+=1)V[A]&=255;for(;V.length<W;)V.unshift(0);if(V[W-1]!==188)throw new Error("encoded message does not end in 0xbc");var Z=(V=String.fromCharCode.apply(String,V)).substr(0,W-B-1),ne=V.substr(Z.length,B),ce=65280>>8*W-H&255;if((Z.charCodeAt(0)&ce)!=0)throw new Error("bits beyond keysize not zero");var he=sy(ne,Z.length,j),pe=[];for(A=0;A<Z.length;A+=1)pe[A]=Z.charCodeAt(A)^he.charCodeAt(A);pe[0]&=~ce;var U=W-B-v-2;for(A=0;A<U;A+=1)if(pe[A]!==0)throw new Error("leftmost octets not zero");if(pe[U]!==1)throw new Error("0x01 marker not found");return ne===Oi(j(_o("\0\0\0\0\0\0\0\0"+K+String.fromCharCode.apply(String,pe.slice(-v)))))},ke.SALT_LEN_HLEN=-1,ke.SALT_LEN_MAX=-2,ke.SALT_LEN_RECOVER=-2,ur.hex2dn=function(h,f){f===void 0&&(f=0);var m=new ur;return oe.getTLV(h,f),m.getX500Name(h).str},ur.hex2rdn=function(h,f){if(f===void 0&&(f=0),h.substr(f,2)!=="31")throw new Error("malformed RDN");for(var m=new Array,v=oe.getChildIdx(h,f),A=0;A<v.length;A++)m.push(ur.hex2attrTypeValue(h,v[A]));return(m=m.map(function(C){return C.replace("+","\\+")})).join("+")},ur.hex2attrTypeValue=function(h,f){var m=oe,v=m.getV;if(f===void 0&&(f=0),h.substr(f,2)!=="30")throw new Error("malformed attribute type and value");var A=m.getChildIdx(h,f);A.length!==2||h.substr(A[0],2);var C=v(h,A[0]),j=I.asn1.ASN1Util.oidHexToInt(C);return I.asn1.x509.OID.oid2atype(j)+"="+Oi(v(h,A[1]))},ur.getPublicKeyFromCertHex=function(h){var f=new ur;return f.readCertHex(h),f.getPublicKey()},ur.getPublicKeyFromCertPEM=function(h){var f=new ur;return f.readCertPEM(h),f.getPublicKey()},ur.getPublicKeyInfoPropOfCertPEM=function(h){var f,m,v=oe.getVbyList,A={};return A.algparam=null,(f=new ur).readCertPEM(h),m=f.getPublicKeyHex(),A.keyhex=v(m,0,[1],"03").substr(2),A.algoid=v(m,0,[0,0],"06"),A.algoid==="2a8648ce3d0201"&&(A.algparam=v(m,0,[0,1],"06")),A},ur.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],I!==void 0&&I||(r.KJUR=I={}),I.jws!==void 0&&I.jws||(I.jws={}),I.jws.JWS=function(){var h=I.jws.JWS.isSafeJSONString;this.parseJWS=function(f,m){if(this.parsedJWS===void 0||!m&&this.parsedJWS.sigvalH===void 0){var v=f.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(v==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var A=v[1],C=v[2],j=v[3],K=A+"."+C;if(this.parsedJWS={},this.parsedJWS.headB64U=A,this.parsedJWS.payloadB64U=C,this.parsedJWS.sigvalB64U=j,this.parsedJWS.si=K,!m){var B=fn(j),H=wr(B,16);this.parsedJWS.sigvalH=B,this.parsedJWS.sigvalBI=H}var W=fe(A),V=fe(C);if(this.parsedJWS.headS=W,this.parsedJWS.payloadS=V,!h(W,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+W}}},I.jws.JWS.sign=function(h,f,m,v,A){var C,j,K,B=I,H=B.jws.JWS,W=H.readSafeJSONString,V=H.isSafeJSONString,Z=B.crypto,ne=(Z.ECDSA,Z.Mac),ce=Z.Signature,he=JSON;if(typeof f!="string"&&(f===void 0?"undefined":b(f))!="object")throw"spHeader must be JSON string or object: "+f;if((f===void 0?"undefined":b(f))=="object"&&(j=f,C=he.stringify(j)),typeof f=="string"){if(!V(C=f))throw"JWS Head is not safe JSON string: "+C;j=W(C)}if(K=m,(m===void 0?"undefined":b(m))=="object"&&(K=he.stringify(m)),h!=""&&h!=null||j.alg===void 0||(h=j.alg),h!=""&&h!=null&&j.alg===void 0&&(j.alg=h,C=he.stringify(j)),h!==j.alg)throw"alg and sHeader.alg doesn't match: "+h+"!="+j.alg;var pe=null;if(H.jwsalg2sigalg[h]===void 0)throw"unsupported alg name: "+h;pe=H.jwsalg2sigalg[h];var U=ie(C)+"."+ie(K),q="";if(pe.substr(0,4)=="Hmac"){if(v===void 0)throw"mac key shall be specified for HS* alg";var G=new ne({alg:pe,prov:"cryptojs",pass:v});G.updateString(U),q=G.doFinal()}else if(pe.indexOf("withECDSA")!=-1){(le=new ce({alg:pe})).init(v,A),le.updateString(U);var J=le.sign();q=I.crypto.ECDSA.asn1SigToConcatSig(J)}else{var le;pe!="none"&&((le=new ce({alg:pe})).init(v,A),le.updateString(U),q=le.sign())}return U+"."+cr(q)},I.jws.JWS.verify=function(h,f,m){var v,A=I,C=A.jws.JWS,j=C.readSafeJSONString,K=A.crypto,B=K.ECDSA,H=K.Mac,W=K.Signature;b(ke)!==void 0&&(v=ke);var V=h.split(".");if(V.length!==3)return!1;var Z=V[0]+"."+V[1],ne=fn(V[2]),ce=j(fe(V[0])),he=null,pe=null;if(ce.alg===void 0)throw"algorithm not specified in header";if(pe=(he=ce.alg).substr(0,2),m!=null&&Object.prototype.toString.call(m)==="[object Array]"&&m.length>0&&(":"+m.join(":")+":").indexOf(":"+he+":")==-1)throw"algorithm '"+he+"' not accepted in the list";if(he!="none"&&f===null)throw"key shall be specified to verify.";if(typeof f=="string"&&f.indexOf("-----BEGIN ")!=-1&&(f=Jn.getKey(f)),!(pe!="RS"&&pe!="PS"||f instanceof v))throw"key shall be a RSAKey obj for RS* and PS* algs";if(pe=="ES"&&!(f instanceof B))throw"key shall be a ECDSA obj for ES* algs";var U=null;if(C.jwsalg2sigalg[ce.alg]===void 0)throw"unsupported alg name: "+he;if((U=C.jwsalg2sigalg[he])=="none")throw"not supported";if(U.substr(0,4)=="Hmac"){if(f===void 0)throw"hexadecimal key shall be specified for HMAC";var q=new H({alg:U,pass:f});return q.updateString(Z),ne==q.doFinal()}if(U.indexOf("withECDSA")!=-1){var G,J=null;try{J=B.concatSigToASN1Sig(ne)}catch{return!1}return(G=new W({alg:U})).init(f),G.updateString(Z),G.verify(J)}return(G=new W({alg:U})).init(f),G.updateString(Z),G.verify(ne)},I.jws.JWS.parse=function(h){var f,m,v,A=h.split("."),C={};if(A.length!=2&&A.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return f=A[0],m=A[1],A.length==3&&(v=A[2]),C.headerObj=I.jws.JWS.readSafeJSONString(fe(f)),C.payloadObj=I.jws.JWS.readSafeJSONString(fe(m)),C.headerPP=JSON.stringify(C.headerObj,null,"  "),C.payloadObj==null?C.payloadPP=fe(m):C.payloadPP=JSON.stringify(C.payloadObj,null,"  "),v!==void 0&&(C.sigHex=fn(v)),C},I.jws.JWS.verifyJWT=function(h,f,m){var v=I.jws,A=v.JWS,C=A.readSafeJSONString,j=A.inArray,K=A.includedArray,B=h.split("."),H=B[0],W=B[1],V=(fn(B[2]),C(fe(H))),Z=C(fe(W));if(V.alg===void 0)return!1;if(m.alg===void 0)throw"acceptField.alg shall be specified";if(!j(V.alg,m.alg)||Z.iss!==void 0&&b(m.iss)==="object"&&!j(Z.iss,m.iss)||Z.sub!==void 0&&b(m.sub)==="object"&&!j(Z.sub,m.sub))return!1;if(Z.aud!==void 0&&b(m.aud)==="object"){if(typeof Z.aud=="string"){if(!j(Z.aud,m.aud))return!1}else if(b(Z.aud)=="object"&&!K(Z.aud,m.aud))return!1}var ne=v.IntDate.getNow();return m.verifyAt!==void 0&&typeof m.verifyAt=="number"&&(ne=m.verifyAt),m.gracePeriod!==void 0&&typeof m.gracePeriod=="number"||(m.gracePeriod=0),!(Z.exp!==void 0&&typeof Z.exp=="number"&&Z.exp+m.gracePeriod<ne)&&!(Z.nbf!==void 0&&typeof Z.nbf=="number"&&ne<Z.nbf-m.gracePeriod)&&!(Z.iat!==void 0&&typeof Z.iat=="number"&&ne<Z.iat-m.gracePeriod)&&(Z.jti===void 0||m.jti===void 0||Z.jti===m.jti)&&!!A.verify(h,f,m.alg)},I.jws.JWS.includedArray=function(h,f){var m=I.jws.JWS.inArray;if(h===null||(h===void 0?"undefined":b(h))!=="object"||typeof h.length!="number")return!1;for(var v=0;v<h.length;v++)if(!m(h[v],f))return!1;return!0},I.jws.JWS.inArray=function(h,f){if(f===null||(f===void 0?"undefined":b(f))!=="object"||typeof f.length!="number")return!1;for(var m=0;m<f.length;m++)if(f[m]==h)return!0;return!1},I.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},I.jws.JWS.isSafeJSONString=function(h,f,m){var v=null;try{return((v=k(h))===void 0?"undefined":b(v))!="object"||v.constructor===Array?0:(f&&(f[m]=v),1)}catch{return 0}},I.jws.JWS.readSafeJSONString=function(h){var f=null;try{return((f=k(h))===void 0?"undefined":b(f))!="object"||f.constructor===Array?null:f}catch{return null}},I.jws.JWS.getEncodedSignatureValueFromJWS=function(h){var f=h.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(f==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return f[1]},I.jws.JWS.getJWKthumbprint=function(h){if(h.kty!=="RSA"&&h.kty!=="EC"&&h.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var f="{";if(h.kty==="RSA"){if(typeof h.n!="string"||typeof h.e!="string")throw"wrong n and e value for RSA key";f+='"e":"'+h.e+'",',f+='"kty":"'+h.kty+'",',f+='"n":"'+h.n+'"}'}else if(h.kty==="EC"){if(typeof h.crv!="string"||typeof h.x!="string"||typeof h.y!="string")throw"wrong crv, x and y value for EC key";f+='"crv":"'+h.crv+'",',f+='"kty":"'+h.kty+'",',f+='"x":"'+h.x+'",',f+='"y":"'+h.y+'"}'}else if(h.kty==="oct"){if(typeof h.k!="string")throw"wrong k value for oct(symmetric) key";f+='"kty":"'+h.kty+'",',f+='"k":"'+h.k+'"}'}var m=_o(f);return cr(I.crypto.Util.hashHex(m,"sha256"))},I.jws.IntDate={},I.jws.IntDate.get=function(h){var f=I.jws.IntDate,m=f.getNow,v=f.getZulu;if(h=="now")return m();if(h=="now + 1hour")return m()+3600;if(h=="now + 1day")return m()+86400;if(h=="now + 1month")return m()+2592e3;if(h=="now + 1year")return m()+31536e3;if(h.match(/Z$/))return v(h);if(h.match(/^[0-9]+$/))return parseInt(h);throw"unsupported format: "+h},I.jws.IntDate.getZulu=function(h){return Xm(h)},I.jws.IntDate.getNow=function(){return~~(new Date/1e3)},I.jws.IntDate.intDate2UTCString=function(h){return new Date(1e3*h).toUTCString()},I.jws.IntDate.intDate2Zulu=function(h){var f=new Date(1e3*h);return("0000"+f.getUTCFullYear()).slice(-4)+("00"+(f.getUTCMonth()+1)).slice(-2)+("00"+f.getUTCDate()).slice(-2)+("00"+f.getUTCHours()).slice(-2)+("00"+f.getUTCMinutes()).slice(-2)+("00"+f.getUTCSeconds()).slice(-2)+"Z"},r.SecureRandom=pt,r.rng_seed_time=de,r.BigInteger=$,r.RSAKey=ke;var VE=I.crypto.EDSA;r.EDSA=VE;var zE=I.crypto.DSA;r.DSA=zE;var GE=I.crypto.Signature;r.Signature=GE;var YE=I.crypto.MessageDigest;r.MessageDigest=YE;var JE=I.crypto.Mac;r.Mac=JE;var ZE=I.crypto.Cipher;r.Cipher=ZE,r.KEYUTIL=Jn,r.ASN1HEX=oe,r.X509=ur,r.CryptoJS=F,r.b64tohex=Y,r.b64toBA=X,r.stoBA=at,r.BAtos=dn,r.BAtohex=$t,r.stohex=Dt,r.stob64=function(f){return D(Dt(f))},r.stob64u=function(f){return Ct(D(Dt(f)))},r.b64utos=function(f){return dn(X(Gc(f)))},r.b64tob64u=Ct,r.b64utob64=Gc,r.hex2b64=D,r.hextob64u=cr,r.b64utohex=fn,r.utf8tob64u=ie,r.b64utoutf8=fe,r.utf8tob64=function(f){return D(Nu(Mu(f)))},r.b64toutf8=function(f){return decodeURIComponent(Ou(Y(f)))},r.utf8tohex=hh,r.hextoutf8=lr,r.hextorstr=Oi,r.rstrtohex=_o,r.hextob64=Jm,r.hextob64nl=Zm,r.b64nltohex=Qm,r.hextopem=fi,r.pemtohex=wo,r.hextoArrayBuffer=function(f){if(f.length%2!=0)throw"input is not even length";if(f.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var m=new ArrayBuffer(f.length/2),v=new DataView(m),A=0;A<f.length/2;A++)v.setUint8(A,parseInt(f.substr(2*A,2),16));return m},r.ArrayBuffertohex=function(f){for(var m="",v=new DataView(f),A=0;A<f.byteLength;A++)m+=("00"+v.getUint8(A).toString(16)).slice(-2);return m},r.zulutomsec=ph,r.zulutosec=Xm,r.zulutodate=function(f){return new Date(ph(f))},r.datetozulu=function(f,m,v){var A,C=f.getUTCFullYear();if(m){if(C<1950||2049<C)throw"not proper year for UTCTime: "+C;A=(""+C).slice(-2)}else A=("000"+C).slice(-4);if(A+=("0"+(f.getUTCMonth()+1)).slice(-2),A+=("0"+f.getUTCDate()).slice(-2),A+=("0"+f.getUTCHours()).slice(-2),A+=("0"+f.getUTCMinutes()).slice(-2),A+=("0"+f.getUTCSeconds()).slice(-2),v){var j=f.getUTCMilliseconds();j!==0&&(A+="."+(j=(j=("00"+j).slice(-3)).replace(/0+$/g,"")))}return A+="Z"},r.uricmptohex=Nu,r.hextouricmp=Ou,r.ipv6tohex=ey,r.hextoipv6=ty,r.hextoip=gh,r.iptohex=function(f){var m="malformed IP address";if(!(f=f.toLowerCase(f)).match(/^[0-9.]+$/)){if(f.match(/^[0-9a-f:]+$/)&&f.indexOf(":")!==-1)return ey(f);throw m}var v=f.split(".");if(v.length!==4)throw m;var A="";try{for(var C=0;C<4;C++)A+=("0"+parseInt(v[C]).toString(16)).slice(-2);return A}catch{throw m}},r.encodeURIComponentAll=Mu,r.newline_toUnix=function(f){return f=f.replace(/\r\n/gm,`
`)},r.newline_toDos=function(f){return f=(f=f.replace(/\r\n/gm,`
`)).replace(/\n/gm,`\r
`)},r.hextoposhex=mh,r.intarystrtohex=function(f){f=(f=(f=f.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return f.split(/,/).map(function(m,v,A){var C=parseInt(m);if(C<0||255<C)throw"integer not in range 0-255";return("00"+C.toString(16)).slice(-2)}).join("")}catch(m){throw"malformed integer array string: "+m}},r.strdiffidx=function(f,m){var v=f.length;f.length>m.length&&(v=m.length);for(var A=0;A<v;A++)if(f.charCodeAt(A)!=m.charCodeAt(A))return A;return f.length!=m.length?v:-1},r.KJUR=I;var QE=I.crypto;r.crypto=QE;var XE=I.asn1;r.asn1=XE;var eS=I.jws;r.jws=eS;var tS=I.lang;r.lang=tS}).call(this,i(28).Buffer)},function(n,r,i){(function(o){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */var s=i(30),a=i(31),c=i(32);function l(){return d.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(Q,N){if(l()<N)throw new RangeError("Invalid typed array length");return d.TYPED_ARRAY_SUPPORT?(Q=new Uint8Array(N)).__proto__=d.prototype:(Q===null&&(Q=new d(N)),Q.length=N),Q}function d(Q,N,O){if(!(d.TYPED_ARRAY_SUPPORT||this instanceof d))return new d(Q,N,O);if(typeof Q=="number"){if(typeof N=="string")throw new Error("If encoding is specified then the first argument must be a string");return y(this,Q)}return g(this,Q,N,O)}function g(Q,N,O,z){if(typeof N=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer!="undefined"&&N instanceof ArrayBuffer?function(de,me,Oe,nt){if(me.byteLength,Oe<0||me.byteLength<Oe)throw new RangeError("'offset' is out of bounds");if(me.byteLength<Oe+(nt||0))throw new RangeError("'length' is out of bounds");return me=Oe===void 0&&nt===void 0?new Uint8Array(me):nt===void 0?new Uint8Array(me,Oe):new Uint8Array(me,Oe,nt),d.TYPED_ARRAY_SUPPORT?(de=me).__proto__=d.prototype:de=w(de,me),de}(Q,N,O,z):typeof N=="string"?function(de,me,Oe){if(typeof Oe=="string"&&Oe!==""||(Oe="utf8"),!d.isEncoding(Oe))throw new TypeError('"encoding" must be a valid string encoding');var nt=0|b(me,Oe),xt=(de=u(de,nt)).write(me,Oe);return xt!==nt&&(de=de.slice(0,xt)),de}(Q,N,O):function(de,me){if(d.isBuffer(me)){var Oe=0|E(me.length);return(de=u(de,Oe)).length===0||me.copy(de,0,0,Oe),de}if(me){if(typeof ArrayBuffer!="undefined"&&me.buffer instanceof ArrayBuffer||"length"in me)return typeof me.length!="number"||function(xt){return xt!=xt}(me.length)?u(de,0):w(de,me);if(me.type==="Buffer"&&c(me.data))return w(de,me.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(Q,N)}function p(Q){if(typeof Q!="number")throw new TypeError('"size" argument must be a number');if(Q<0)throw new RangeError('"size" argument must not be negative')}function y(Q,N){if(p(N),Q=u(Q,N<0?0:0|E(N)),!d.TYPED_ARRAY_SUPPORT)for(var O=0;O<N;++O)Q[O]=0;return Q}function w(Q,N){var O=N.length<0?0:0|E(N.length);Q=u(Q,O);for(var z=0;z<O;z+=1)Q[z]=255&N[z];return Q}function E(Q){if(Q>=l())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l().toString(16)+" bytes");return 0|Q}function b(Q,N){if(d.isBuffer(Q))return Q.length;if(typeof ArrayBuffer!="undefined"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(Q)||Q instanceof ArrayBuffer))return Q.byteLength;typeof Q!="string"&&(Q=""+Q);var O=Q.length;if(O===0)return 0;for(var z=!1;;)switch(N){case"ascii":case"latin1":case"binary":return O;case"utf8":case"utf-8":case void 0:return ln(Q).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*O;case"hex":return O>>>1;case"base64":return vn(Q).length;default:if(z)return ln(Q).length;N=(""+N).toLowerCase(),z=!0}}function S(Q,N,O){var z=!1;if((N===void 0||N<0)&&(N=0),N>this.length||((O===void 0||O>this.length)&&(O=this.length),O<=0)||(O>>>=0)<=(N>>>=0))return"";for(Q||(Q="utf8");;)switch(Q){case"hex":return Ce(this,N,O);case"utf8":case"utf-8":return Ae(this,N,O);case"ascii":return se(this,N,O);case"latin1":case"binary":return we(this,N,O);case"base64":return _e(this,N,O);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ze(this,N,O);default:if(z)throw new TypeError("Unknown encoding: "+Q);Q=(Q+"").toLowerCase(),z=!0}}function R(Q,N,O){var z=Q[N];Q[N]=Q[O],Q[O]=z}function F(Q,N,O,z,ee){if(Q.length===0)return-1;if(typeof O=="string"?(z=O,O=0):O>2147483647?O=2147483647:O<-2147483648&&(O=-2147483648),O=+O,isNaN(O)&&(O=ee?0:Q.length-1),O<0&&(O=Q.length+O),O>=Q.length){if(ee)return-1;O=Q.length-1}else if(O<0){if(!ee)return-1;O=0}if(typeof N=="string"&&(N=d.from(N,z)),d.isBuffer(N))return N.length===0?-1:M(Q,N,O,z,ee);if(typeof N=="number")return N&=255,d.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?ee?Uint8Array.prototype.indexOf.call(Q,N,O):Uint8Array.prototype.lastIndexOf.call(Q,N,O):M(Q,[N],O,z,ee);throw new TypeError("val must be string, number or Buffer")}function M(Q,N,O,z,ee){var de,me=1,Oe=Q.length,nt=N.length;if(z!==void 0&&((z=String(z).toLowerCase())==="ucs2"||z==="ucs-2"||z==="utf16le"||z==="utf-16le")){if(Q.length<2||N.length<2)return-1;me=2,Oe/=2,nt/=2,O/=2}function xt(Si,ke){return me===1?Si[ke]:Si.readUInt16BE(ke*me)}if(ee){var ht=-1;for(de=O;de<Oe;de++)if(xt(Q,de)===xt(N,ht===-1?0:de-ht)){if(ht===-1&&(ht=de),de-ht+1===nt)return ht*me}else ht!==-1&&(de-=de-ht),ht=-1}else for(O+nt>Oe&&(O=Oe-nt),de=O;de>=0;de--){for(var pt=!0,wr=0;wr<nt;wr++)if(xt(Q,de+wr)!==xt(N,wr)){pt=!1;break}if(pt)return de}return-1}function P(Q,N,O,z){O=Number(O)||0;var ee=Q.length-O;z?(z=Number(z))>ee&&(z=ee):z=ee;var de=N.length;if(de%2!=0)throw new TypeError("Invalid hex string");z>de/2&&(z=de/2);for(var me=0;me<z;++me){var Oe=parseInt(N.substr(2*me,2),16);if(isNaN(Oe))return me;Q[O+me]=Oe}return me}function D(Q,N,O,z){return Mt(ln(N,Q.length-O),Q,O,z)}function Y(Q,N,O,z){return Mt(function(de){for(var me=[],Oe=0;Oe<de.length;++Oe)me.push(255&de.charCodeAt(Oe));return me}(N),Q,O,z)}function X(Q,N,O,z){return Y(Q,N,O,z)}function $(Q,N,O,z){return Mt(vn(N),Q,O,z)}function te(Q,N,O,z){return Mt(function(de,me){for(var Oe,nt,xt,ht=[],pt=0;pt<de.length&&!((me-=2)<0);++pt)nt=(Oe=de.charCodeAt(pt))>>8,xt=Oe%256,ht.push(xt),ht.push(nt);return ht}(N,Q.length-O),Q,O,z)}function _e(Q,N,O){return N===0&&O===Q.length?s.fromByteArray(Q):s.fromByteArray(Q.slice(N,O))}function Ae(Q,N,O){O=Math.min(Q.length,O);for(var z=[],ee=N;ee<O;){var de,me,Oe,nt,xt=Q[ee],ht=null,pt=xt>239?4:xt>223?3:xt>191?2:1;if(ee+pt<=O)switch(pt){case 1:xt<128&&(ht=xt);break;case 2:(192&(de=Q[ee+1]))==128&&(nt=(31&xt)<<6|63&de)>127&&(ht=nt);break;case 3:de=Q[ee+1],me=Q[ee+2],(192&de)==128&&(192&me)==128&&(nt=(15&xt)<<12|(63&de)<<6|63&me)>2047&&(nt<55296||nt>57343)&&(ht=nt);break;case 4:de=Q[ee+1],me=Q[ee+2],Oe=Q[ee+3],(192&de)==128&&(192&me)==128&&(192&Oe)==128&&(nt=(15&xt)<<18|(63&de)<<12|(63&me)<<6|63&Oe)>65535&&nt<1114112&&(ht=nt)}ht===null?(ht=65533,pt=1):ht>65535&&(ht-=65536,z.push(ht>>>10&1023|55296),ht=56320|1023&ht),z.push(ht),ee+=pt}return function(Si){var ke=Si.length;if(ke<=re)return String.fromCharCode.apply(String,Si);for(var un="",L=0;L<ke;)un+=String.fromCharCode.apply(String,Si.slice(L,L+=re));return un}(z)}r.Buffer=d,r.SlowBuffer=function(N){return+N!=N&&(N=0),d.alloc(+N)},r.INSPECT_MAX_BYTES=50,d.TYPED_ARRAY_SUPPORT=o.TYPED_ARRAY_SUPPORT!==void 0?o.TYPED_ARRAY_SUPPORT:function(){try{var N=new Uint8Array(1);return N.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},N.foo()===42&&typeof N.subarray=="function"&&N.subarray(1,1).byteLength===0}catch{return!1}}(),r.kMaxLength=l(),d.poolSize=8192,d._augment=function(Q){return Q.__proto__=d.prototype,Q},d.from=function(Q,N,O){return g(null,Q,N,O)},d.TYPED_ARRAY_SUPPORT&&(d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,typeof Symbol!="undefined"&&Symbol.species&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0})),d.alloc=function(Q,N,O){return function(ee,de,me,Oe){return p(de),de<=0?u(ee,de):me!==void 0?typeof Oe=="string"?u(ee,de).fill(me,Oe):u(ee,de).fill(me):u(ee,de)}(null,Q,N,O)},d.allocUnsafe=function(Q){return y(null,Q)},d.allocUnsafeSlow=function(Q){return y(null,Q)},d.isBuffer=function(N){return!(N==null||!N._isBuffer)},d.compare=function(N,O){if(!d.isBuffer(N)||!d.isBuffer(O))throw new TypeError("Arguments must be Buffers");if(N===O)return 0;for(var z=N.length,ee=O.length,de=0,me=Math.min(z,ee);de<me;++de)if(N[de]!==O[de]){z=N[de],ee=O[de];break}return z<ee?-1:ee<z?1:0},d.isEncoding=function(N){switch(String(N).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(N,O){if(!c(N))throw new TypeError('"list" argument must be an Array of Buffers');if(N.length===0)return d.alloc(0);var z;if(O===void 0)for(O=0,z=0;z<N.length;++z)O+=N[z].length;var ee=d.allocUnsafe(O),de=0;for(z=0;z<N.length;++z){var me=N[z];if(!d.isBuffer(me))throw new TypeError('"list" argument must be an Array of Buffers');me.copy(ee,de),de+=me.length}return ee},d.byteLength=b,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var N=this.length;if(N%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var O=0;O<N;O+=2)R(this,O,O+1);return this},d.prototype.swap32=function(){var N=this.length;if(N%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var O=0;O<N;O+=4)R(this,O,O+3),R(this,O+1,O+2);return this},d.prototype.swap64=function(){var N=this.length;if(N%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var O=0;O<N;O+=8)R(this,O,O+7),R(this,O+1,O+6),R(this,O+2,O+5),R(this,O+3,O+4);return this},d.prototype.toString=function(){var N=0|this.length;return N===0?"":arguments.length===0?Ae(this,0,N):S.apply(this,arguments)},d.prototype.equals=function(N){if(!d.isBuffer(N))throw new TypeError("Argument must be a Buffer");return this===N||d.compare(this,N)===0},d.prototype.inspect=function(){var N="",O=r.INSPECT_MAX_BYTES;return this.length>0&&(N=this.toString("hex",0,O).match(/.{2}/g).join(" "),this.length>O&&(N+=" ... ")),"<Buffer "+N+">"},d.prototype.compare=function(N,O,z,ee,de){if(!d.isBuffer(N))throw new TypeError("Argument must be a Buffer");if(O===void 0&&(O=0),z===void 0&&(z=N?N.length:0),ee===void 0&&(ee=0),de===void 0&&(de=this.length),O<0||z>N.length||ee<0||de>this.length)throw new RangeError("out of range index");if(ee>=de&&O>=z)return 0;if(ee>=de)return-1;if(O>=z)return 1;if(this===N)return 0;for(var me=(de>>>=0)-(ee>>>=0),Oe=(z>>>=0)-(O>>>=0),nt=Math.min(me,Oe),xt=this.slice(ee,de),ht=N.slice(O,z),pt=0;pt<nt;++pt)if(xt[pt]!==ht[pt]){me=xt[pt],Oe=ht[pt];break}return me<Oe?-1:Oe<me?1:0},d.prototype.includes=function(N,O,z){return this.indexOf(N,O,z)!==-1},d.prototype.indexOf=function(N,O,z){return F(this,N,O,z,!0)},d.prototype.lastIndexOf=function(N,O,z){return F(this,N,O,z,!1)},d.prototype.write=function(N,O,z,ee){if(O===void 0)ee="utf8",z=this.length,O=0;else if(z===void 0&&typeof O=="string")ee=O,z=this.length,O=0;else{if(!isFinite(O))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");O|=0,isFinite(z)?(z|=0,ee===void 0&&(ee="utf8")):(ee=z,z=void 0)}var de=this.length-O;if((z===void 0||z>de)&&(z=de),N.length>0&&(z<0||O<0)||O>this.length)throw new RangeError("Attempt to write outside buffer bounds");ee||(ee="utf8");for(var me=!1;;)switch(ee){case"hex":return P(this,N,O,z);case"utf8":case"utf-8":return D(this,N,O,z);case"ascii":return Y(this,N,O,z);case"latin1":case"binary":return X(this,N,O,z);case"base64":return $(this,N,O,z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te(this,N,O,z);default:if(me)throw new TypeError("Unknown encoding: "+ee);ee=(""+ee).toLowerCase(),me=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var re=4096;function se(Q,N,O){var z="";O=Math.min(Q.length,O);for(var ee=N;ee<O;++ee)z+=String.fromCharCode(127&Q[ee]);return z}function we(Q,N,O){var z="";O=Math.min(Q.length,O);for(var ee=N;ee<O;++ee)z+=String.fromCharCode(Q[ee]);return z}function Ce(Q,N,O){var z=Q.length;(!N||N<0)&&(N=0),(!O||O<0||O>z)&&(O=z);for(var ee="",de=N;de<O;++de)ee+=Fn(Q[de]);return ee}function Ze(Q,N,O){for(var z=Q.slice(N,O),ee="",de=0;de<z.length;de+=2)ee+=String.fromCharCode(z[de]+256*z[de+1]);return ee}function Ee(Q,N,O){if(Q%1!=0||Q<0)throw new RangeError("offset is not uint");if(Q+N>O)throw new RangeError("Trying to access beyond buffer length")}function Ve(Q,N,O,z,ee,de){if(!d.isBuffer(Q))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>ee||N<de)throw new RangeError('"value" argument is out of bounds');if(O+z>Q.length)throw new RangeError("Index out of range")}function Ge(Q,N,O,z){N<0&&(N=65535+N+1);for(var ee=0,de=Math.min(Q.length-O,2);ee<de;++ee)Q[O+ee]=(N&255<<8*(z?ee:1-ee))>>>8*(z?ee:1-ee)}function tt(Q,N,O,z){N<0&&(N=4294967295+N+1);for(var ee=0,de=Math.min(Q.length-O,4);ee<de;++ee)Q[O+ee]=N>>>8*(z?ee:3-ee)&255}function rn(Q,N,O,z,ee,de){if(O+z>Q.length)throw new RangeError("Index out of range");if(O<0)throw new RangeError("Index out of range")}function St(Q,N,O,z,ee){return ee||rn(Q,0,O,4),a.write(Q,N,O,z,23,4),O+4}function cn(Q,N,O,z,ee){return ee||rn(Q,0,O,8),a.write(Q,N,O,z,52,8),O+8}d.prototype.slice=function(N,O){var z,ee=this.length;if((N=~~N)<0?(N+=ee)<0&&(N=0):N>ee&&(N=ee),(O=O===void 0?ee:~~O)<0?(O+=ee)<0&&(O=0):O>ee&&(O=ee),O<N&&(O=N),d.TYPED_ARRAY_SUPPORT)(z=this.subarray(N,O)).__proto__=d.prototype;else{var de=O-N;z=new d(de,void 0);for(var me=0;me<de;++me)z[me]=this[me+N]}return z},d.prototype.readUIntLE=function(N,O,z){N|=0,O|=0,z||Ee(N,O,this.length);for(var ee=this[N],de=1,me=0;++me<O&&(de*=256);)ee+=this[N+me]*de;return ee},d.prototype.readUIntBE=function(N,O,z){N|=0,O|=0,z||Ee(N,O,this.length);for(var ee=this[N+--O],de=1;O>0&&(de*=256);)ee+=this[N+--O]*de;return ee},d.prototype.readUInt8=function(N,O){return O||Ee(N,1,this.length),this[N]},d.prototype.readUInt16LE=function(N,O){return O||Ee(N,2,this.length),this[N]|this[N+1]<<8},d.prototype.readUInt16BE=function(N,O){return O||Ee(N,2,this.length),this[N]<<8|this[N+1]},d.prototype.readUInt32LE=function(N,O){return O||Ee(N,4,this.length),(this[N]|this[N+1]<<8|this[N+2]<<16)+16777216*this[N+3]},d.prototype.readUInt32BE=function(N,O){return O||Ee(N,4,this.length),16777216*this[N]+(this[N+1]<<16|this[N+2]<<8|this[N+3])},d.prototype.readIntLE=function(N,O,z){N|=0,O|=0,z||Ee(N,O,this.length);for(var ee=this[N],de=1,me=0;++me<O&&(de*=256);)ee+=this[N+me]*de;return ee>=(de*=128)&&(ee-=Math.pow(2,8*O)),ee},d.prototype.readIntBE=function(N,O,z){N|=0,O|=0,z||Ee(N,O,this.length);for(var ee=O,de=1,me=this[N+--ee];ee>0&&(de*=256);)me+=this[N+--ee]*de;return me>=(de*=128)&&(me-=Math.pow(2,8*O)),me},d.prototype.readInt8=function(N,O){return O||Ee(N,1,this.length),128&this[N]?-1*(255-this[N]+1):this[N]},d.prototype.readInt16LE=function(N,O){O||Ee(N,2,this.length);var z=this[N]|this[N+1]<<8;return 32768&z?4294901760|z:z},d.prototype.readInt16BE=function(N,O){O||Ee(N,2,this.length);var z=this[N+1]|this[N]<<8;return 32768&z?4294901760|z:z},d.prototype.readInt32LE=function(N,O){return O||Ee(N,4,this.length),this[N]|this[N+1]<<8|this[N+2]<<16|this[N+3]<<24},d.prototype.readInt32BE=function(N,O){return O||Ee(N,4,this.length),this[N]<<24|this[N+1]<<16|this[N+2]<<8|this[N+3]},d.prototype.readFloatLE=function(N,O){return O||Ee(N,4,this.length),a.read(this,N,!0,23,4)},d.prototype.readFloatBE=function(N,O){return O||Ee(N,4,this.length),a.read(this,N,!1,23,4)},d.prototype.readDoubleLE=function(N,O){return O||Ee(N,8,this.length),a.read(this,N,!0,52,8)},d.prototype.readDoubleBE=function(N,O){return O||Ee(N,8,this.length),a.read(this,N,!1,52,8)},d.prototype.writeUIntLE=function(N,O,z,ee){N=+N,O|=0,z|=0,ee||Ve(this,N,O,z,Math.pow(2,8*z)-1,0);var de=1,me=0;for(this[O]=255&N;++me<z&&(de*=256);)this[O+me]=N/de&255;return O+z},d.prototype.writeUIntBE=function(N,O,z,ee){N=+N,O|=0,z|=0,ee||Ve(this,N,O,z,Math.pow(2,8*z)-1,0);var de=z-1,me=1;for(this[O+de]=255&N;--de>=0&&(me*=256);)this[O+de]=N/me&255;return O+z},d.prototype.writeUInt8=function(N,O,z){return N=+N,O|=0,z||Ve(this,N,O,1,255,0),d.TYPED_ARRAY_SUPPORT||(N=Math.floor(N)),this[O]=255&N,O+1},d.prototype.writeUInt16LE=function(N,O,z){return N=+N,O|=0,z||Ve(this,N,O,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[O]=255&N,this[O+1]=N>>>8):Ge(this,N,O,!0),O+2},d.prototype.writeUInt16BE=function(N,O,z){return N=+N,O|=0,z||Ve(this,N,O,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[O]=N>>>8,this[O+1]=255&N):Ge(this,N,O,!1),O+2},d.prototype.writeUInt32LE=function(N,O,z){return N=+N,O|=0,z||Ve(this,N,O,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[O+3]=N>>>24,this[O+2]=N>>>16,this[O+1]=N>>>8,this[O]=255&N):tt(this,N,O,!0),O+4},d.prototype.writeUInt32BE=function(N,O,z){return N=+N,O|=0,z||Ve(this,N,O,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[O]=N>>>24,this[O+1]=N>>>16,this[O+2]=N>>>8,this[O+3]=255&N):tt(this,N,O,!1),O+4},d.prototype.writeIntLE=function(N,O,z,ee){if(N=+N,O|=0,!ee){var de=Math.pow(2,8*z-1);Ve(this,N,O,z,de-1,-de)}var me=0,Oe=1,nt=0;for(this[O]=255&N;++me<z&&(Oe*=256);)N<0&&nt===0&&this[O+me-1]!==0&&(nt=1),this[O+me]=(N/Oe>>0)-nt&255;return O+z},d.prototype.writeIntBE=function(N,O,z,ee){if(N=+N,O|=0,!ee){var de=Math.pow(2,8*z-1);Ve(this,N,O,z,de-1,-de)}var me=z-1,Oe=1,nt=0;for(this[O+me]=255&N;--me>=0&&(Oe*=256);)N<0&&nt===0&&this[O+me+1]!==0&&(nt=1),this[O+me]=(N/Oe>>0)-nt&255;return O+z},d.prototype.writeInt8=function(N,O,z){return N=+N,O|=0,z||Ve(this,N,O,1,127,-128),d.TYPED_ARRAY_SUPPORT||(N=Math.floor(N)),N<0&&(N=255+N+1),this[O]=255&N,O+1},d.prototype.writeInt16LE=function(N,O,z){return N=+N,O|=0,z||Ve(this,N,O,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[O]=255&N,this[O+1]=N>>>8):Ge(this,N,O,!0),O+2},d.prototype.writeInt16BE=function(N,O,z){return N=+N,O|=0,z||Ve(this,N,O,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[O]=N>>>8,this[O+1]=255&N):Ge(this,N,O,!1),O+2},d.prototype.writeInt32LE=function(N,O,z){return N=+N,O|=0,z||Ve(this,N,O,4,2147483647,-2147483648),d.TYPED_ARRAY_SUPPORT?(this[O]=255&N,this[O+1]=N>>>8,this[O+2]=N>>>16,this[O+3]=N>>>24):tt(this,N,O,!0),O+4},d.prototype.writeInt32BE=function(N,O,z){return N=+N,O|=0,z||Ve(this,N,O,4,2147483647,-2147483648),N<0&&(N=4294967295+N+1),d.TYPED_ARRAY_SUPPORT?(this[O]=N>>>24,this[O+1]=N>>>16,this[O+2]=N>>>8,this[O+3]=255&N):tt(this,N,O,!1),O+4},d.prototype.writeFloatLE=function(N,O,z){return St(this,N,O,!0,z)},d.prototype.writeFloatBE=function(N,O,z){return St(this,N,O,!1,z)},d.prototype.writeDoubleLE=function(N,O,z){return cn(this,N,O,!0,z)},d.prototype.writeDoubleBE=function(N,O,z){return cn(this,N,O,!1,z)},d.prototype.copy=function(N,O,z,ee){if(z||(z=0),ee||ee===0||(ee=this.length),O>=N.length&&(O=N.length),O||(O=0),ee>0&&ee<z&&(ee=z),ee===z||N.length===0||this.length===0)return 0;if(O<0)throw new RangeError("targetStart out of bounds");if(z<0||z>=this.length)throw new RangeError("sourceStart out of bounds");if(ee<0)throw new RangeError("sourceEnd out of bounds");ee>this.length&&(ee=this.length),N.length-O<ee-z&&(ee=N.length-O+z);var de,me=ee-z;if(this===N&&z<O&&O<ee)for(de=me-1;de>=0;--de)N[de+O]=this[de+z];else if(me<1e3||!d.TYPED_ARRAY_SUPPORT)for(de=0;de<me;++de)N[de+O]=this[de+z];else Uint8Array.prototype.set.call(N,this.subarray(z,z+me),O);return me},d.prototype.fill=function(N,O,z,ee){if(typeof N=="string"){if(typeof O=="string"?(ee=O,O=0,z=this.length):typeof z=="string"&&(ee=z,z=this.length),N.length===1){var de=N.charCodeAt(0);de<256&&(N=de)}if(ee!==void 0&&typeof ee!="string")throw new TypeError("encoding must be a string");if(typeof ee=="string"&&!d.isEncoding(ee))throw new TypeError("Unknown encoding: "+ee)}else typeof N=="number"&&(N&=255);if(O<0||this.length<O||this.length<z)throw new RangeError("Out of range index");if(z<=O)return this;var me;if(O>>>=0,z=z===void 0?this.length:z>>>0,N||(N=0),typeof N=="number")for(me=O;me<z;++me)this[me]=N;else{var Oe=d.isBuffer(N)?N:ln(new d(N,ee).toString()),nt=Oe.length;for(me=0;me<z-O;++me)this[me+O]=Oe[me%nt]}return this};var _r=/[^+\/0-9A-Za-z-_]/g;function Fn(Q){return Q<16?"0"+Q.toString(16):Q.toString(16)}function ln(Q,N){var O;N=N||1/0;for(var z=Q.length,ee=null,de=[],me=0;me<z;++me){if((O=Q.charCodeAt(me))>55295&&O<57344){if(!ee){if(O>56319){(N-=3)>-1&&de.push(239,191,189);continue}if(me+1===z){(N-=3)>-1&&de.push(239,191,189);continue}ee=O;continue}if(O<56320){(N-=3)>-1&&de.push(239,191,189),ee=O;continue}O=65536+(ee-55296<<10|O-56320)}else ee&&(N-=3)>-1&&de.push(239,191,189);if(ee=null,O<128){if((N-=1)<0)break;de.push(O)}else if(O<2048){if((N-=2)<0)break;de.push(O>>6|192,63&O|128)}else if(O<65536){if((N-=3)<0)break;de.push(O>>12|224,O>>6&63|128,63&O|128)}else{if(!(O<1114112))throw new Error("Invalid code point");if((N-=4)<0)break;de.push(O>>18|240,O>>12&63|128,O>>6&63|128,63&O|128)}}return de}function vn(Q){return s.toByteArray(function(O){if((O=function(ee){return ee.trim?ee.trim():ee.replace(/^\s+|\s+$/g,"")}(O).replace(_r,"")).length<2)return"";for(;O.length%4!=0;)O+="=";return O}(Q))}function Mt(Q,N,O,z){for(var ee=0;ee<z&&!(ee+O>=N.length||ee>=Q.length);++ee)N[ee+O]=Q[ee];return ee}}).call(this,i(29))},function(n,r){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch{typeof window=="object"&&(i=window)}n.exports=i},function(n,r,i){r.byteLength=function(y){var w=d(y),E=w[0],b=w[1];return 3*(E+b)/4-b},r.toByteArray=function(y){var w,E,b=d(y),S=b[0],R=b[1],F=new a(function(Y,X,$){return 3*(X+$)/4-$}(0,S,R)),M=0,P=R>0?S-4:S;for(E=0;E<P;E+=4)w=s[y.charCodeAt(E)]<<18|s[y.charCodeAt(E+1)]<<12|s[y.charCodeAt(E+2)]<<6|s[y.charCodeAt(E+3)],F[M++]=w>>16&255,F[M++]=w>>8&255,F[M++]=255&w;return R===2&&(w=s[y.charCodeAt(E)]<<2|s[y.charCodeAt(E+1)]>>4,F[M++]=255&w),R===1&&(w=s[y.charCodeAt(E)]<<10|s[y.charCodeAt(E+1)]<<4|s[y.charCodeAt(E+2)]>>2,F[M++]=w>>8&255,F[M++]=255&w),F},r.fromByteArray=function(y){for(var w,E=y.length,b=E%3,S=[],R=16383,F=0,M=E-b;F<M;F+=R)S.push(g(y,F,F+R>M?M:F+R));return b===1?(w=y[E-1],S.push(o[w>>2]+o[w<<4&63]+"==")):b===2&&(w=(y[E-2]<<8)+y[E-1],S.push(o[w>>10]+o[w>>4&63]+o[w<<2&63]+"=")),S.join("")};for(var o=[],s=[],a=typeof Uint8Array!="undefined"?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,u=c.length;l<u;++l)o[l]=c[l],s[c.charCodeAt(l)]=l;function d(p){var y=p.length;if(y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var w=p.indexOf("=");return w===-1&&(w=y),[w,w===y?0:4-w%4]}function g(p,y,w){for(var E,b,S=[],R=y;R<w;R+=3)E=(p[R]<<16&16711680)+(p[R+1]<<8&65280)+(255&p[R+2]),S.push(o[(b=E)>>18&63]+o[b>>12&63]+o[b>>6&63]+o[63&b]);return S.join("")}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},function(n,r){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */r.read=function(i,o,s,a,c){var l,u,d=8*c-a-1,g=(1<<d)-1,p=g>>1,y=-7,w=s?c-1:0,E=s?-1:1,b=i[o+w];for(w+=E,l=b&(1<<-y)-1,b>>=-y,y+=d;y>0;l=256*l+i[o+w],w+=E,y-=8);for(u=l&(1<<-y)-1,l>>=-y,y+=a;y>0;u=256*u+i[o+w],w+=E,y-=8);if(l===0)l=1-p;else{if(l===g)return u?NaN:1/0*(b?-1:1);u+=Math.pow(2,a),l-=p}return(b?-1:1)*u*Math.pow(2,l-a)},r.write=function(i,o,s,a,c,l){var u,d,g,p=8*l-c-1,y=(1<<p)-1,w=y>>1,E=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=a?0:l-1,S=a?1:-1,R=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(d=isNaN(o)?1:0,u=y):(u=Math.floor(Math.log(o)/Math.LN2),o*(g=Math.pow(2,-u))<1&&(u--,g*=2),(o+=u+w>=1?E/g:E*Math.pow(2,1-w))*g>=2&&(u++,g/=2),u+w>=y?(d=0,u=y):u+w>=1?(d=(o*g-1)*Math.pow(2,c),u+=w):(d=o*Math.pow(2,w-1)*Math.pow(2,c),u=0));c>=8;i[s+b]=255&d,b+=S,d/=256,c-=8);for(u=u<<c|d,p+=c;p>0;i[s+b]=255&u,b+=S,u/=256,p-=8);i[s+b-S]|=128*R}},function(n,r){var i={}.toString;n.exports=Array.isArray||function(o){return i.call(o)=="[object Array]"}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(a){var c=a.jws,l=a.KeyUtil,u=a.X509,d=a.crypto,g=a.hextob64u,p=a.b64tohex,y=a.AllowedSigningAlgs;return function(){function w(){(function(b,S){if(!(b instanceof S))throw new TypeError("Cannot call a class as a function")})(this,w)}return w.parseJwt=function(b){o.Log.debug("JoseUtil.parseJwt");try{var S=c.JWS.parse(b);return{header:S.headerObj,payload:S.payloadObj}}catch(R){o.Log.error(R)}},w.validateJwt=function(b,S,R,F,M,P,D){o.Log.debug("JoseUtil.validateJwt");try{if(S.kty==="RSA")if(S.e&&S.n)S=l.getKey(S);else{if(!S.x5c||!S.x5c.length)return o.Log.error("JoseUtil.validateJwt: RSA key missing key material",S),Promise.reject(new Error("RSA key missing key material"));var Y=p(S.x5c[0]);S=u.getPublicKeyFromCertHex(Y)}else{if(S.kty!=="EC")return o.Log.error("JoseUtil.validateJwt: Unsupported key type",S&&S.kty),Promise.reject(new Error(S.kty));if(!(S.crv&&S.x&&S.y))return o.Log.error("JoseUtil.validateJwt: EC key missing key material",S),Promise.reject(new Error("EC key missing key material"));S=l.getKey(S)}return w._validateJwt(b,S,R,F,M,P,D)}catch(X){return o.Log.error(X&&X.message||X),Promise.reject("JWT validation failed")}},w.validateJwtAttributes=function(b,S,R,F,M,P){F||(F=0),M||(M=parseInt(Date.now()/1e3));var D=w.parseJwt(b).payload;if(!D.iss)return o.Log.error("JoseUtil._validateJwt: issuer was not provided"),Promise.reject(new Error("issuer was not provided"));if(D.iss!==S)return o.Log.error("JoseUtil._validateJwt: Invalid issuer in token",D.iss),Promise.reject(new Error("Invalid issuer in token: "+D.iss));if(!D.aud)return o.Log.error("JoseUtil._validateJwt: aud was not provided"),Promise.reject(new Error("aud was not provided"));if(!(D.aud===R||Array.isArray(D.aud)&&D.aud.indexOf(R)>=0))return o.Log.error("JoseUtil._validateJwt: Invalid audience in token",D.aud),Promise.reject(new Error("Invalid audience in token: "+D.aud));if(D.azp&&D.azp!==R)return o.Log.error("JoseUtil._validateJwt: Invalid azp in token",D.azp),Promise.reject(new Error("Invalid azp in token: "+D.azp));if(!P){var Y=M+F,X=M-F;if(!D.iat)return o.Log.error("JoseUtil._validateJwt: iat was not provided"),Promise.reject(new Error("iat was not provided"));if(Y<D.iat)return o.Log.error("JoseUtil._validateJwt: iat is in the future",D.iat),Promise.reject(new Error("iat is in the future: "+D.iat));if(D.nbf&&Y<D.nbf)return o.Log.error("JoseUtil._validateJwt: nbf is in the future",D.nbf),Promise.reject(new Error("nbf is in the future: "+D.nbf));if(!D.exp)return o.Log.error("JoseUtil._validateJwt: exp was not provided"),Promise.reject(new Error("exp was not provided"));if(D.exp<X)return o.Log.error("JoseUtil._validateJwt: exp is in the past",D.exp),Promise.reject(new Error("exp is in the past:"+D.exp))}return Promise.resolve(D)},w._validateJwt=function(b,S,R,F,M,P,D){return w.validateJwtAttributes(b,R,F,M,P,D).then(function(Y){try{return c.JWS.verify(b,S,y)?Y:(o.Log.error("JoseUtil._validateJwt: signature validation failed"),Promise.reject(new Error("signature validation failed")))}catch(X){return o.Log.error(X&&X.message||X),Promise.reject(new Error("signature validation failed"))}})},w.hashString=function(b,S){try{return d.Util.hashString(b,S)}catch(R){o.Log.error(R)}},w.hexToBase64Url=function(b){try{return g(b)}catch(S){o.Log.error(S)}},w}()};var o=i(0);n.exports=r.default},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.SigninResponse=void 0;var o=function(){function c(l,u){for(var d=0;d<u.length;d++){var g=u[d];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(l,g.key,g)}}return function(l,u,d){return u&&c(l.prototype,u),d&&c(l,d),l}}(),s=i(3);function a(c,l){if(!(c instanceof l))throw new TypeError("Cannot call a class as a function")}r.SigninResponse=function(){function c(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#";a(this,c);var d=s.UrlUtility.parseUrlFragment(l,u);this.error=d.error,this.error_description=d.error_description,this.error_uri=d.error_uri,this.code=d.code,this.state=d.state,this.id_token=d.id_token,this.session_state=d.session_state,this.access_token=d.access_token,this.token_type=d.token_type,this.scope=d.scope,this.profile=void 0,this.expires_in=d.expires_in}return o(c,[{key:"expires_in",get:function(){if(this.expires_at){var u=parseInt(Date.now()/1e3);return this.expires_at-u}},set:function(u){var d=parseInt(u);if(typeof d=="number"&&d>0){var g=parseInt(Date.now()/1e3);this.expires_at=g+d}}},{key:"expired",get:function(){var u=this.expires_in;if(u!==void 0)return u<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}},{key:"isOpenIdConnect",get:function(){return this.scopes.indexOf("openid")>=0||!!this.id_token}}]),c}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.SignoutRequest=void 0;var o=i(0),s=i(3),a=i(9);r.SignoutRequest=function c(l){var u=l.url,d=l.id_token_hint,g=l.post_logout_redirect_uri,p=l.data,y=l.extraQueryParams,w=l.request_type;if(function(S,R){if(!(S instanceof R))throw new TypeError("Cannot call a class as a function")}(this,c),!u)throw o.Log.error("SignoutRequest.ctor: No url passed"),new Error("url");for(var E in d&&(u=s.UrlUtility.addQueryParam(u,"id_token_hint",d)),g&&(u=s.UrlUtility.addQueryParam(u,"post_logout_redirect_uri",g),p&&(this.state=new a.State({data:p,request_type:w}),u=s.UrlUtility.addQueryParam(u,"state",this.state.id))),y)u=s.UrlUtility.addQueryParam(u,E,y[E]);this.url=u}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.SignoutResponse=void 0;var o=i(3);r.SignoutResponse=function s(a){(function(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")})(this,s);var c=o.UrlUtility.parseUrlFragment(a,"?");this.error=c.error,this.error_description=c.error_description,this.error_uri=c.error_uri,this.state=c.state}},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.InMemoryWebStorage=void 0;var o=function(){function a(c,l){for(var u=0;u<l.length;u++){var d=l[u];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}return function(c,l,u){return l&&a(c.prototype,l),u&&a(c,u),c}}(),s=i(0);r.InMemoryWebStorage=function(){function a(){(function(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")})(this,a),this._data={}}return a.prototype.getItem=function(l){return s.Log.debug("InMemoryWebStorage.getItem",l),this._data[l]},a.prototype.setItem=function(l,u){s.Log.debug("InMemoryWebStorage.setItem",l),this._data[l]=u},a.prototype.removeItem=function(l){s.Log.debug("InMemoryWebStorage.removeItem",l),delete this._data[l]},a.prototype.key=function(l){return Object.getOwnPropertyNames(this._data)[l]},o(a,[{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}}]),a}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.UserManager=void 0;var o=function(){function R(F,M){for(var P=0;P<M.length;P++){var D=M[P];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(F,D.key,D)}}return function(F,M,P){return M&&R(F.prototype,M),P&&R(F,P),F}}(),s=i(0),a=i(10),c=i(39),l=i(15),u=i(45),d=i(47),g=i(18),p=i(8),y=i(20),w=i(11),E=i(4);function b(R,F){if(!(R instanceof F))throw new TypeError("Cannot call a class as a function")}function S(R,F){if(!R)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!F||typeof F!="object"&&typeof F!="function"?R:F}r.UserManager=function(R){function F(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d.SilentRenewService,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g.SessionMonitor,Y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:y.TokenRevocationClient,X=arguments.length>4&&arguments[4]!==void 0?arguments[4]:w.TokenClient,$=arguments.length>5&&arguments[5]!==void 0?arguments[5]:E.JoseUtil;b(this,F),M instanceof c.UserManagerSettings||(M=new c.UserManagerSettings(M));var te=S(this,R.call(this,M));return te._events=new u.UserManagerEvents(M),te._silentRenewService=new P(te),te.settings.automaticSilentRenew&&(s.Log.debug("UserManager.ctor: automaticSilentRenew is configured, setting up silent renew"),te.startSilentRenew()),te.settings.monitorSession&&(s.Log.debug("UserManager.ctor: monitorSession is configured, setting up session monitor"),te._sessionMonitor=new D(te)),te._tokenRevocationClient=new Y(te._settings),te._tokenClient=new X(te._settings),te._joseUtil=$,te}return function(P,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof D);P.prototype=Object.create(D&&D.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),D&&(Object.setPrototypeOf?Object.setPrototypeOf(P,D):P.__proto__=D)}(F,R),F.prototype.getUser=function(){var P=this;return this._loadUser().then(function(D){return D?(s.Log.info("UserManager.getUser: user loaded"),P._events.load(D,!1),D):(s.Log.info("UserManager.getUser: user not found in storage"),null)})},F.prototype.removeUser=function(){var P=this;return this.storeUser(null).then(function(){s.Log.info("UserManager.removeUser: user removed from storage"),P._events.unload()})},F.prototype.signinRedirect=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(P=Object.assign({},P)).request_type="si:r";var D={useReplaceToNavigate:P.useReplaceToNavigate};return this._signinStart(P,this._redirectNavigator,D).then(function(){s.Log.info("UserManager.signinRedirect: successful")})},F.prototype.signinRedirectCallback=function(P){return this._signinEnd(P||this._redirectNavigator.url).then(function(D){return D.profile&&D.profile.sub?s.Log.info("UserManager.signinRedirectCallback: successful, signed in sub: ",D.profile.sub):s.Log.info("UserManager.signinRedirectCallback: no sub"),D})},F.prototype.signinPopup=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(P=Object.assign({},P)).request_type="si:p";var D=P.redirect_uri||this.settings.popup_redirect_uri||this.settings.redirect_uri;return D?(P.redirect_uri=D,P.display="popup",this._signin(P,this._popupNavigator,{startUrl:D,popupWindowFeatures:P.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:P.popupWindowTarget||this.settings.popupWindowTarget}).then(function(Y){return Y&&(Y.profile&&Y.profile.sub?s.Log.info("UserManager.signinPopup: signinPopup successful, signed in sub: ",Y.profile.sub):s.Log.info("UserManager.signinPopup: no sub")),Y})):(s.Log.error("UserManager.signinPopup: No popup_redirect_uri or redirect_uri configured"),Promise.reject(new Error("No popup_redirect_uri or redirect_uri configured")))},F.prototype.signinPopupCallback=function(P){return this._signinCallback(P,this._popupNavigator).then(function(D){return D&&(D.profile&&D.profile.sub?s.Log.info("UserManager.signinPopupCallback: successful, signed in sub: ",D.profile.sub):s.Log.info("UserManager.signinPopupCallback: no sub")),D}).catch(function(D){s.Log.error(D.message)})},F.prototype.signinSilent=function(){var P=this,D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return D=Object.assign({},D),this._loadUser().then(function(Y){return Y&&Y.refresh_token?(D.refresh_token=Y.refresh_token,P._useRefreshToken(D)):(D.request_type="si:s",D.id_token_hint=D.id_token_hint||P.settings.includeIdTokenInSilentRenew&&Y&&Y.id_token,Y&&P._settings.validateSubOnSilentRenew&&(s.Log.debug("UserManager.signinSilent, subject prior to silent renew: ",Y.profile.sub),D.current_sub=Y.profile.sub),P._signinSilentIframe(D))})},F.prototype._useRefreshToken=function(){var P=this,D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._tokenClient.exchangeRefreshToken(D).then(function(Y){return Y?Y.access_token?P._loadUser().then(function(X){if(X){var $=Promise.resolve();return Y.id_token&&($=P._validateIdTokenFromTokenRefreshToken(X.profile,Y.id_token)),$.then(function(){return s.Log.debug("UserManager._useRefreshToken: refresh token response success"),X.id_token=Y.id_token||X.id_token,X.access_token=Y.access_token,X.refresh_token=Y.refresh_token||X.refresh_token,X.expires_in=Y.expires_in,P.storeUser(X).then(function(){return P._events.load(X),X})})}return null}):(s.Log.error("UserManager._useRefreshToken: No access token returned from token endpoint"),Promise.reject("No access token returned from token endpoint")):(s.Log.error("UserManager._useRefreshToken: No response returned from token endpoint"),Promise.reject("No response returned from token endpoint"))})},F.prototype._validateIdTokenFromTokenRefreshToken=function(P,D){var Y=this;return this._metadataService.getIssuer().then(function(X){return Y.settings.getEpochTime().then(function($){return Y._joseUtil.validateJwtAttributes(D,X,Y._settings.client_id,Y._settings.clockSkew,$).then(function(te){return te?te.sub!==P.sub?(s.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: sub in id_token does not match current sub"),Promise.reject(new Error("sub in id_token does not match current sub"))):te.auth_time&&te.auth_time!==P.auth_time?(s.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: auth_time in id_token does not match original auth_time"),Promise.reject(new Error("auth_time in id_token does not match original auth_time"))):te.azp&&te.azp!==P.azp?(s.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp in id_token does not match original azp"),Promise.reject(new Error("azp in id_token does not match original azp"))):!te.azp&&P.azp?(s.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp not in id_token, but present in original id_token"),Promise.reject(new Error("azp not in id_token, but present in original id_token"))):void 0:(s.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: Failed to validate id_token"),Promise.reject(new Error("Failed to validate id_token")))})})})},F.prototype._signinSilentIframe=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},D=P.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return D?(P.redirect_uri=D,P.prompt=P.prompt||"none",this._signin(P,this._iframeNavigator,{startUrl:D,silentRequestTimeout:P.silentRequestTimeout||this.settings.silentRequestTimeout}).then(function(Y){return Y&&(Y.profile&&Y.profile.sub?s.Log.info("UserManager.signinSilent: successful, signed in sub: ",Y.profile.sub):s.Log.info("UserManager.signinSilent: no sub")),Y})):(s.Log.error("UserManager.signinSilent: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},F.prototype.signinSilentCallback=function(P){return this._signinCallback(P,this._iframeNavigator).then(function(D){return D&&(D.profile&&D.profile.sub?s.Log.info("UserManager.signinSilentCallback: successful, signed in sub: ",D.profile.sub):s.Log.info("UserManager.signinSilentCallback: no sub")),D})},F.prototype.signinCallback=function(P){var D=this;return this.readSigninResponseState(P).then(function(Y){var X=Y.state;return Y.response,X.request_type==="si:r"?D.signinRedirectCallback(P):X.request_type==="si:p"?D.signinPopupCallback(P):X.request_type==="si:s"?D.signinSilentCallback(P):Promise.reject(new Error("invalid response_type in state"))})},F.prototype.signoutCallback=function(P,D){var Y=this;return this.readSignoutResponseState(P).then(function(X){var $=X.state,te=X.response;return $?$.request_type==="so:r"?Y.signoutRedirectCallback(P):$.request_type==="so:p"?Y.signoutPopupCallback(P,D):Promise.reject(new Error("invalid response_type in state")):te})},F.prototype.querySessionStatus=function(){var P=this,D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(D=Object.assign({},D)).request_type="si:s";var Y=D.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return Y?(D.redirect_uri=Y,D.prompt="none",D.response_type=D.response_type||this.settings.query_status_response_type,D.scope=D.scope||"openid",D.skipUserInfo=!0,this._signinStart(D,this._iframeNavigator,{startUrl:Y,silentRequestTimeout:D.silentRequestTimeout||this.settings.silentRequestTimeout}).then(function(X){return P.processSigninResponse(X.url).then(function($){if(s.Log.debug("UserManager.querySessionStatus: got signin response"),$.session_state&&$.profile.sub)return s.Log.info("UserManager.querySessionStatus: querySessionStatus success for sub: ",$.profile.sub),{session_state:$.session_state,sub:$.profile.sub,sid:$.profile.sid};s.Log.info("querySessionStatus successful, user not authenticated")}).catch(function($){if($.session_state&&P.settings.monitorAnonymousSession&&($.message=="login_required"||$.message=="consent_required"||$.message=="interaction_required"||$.message=="account_selection_required"))return s.Log.info("UserManager.querySessionStatus: querySessionStatus success for anonymous user"),{session_state:$.session_state};throw $})})):(s.Log.error("UserManager.querySessionStatus: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},F.prototype._signin=function(P,D){var Y=this,X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._signinStart(P,D,X).then(function($){return Y._signinEnd($.url,P)})},F.prototype._signinStart=function(P,D){var Y=this,X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return D.prepare(X).then(function($){return s.Log.debug("UserManager._signinStart: got navigator window handle"),Y.createSigninRequest(P).then(function(te){return s.Log.debug("UserManager._signinStart: got signin request"),X.url=te.url,X.id=te.state.id,$.navigate(X)}).catch(function(te){throw $.close&&(s.Log.debug("UserManager._signinStart: Error after preparing navigator, closing navigator window"),$.close()),te})})},F.prototype._signinEnd=function(P){var D=this,Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.processSigninResponse(P).then(function(X){s.Log.debug("UserManager._signinEnd: got signin response");var $=new l.User(X);if(Y.current_sub){if(Y.current_sub!==$.profile.sub)return s.Log.debug("UserManager._signinEnd: current user does not match user returned from signin. sub from signin: ",$.profile.sub),Promise.reject(new Error("login_required"));s.Log.debug("UserManager._signinEnd: current user matches user returned from signin")}return D.storeUser($).then(function(){return s.Log.debug("UserManager._signinEnd: user stored"),D._events.load($),$})})},F.prototype._signinCallback=function(P,D){s.Log.debug("UserManager._signinCallback");var Y=this._settings.response_mode==="query"||!this._settings.response_mode&&p.SigninRequest.isCode(this._settings.response_type)?"?":"#";return D.callback(P,void 0,Y)},F.prototype.signoutRedirect=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(P=Object.assign({},P)).request_type="so:r";var D=P.post_logout_redirect_uri||this.settings.post_logout_redirect_uri;D&&(P.post_logout_redirect_uri=D);var Y={useReplaceToNavigate:P.useReplaceToNavigate};return this._signoutStart(P,this._redirectNavigator,Y).then(function(){s.Log.info("UserManager.signoutRedirect: successful")})},F.prototype.signoutRedirectCallback=function(P){return this._signoutEnd(P||this._redirectNavigator.url).then(function(D){return s.Log.info("UserManager.signoutRedirectCallback: successful"),D})},F.prototype.signoutPopup=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(P=Object.assign({},P)).request_type="so:p";var D=P.post_logout_redirect_uri||this.settings.popup_post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return P.post_logout_redirect_uri=D,P.display="popup",P.post_logout_redirect_uri&&(P.state=P.state||{}),this._signout(P,this._popupNavigator,{startUrl:D,popupWindowFeatures:P.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:P.popupWindowTarget||this.settings.popupWindowTarget}).then(function(){s.Log.info("UserManager.signoutPopup: successful")})},F.prototype.signoutPopupCallback=function(P,D){return D===void 0&&typeof P=="boolean"&&(D=P,P=null),this._popupNavigator.callback(P,D,"?").then(function(){s.Log.info("UserManager.signoutPopupCallback: successful")})},F.prototype._signout=function(P,D){var Y=this,X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._signoutStart(P,D,X).then(function($){return Y._signoutEnd($.url)})},F.prototype._signoutStart=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},D=this,Y=arguments[1],X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Y.prepare(X).then(function($){return s.Log.debug("UserManager._signoutStart: got navigator window handle"),D._loadUser().then(function(te){return s.Log.debug("UserManager._signoutStart: loaded current user from storage"),(D._settings.revokeAccessTokenOnSignout?D._revokeInternal(te):Promise.resolve()).then(function(){var _e=P.id_token_hint||te&&te.id_token;return _e&&(s.Log.debug("UserManager._signoutStart: Setting id_token into signout request"),P.id_token_hint=_e),D.removeUser().then(function(){return s.Log.debug("UserManager._signoutStart: user removed, creating signout request"),D.createSignoutRequest(P).then(function(Ae){return s.Log.debug("UserManager._signoutStart: got signout request"),X.url=Ae.url,Ae.state&&(X.id=Ae.state.id),$.navigate(X)})})})}).catch(function(te){throw $.close&&(s.Log.debug("UserManager._signoutStart: Error after preparing navigator, closing navigator window"),$.close()),te})})},F.prototype._signoutEnd=function(P){return this.processSignoutResponse(P).then(function(D){return s.Log.debug("UserManager._signoutEnd: got signout response"),D})},F.prototype.revokeAccessToken=function(){var P=this;return this._loadUser().then(function(D){return P._revokeInternal(D,!0).then(function(Y){if(Y)return s.Log.debug("UserManager.revokeAccessToken: removing token properties from user and re-storing"),D.access_token=null,D.refresh_token=null,D.expires_at=null,D.token_type=null,P.storeUser(D).then(function(){s.Log.debug("UserManager.revokeAccessToken: user stored"),P._events.load(D)})})}).then(function(){s.Log.info("UserManager.revokeAccessToken: access token revoked successfully")})},F.prototype._revokeInternal=function(P,D){var Y=this;if(P){var X=P.access_token,$=P.refresh_token;return this._revokeAccessTokenInternal(X,D).then(function(te){return Y._revokeRefreshTokenInternal($,D).then(function(_e){return te||_e||s.Log.debug("UserManager.revokeAccessToken: no need to revoke due to no token(s), or JWT format"),te||_e})})}return Promise.resolve(!1)},F.prototype._revokeAccessTokenInternal=function(P,D){return!P||P.indexOf(".")>=0?Promise.resolve(!1):this._tokenRevocationClient.revoke(P,D).then(function(){return!0})},F.prototype._revokeRefreshTokenInternal=function(P,D){return P?this._tokenRevocationClient.revoke(P,D,"refresh_token").then(function(){return!0}):Promise.resolve(!1)},F.prototype.startSilentRenew=function(){this._silentRenewService.start()},F.prototype.stopSilentRenew=function(){this._silentRenewService.stop()},F.prototype._loadUser=function(){return this._userStore.get(this._userStoreKey).then(function(P){return P?(s.Log.debug("UserManager._loadUser: user storageString loaded"),l.User.fromStorageString(P)):(s.Log.debug("UserManager._loadUser: no user storageString"),null)})},F.prototype.storeUser=function(P){if(P){s.Log.debug("UserManager.storeUser: storing user");var D=P.toStorageString();return this._userStore.set(this._userStoreKey,D)}return s.Log.debug("storeUser.storeUser: removing user"),this._userStore.remove(this._userStoreKey)},o(F,[{key:"_redirectNavigator",get:function(){return this.settings.redirectNavigator}},{key:"_popupNavigator",get:function(){return this.settings.popupNavigator}},{key:"_iframeNavigator",get:function(){return this.settings.iframeNavigator}},{key:"_userStore",get:function(){return this.settings.userStore}},{key:"events",get:function(){return this._events}},{key:"_userStoreKey",get:function(){return"user:"+this.settings.authority+":"+this.settings.client_id}}]),F}(a.OidcClient)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.UserManagerSettings=void 0;var o=function(){function w(E,b){for(var S=0;S<b.length;S++){var R=b[S];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(E,R.key,R)}}return function(E,b,S){return b&&w(E.prototype,b),S&&w(E,S),E}}(),s=(i(0),i(5)),a=i(40),c=i(41),l=i(43),u=i(6),d=i(1),g=i(8);function p(w,E){if(!(w instanceof E))throw new TypeError("Cannot call a class as a function")}function y(w,E){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!E||typeof E!="object"&&typeof E!="function"?w:E}r.UserManagerSettings=function(w){function E(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=b.popup_redirect_uri,R=b.popup_post_logout_redirect_uri,F=b.popupWindowFeatures,M=b.popupWindowTarget,P=b.silent_redirect_uri,D=b.silentRequestTimeout,Y=b.automaticSilentRenew,X=Y!==void 0&&Y,$=b.validateSubOnSilentRenew,te=$!==void 0&&$,_e=b.includeIdTokenInSilentRenew,Ae=_e===void 0||_e,re=b.monitorSession,se=re===void 0||re,we=b.monitorAnonymousSession,Ce=we!==void 0&&we,Ze=b.checkSessionInterval,Ee=Ze===void 0?2e3:Ze,Ve=b.stopCheckSessionOnError,Ge=Ve===void 0||Ve,tt=b.query_status_response_type,rn=b.revokeAccessTokenOnSignout,St=rn!==void 0&&rn,cn=b.accessTokenExpiringNotificationTime,_r=cn===void 0?60:cn,Fn=b.redirectNavigator,ln=Fn===void 0?new a.RedirectNavigator:Fn,vn=b.popupNavigator,Mt=vn===void 0?new c.PopupNavigator:vn,Q=b.iframeNavigator,N=Q===void 0?new l.IFrameNavigator:Q,O=b.userStore,z=O===void 0?new u.WebStorageStateStore({store:d.Global.sessionStorage}):O;p(this,E);var ee=y(this,w.call(this,arguments[0]));return ee._popup_redirect_uri=S,ee._popup_post_logout_redirect_uri=R,ee._popupWindowFeatures=F,ee._popupWindowTarget=M,ee._silent_redirect_uri=P,ee._silentRequestTimeout=D,ee._automaticSilentRenew=X,ee._validateSubOnSilentRenew=te,ee._includeIdTokenInSilentRenew=Ae,ee._accessTokenExpiringNotificationTime=_r,ee._monitorSession=se,ee._monitorAnonymousSession=Ce,ee._checkSessionInterval=Ee,ee._stopCheckSessionOnError=Ge,tt?ee._query_status_response_type=tt:arguments[0]&&arguments[0].response_type?ee._query_status_response_type=g.SigninRequest.isOidc(arguments[0].response_type)?"id_token":"code":ee._query_status_response_type="id_token",ee._revokeAccessTokenOnSignout=St,ee._redirectNavigator=ln,ee._popupNavigator=Mt,ee._iframeNavigator=N,ee._userStore=z,ee}return function(S,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof R);S.prototype=Object.create(R&&R.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(S,R):S.__proto__=R)}(E,w),o(E,[{key:"popup_redirect_uri",get:function(){return this._popup_redirect_uri}},{key:"popup_post_logout_redirect_uri",get:function(){return this._popup_post_logout_redirect_uri}},{key:"popupWindowFeatures",get:function(){return this._popupWindowFeatures}},{key:"popupWindowTarget",get:function(){return this._popupWindowTarget}},{key:"silent_redirect_uri",get:function(){return this._silent_redirect_uri}},{key:"silentRequestTimeout",get:function(){return this._silentRequestTimeout}},{key:"automaticSilentRenew",get:function(){return this._automaticSilentRenew}},{key:"validateSubOnSilentRenew",get:function(){return this._validateSubOnSilentRenew}},{key:"includeIdTokenInSilentRenew",get:function(){return this._includeIdTokenInSilentRenew}},{key:"accessTokenExpiringNotificationTime",get:function(){return this._accessTokenExpiringNotificationTime}},{key:"monitorSession",get:function(){return this._monitorSession}},{key:"monitorAnonymousSession",get:function(){return this._monitorAnonymousSession}},{key:"checkSessionInterval",get:function(){return this._checkSessionInterval}},{key:"stopCheckSessionOnError",get:function(){return this._stopCheckSessionOnError}},{key:"query_status_response_type",get:function(){return this._query_status_response_type}},{key:"revokeAccessTokenOnSignout",get:function(){return this._revokeAccessTokenOnSignout}},{key:"redirectNavigator",get:function(){return this._redirectNavigator}},{key:"popupNavigator",get:function(){return this._popupNavigator}},{key:"iframeNavigator",get:function(){return this._iframeNavigator}},{key:"userStore",get:function(){return this._userStore}}]),E}(s.OidcClientSettings)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.RedirectNavigator=void 0;var o=function(){function a(c,l){for(var u=0;u<l.length;u++){var d=l[u];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}return function(c,l,u){return l&&a(c.prototype,l),u&&a(c,u),c}}(),s=i(0);r.RedirectNavigator=function(){function a(){(function(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")})(this,a)}return a.prototype.prepare=function(){return Promise.resolve(this)},a.prototype.navigate=function(l){return l&&l.url?(l.useReplaceToNavigate?window.location.replace(l.url):window.location=l.url,Promise.resolve()):(s.Log.error("RedirectNavigator.navigate: No url provided"),Promise.reject(new Error("No url provided")))},o(a,[{key:"url",get:function(){return window.location.href}}]),a}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.PopupNavigator=void 0;var o=i(0),s=i(42);r.PopupNavigator=function(){function a(){(function(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")})(this,a)}return a.prototype.prepare=function(l){var u=new s.PopupWindow(l);return Promise.resolve(u)},a.prototype.callback=function(l,u,d){o.Log.debug("PopupNavigator.callback");try{return s.PopupWindow.notifyOpener(l,u,d),Promise.resolve()}catch(g){return Promise.reject(g)}},a}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.PopupWindow=void 0;var o=function(){function c(l,u){for(var d=0;d<u.length;d++){var g=u[d];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(l,g.key,g)}}return function(l,u,d){return u&&c(l.prototype,u),d&&c(l,d),l}}(),s=i(0),a=i(3);r.PopupWindow=function(){function c(l){var u=this;(function(y,w){if(!(y instanceof w))throw new TypeError("Cannot call a class as a function")})(this,c),this._promise=new Promise(function(p,y){u._resolve=p,u._reject=y});var d=l.popupWindowTarget||"_blank",g=l.popupWindowFeatures||"location=no,toolbar=no,width=500,height=500,left=100,top=100;";this._popup=window.open("",d,g),this._popup&&(s.Log.debug("PopupWindow.ctor: popup successfully created"),this._checkForPopupClosedTimer=window.setInterval(this._checkForPopupClosed.bind(this),500))}return c.prototype.navigate=function(u){return this._popup?u&&u.url?(s.Log.debug("PopupWindow.navigate: Setting URL in popup"),this._id=u.id,this._id&&(window["popupCallback_"+u.id]=this._callback.bind(this)),this._popup.focus(),this._popup.window.location=u.url):(this._error("PopupWindow.navigate: no url provided"),this._error("No url provided")):this._error("PopupWindow.navigate: Error opening popup window"),this.promise},c.prototype._success=function(u){s.Log.debug("PopupWindow.callback: Successful response from popup window"),this._cleanup(),this._resolve(u)},c.prototype._error=function(u){s.Log.error("PopupWindow.error: ",u),this._cleanup(),this._reject(new Error(u))},c.prototype.close=function(){this._cleanup(!1)},c.prototype._cleanup=function(u){s.Log.debug("PopupWindow.cleanup"),window.clearInterval(this._checkForPopupClosedTimer),this._checkForPopupClosedTimer=null,delete window["popupCallback_"+this._id],this._popup&&!u&&this._popup.close(),this._popup=null},c.prototype._checkForPopupClosed=function(){this._popup&&!this._popup.closed||this._error("Popup window closed")},c.prototype._callback=function(u,d){this._cleanup(d),u?(s.Log.debug("PopupWindow.callback success"),this._success({url:u})):(s.Log.debug("PopupWindow.callback: Invalid response from popup"),this._error("Invalid response from popup"))},c.notifyOpener=function(u,d,g){if(window.opener){if(u=u||window.location.href){var p=a.UrlUtility.parseUrlFragment(u,g);if(p.state){var y="popupCallback_"+p.state,w=window.opener[y];w?(s.Log.debug("PopupWindow.notifyOpener: passing url message to opener"),w(u,d)):s.Log.warn("PopupWindow.notifyOpener: no matching callback found on opener")}else s.Log.warn("PopupWindow.notifyOpener: no state found in response url")}}else s.Log.warn("PopupWindow.notifyOpener: no window.opener. Can't complete notification.")},o(c,[{key:"promise",get:function(){return this._promise}}]),c}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.IFrameNavigator=void 0;var o=i(0),s=i(44);r.IFrameNavigator=function(){function a(){(function(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")})(this,a)}return a.prototype.prepare=function(l){var u=new s.IFrameWindow(l);return Promise.resolve(u)},a.prototype.callback=function(l){o.Log.debug("IFrameNavigator.callback");try{return s.IFrameWindow.notifyParent(l),Promise.resolve()}catch(u){return Promise.reject(u)}},a}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.IFrameWindow=void 0;var o=function(){function a(c,l){for(var u=0;u<l.length;u++){var d=l[u];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}return function(c,l,u){return l&&a(c.prototype,l),u&&a(c,u),c}}(),s=i(0);r.IFrameWindow=function(){function a(c){var l=this;(function(d,g){if(!(d instanceof g))throw new TypeError("Cannot call a class as a function")})(this,a),this._promise=new Promise(function(u,d){l._resolve=u,l._reject=d}),this._boundMessageEvent=this._message.bind(this),window.addEventListener("message",this._boundMessageEvent,!1),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.width=0,this._frame.height=0,window.document.body.appendChild(this._frame)}return a.prototype.navigate=function(l){if(l&&l.url){var u=l.silentRequestTimeout||1e4;s.Log.debug("IFrameWindow.navigate: Using timeout of:",u),this._timer=window.setTimeout(this._timeout.bind(this),u),this._frame.src=l.url}else this._error("No url provided");return this.promise},a.prototype._success=function(l){this._cleanup(),s.Log.debug("IFrameWindow: Successful response from frame window"),this._resolve(l)},a.prototype._error=function(l){this._cleanup(),s.Log.error(l),this._reject(new Error(l))},a.prototype.close=function(){this._cleanup()},a.prototype._cleanup=function(){this._frame&&(s.Log.debug("IFrameWindow: cleanup"),window.removeEventListener("message",this._boundMessageEvent,!1),window.clearTimeout(this._timer),window.document.body.removeChild(this._frame),this._timer=null,this._frame=null,this._boundMessageEvent=null)},a.prototype._timeout=function(){s.Log.debug("IFrameWindow.timeout"),this._error("Frame window timed out")},a.prototype._message=function(l){if(s.Log.debug("IFrameWindow.message"),this._timer&&l.origin===this._origin&&l.source===this._frame.contentWindow&&typeof l.data=="string"&&(l.data.startsWith("http://")||l.data.startsWith("https://"))){var u=l.data;u?this._success({url:u}):this._error("Invalid response from frame")}},a.notifyParent=function(l){s.Log.debug("IFrameWindow.notifyParent"),(l=l||window.location.href)&&(s.Log.debug("IFrameWindow.notifyParent: posting url message to parent"),window.parent.postMessage(l,location.protocol+"//"+location.host))},o(a,[{key:"promise",get:function(){return this._promise}},{key:"_origin",get:function(){return location.protocol+"//"+location.host}}]),a}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.UserManagerEvents=void 0;var o=i(0),s=i(16),a=i(17);r.UserManagerEvents=function(c){function l(u){(function(p,y){if(!(p instanceof y))throw new TypeError("Cannot call a class as a function")})(this,l);var d=function(p,y){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!y||typeof y!="object"&&typeof y!="function"?p:y}(this,c.call(this,u));return d._userLoaded=new a.Event("User loaded"),d._userUnloaded=new a.Event("User unloaded"),d._silentRenewError=new a.Event("Silent renew error"),d._userSignedIn=new a.Event("User signed in"),d._userSignedOut=new a.Event("User signed out"),d._userSessionChanged=new a.Event("User session changed"),d}return function(d,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);d.prototype=Object.create(g&&g.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(d,g):d.__proto__=g)}(l,c),l.prototype.load=function(d){var g=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];o.Log.debug("UserManagerEvents.load"),c.prototype.load.call(this,d),g&&this._userLoaded.raise(d)},l.prototype.unload=function(){o.Log.debug("UserManagerEvents.unload"),c.prototype.unload.call(this),this._userUnloaded.raise()},l.prototype.addUserLoaded=function(d){this._userLoaded.addHandler(d)},l.prototype.removeUserLoaded=function(d){this._userLoaded.removeHandler(d)},l.prototype.addUserUnloaded=function(d){this._userUnloaded.addHandler(d)},l.prototype.removeUserUnloaded=function(d){this._userUnloaded.removeHandler(d)},l.prototype.addSilentRenewError=function(d){this._silentRenewError.addHandler(d)},l.prototype.removeSilentRenewError=function(d){this._silentRenewError.removeHandler(d)},l.prototype._raiseSilentRenewError=function(d){o.Log.debug("UserManagerEvents._raiseSilentRenewError",d.message),this._silentRenewError.raise(d)},l.prototype.addUserSignedIn=function(d){this._userSignedIn.addHandler(d)},l.prototype.removeUserSignedIn=function(d){this._userSignedIn.removeHandler(d)},l.prototype._raiseUserSignedIn=function(){o.Log.debug("UserManagerEvents._raiseUserSignedIn"),this._userSignedIn.raise()},l.prototype.addUserSignedOut=function(d){this._userSignedOut.addHandler(d)},l.prototype.removeUserSignedOut=function(d){this._userSignedOut.removeHandler(d)},l.prototype._raiseUserSignedOut=function(){o.Log.debug("UserManagerEvents._raiseUserSignedOut"),this._userSignedOut.raise()},l.prototype.addUserSessionChanged=function(d){this._userSessionChanged.addHandler(d)},l.prototype.removeUserSessionChanged=function(d){this._userSessionChanged.removeHandler(d)},l.prototype._raiseUserSessionChanged=function(){o.Log.debug("UserManagerEvents._raiseUserSessionChanged"),this._userSessionChanged.raise()},l}(s.AccessTokenEvents)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.Timer=void 0;var o=function(){function d(g,p){for(var y=0;y<p.length;y++){var w=p[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(g,w.key,w)}}return function(g,p,y){return p&&d(g.prototype,p),y&&d(g,y),g}}(),s=i(0),a=i(1),c=i(17);function l(d,g){if(!(d instanceof g))throw new TypeError("Cannot call a class as a function")}function u(d,g){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!g||typeof g!="object"&&typeof g!="function"?d:g}r.Timer=function(d){function g(p){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a.Global.timer,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;l(this,g);var E=u(this,d.call(this,p));return E._timer=y,E._nowFunc=w||function(){return Date.now()/1e3},E}return function(y,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);y.prototype=Object.create(w&&w.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(y,w):y.__proto__=w)}(g,d),g.prototype.init=function(y){y<=0&&(y=1),y=parseInt(y);var w=this.now+y;if(this.expiration===w&&this._timerHandle)s.Log.debug("Timer.init timer "+this._name+" skipping initialization since already initialized for expiration:",this.expiration);else{this.cancel(),s.Log.debug("Timer.init timer "+this._name+" for duration:",y),this._expiration=w;var E=5;y<E&&(E=y),this._timerHandle=this._timer.setInterval(this._callback.bind(this),1e3*E)}},g.prototype.cancel=function(){this._timerHandle&&(s.Log.debug("Timer.cancel: ",this._name),this._timer.clearInterval(this._timerHandle),this._timerHandle=null)},g.prototype._callback=function(){var y=this._expiration-this.now;s.Log.debug("Timer.callback; "+this._name+" timer expires in:",y),this._expiration<=this.now&&(this.cancel(),d.prototype.raise.call(this))},o(g,[{key:"now",get:function(){return parseInt(this._nowFunc())}},{key:"expiration",get:function(){return this._expiration}}]),g}(c.Event)},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.SilentRenewService=void 0;var o=i(0);r.SilentRenewService=function(){function s(a){(function(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")})(this,s),this._userManager=a}return s.prototype.start=function(){this._callback||(this._callback=this._tokenExpiring.bind(this),this._userManager.events.addAccessTokenExpiring(this._callback),this._userManager.getUser().then(function(c){}).catch(function(c){o.Log.error("SilentRenewService.start: Error from getUser:",c.message)}))},s.prototype.stop=function(){this._callback&&(this._userManager.events.removeAccessTokenExpiring(this._callback),delete this._callback)},s.prototype._tokenExpiring=function(){var c=this;this._userManager.signinSilent().then(function(l){o.Log.debug("SilentRenewService._tokenExpiring: Silent token renewal successful")},function(l){o.Log.error("SilentRenewService._tokenExpiring: Error from signinSilent:",l.message),c._userManager.events._raiseSilentRenewError(l)})},s}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.CordovaPopupNavigator=void 0;var o=i(21);r.CordovaPopupNavigator=function(){function s(){(function(c,l){if(!(c instanceof l))throw new TypeError("Cannot call a class as a function")})(this,s)}return s.prototype.prepare=function(c){var l=new o.CordovaPopupWindow(c);return Promise.resolve(l)},s}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.CordovaIFrameNavigator=void 0;var o=i(21);r.CordovaIFrameNavigator=function(){function s(){(function(c,l){if(!(c instanceof l))throw new TypeError("Cannot call a class as a function")})(this,s)}return s.prototype.prepare=function(c){c.popupWindowFeatures="hidden=yes";var l=new o.CordovaPopupWindow(c);return Promise.resolve(l)},s}()},function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.Version="1.11.6"}])})})(gi);function CI(t,e){var n,r,i,o;throw t.error==="invalid_redirect_uri"?new Error(`Dynamic client registration failed: the provided redirect uri [${(n=e.redirectUrl)===null||n===void 0?void 0:n.toString()}] is invalid - ${(r=t.error_description)!==null&&r!==void 0?r:""}`):t.error==="invalid_client_metadata"?new Error(`Dynamic client registration failed: the provided client metadata ${JSON.stringify(e)} is invalid - ${(i=t.error_description)!==null&&i!==void 0?i:""}`):new Error(`Dynamic client registration failed: ${t.error} - ${(o=t.error_description)!==null&&o!==void 0?o:""}`)}function PI(t,e){if(t.client_id===void 0)throw new Error(`Dynamic client registration failed: no client_id has been found on ${JSON.stringify(t)}`);if(e.redirectUrl&&(t.redirect_uris===void 0||t.redirect_uris[0]!==e.redirectUrl.toString()))throw new Error(`Dynamic client registration failed: the returned redirect URIs ${JSON.stringify(t.redirect_uris)} don't match the provided ${JSON.stringify([e.redirectUrl.toString()])}`)}async function NI(t,e){var n;if(!e.registrationEndpoint)throw new Error("Dynamic Registration could not be completed because the issuer has no registration endpoint.");if(!Array.isArray(e.idTokenSigningAlgValuesSupported))throw new Error("The OIDC issuer discovery profile is missing the 'id_token_signing_alg_values_supported' value, which is mandatory.");const r=Kt.determineSigningAlg(e.idTokenSigningAlgValuesSupported,Kt.PREFERRED_SIGNING_ALG),i={client_name:t.clientName,application_type:"web",redirect_uris:[(n=t.redirectUrl)===null||n===void 0?void 0:n.toString()],subject_type:"public",token_endpoint_auth_method:"client_secret_basic",id_token_signed_response_alg:r,grant_types:["authorization_code","refresh_token"]},o={"Content-Type":"application/json"},s=await fetch(e.registrationEndpoint.toString(),{method:"POST",headers:o,body:JSON.stringify(i)});if(s.ok){const a=await s.json();return PI(a,t),{clientId:a.client_id,clientSecret:a.client_secret,idTokenSignedResponseAlg:a.id_token_signed_response_alg,clientType:"dynamic"}}throw s.status===400&&CI(await s.json(),t),new Error(`Dynamic client registration failed: the server returned ${s.status} ${s.statusText} - ${await s.text()}`)}function OI(t){return t.error!==void 0&&typeof t.error=="string"}function Yy(t){return t.error_description!==void 0&&typeof t.error_description=="string"}function MI(t){return t.error_uri!==void 0&&typeof t.error_uri=="string"}function LI(t){return t.access_token!==void 0&&typeof t.access_token=="string"}function UI(t){return t.id_token!==void 0&&typeof t.id_token=="string"}function jI(t){return t.refresh_token!==void 0&&typeof t.refresh_token=="string"}function $I(t){return t.token_type!==void 0&&typeof t.token_type=="string"}function BI(t){return t.expires_in===void 0||typeof t.expires_in=="number"}function HI(t,e){if(e.grantType&&(!t.grantTypesSupported||!t.grantTypesSupported.includes(e.grantType)))throw new Error(`The issuer [${t.issuer}] does not support the [${e.grantType}] grant`);if(!t.tokenEndpoint)throw new Error(`This issuer [${t.issuer}] does not have a token endpoint`)}function d1(t,e){if(OI(t))throw new Kt.OidcProviderError(`Token endpoint returned error [${t.error}]${Yy(t)?`: ${t.error_description}`:""}${MI(t)?` (see ${t.error_uri})`:""}`,t.error,Yy(t)?t.error_description:void 0);if(!LI(t))throw new Kt.InvalidResponseError(["access_token"]);if(!UI(t))throw new Kt.InvalidResponseError(["id_token"]);if(!$I(t))throw new Kt.InvalidResponseError(["token_type"]);if(!BI(t))throw new Kt.InvalidResponseError(["expires_in"]);if(!e&&t.token_type.toLowerCase()!=="bearer")throw new Error(`Invalid token endpoint response: requested a [Bearer] token, but got a 'token_type' value of [${t.token_type}].`);return t}async function KI(t,e,n,r){HI(t,n);const i={"content-type":"application/x-www-form-urlencoded"};let o;r&&(o=await Kt.generateDpopKeyPair(),i.DPoP=await Kt.createDpopHeader(t.tokenEndpoint,"POST",o)),e.clientSecret&&(i.Authorization=`Basic ${btoa(`${e.clientId}:${e.clientSecret}`)}`);const s={grant_type:n.grantType,redirect_uri:n.redirectUrl,code:n.code,code_verifier:n.codeVerifier,client_id:e.clientId},a={method:"POST",headers:i,body:new URLSearchParams(s).toString()},l=await(await await fetch(t.tokenEndpoint,a)).json(),u=d1(l,r),d=await Kt.getWebidFromTokenPayload(u.id_token,t.jwksUri,t.issuer,e.clientId);return{accessToken:u.access_token,idToken:u.id_token,refreshToken:jI(u)?u.refresh_token:void 0,webId:d,dpopKey:o,expiresIn:u.expires_in}}async function WI(t){let e;try{const n=new gi.exports.OidcClient({response_mode:"query",loadUserInfo:!1});if(e=await n.processSigninResponse(t),n.settings.metadata===void 0)throw new Error("Cannot retrieve issuer metadata from client information in storage.");if(n.settings.metadata.jwks_uri===void 0)throw new Error("Missing some issuer metadata from client information in storage: 'jwks_uri' is undefined");if(n.settings.metadata.issuer===void 0)throw new Error("Missing some issuer metadata from client information in storage: 'issuer' is undefined");if(n.settings.client_id===void 0)throw new Error("Missing some client information in storage: 'client_id' is undefined");const r=await Kt.getWebidFromTokenPayload(e.id_token,n.settings.metadata.jwks_uri,n.settings.metadata.issuer,n.settings.client_id);return{accessToken:e.access_token,idToken:e.id_token,webId:r,refreshToken:e.refresh_token}}catch(n){throw new Error(`Problem handling Auth Code Grant (Flow) redirect - URL [${t}]: ${n}`)}}async function qI(t,e,n){return KI(t,e,n,!0)}const VI=t=>{try{return new URL(t),!0}catch{return!1}};async function zI(t,e,n,r){if(n.clientId===void 0)throw new Error("No client ID available when trying to refresh the access token.");const i={grant_type:"refresh_token",refresh_token:t,scope:Kt.DEFAULT_SCOPES};let o={};r!==void 0&&(o={DPoP:await Kt.createDpopHeader(e.tokenEndpoint,"POST",r)});let s={};n.clientSecret!==void 0?s={Authorization:`Basic ${btoa(`${n.clientId}:${n.clientSecret}`)}`}:VI(n.clientId)&&(i.client_id=n.clientId);const a=await fetch(e.tokenEndpoint,{method:"POST",body:new URLSearchParams(i).toString(),headers:{...o,...s,"Content-Type":"application/x-www-form-urlencoded"}});let c;try{c=await a.json()}catch{throw new Error(`The token endpoint of issuer ${e.issuer} returned a malformed response.`)}const l=d1(c,r!==void 0),u=await Kt.getWebidFromTokenPayload(l.id_token,e.jwksUri,e.issuer,n.clientId);return{accessToken:l.access_token,idToken:l.id_token,refreshToken:typeof l.refresh_token=="string"?l.refresh_token:void 0,webId:u,dpopKey:r,expiresIn:l.expires_in}}function GI(t){const e=new URL(t);return e.searchParams.delete("code"),e.searchParams.delete("state"),e.hash="",e.toString()}async function YI(){await new gi.exports.OidcClient({response_mode:"query"}).clearStaleState(new gi.exports.WebStorageStateStore({}));const e=window.localStorage,n=[];for(let r=0;r<=e.length;r+=1){const i=e.key(r);i&&(i.match(/^oidc\..+$/)||i.match(/^solidClientAuthenticationUser:.+$/))&&n.push(i)}n.forEach(r=>e.removeItem(r))}var JI=Object.freeze(Object.defineProperty({__proto__:null,clearOidcPersistentStorage:YI,getBearerToken:WI,getDpopToken:qI,refresh:zI,registerClient:NI,removeOidcQueryParam:GI,CordovaIFrameNavigator:gi.exports.CordovaIFrameNavigator,CordovaPopupNavigator:gi.exports.CordovaPopupNavigator,InMemoryWebStorage:gi.exports.InMemoryWebStorage,Log:gi.exports.Log,OidcClient:gi.exports.OidcClient,SessionMonitor:gi.exports.SessionMonitor,User:gi.exports.User,UserManager:gi.exports.UserManager,Version:gi.exports.Version,WebStorageStateStore:gi.exports.WebStorageStateStore},Symbol.toStringTag,{value:"Module"})),jc=lf(JI);Object.defineProperty(k0,"__esModule",{value:!0});const ZI=Kt,QI=jc,Jy=(t,e)=>window.fetch(t,e);class XI{constructor(e,n,r,i,o){this.loginHandler=e,this.redirectHandler=n,this.logoutHandler=r,this.sessionInfoManager=i,this.issuerConfigFetcher=o,this.login=async(s,a)=>{var c,l;await this.sessionInfoManager.clear(s.sessionId);const u=(0,QI.removeOidcQueryParam)((c=s.redirectUrl)!==null&&c!==void 0?c:window.location.href);await this.loginHandler.handle({...s,redirectUrl:u,clientName:(l=s.clientName)!==null&&l!==void 0?l:s.clientId,eventEmitter:a})},this.fetch=Jy,this.logout=async s=>{await this.logoutHandler.handle(s),this.fetch=Jy},this.getSessionInfo=async s=>this.sessionInfoManager.get(s),this.getAllSessionInfo=async()=>this.sessionInfoManager.getAll(),this.validateCurrentSession=async s=>{const a=await this.sessionInfoManager.get(s);return a===void 0||a.clientAppId===void 0||a.issuer===void 0?null:a},this.handleIncomingRedirect=async(s,a)=>{try{const c=await this.redirectHandler.handle(s,a);return this.fetch=c.fetch.bind(window),this.cleanUrlAfterRedirect(s),{isLoggedIn:c.isLoggedIn,webId:c.webId,sessionId:c.sessionId,expirationDate:c.expirationDate}}catch(c){this.cleanUrlAfterRedirect(s),a.emit(ZI.EVENTS.ERROR,"redirect",c);return}}}cleanUrlAfterRedirect(e){const n=new URL(e);n.searchParams.delete("state"),n.searchParams.delete("code"),n.searchParams.delete("id_token"),n.searchParams.delete("access_token"),n.searchParams.delete("error"),n.searchParams.delete("error_description"),window.history.replaceState(null,"",n.toString())}}k0.default=XI;var F0={};Object.defineProperty(F0,"__esModule",{value:!0});const Oh=Kt;function Zy(t){return typeof t.oidcIssuer=="string"}function Qy(t){return typeof t.redirectUrl=="string"}class eR{constructor(e,n,r,i){this.storageUtility=e,this.oidcHandler=n,this.issuerConfigFetcher=r,this.clientRegistrar=i}async canHandle(e){return Zy(e)&&Qy(e)}async handle(e){if(!Zy(e))throw new Oh.ConfigurationError(`OidcLoginHandler requires an OIDC issuer: missing property 'oidcIssuer' in ${JSON.stringify(e)}`);if(!Qy(e))throw new Oh.ConfigurationError(`OidcLoginHandler requires a redirect URL: missing property 'redirectUrl' in ${JSON.stringify(e)}`);const n=await this.issuerConfigFetcher.fetchConfig(e.oidcIssuer),r=await(0,Oh.handleRegistration)(e,n,this.storageUtility,this.clientRegistrar),i={issuer:n.issuer,dpop:e.tokenType.toLowerCase()==="dpop",...e,issuerConfiguration:n,client:r};return this.oidcHandler.handle(i)}}F0.default=eR;var D0={};Object.defineProperty(D0,"__esModule",{value:!0});const tR=Kt,nR=jc;class rR{constructor(e,n){this.storageUtility=e,this.redirector=n}async canHandle(e){return!!(e.issuerConfiguration.grantTypesSupported&&e.issuerConfiguration.grantTypesSupported.indexOf("authorization_code")>-1)}async handle(e){var n;const r={authority:e.issuer.toString(),client_id:e.client.clientId,client_secret:e.client.clientSecret,redirect_uri:e.redirectUrl.toString(),post_logout_redirect_uri:e.redirectUrl.toString(),response_type:"code",scope:tR.DEFAULT_SCOPES,filterProtocolClaims:!0,loadUserInfo:!1,code_verifier:!0,prompt:(n=e.prompt)!==null&&n!==void 0?n:"consent"},i=new nR.OidcClient(r),{redirector:o}=this,s=this.storageUtility;try{const a=await i.createSigninRequest();await Promise.all([s.setForUser(a.state._id,{sessionId:e.sessionId}),s.setForUser(e.sessionId,{codeVerifier:a.state._code_verifier,issuer:e.issuer.toString(),redirectUrl:e.redirectUrl,dpop:e.dpop?"true":"false"})]),o.redirect(a.url.toString(),{handleRedirect:e.handleRedirect})}catch(a){console.error(a)}}}D0.default=rR;var f1={},Ef={};Object.defineProperty(Ef,"__esModule",{value:!0});Ef.appendToUrlPathname=void 0;function iR(t,e){const n=new URL(t),r=n.pathname;return n.pathname=`${r}${r.endsWith("/")?"":"/"}${e.startsWith("/")?e.substring(1):e}`,n.toString()}Ef.appendToUrlPathname=iR;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.WELL_KNOWN_OPENID_CONFIG=void 0;const e=Kt,n=Ef;t.WELL_KNOWN_OPENID_CONFIG=".well-known/openid-configuration";const r={issuer:{toKey:"issuer",convertToUrl:!0},authorization_endpoint:{toKey:"authorizationEndpoint",convertToUrl:!0},token_endpoint:{toKey:"tokenEndpoint",convertToUrl:!0},userinfo_endpoint:{toKey:"userinfoEndpoint",convertToUrl:!0},jwks_uri:{toKey:"jwksUri",convertToUrl:!0},registration_endpoint:{toKey:"registrationEndpoint",convertToUrl:!0},scopes_supported:{toKey:"scopesSupported"},response_types_supported:{toKey:"responseTypesSupported"},response_modes_supported:{toKey:"responseModesSupported"},grant_types_supported:{toKey:"grantTypesSupported"},acr_values_supported:{toKey:"acrValuesSupported"},subject_types_supported:{toKey:"subjectTypesSupported"},id_token_signing_alg_values_supported:{toKey:"idTokenSigningAlgValuesSupported"},id_token_encryption_alg_values_supported:{toKey:"idTokenEncryptionAlgValuesSupported"},id_token_encryption_enc_values_supported:{toKey:"idTokenEncryptionEncValuesSupported"},userinfo_signing_alg_values_supported:{toKey:"userinfoSigningAlgValuesSupported"},userinfo_encryption_alg_values_supported:{toKey:"userinfoEncryptionAlgValuesSupported"},userinfo_encryption_enc_values_supported:{toKey:"userinfoEncryptionEncValuesSupported"},request_object_signing_alg_values_supported:{toKey:"requestObjectSigningAlgValuesSupported"},request_object_encryption_alg_values_supported:{toKey:"requestObjectEncryptionAlgValuesSupported"},request_object_encryption_enc_values_supported:{toKey:"requestObjectEncryptionEncValuesSupported"},token_endpoint_auth_methods_supported:{toKey:"tokenEndpointAuthMethodsSupported"},token_endpoint_auth_signing_alg_values_supported:{toKey:"tokenEndpointAuthSigningAlgValuesSupported"},display_values_supported:{toKey:"displayValuesSupported"},claim_types_supported:{toKey:"claimTypesSupported"},claims_supported:{toKey:"claimsSupported"},service_documentation:{toKey:"serviceDocumentation"},claims_locales_supported:{toKey:"claimsLocalesSupported"},ui_locales_supported:{toKey:"uiLocalesSupported"},claims_parameter_supported:{toKey:"claimsParameterSupported"},request_parameter_supported:{toKey:"requestParameterSupported"},request_uri_parameter_supported:{toKey:"requestUriParameterSupported"},require_request_uri_registration:{toKey:"requireRequestUriRegistration"},op_policy_uri:{toKey:"opPolicyUri",convertToUrl:!0},op_tos_uri:{toKey:"opTosUri",convertToUrl:!0}};function i(s){const a={};return Object.keys(s).forEach(c=>{r[c]&&(a[r[c].toKey]=s[c])}),Array.isArray(a.scopesSupported)||(a.scopesSupported=["openid"]),a}class o{constructor(a){this.storageUtility=a}static getLocalStorageKey(a){return`issuerConfig:${a}`}async fetchConfig(a){let c;const l=(0,n.appendToUrlPathname)(a,t.WELL_KNOWN_OPENID_CONFIG),u=await window.fetch(l);try{c=i(await u.json())}catch(d){throw new e.ConfigurationError(`[${a.toString()}] has an invalid configuration: ${d.message}`)}return await this.storageUtility.set(o.getLocalStorageKey(a),JSON.stringify(c)),c}}t.default=o})(f1);var Sf={},Do={};Object.defineProperty(Do,"__esModule",{value:!0});Do.SessionInfoManager=Do.clear=Do.getUnauthenticatedSession=void 0;const oR=Kt,sR=I0,aR=jc;function cR(){return{isLoggedIn:!1,sessionId:(0,sR.v4)(),fetch}}Do.getUnauthenticatedSession=cR;async function h1(t,e){await Promise.all([e.deleteAllUserData(t,{secure:!1}),e.deleteAllUserData(t,{secure:!0}),e.delete("clientKey",{secure:!1})]),await(0,aR.clearOidcPersistentStorage)()}Do.clear=h1;class lR{constructor(e){this.storageUtility=e}update(e,n){throw new Error("Not Implemented")}async get(e){var n;const r=await this.storageUtility.getForUser(e,"isLoggedIn",{secure:!0}),i=await this.storageUtility.getForUser(e,"webId",{secure:!0}),o=await this.storageUtility.getForUser(e,"clientId",{secure:!1}),s=await this.storageUtility.getForUser(e,"clientSecret",{secure:!1}),a=await this.storageUtility.getForUser(e,"redirectUrl",{secure:!1}),c=await this.storageUtility.getForUser(e,"refreshToken",{secure:!0}),l=await this.storageUtility.getForUser(e,"issuer",{secure:!1}),u=(n=await this.storageUtility.getForUser(e,"tokenType",{secure:!1}))!==null&&n!==void 0?n:"DPoP";if(!(0,oR.isSupportedTokenType)(u))throw new Error(`Tokens of type [${u}] are not supported.`);if(!(o===void 0&&r===void 0&&i===void 0&&c===void 0))return{sessionId:e,webId:i,isLoggedIn:r==="true",redirectUrl:a,refreshToken:c,issuer:l,clientAppId:o,clientAppSecret:s,tokenType:u}}async getAll(){throw new Error("Not implemented")}async clear(e){return h1(e,this.storageUtility)}async register(e){throw new Error("Not implemented")}async getRegisteredSessionIdAll(){throw new Error("Not implemented")}async clearAll(){throw new Error("Not implemented")}}Do.SessionInfoManager=lR;Object.defineProperty(Sf,"__esModule",{value:!0});Sf.FallbackRedirectHandler=void 0;const uR=Do;class dR{async canHandle(e){try{return new URL(e),!0}catch(n){throw new Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${n}`)}}async handle(e){return(0,uR.getUnauthenticatedSession)()}}Sf.FallbackRedirectHandler=dR;var C0={};Object.defineProperty(C0,"__esModule",{value:!0});class fR{constructor(e){this.sessionInfoManager=e}async canHandle(){return!0}async handle(e){await this.sessionInfoManager.clear(e)}}C0.default=fR;var Tf={};Object.defineProperty(Tf,"__esModule",{value:!0});Tf.AuthCodeRedirectHandler=void 0;const Xy=Kt,e_=jc;class hR{constructor(e,n,r,i,o){this.storageUtility=e,this.sessionInfoManager=n,this.issuerConfigFetcher=r,this.clientRegistrar=i,this.tokerRefresher=o}async canHandle(e){try{const n=new URL(e);return n.searchParams.get("code")!==null&&n.searchParams.get("state")!==null}catch(n){throw new Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${n}`)}}async handle(e,n){if(!await this.canHandle(e))throw new Error(`AuthCodeRedirectHandler cannot handle [${e}]: it is missing one of [code, state].`);const r=new URL(e),i=r.searchParams.get("state"),o=await this.storageUtility.getForUser(i,"sessionId",{errorIfNull:!0}),{issuerConfig:s,codeVerifier:a,redirectUrl:c,dpop:l}=await(0,Xy.loadOidcContextFromStorage)(o,this.storageUtility,this.issuerConfigFetcher);if(a===void 0)throw new Error(`The code verifier for session ${o} is missing from storage.`);if(c===void 0)throw new Error(`The redirect URL for session ${o} is missing from storage.`);const u=await this.clientRegistrar.getClient({sessionId:o},s);let d;const g=Date.now();l?(d=await(0,e_.getDpopToken)(s,u,{grantType:"authorization_code",code:r.searchParams.get("code"),codeVerifier:a,redirectUrl:c}),window.localStorage.removeItem(`oidc.${i}`)):d=await(0,e_.getBearerToken)(r.toString());let p;d.refreshToken!==void 0&&(p={sessionId:o,refreshToken:d.refreshToken,tokenRefresher:this.tokerRefresher});const y=await(0,Xy.buildAuthenticatedFetch)(fetch,d.accessToken,{dpopKey:d.dpopKey,refreshOptions:p,eventEmitter:n,expiresIn:d.expiresIn});await this.storageUtility.setForUser(o,{webId:d.webId,isLoggedIn:"true"},{secure:!0}),r.searchParams.delete("code"),await this.storageUtility.setForUser(o,{redirectUrl:r.toString()},{secure:!1});const w=await this.sessionInfoManager.get(o);if(!w)throw new Error(`Could not retrieve session: [${o}].`);return Object.assign(w,{fetch:y,expirationDate:typeof d.expiresIn=="number"?g+d.expiresIn*1e3:null})}}Tf.AuthCodeRedirectHandler=hR;var P0={};Object.defineProperty(P0,"__esModule",{value:!0});const pR=Kt;class gR extends pR.AggregateHandler{constructor(e){super(e)}}P0.default=gR;var N0={};Object.defineProperty(N0,"__esModule",{value:!0});class mR{get storage(){return window.localStorage}async get(e){return this.storage.getItem(e)||void 0}async set(e,n){this.storage.setItem(e,n)}async delete(e){this.storage.removeItem(e)}}N0.default=mR;var O0={};Object.defineProperty(O0,"__esModule",{value:!0});class yR{redirect(e,n){n&&n.handleRedirect?n.handleRedirect(e):n&&n.redirectByReplacingState?window.history.replaceState({},"",e):window.location.href=e}}O0.default=yR;var M0={};Object.defineProperty(M0,"__esModule",{value:!0});const _R=jc;class wR{constructor(e){this.storageUtility=e}async getClient(e,n){const[r,i]=await Promise.all([this.storageUtility.getForUser(e.sessionId,"clientId",{secure:!1}),this.storageUtility.getForUser(e.sessionId,"clientSecret",{secure:!1})]);if(r)return{clientId:r,clientSecret:i,clientType:"dynamic"};try{const o=await(0,_R.registerClient)(e,n),s={clientId:o.clientId};return o.clientSecret&&(s.clientSecret=o.clientSecret),o.idTokenSignedResponseAlg&&(s.idTokenSignedResponseAlg=o.idTokenSignedResponseAlg),await this.storageUtility.setForUser(e.sessionId,s,{secure:!1}),o}catch(o){throw new Error(`Client registration failed: [${o}]`)}}}M0.default=wR;var Af={};Object.defineProperty(Af,"__esModule",{value:!0});Af.ErrorOidcHandler=void 0;const vR=Kt,bR=Do;class ER{async canHandle(e){try{return new URL(e).searchParams.has("error")}catch(n){throw new Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${n}`)}}async handle(e,n){if(n!==void 0){const r=new URL(e),i=r.searchParams.get("error"),o=r.searchParams.get("error_description");n.emit(vR.EVENTS.ERROR,i,o)}return(0,bR.getUnauthenticatedSession)()}}Af.ErrorOidcHandler=ER;var L0={};Object.defineProperty(L0,"__esModule",{value:!0});const t_=Kt,SR=jc;class TR{constructor(e,n,r){this.storageUtility=e,this.issuerConfigFetcher=n,this.clientRegistrar=r}async refresh(e,n,r,i){const o=await(0,t_.loadOidcContextFromStorage)(e,this.storageUtility,this.issuerConfigFetcher),s=await this.clientRegistrar.getClient({sessionId:e},o.issuerConfig);if(n===void 0)throw new Error(`Session [${e}] has no refresh token to allow it to refresh its access token.`);if(o.dpop&&r===void 0)throw new Error(`For session [${e}], the key bound to the DPoP access token must be provided to refresh said access token.`);const a=await(0,SR.refresh)(n,o.issuerConfig,s,r);return a.refreshToken!==void 0&&(i==null||i.emit(t_.EVENTS.NEW_REFRESH_TOKEN,a.refreshToken),await this.storageUtility.setForUser(e,{refreshToken:a.refreshToken})),a}}L0.default=TR;var mo=Vt&&Vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(du,"__esModule",{value:!0});du.getClientAuthenticationWithDependencies=void 0;const AR=Kt,xR=mo(R0),IR=mo(k0),RR=mo(F0),kR=mo(D0),FR=mo(f1),DR=Sf,CR=mo(C0),PR=Do,NR=Tf,OR=mo(P0),MR=mo(N0),LR=mo(O0),UR=mo(M0),jR=Af,$R=mo(L0);function BR(t){const e=new AR.InMemoryStorage,n=t.secureStorage||e,r=t.insecureStorage||new MR.default,i=new xR.default(n,r),o=new FR.default(i),s=new UR.default(i),a=new PR.SessionInfoManager(i),c=new $R.default(i,o,s),l=new RR.default(i,new kR.default(i,new LR.default),o,s),u=new OR.default([new jR.ErrorOidcHandler,new NR.AuthCodeRedirectHandler(i,a,o,s,c),new DR.FallbackRedirectHandler]);return new IR.default(l,u,new CR.default(a),a,o)}du.getClientAuthenticationWithDependencies=BR;var Dc={};Object.defineProperty(Dc,"__esModule",{value:!0});Dc.KEY_CURRENT_URL=Dc.KEY_CURRENT_SESSION=void 0;const p1=Kt;Dc.KEY_CURRENT_SESSION=`${p1.SOLID_CLIENT_AUTHN_KEY_PREFIX}currentSession`;Dc.KEY_CURRENT_URL=`${p1.SOLID_CLIENT_AUTHN_KEY_PREFIX}currentUrl`;Object.defineProperty(xa,"__esModule",{value:!0});xa.Session=xa.silentlyAuthenticate=void 0;const HR=su.exports,Li=Kt,KR=I0,n_=du,ic=Dc;async function g1(t,e,n){var r;const i=await e.validateCurrentSession(t);return i!==null?(window.localStorage.setItem(ic.KEY_CURRENT_URL,window.location.href),await e.login({sessionId:t,prompt:"none",oidcIssuer:i.issuer,redirectUrl:i.redirectUrl,clientId:i.clientAppId,clientSecret:i.clientAppSecret,tokenType:(r=i.tokenType)!==null&&r!==void 0?r:"DPoP"},n),!0):!1}xa.silentlyAuthenticate=g1;function WR(t){return!!(t!=null&&t.isLoggedIn)}class qR extends HR.EventEmitter{constructor(e={},n){super(),this.tokenRequestInProgress=!1,this.login=async r=>{var i;return await this.clientAuthentication.login({sessionId:this.info.sessionId,...r,tokenType:(i=r.tokenType)!==null&&i!==void 0?i:"DPoP"},this),new Promise(()=>{})},this.fetch=async(r,i)=>this.clientAuthentication.fetch(r,i),this.internalLogout=async r=>{window.localStorage.removeItem(ic.KEY_CURRENT_SESSION),await this.clientAuthentication.logout(this.info.sessionId),this.info.isLoggedIn=!1,r&&this.emit(Li.EVENTS.LOGOUT)},this.logout=async()=>this.internalLogout(!0),this.handleIncomingRedirect=async(r={})=>{var i;if(this.info.isLoggedIn)return this.info;if(this.tokenRequestInProgress)return;const o=typeof r=="string"?{url:r}:r,s=(i=o.url)!==null&&i!==void 0?i:window.location.href;this.tokenRequestInProgress=!0;const a=await this.clientAuthentication.handleIncomingRedirect(s,this);if(WR(a)){this.setSessionInfo(a);const c=window.localStorage.getItem(ic.KEY_CURRENT_URL);c===null?this.emit(Li.EVENTS.LOGIN):(window.localStorage.removeItem(ic.KEY_CURRENT_URL),this.emit(Li.EVENTS.SESSION_RESTORED,c))}else if(o.restorePreviousSession===!0){const c=window.localStorage.getItem(ic.KEY_CURRENT_SESSION);if(c!==null&&await g1(c,this.clientAuthentication,this))return new Promise(()=>{})}return this.tokenRequestInProgress=!1,a},e.clientAuthentication?this.clientAuthentication=e.clientAuthentication:e.secureStorage&&e.insecureStorage?this.clientAuthentication=(0,n_.getClientAuthenticationWithDependencies)({secureStorage:e.secureStorage,insecureStorage:e.insecureStorage}):this.clientAuthentication=(0,n_.getClientAuthenticationWithDependencies)({}),e.sessionInfo?this.info={sessionId:e.sessionInfo.sessionId,isLoggedIn:!1,webId:e.sessionInfo.webId}:this.info={sessionId:n!=null?n:(0,KR.v4)(),isLoggedIn:!1},this.on(Li.EVENTS.LOGIN,()=>window.localStorage.setItem(ic.KEY_CURRENT_SESSION,this.info.sessionId)),this.on(Li.EVENTS.SESSION_EXPIRED,()=>this.internalLogout(!1)),this.on(Li.EVENTS.ERROR,()=>this.internalLogout(!1))}onLogin(e){this.on(Li.EVENTS.LOGIN,e)}onLogout(e){this.on(Li.EVENTS.LOGOUT,e)}onError(e){this.on(Li.EVENTS.ERROR,e)}onSessionRestore(e){this.on(Li.EVENTS.SESSION_RESTORED,e)}onSessionExpiration(e){this.on(Li.EVENTS.SESSION_EXPIRED,e)}setSessionInfo(e){this.info.isLoggedIn=e.isLoggedIn,this.info.webId=e.webId,this.info.sessionId=e.sessionId,this.info.expirationDate=e.expirationDate,this.on(Li.EVENTS.SESSION_EXTENDED,n=>{this.info.expirationDate=Date.now()+n*1e3})}}xa.Session=qR;var Fr={};Object.defineProperty(Fr,"__esModule",{value:!0});Fr.onSessionRestore=Fr.onLogout=Fr.onLogin=Fr.handleIncomingRedirect=Fr.logout=Fr.login=Fr.fetch=Fr.getDefaultSession=void 0;const VR=xa;let Mh;function Hs(){return typeof Mh=="undefined"&&(Mh=new VR.Session),Mh}Fr.getDefaultSession=Hs;const zR=(...t)=>Hs().fetch(...t);Fr.fetch=zR;const GR=(...t)=>Hs().login(...t);Fr.login=GR;const YR=(...t)=>Hs().logout(...t);Fr.logout=YR;const JR=(...t)=>Hs().handleIncomingRedirect(...t);Fr.handleIncomingRedirect=JR;const ZR=(...t)=>Hs().onLogin(...t);Fr.onLogin=ZR;const QR=(...t)=>Hs().onLogout(...t);Fr.onLogout=QR;const XR=(...t)=>Hs().onSessionRestore(...t);Fr.onSessionRestore=XR;(function(t){var e=Vt&&Vt.__createBinding||(Object.create?function(s,a,c,l){l===void 0&&(l=c);var u=Object.getOwnPropertyDescriptor(a,c);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[c]}}),Object.defineProperty(s,l,u)}:function(s,a,c,l){l===void 0&&(l=c),s[l]=a[c]}),n=Vt&&Vt.__exportStar||function(s,a){for(var c in s)c!=="default"&&!Object.prototype.hasOwnProperty.call(a,c)&&e(a,s,c)};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryStorage=t.ConfigurationError=t.NotImplementedError=t.getClientAuthenticationWithDependencies=t.Session=void 0;var r=xa;Object.defineProperty(t,"Session",{enumerable:!0,get:function(){return r.Session}});var i=du;Object.defineProperty(t,"getClientAuthenticationWithDependencies",{enumerable:!0,get:function(){return i.getClientAuthenticationWithDependencies}}),n(Fr,t);var o=Kt;Object.defineProperty(t,"NotImplementedError",{enumerable:!0,get:function(){return o.NotImplementedError}}),Object.defineProperty(t,"ConfigurationError",{enumerable:!0,get:function(){return o.ConfigurationError}}),Object.defineProperty(t,"InMemoryStorage",{enumerable:!0,get:function(){return o.InMemoryStorage}})})(ia);var Ls={},xf={};xf.byteLength=nk;xf.toByteArray=ik;xf.fromByteArray=ak;var ko=[],ji=[],ek=typeof Uint8Array!="undefined"?Uint8Array:Array,Lh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Xa=0,tk=Lh.length;Xa<tk;++Xa)ko[Xa]=Lh[Xa],ji[Lh.charCodeAt(Xa)]=Xa;ji["-".charCodeAt(0)]=62;ji["_".charCodeAt(0)]=63;function m1(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function nk(t){var e=m1(t),n=e[0],r=e[1];return(n+r)*3/4-r}function rk(t,e,n){return(e+n)*3/4-n}function ik(t){var e,n=m1(t),r=n[0],i=n[1],o=new ek(rk(t,r,i)),s=0,a=i>0?r-4:r,c;for(c=0;c<a;c+=4)e=ji[t.charCodeAt(c)]<<18|ji[t.charCodeAt(c+1)]<<12|ji[t.charCodeAt(c+2)]<<6|ji[t.charCodeAt(c+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=ji[t.charCodeAt(c)]<<2|ji[t.charCodeAt(c+1)]>>4,o[s++]=e&255),i===1&&(e=ji[t.charCodeAt(c)]<<10|ji[t.charCodeAt(c+1)]<<4|ji[t.charCodeAt(c+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function ok(t){return ko[t>>18&63]+ko[t>>12&63]+ko[t>>6&63]+ko[t&63]}function sk(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),i.push(ok(r));return i.join("")}function ak(t){for(var e,n=t.length,r=n%3,i=[],o=16383,s=0,a=n-r;s<a;s+=o)i.push(sk(t,s,s+o>a?a:s+o));return r===1?(e=t[n-1],i.push(ko[e>>2]+ko[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(ko[e>>10]+ko[e>>4&63]+ko[e<<2&63]+"=")),i.join("")}var U0={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */U0.read=function(t,e,n,r,i){var o,s,a=i*8-r-1,c=(1<<a)-1,l=c>>1,u=-7,d=n?i-1:0,g=n?-1:1,p=t[e+d];for(d+=g,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=o*256+t[e+d],d+=g,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=s*256+t[e+d],d+=g,u-=8);if(o===0)o=1-l;else{if(o===c)return s?NaN:(p?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-l}return(p?-1:1)*s*Math.pow(2,o-r)};U0.write=function(t,e,n,r,i,o){var s,a,c,l=o*8-i-1,u=(1<<l)-1,d=u>>1,g=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,y=r?1:-1,w=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),s+d>=1?e+=g/c:e+=g*Math.pow(2,1-d),e*c>=2&&(s++,c/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(e*c-1)*Math.pow(2,i),s=s+d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=a&255,p+=y,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;t[n+p]=s&255,p+=y,s/=256,l-=8);t[n+p-y]|=w*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=xf,n=U0,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=S,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const L=new Uint8Array(1),x={foo:function(){return 42}};return Object.setPrototypeOf(x,Uint8Array.prototype),Object.setPrototypeOf(L,x),L.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(!!a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(!!a.isBuffer(this))return this.byteOffset}});function s(L){if(L>i)throw new RangeError('The value "'+L+'" is invalid for option "size"');const x=new Uint8Array(L);return Object.setPrototypeOf(x,a.prototype),x}function a(L,x,k){if(typeof L=="number"){if(typeof x=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(L)}return c(L,x,k)}a.poolSize=8192;function c(L,x,k){if(typeof L=="string")return g(L,x);if(ArrayBuffer.isView(L))return y(L);if(L==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L);if(pt(L,ArrayBuffer)||L&&pt(L.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(pt(L,SharedArrayBuffer)||L&&pt(L.buffer,SharedArrayBuffer)))return w(L,x,k);if(typeof L=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const I=L.valueOf&&L.valueOf();if(I!=null&&I!==L)return a.from(I,x,k);const ie=E(L);if(ie)return ie;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof L[Symbol.toPrimitive]=="function")return a.from(L[Symbol.toPrimitive]("string"),x,k);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L)}a.from=function(L,x,k){return c(L,x,k)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(L){if(typeof L!="number")throw new TypeError('"size" argument must be of type number');if(L<0)throw new RangeError('The value "'+L+'" is invalid for option "size"')}function u(L,x,k){return l(L),L<=0?s(L):x!==void 0?typeof k=="string"?s(L).fill(x,k):s(L).fill(x):s(L)}a.alloc=function(L,x,k){return u(L,x,k)};function d(L){return l(L),s(L<0?0:b(L)|0)}a.allocUnsafe=function(L){return d(L)},a.allocUnsafeSlow=function(L){return d(L)};function g(L,x){if((typeof x!="string"||x==="")&&(x="utf8"),!a.isEncoding(x))throw new TypeError("Unknown encoding: "+x);const k=R(L,x)|0;let I=s(k);const ie=I.write(L,x);return ie!==k&&(I=I.slice(0,ie)),I}function p(L){const x=L.length<0?0:b(L.length)|0,k=s(x);for(let I=0;I<x;I+=1)k[I]=L[I]&255;return k}function y(L){if(pt(L,Uint8Array)){const x=new Uint8Array(L);return w(x.buffer,x.byteOffset,x.byteLength)}return p(L)}function w(L,x,k){if(x<0||L.byteLength<x)throw new RangeError('"offset" is outside of buffer bounds');if(L.byteLength<x+(k||0))throw new RangeError('"length" is outside of buffer bounds');let I;return x===void 0&&k===void 0?I=new Uint8Array(L):k===void 0?I=new Uint8Array(L,x):I=new Uint8Array(L,x,k),Object.setPrototypeOf(I,a.prototype),I}function E(L){if(a.isBuffer(L)){const x=b(L.length)|0,k=s(x);return k.length===0||L.copy(k,0,0,x),k}if(L.length!==void 0)return typeof L.length!="number"||wr(L.length)?s(0):p(L);if(L.type==="Buffer"&&Array.isArray(L.data))return p(L.data)}function b(L){if(L>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return L|0}function S(L){return+L!=L&&(L=0),a.alloc(+L)}a.isBuffer=function(x){return x!=null&&x._isBuffer===!0&&x!==a.prototype},a.compare=function(x,k){if(pt(x,Uint8Array)&&(x=a.from(x,x.offset,x.byteLength)),pt(k,Uint8Array)&&(k=a.from(k,k.offset,k.byteLength)),!a.isBuffer(x)||!a.isBuffer(k))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(x===k)return 0;let I=x.length,ie=k.length;for(let fe=0,oe=Math.min(I,ie);fe<oe;++fe)if(x[fe]!==k[fe]){I=x[fe],ie=k[fe];break}return I<ie?-1:ie<I?1:0},a.isEncoding=function(x){switch(String(x).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(x,k){if(!Array.isArray(x))throw new TypeError('"list" argument must be an Array of Buffers');if(x.length===0)return a.alloc(0);let I;if(k===void 0)for(k=0,I=0;I<x.length;++I)k+=x[I].length;const ie=a.allocUnsafe(k);let fe=0;for(I=0;I<x.length;++I){let oe=x[I];if(pt(oe,Uint8Array))fe+oe.length>ie.length?(a.isBuffer(oe)||(oe=a.from(oe)),oe.copy(ie,fe)):Uint8Array.prototype.set.call(ie,oe,fe);else if(a.isBuffer(oe))oe.copy(ie,fe);else throw new TypeError('"list" argument must be an Array of Buffers');fe+=oe.length}return ie};function R(L,x){if(a.isBuffer(L))return L.length;if(ArrayBuffer.isView(L)||pt(L,ArrayBuffer))return L.byteLength;if(typeof L!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof L);const k=L.length,I=arguments.length>2&&arguments[2]===!0;if(!I&&k===0)return 0;let ie=!1;for(;;)switch(x){case"ascii":case"latin1":case"binary":return k;case"utf8":case"utf-8":return me(L).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k*2;case"hex":return k>>>1;case"base64":return xt(L).length;default:if(ie)return I?-1:me(L).length;x=(""+x).toLowerCase(),ie=!0}}a.byteLength=R;function F(L,x,k){let I=!1;if((x===void 0||x<0)&&(x=0),x>this.length||((k===void 0||k>this.length)&&(k=this.length),k<=0)||(k>>>=0,x>>>=0,k<=x))return"";for(L||(L="utf8");;)switch(L){case"hex":return Ee(this,x,k);case"utf8":case"utf-8":return re(this,x,k);case"ascii":return Ce(this,x,k);case"latin1":case"binary":return Ze(this,x,k);case"base64":return Ae(this,x,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ve(this,x,k);default:if(I)throw new TypeError("Unknown encoding: "+L);L=(L+"").toLowerCase(),I=!0}}a.prototype._isBuffer=!0;function M(L,x,k){const I=L[x];L[x]=L[k],L[k]=I}a.prototype.swap16=function(){const x=this.length;if(x%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let k=0;k<x;k+=2)M(this,k,k+1);return this},a.prototype.swap32=function(){const x=this.length;if(x%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let k=0;k<x;k+=4)M(this,k,k+3),M(this,k+1,k+2);return this},a.prototype.swap64=function(){const x=this.length;if(x%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let k=0;k<x;k+=8)M(this,k,k+7),M(this,k+1,k+6),M(this,k+2,k+5),M(this,k+3,k+4);return this},a.prototype.toString=function(){const x=this.length;return x===0?"":arguments.length===0?re(this,0,x):F.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(x){if(!a.isBuffer(x))throw new TypeError("Argument must be a Buffer");return this===x?!0:a.compare(this,x)===0},a.prototype.inspect=function(){let x="";const k=t.INSPECT_MAX_BYTES;return x=this.toString("hex",0,k).replace(/(.{2})/g,"$1 ").trim(),this.length>k&&(x+=" ... "),"<Buffer "+x+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(x,k,I,ie,fe){if(pt(x,Uint8Array)&&(x=a.from(x,x.offset,x.byteLength)),!a.isBuffer(x))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof x);if(k===void 0&&(k=0),I===void 0&&(I=x?x.length:0),ie===void 0&&(ie=0),fe===void 0&&(fe=this.length),k<0||I>x.length||ie<0||fe>this.length)throw new RangeError("out of range index");if(ie>=fe&&k>=I)return 0;if(ie>=fe)return-1;if(k>=I)return 1;if(k>>>=0,I>>>=0,ie>>>=0,fe>>>=0,this===x)return 0;let oe=fe-ie,at=I-k;const dn=Math.min(oe,at),$t=this.slice(ie,fe),Dt=x.slice(k,I);for(let Ct=0;Ct<dn;++Ct)if($t[Ct]!==Dt[Ct]){oe=$t[Ct],at=Dt[Ct];break}return oe<at?-1:at<oe?1:0};function P(L,x,k,I,ie){if(L.length===0)return-1;if(typeof k=="string"?(I=k,k=0):k>2147483647?k=2147483647:k<-2147483648&&(k=-2147483648),k=+k,wr(k)&&(k=ie?0:L.length-1),k<0&&(k=L.length+k),k>=L.length){if(ie)return-1;k=L.length-1}else if(k<0)if(ie)k=0;else return-1;if(typeof x=="string"&&(x=a.from(x,I)),a.isBuffer(x))return x.length===0?-1:D(L,x,k,I,ie);if(typeof x=="number")return x=x&255,typeof Uint8Array.prototype.indexOf=="function"?ie?Uint8Array.prototype.indexOf.call(L,x,k):Uint8Array.prototype.lastIndexOf.call(L,x,k):D(L,[x],k,I,ie);throw new TypeError("val must be string, number or Buffer")}function D(L,x,k,I,ie){let fe=1,oe=L.length,at=x.length;if(I!==void 0&&(I=String(I).toLowerCase(),I==="ucs2"||I==="ucs-2"||I==="utf16le"||I==="utf-16le")){if(L.length<2||x.length<2)return-1;fe=2,oe/=2,at/=2,k/=2}function dn(Dt,Ct){return fe===1?Dt[Ct]:Dt.readUInt16BE(Ct*fe)}let $t;if(ie){let Dt=-1;for($t=k;$t<oe;$t++)if(dn(L,$t)===dn(x,Dt===-1?0:$t-Dt)){if(Dt===-1&&(Dt=$t),$t-Dt+1===at)return Dt*fe}else Dt!==-1&&($t-=$t-Dt),Dt=-1}else for(k+at>oe&&(k=oe-at),$t=k;$t>=0;$t--){let Dt=!0;for(let Ct=0;Ct<at;Ct++)if(dn(L,$t+Ct)!==dn(x,Ct)){Dt=!1;break}if(Dt)return $t}return-1}a.prototype.includes=function(x,k,I){return this.indexOf(x,k,I)!==-1},a.prototype.indexOf=function(x,k,I){return P(this,x,k,I,!0)},a.prototype.lastIndexOf=function(x,k,I){return P(this,x,k,I,!1)};function Y(L,x,k,I){k=Number(k)||0;const ie=L.length-k;I?(I=Number(I),I>ie&&(I=ie)):I=ie;const fe=x.length;I>fe/2&&(I=fe/2);let oe;for(oe=0;oe<I;++oe){const at=parseInt(x.substr(oe*2,2),16);if(wr(at))return oe;L[k+oe]=at}return oe}function X(L,x,k,I){return ht(me(x,L.length-k),L,k,I)}function $(L,x,k,I){return ht(Oe(x),L,k,I)}function te(L,x,k,I){return ht(xt(x),L,k,I)}function _e(L,x,k,I){return ht(nt(x,L.length-k),L,k,I)}a.prototype.write=function(x,k,I,ie){if(k===void 0)ie="utf8",I=this.length,k=0;else if(I===void 0&&typeof k=="string")ie=k,I=this.length,k=0;else if(isFinite(k))k=k>>>0,isFinite(I)?(I=I>>>0,ie===void 0&&(ie="utf8")):(ie=I,I=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const fe=this.length-k;if((I===void 0||I>fe)&&(I=fe),x.length>0&&(I<0||k<0)||k>this.length)throw new RangeError("Attempt to write outside buffer bounds");ie||(ie="utf8");let oe=!1;for(;;)switch(ie){case"hex":return Y(this,x,k,I);case"utf8":case"utf-8":return X(this,x,k,I);case"ascii":case"latin1":case"binary":return $(this,x,k,I);case"base64":return te(this,x,k,I);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _e(this,x,k,I);default:if(oe)throw new TypeError("Unknown encoding: "+ie);ie=(""+ie).toLowerCase(),oe=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ae(L,x,k){return x===0&&k===L.length?e.fromByteArray(L):e.fromByteArray(L.slice(x,k))}function re(L,x,k){k=Math.min(L.length,k);const I=[];let ie=x;for(;ie<k;){const fe=L[ie];let oe=null,at=fe>239?4:fe>223?3:fe>191?2:1;if(ie+at<=k){let dn,$t,Dt,Ct;switch(at){case 1:fe<128&&(oe=fe);break;case 2:dn=L[ie+1],(dn&192)===128&&(Ct=(fe&31)<<6|dn&63,Ct>127&&(oe=Ct));break;case 3:dn=L[ie+1],$t=L[ie+2],(dn&192)===128&&($t&192)===128&&(Ct=(fe&15)<<12|(dn&63)<<6|$t&63,Ct>2047&&(Ct<55296||Ct>57343)&&(oe=Ct));break;case 4:dn=L[ie+1],$t=L[ie+2],Dt=L[ie+3],(dn&192)===128&&($t&192)===128&&(Dt&192)===128&&(Ct=(fe&15)<<18|(dn&63)<<12|($t&63)<<6|Dt&63,Ct>65535&&Ct<1114112&&(oe=Ct))}}oe===null?(oe=65533,at=1):oe>65535&&(oe-=65536,I.push(oe>>>10&1023|55296),oe=56320|oe&1023),I.push(oe),ie+=at}return we(I)}const se=4096;function we(L){const x=L.length;if(x<=se)return String.fromCharCode.apply(String,L);let k="",I=0;for(;I<x;)k+=String.fromCharCode.apply(String,L.slice(I,I+=se));return k}function Ce(L,x,k){let I="";k=Math.min(L.length,k);for(let ie=x;ie<k;++ie)I+=String.fromCharCode(L[ie]&127);return I}function Ze(L,x,k){let I="";k=Math.min(L.length,k);for(let ie=x;ie<k;++ie)I+=String.fromCharCode(L[ie]);return I}function Ee(L,x,k){const I=L.length;(!x||x<0)&&(x=0),(!k||k<0||k>I)&&(k=I);let ie="";for(let fe=x;fe<k;++fe)ie+=Si[L[fe]];return ie}function Ve(L,x,k){const I=L.slice(x,k);let ie="";for(let fe=0;fe<I.length-1;fe+=2)ie+=String.fromCharCode(I[fe]+I[fe+1]*256);return ie}a.prototype.slice=function(x,k){const I=this.length;x=~~x,k=k===void 0?I:~~k,x<0?(x+=I,x<0&&(x=0)):x>I&&(x=I),k<0?(k+=I,k<0&&(k=0)):k>I&&(k=I),k<x&&(k=x);const ie=this.subarray(x,k);return Object.setPrototypeOf(ie,a.prototype),ie};function Ge(L,x,k){if(L%1!==0||L<0)throw new RangeError("offset is not uint");if(L+x>k)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(x,k,I){x=x>>>0,k=k>>>0,I||Ge(x,k,this.length);let ie=this[x],fe=1,oe=0;for(;++oe<k&&(fe*=256);)ie+=this[x+oe]*fe;return ie},a.prototype.readUintBE=a.prototype.readUIntBE=function(x,k,I){x=x>>>0,k=k>>>0,I||Ge(x,k,this.length);let ie=this[x+--k],fe=1;for(;k>0&&(fe*=256);)ie+=this[x+--k]*fe;return ie},a.prototype.readUint8=a.prototype.readUInt8=function(x,k){return x=x>>>0,k||Ge(x,1,this.length),this[x]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(x,k){return x=x>>>0,k||Ge(x,2,this.length),this[x]|this[x+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(x,k){return x=x>>>0,k||Ge(x,2,this.length),this[x]<<8|this[x+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(x,k){return x=x>>>0,k||Ge(x,4,this.length),(this[x]|this[x+1]<<8|this[x+2]<<16)+this[x+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(x,k){return x=x>>>0,k||Ge(x,4,this.length),this[x]*16777216+(this[x+1]<<16|this[x+2]<<8|this[x+3])},a.prototype.readBigUInt64LE=ke(function(x){x=x>>>0,O(x,"offset");const k=this[x],I=this[x+7];(k===void 0||I===void 0)&&z(x,this.length-8);const ie=k+this[++x]*2**8+this[++x]*2**16+this[++x]*2**24,fe=this[++x]+this[++x]*2**8+this[++x]*2**16+I*2**24;return BigInt(ie)+(BigInt(fe)<<BigInt(32))}),a.prototype.readBigUInt64BE=ke(function(x){x=x>>>0,O(x,"offset");const k=this[x],I=this[x+7];(k===void 0||I===void 0)&&z(x,this.length-8);const ie=k*2**24+this[++x]*2**16+this[++x]*2**8+this[++x],fe=this[++x]*2**24+this[++x]*2**16+this[++x]*2**8+I;return(BigInt(ie)<<BigInt(32))+BigInt(fe)}),a.prototype.readIntLE=function(x,k,I){x=x>>>0,k=k>>>0,I||Ge(x,k,this.length);let ie=this[x],fe=1,oe=0;for(;++oe<k&&(fe*=256);)ie+=this[x+oe]*fe;return fe*=128,ie>=fe&&(ie-=Math.pow(2,8*k)),ie},a.prototype.readIntBE=function(x,k,I){x=x>>>0,k=k>>>0,I||Ge(x,k,this.length);let ie=k,fe=1,oe=this[x+--ie];for(;ie>0&&(fe*=256);)oe+=this[x+--ie]*fe;return fe*=128,oe>=fe&&(oe-=Math.pow(2,8*k)),oe},a.prototype.readInt8=function(x,k){return x=x>>>0,k||Ge(x,1,this.length),this[x]&128?(255-this[x]+1)*-1:this[x]},a.prototype.readInt16LE=function(x,k){x=x>>>0,k||Ge(x,2,this.length);const I=this[x]|this[x+1]<<8;return I&32768?I|4294901760:I},a.prototype.readInt16BE=function(x,k){x=x>>>0,k||Ge(x,2,this.length);const I=this[x+1]|this[x]<<8;return I&32768?I|4294901760:I},a.prototype.readInt32LE=function(x,k){return x=x>>>0,k||Ge(x,4,this.length),this[x]|this[x+1]<<8|this[x+2]<<16|this[x+3]<<24},a.prototype.readInt32BE=function(x,k){return x=x>>>0,k||Ge(x,4,this.length),this[x]<<24|this[x+1]<<16|this[x+2]<<8|this[x+3]},a.prototype.readBigInt64LE=ke(function(x){x=x>>>0,O(x,"offset");const k=this[x],I=this[x+7];(k===void 0||I===void 0)&&z(x,this.length-8);const ie=this[x+4]+this[x+5]*2**8+this[x+6]*2**16+(I<<24);return(BigInt(ie)<<BigInt(32))+BigInt(k+this[++x]*2**8+this[++x]*2**16+this[++x]*2**24)}),a.prototype.readBigInt64BE=ke(function(x){x=x>>>0,O(x,"offset");const k=this[x],I=this[x+7];(k===void 0||I===void 0)&&z(x,this.length-8);const ie=(k<<24)+this[++x]*2**16+this[++x]*2**8+this[++x];return(BigInt(ie)<<BigInt(32))+BigInt(this[++x]*2**24+this[++x]*2**16+this[++x]*2**8+I)}),a.prototype.readFloatLE=function(x,k){return x=x>>>0,k||Ge(x,4,this.length),n.read(this,x,!0,23,4)},a.prototype.readFloatBE=function(x,k){return x=x>>>0,k||Ge(x,4,this.length),n.read(this,x,!1,23,4)},a.prototype.readDoubleLE=function(x,k){return x=x>>>0,k||Ge(x,8,this.length),n.read(this,x,!0,52,8)},a.prototype.readDoubleBE=function(x,k){return x=x>>>0,k||Ge(x,8,this.length),n.read(this,x,!1,52,8)};function tt(L,x,k,I,ie,fe){if(!a.isBuffer(L))throw new TypeError('"buffer" argument must be a Buffer instance');if(x>ie||x<fe)throw new RangeError('"value" argument is out of bounds');if(k+I>L.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(x,k,I,ie){if(x=+x,k=k>>>0,I=I>>>0,!ie){const at=Math.pow(2,8*I)-1;tt(this,x,k,I,at,0)}let fe=1,oe=0;for(this[k]=x&255;++oe<I&&(fe*=256);)this[k+oe]=x/fe&255;return k+I},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(x,k,I,ie){if(x=+x,k=k>>>0,I=I>>>0,!ie){const at=Math.pow(2,8*I)-1;tt(this,x,k,I,at,0)}let fe=I-1,oe=1;for(this[k+fe]=x&255;--fe>=0&&(oe*=256);)this[k+fe]=x/oe&255;return k+I},a.prototype.writeUint8=a.prototype.writeUInt8=function(x,k,I){return x=+x,k=k>>>0,I||tt(this,x,k,1,255,0),this[k]=x&255,k+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(x,k,I){return x=+x,k=k>>>0,I||tt(this,x,k,2,65535,0),this[k]=x&255,this[k+1]=x>>>8,k+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(x,k,I){return x=+x,k=k>>>0,I||tt(this,x,k,2,65535,0),this[k]=x>>>8,this[k+1]=x&255,k+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(x,k,I){return x=+x,k=k>>>0,I||tt(this,x,k,4,4294967295,0),this[k+3]=x>>>24,this[k+2]=x>>>16,this[k+1]=x>>>8,this[k]=x&255,k+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(x,k,I){return x=+x,k=k>>>0,I||tt(this,x,k,4,4294967295,0),this[k]=x>>>24,this[k+1]=x>>>16,this[k+2]=x>>>8,this[k+3]=x&255,k+4};function rn(L,x,k,I,ie){N(x,I,ie,L,k,7);let fe=Number(x&BigInt(4294967295));L[k++]=fe,fe=fe>>8,L[k++]=fe,fe=fe>>8,L[k++]=fe,fe=fe>>8,L[k++]=fe;let oe=Number(x>>BigInt(32)&BigInt(4294967295));return L[k++]=oe,oe=oe>>8,L[k++]=oe,oe=oe>>8,L[k++]=oe,oe=oe>>8,L[k++]=oe,k}function St(L,x,k,I,ie){N(x,I,ie,L,k,7);let fe=Number(x&BigInt(4294967295));L[k+7]=fe,fe=fe>>8,L[k+6]=fe,fe=fe>>8,L[k+5]=fe,fe=fe>>8,L[k+4]=fe;let oe=Number(x>>BigInt(32)&BigInt(4294967295));return L[k+3]=oe,oe=oe>>8,L[k+2]=oe,oe=oe>>8,L[k+1]=oe,oe=oe>>8,L[k]=oe,k+8}a.prototype.writeBigUInt64LE=ke(function(x,k=0){return rn(this,x,k,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=ke(function(x,k=0){return St(this,x,k,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(x,k,I,ie){if(x=+x,k=k>>>0,!ie){const dn=Math.pow(2,8*I-1);tt(this,x,k,I,dn-1,-dn)}let fe=0,oe=1,at=0;for(this[k]=x&255;++fe<I&&(oe*=256);)x<0&&at===0&&this[k+fe-1]!==0&&(at=1),this[k+fe]=(x/oe>>0)-at&255;return k+I},a.prototype.writeIntBE=function(x,k,I,ie){if(x=+x,k=k>>>0,!ie){const dn=Math.pow(2,8*I-1);tt(this,x,k,I,dn-1,-dn)}let fe=I-1,oe=1,at=0;for(this[k+fe]=x&255;--fe>=0&&(oe*=256);)x<0&&at===0&&this[k+fe+1]!==0&&(at=1),this[k+fe]=(x/oe>>0)-at&255;return k+I},a.prototype.writeInt8=function(x,k,I){return x=+x,k=k>>>0,I||tt(this,x,k,1,127,-128),x<0&&(x=255+x+1),this[k]=x&255,k+1},a.prototype.writeInt16LE=function(x,k,I){return x=+x,k=k>>>0,I||tt(this,x,k,2,32767,-32768),this[k]=x&255,this[k+1]=x>>>8,k+2},a.prototype.writeInt16BE=function(x,k,I){return x=+x,k=k>>>0,I||tt(this,x,k,2,32767,-32768),this[k]=x>>>8,this[k+1]=x&255,k+2},a.prototype.writeInt32LE=function(x,k,I){return x=+x,k=k>>>0,I||tt(this,x,k,4,2147483647,-2147483648),this[k]=x&255,this[k+1]=x>>>8,this[k+2]=x>>>16,this[k+3]=x>>>24,k+4},a.prototype.writeInt32BE=function(x,k,I){return x=+x,k=k>>>0,I||tt(this,x,k,4,2147483647,-2147483648),x<0&&(x=4294967295+x+1),this[k]=x>>>24,this[k+1]=x>>>16,this[k+2]=x>>>8,this[k+3]=x&255,k+4},a.prototype.writeBigInt64LE=ke(function(x,k=0){return rn(this,x,k,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=ke(function(x,k=0){return St(this,x,k,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function cn(L,x,k,I,ie,fe){if(k+I>L.length)throw new RangeError("Index out of range");if(k<0)throw new RangeError("Index out of range")}function _r(L,x,k,I,ie){return x=+x,k=k>>>0,ie||cn(L,x,k,4),n.write(L,x,k,I,23,4),k+4}a.prototype.writeFloatLE=function(x,k,I){return _r(this,x,k,!0,I)},a.prototype.writeFloatBE=function(x,k,I){return _r(this,x,k,!1,I)};function Fn(L,x,k,I,ie){return x=+x,k=k>>>0,ie||cn(L,x,k,8),n.write(L,x,k,I,52,8),k+8}a.prototype.writeDoubleLE=function(x,k,I){return Fn(this,x,k,!0,I)},a.prototype.writeDoubleBE=function(x,k,I){return Fn(this,x,k,!1,I)},a.prototype.copy=function(x,k,I,ie){if(!a.isBuffer(x))throw new TypeError("argument should be a Buffer");if(I||(I=0),!ie&&ie!==0&&(ie=this.length),k>=x.length&&(k=x.length),k||(k=0),ie>0&&ie<I&&(ie=I),ie===I||x.length===0||this.length===0)return 0;if(k<0)throw new RangeError("targetStart out of bounds");if(I<0||I>=this.length)throw new RangeError("Index out of range");if(ie<0)throw new RangeError("sourceEnd out of bounds");ie>this.length&&(ie=this.length),x.length-k<ie-I&&(ie=x.length-k+I);const fe=ie-I;return this===x&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(k,I,ie):Uint8Array.prototype.set.call(x,this.subarray(I,ie),k),fe},a.prototype.fill=function(x,k,I,ie){if(typeof x=="string"){if(typeof k=="string"?(ie=k,k=0,I=this.length):typeof I=="string"&&(ie=I,I=this.length),ie!==void 0&&typeof ie!="string")throw new TypeError("encoding must be a string");if(typeof ie=="string"&&!a.isEncoding(ie))throw new TypeError("Unknown encoding: "+ie);if(x.length===1){const oe=x.charCodeAt(0);(ie==="utf8"&&oe<128||ie==="latin1")&&(x=oe)}}else typeof x=="number"?x=x&255:typeof x=="boolean"&&(x=Number(x));if(k<0||this.length<k||this.length<I)throw new RangeError("Out of range index");if(I<=k)return this;k=k>>>0,I=I===void 0?this.length:I>>>0,x||(x=0);let fe;if(typeof x=="number")for(fe=k;fe<I;++fe)this[fe]=x;else{const oe=a.isBuffer(x)?x:a.from(x,ie),at=oe.length;if(at===0)throw new TypeError('The value "'+x+'" is invalid for argument "value"');for(fe=0;fe<I-k;++fe)this[fe+k]=oe[fe%at]}return this};const ln={};function vn(L,x,k){ln[L]=class extends k{constructor(){super(),Object.defineProperty(this,"message",{value:x.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${L}]`,this.stack,delete this.name}get code(){return L}set code(ie){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ie,writable:!0})}toString(){return`${this.name} [${L}]: ${this.message}`}}}vn("ERR_BUFFER_OUT_OF_BOUNDS",function(L){return L?`${L} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),vn("ERR_INVALID_ARG_TYPE",function(L,x){return`The "${L}" argument must be of type number. Received type ${typeof x}`},TypeError),vn("ERR_OUT_OF_RANGE",function(L,x,k){let I=`The value of "${L}" is out of range.`,ie=k;return Number.isInteger(k)&&Math.abs(k)>2**32?ie=Mt(String(k)):typeof k=="bigint"&&(ie=String(k),(k>BigInt(2)**BigInt(32)||k<-(BigInt(2)**BigInt(32)))&&(ie=Mt(ie)),ie+="n"),I+=` It must be ${x}. Received ${ie}`,I},RangeError);function Mt(L){let x="",k=L.length;const I=L[0]==="-"?1:0;for(;k>=I+4;k-=3)x=`_${L.slice(k-3,k)}${x}`;return`${L.slice(0,k)}${x}`}function Q(L,x,k){O(x,"offset"),(L[x]===void 0||L[x+k]===void 0)&&z(x,L.length-(k+1))}function N(L,x,k,I,ie,fe){if(L>k||L<x){const oe=typeof x=="bigint"?"n":"";let at;throw fe>3?x===0||x===BigInt(0)?at=`>= 0${oe} and < 2${oe} ** ${(fe+1)*8}${oe}`:at=`>= -(2${oe} ** ${(fe+1)*8-1}${oe}) and < 2 ** ${(fe+1)*8-1}${oe}`:at=`>= ${x}${oe} and <= ${k}${oe}`,new ln.ERR_OUT_OF_RANGE("value",at,L)}Q(I,ie,fe)}function O(L,x){if(typeof L!="number")throw new ln.ERR_INVALID_ARG_TYPE(x,"number",L)}function z(L,x,k){throw Math.floor(L)!==L?(O(L,k),new ln.ERR_OUT_OF_RANGE(k||"offset","an integer",L)):x<0?new ln.ERR_BUFFER_OUT_OF_BOUNDS:new ln.ERR_OUT_OF_RANGE(k||"offset",`>= ${k?1:0} and <= ${x}`,L)}const ee=/[^+/0-9A-Za-z-_]/g;function de(L){if(L=L.split("=")[0],L=L.trim().replace(ee,""),L.length<2)return"";for(;L.length%4!==0;)L=L+"=";return L}function me(L,x){x=x||1/0;let k;const I=L.length;let ie=null;const fe=[];for(let oe=0;oe<I;++oe){if(k=L.charCodeAt(oe),k>55295&&k<57344){if(!ie){if(k>56319){(x-=3)>-1&&fe.push(239,191,189);continue}else if(oe+1===I){(x-=3)>-1&&fe.push(239,191,189);continue}ie=k;continue}if(k<56320){(x-=3)>-1&&fe.push(239,191,189),ie=k;continue}k=(ie-55296<<10|k-56320)+65536}else ie&&(x-=3)>-1&&fe.push(239,191,189);if(ie=null,k<128){if((x-=1)<0)break;fe.push(k)}else if(k<2048){if((x-=2)<0)break;fe.push(k>>6|192,k&63|128)}else if(k<65536){if((x-=3)<0)break;fe.push(k>>12|224,k>>6&63|128,k&63|128)}else if(k<1114112){if((x-=4)<0)break;fe.push(k>>18|240,k>>12&63|128,k>>6&63|128,k&63|128)}else throw new Error("Invalid code point")}return fe}function Oe(L){const x=[];for(let k=0;k<L.length;++k)x.push(L.charCodeAt(k)&255);return x}function nt(L,x){let k,I,ie;const fe=[];for(let oe=0;oe<L.length&&!((x-=2)<0);++oe)k=L.charCodeAt(oe),I=k>>8,ie=k%256,fe.push(ie),fe.push(I);return fe}function xt(L){return e.toByteArray(de(L))}function ht(L,x,k,I){let ie;for(ie=0;ie<I&&!(ie+k>=x.length||ie>=L.length);++ie)x[ie+k]=L[ie];return ie}function pt(L,x){return L instanceof x||L!=null&&L.constructor!=null&&L.constructor.name!=null&&L.constructor.name===x.name}function wr(L){return L!==L}const Si=function(){const L="0123456789abcdef",x=new Array(256);for(let k=0;k<16;++k){const I=k*16;for(let ie=0;ie<16;++ie)x[I+ie]=L[k]+L[ie]}return x}();function ke(L){return typeof BigInt=="undefined"?un:L}function un(){throw new Error("BigInt not supported")}})(Ls);var ck=/^utf-?8|ascii|utf-?16-?le|ucs-?2|base-?64|latin-?1$/i,lk=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,uk=/\s|\uFEFF|\xA0/,dk=/\r?\n[\x20\x09]+/g,fk=/[;,"]/,hk=/[;,"]|\s/,pk=/^[!#$%&'*+\-\.^_`|~\da-zA-Z]+$/,Zo={IDLE:1<<0,URI:1<<1,ATTR:1<<2};function r_(t){return t.replace(lk,"")}function sd(t){return uk.test(t)}function gk(t,e){for(;sd(t[e]);)e++;return e}function i_(t){return hk.test(t)||!pk.test(t)}class gn{constructor(e){this.refs=[],e&&this.parse(e)}rel(e){for(var n=[],r=e.toLowerCase(),i=0;i<this.refs.length;i++)this.refs[i].rel.toLowerCase()===r&&n.push(this.refs[i]);return n}get(e,n){e=e.toLowerCase();for(var r=[],i=0;i<this.refs.length;i++)this.refs[i][e]===n&&r.push(this.refs[i]);return r}set(e){return this.refs.push(e),this}has(e,n){e=e.toLowerCase();for(var r=0;r<this.refs.length;r++)if(this.refs[r][e]===n)return!0;return!1}parse(e,o){o=o||0,e=o?e.slice(o):e,e=r_(e).replace(dk,"");for(var r=Zo.IDLE,i=e.length,o=0,s=null;o<i;)if(r===Zo.IDLE){if(sd(e[o])){o++;continue}else if(e[o]==="<"){s!=null&&(s.rel!=null?this.refs.push(...gn.expandRelations(s)):this.refs.push(s));var a=e.indexOf(">",o);if(a===-1)throw new Error("Expected end of URI delimiter at offset "+o);s={uri:e.slice(o+1,a)},o=a,r=Zo.URI}else throw new Error('Unexpected character "'+e[o]+'" at offset '+o);o++}else if(r===Zo.URI)if(sd(e[o])){o++;continue}else if(e[o]===";")r=Zo.ATTR,o++;else if(e[o]===",")r=Zo.IDLE,o++;else throw new Error('Unexpected character "'+e[o]+'" at offset '+o);else if(r===Zo.ATTR){if(e[o]===";"||sd(e[o])){o++;continue}var a=e.indexOf("=",o);if(a===-1)throw new Error("Expected attribute delimiter at offset "+o);var c=r_(e.slice(o,a)).toLowerCase(),l="";if(o=a+1,o=gk(e,o),e[o]==='"')for(o++;o<i;){if(e[o]==='"'){o++;break}e[o]==="\\"&&o++,l+=e[o],o++}else{for(var a=o+1;!fk.test(e[a])&&a<i;)a++;l=e.slice(o,a),o=a}switch(s[c]&&gn.isSingleOccurenceAttr(c)||(c[c.length-1]==="*"?s[c]=gn.parseExtendedValue(l):(l=c==="type"?l.toLowerCase():l,s[c]!=null?Array.isArray(s[c])?s[c].push(l):s[c]=[s[c],l]:s[c]=l)),e[o]){case",":r=Zo.IDLE;break;case";":r=Zo.ATTR;break}o++}else throw new Error('Unknown parser state "'+r+'"');return s!=null&&(s.rel!=null?this.refs.push(...gn.expandRelations(s)):this.refs.push(s)),s=null,this}toString(){for(var e=[],n="",r=null,i=0;i<this.refs.length;i++)r=this.refs[i],n=Object.keys(this.refs[i]).reduce(function(o,s){return s==="uri"?o:o+"; "+gn.formatAttribute(s,r[s])},"<"+r.uri+">"),e.push(n);return e.join(", ")}}gn.isCompatibleEncoding=function(t){return ck.test(t)};gn.parse=function(t,e){return new gn().parse(t,e)};gn.isSingleOccurenceAttr=function(t){return t==="rel"||t==="type"||t==="media"||t==="title"||t==="title*"};gn.isTokenAttr=function(t){return t==="rel"||t==="type"||t==="anchor"};gn.escapeQuotes=function(t){return t.replace(/"/g,'\\"')};gn.expandRelations=function(t){var e=t.rel.split(" ");return e.map(function(n){var r=Object.assign({},t);return r.rel=n,r})};gn.parseExtendedValue=function(t){var e=/([^']+)?(?:'([^']*)')?(.+)/.exec(t);return{language:e[2].toLowerCase(),encoding:gn.isCompatibleEncoding(e[1])?null:e[1].toLowerCase(),value:gn.isCompatibleEncoding(e[1])?decodeURIComponent(e[3]):e[3]}};gn.formatExtendedAttribute=function(t,e){var n=(e.encoding||"utf-8").toUpperCase(),r=e.language||"en",i="";return Ls.Buffer.isBuffer(e.value)&&gn.isCompatibleEncoding(n)?i=e.value.toString(n):Ls.Buffer.isBuffer(e.value)?i=e.value.toString("hex").replace(/[0-9a-f]{2}/gi,"%$1"):i=encodeURIComponent(e.value),t+"="+n+"'"+r+"'"+i};gn.formatAttribute=function(t,e){return Array.isArray(e)?e.map(n=>gn.formatAttribute(t,n)).join("; "):t[t.length-1]==="*"||typeof e!="string"?gn.formatExtendedAttribute(t,e):(gn.isTokenAttr(t)?e=i_(e)?'"'+gn.escapeQuotes(e)+'"':gn.escapeQuotes(e):i_(e)&&(e=encodeURIComponent(e),e=e.replace(/%20/g," ").replace(/%2C/g,",").replace(/%3B/g,";"),e='"'+e+'"'),t+"="+e)};var mk=gn;class fu{constructor(e){this.value=e||"b"+ ++fu.nextId}equals(e){return!!e&&e.termType===this.termType&&e.value===this.value}}fu.prototype.termType="BlankNode";fu.nextId=0;var yk=fu;class j0{equals(e){return!!e&&e.termType===this.termType}}j0.prototype.termType="DefaultGraph";j0.prototype.value="";var y1=j0;function _k(t){if(!t)return null;if(t.termType==="BlankNode")return this.blankNode(t.value);if(t.termType==="DefaultGraph")return this.defaultGraph();if(t.termType==="Literal")return this.literal(t.value,t.language||this.namedNode(t.datatype.value));if(t.termType==="NamedNode")return this.namedNode(t.value);if(t.termType==="Quad"){const e=this.fromTerm(t.subject),n=this.fromTerm(t.predicate),r=this.fromTerm(t.object),i=this.fromTerm(t.graph);return this.quad(e,n,r,i)}if(t.termType==="Variable")return this.variable(t.value);throw new Error(`unknown termType ${t.termType}`)}var wk=_k;class _1{constructor(e){this.value=e}equals(e){return!!e&&e.termType===this.termType&&e.value===this.value}}_1.prototype.termType="NamedNode";var w1=_1;const v1=w1;class Ra{constructor(e,n,r){this.value=e,this.datatype=Ra.stringDatatype,this.language="",n?(this.language=n,this.datatype=Ra.langStringDatatype):r&&(this.datatype=r)}equals(e){return!!e&&e.termType===this.termType&&e.value===this.value&&e.language===this.language&&e.datatype.equals(this.datatype)}}Ra.prototype.termType="Literal";Ra.langStringDatatype=new v1("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString");Ra.stringDatatype=new v1("http://www.w3.org/2001/XMLSchema#string");var vk=Ra;const bk=y1;class $0{constructor(e,n,r,i){this.subject=e,this.predicate=n,this.object=r,i?this.graph=i:this.graph=new bk}equals(e){return!!e&&(e.termType==="Quad"||!e.termType)&&e.subject.equals(this.subject)&&e.predicate.equals(this.predicate)&&e.object.equals(this.object)&&e.graph.equals(this.graph)}}$0.prototype.termType="Quad";$0.prototype.value="";var Ek=$0;class b1{constructor(e){this.value=e}equals(e){return!!e&&e.termType===this.termType&&e.value===this.value}}b1.prototype.termType="Variable";var Sk=b1;const Tk=yk,Ak=y1,E1=wk,Uh=vk,xk=w1,Ik=Ek,Rk=Sk;function kk(t){return new xk(t)}function Fk(t){return new Tk(t)}function Dk(t,e){return typeof e=="string"?e.indexOf(":")===-1?new Uh(t,e):new Uh(t,null,ja.namedNode(e)):new Uh(t,null,e)}function Ck(t){return new Rk(t)}function Pk(){return ja.defaultGraphInstance}function Nk(t,e,n){return ja.quad(t,e,n)}function Ok(t,e,n,r){return new Ik(t,e,n,r||ja.defaultGraphInstance)}function Mk(t){return E1.call(ja,t)}function Lk(t){return E1.call(ja,t)}const ja={namedNode:kk,blankNode:Fk,literal:Dk,variable:Ck,defaultGraph:Pk,triple:Nk,quad:Ok,fromTerm:Mk,fromQuad:Lk,defaultGraphInstance:new Ak};var Uk=ja;const jk=Uk;var If=jk;function ea(t){return typeof t=="string"||t instanceof String}const $k="http://www.w3.org/2001/XMLSchema#string";function Zn(t){if(typeof t=="string")return t;if(!t)return"";if(typeof t.id!="undefined"&&t.termType!=="Quad")return t.id;let e,n,r,i;switch(t.termType){case"NamedNode":return t.value;case"BlankNode":return`_:${t.value}`;case"Variable":return`?${t.value}`;case"DefaultGraph":return"";case"Literal":return t.language?`"${t.value}"@${t.language}`:`"${t.value}"${t.datatype&&t.datatype.value!==$k?`^^${t.datatype.value}`:""}`;case"Quad":return e=jh(Zn(t.subject)),n=jh(Zn(t.predicate)),r=jh(Zn(t.object)),i=t.graph.termType==="DefaultGraph"?"":` ${Zn(t.graph)}`,`<<${e} ${n} ${r}${i}>>`;default:throw new Error(`Unexpected termType: ${t.termType}`)}}const Bk=/^"(.*".*)(?="[^"]*$)/;function jh(t){return t.replace(Bk,(e,n)=>`"${n.replace(/"/g,'""')}`)}class Hk{constructor(e){if(this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._quads=new Map,e)for(const n of e)this.add(n)}get size(){let e=this._size;if(e!==null)return e;e=0;const n=this._graphs;let r,i;for(const o in n)for(const s in r=n[o].subjects)for(const a in i=r[s])e+=Object.keys(i[a]).length;return this._size=e,this._size}add(e){let n=Zn(e.subject),r=Zn(e.predicate),i=Zn(e.object);const o=Zn(e.graph);let s=this._graphs[o];s||(s=this._graphs[o]={subjects:{},predicates:{},objects:{}},Object.freeze(s));const a=this._ids,c=this._entities;return n=a[n]||(a[c[++this._id]=n]=this._id),r=a[r]||(a[c[++this._id]=r]=this._id),i=a[i]||(a[c[++this._id]=i]=this._id),this._addToIndex(s.subjects,n,r,i),this._addToIndex(s.predicates,r,i,n),this._addToIndex(s.objects,i,n,r),this._setQuad(n,r,i,o,e),this._size=null,this}delete(e){let n=Zn(e.subject),r=Zn(e.predicate),i=Zn(e.object);const o=Zn(e.graph),s=this._ids,a=this._graphs;let c,l,u;if(!(n=s[n])||!(r=s[r])||!(i=s[i])||!(c=a[o])||!(l=c.subjects[n])||!(u=l[r])||!(i in u))return this;this._removeFromIndex(c.subjects,n,r,i),this._removeFromIndex(c.predicates,r,i,n),this._removeFromIndex(c.objects,i,n,r),this._size!==null&&this._size--,this._deleteQuad(n,r,i,o);for(n in c.subjects)return this;return delete a[o],this}has(e){const n=Zn(e.subject),r=Zn(e.predicate),i=Zn(e.object),o=Zn(e.graph),s=this._graphs[o];if(!s)return!1;const a=this._ids;let c,l,u;return ea(n)&&!(c=a[n])||ea(r)&&!(l=a[r])||ea(i)&&!(u=a[i])?!1:this._countInIndex(s.objects,u,c,l)===1}match(e,n,r,i){return this._createDataset(this._match(e,n,r,i))}[Symbol.iterator](){return this._match()[Symbol.iterator]()}_addToIndex(e,n,r,i){const o=e[n]||(e[n]={}),s=o[r]||(o[r]={}),a=i in s;return a||(s[i]=null),!a}_removeFromIndex(e,n,r,i){const o=e[n],s=o[r];delete s[i];for(const a in s)return;delete o[r];for(const a in o)return;delete e[n]}_findInIndex(e,n,r,i,o,s,a,c,l,u){let d,g,p;n&&((d=e,e={})[n]=d[n]);for(const y in e)if(g=e[y],g){r&&((d=g,g={})[r]=d[r]);for(const w in g)if(p=g[w],p){const E=i?i in p?[i]:[]:Object.keys(p);for(let b=0;b<E.length;b++){const S={[o]:y,[s]:w,[a]:E[b]},R=this._getQuad(S.subject,S.predicate,S.object,c);if(u)u.push(R);else if(l(R))return!0}}}return u}_countInIndex(e,n,r,i){let o=0,s,a,c;n&&((s=e,e={})[n]=s[n]);for(const l in e)if(a=e[l],a){r&&((s=a,a={})[r]=s[r]);for(const u in a)c=a[u],c&&(i?i in c&&o++:o+=Object.keys(c).length)}return o}_getGraphs(e){return ea(e)?{[e]:this._graphs[e]}:this._graphs}_match(e,n,r,i){e=e&&Zn(e),n=n&&Zn(n),r=r&&Zn(r),i=i&&Zn(i);const o=[],s=this._getGraphs(i),a=this._ids;let c,l,u,d;if(ea(e)&&!(l=a[e])||ea(n)&&!(u=a[n])||ea(r)&&!(d=a[r]))return o;for(const g in s)c=s[g],c&&(l?d?this._findInIndex(c.objects,d,l,u,"object","subject","predicate",g,null,o):this._findInIndex(c.subjects,l,u,null,"subject","predicate","object",g,null,o):u?this._findInIndex(c.predicates,u,d,null,"predicate","object","subject",g,null,o):d?this._findInIndex(c.objects,d,null,null,"object","subject","predicate",g,null,o):this._findInIndex(c.subjects,null,null,null,"subject","predicate","object",g,null,o));return o}_getQuad(e,n,r,i){return this._quads.get(this._toId(e,n,r,i))}_setQuad(e,n,r,i,o){this._quads.set(this._toId(e,n,r,i),o)}_deleteQuad(e,n,r,i){this._quads.delete(this._toId(e,n,r,i))}_createDataset(e){return new this.constructor(e)}_toId(e,n,r,i){return`${e}:${n}:${r}:${i}`}}var Kk=Hk;const Wk=If,qk=Kk;function Vk(t){return new qk(t)}var S1=Object.assign({dataset:Vk},Wk),B0=class T1{constructor(e,n=new Map,r=0){this.prefix=e,this._existing=n,this.counter=r}clone(){const{prefix:e,_existing:n,counter:r}=this;return new T1(e,new Map(n),r)}getId(e){const n=e&&this._existing.get(e);if(n)return n;const r=this.prefix+this.counter;return this.counter++,e&&this._existing.set(e,r),r}hasId(e){return this._existing.has(e)}getOldIds(){return[...this._existing.keys()]}},A1={exports:{}},Yn=A1.exports={},So,To;function eg(){throw new Error("setTimeout has not been defined")}function tg(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?So=setTimeout:So=eg}catch{So=eg}try{typeof clearTimeout=="function"?To=clearTimeout:To=tg}catch{To=tg}})();function x1(t){if(So===setTimeout)return setTimeout(t,0);if((So===eg||!So)&&setTimeout)return So=setTimeout,setTimeout(t,0);try{return So(t,0)}catch{try{return So.call(null,t,0)}catch{return So.call(this,t,0)}}}function zk(t){if(To===clearTimeout)return clearTimeout(t);if((To===tg||!To)&&clearTimeout)return To=clearTimeout,clearTimeout(t);try{return To(t)}catch{try{return To.call(null,t)}catch{return To.call(this,t)}}}var as=[],dc=!1,da,ad=-1;function Gk(){!dc||!da||(dc=!1,da.length?as=da.concat(as):ad=-1,as.length&&I1())}function I1(){if(!dc){var t=x1(Gk);dc=!0;for(var e=as.length;e;){for(da=as,as=[];++ad<e;)da&&da[ad].run();ad=-1,e=as.length}da=null,dc=!1,zk(t)}}Yn.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];as.push(new R1(t,e)),as.length===1&&!dc&&x1(I1)};function R1(t,e){this.fun=t,this.array=e}R1.prototype.run=function(){this.fun.apply(null,this.array)};Yn.title="browser";Yn.browser=!0;Yn.env={};Yn.argv=[];Yn.version="";Yn.versions={};function gs(){}Yn.on=gs;Yn.addListener=gs;Yn.once=gs;Yn.off=gs;Yn.removeListener=gs;Yn.removeAllListeners=gs;Yn.emit=gs;Yn.prependListener=gs;Yn.prependOnceListener=gs;Yn.listeners=function(t){return[]};Yn.binding=function(t){throw new Error("process.binding is not supported")};Yn.cwd=function(){return"/"};Yn.chdir=function(t){throw new Error("process.chdir is not supported")};Yn.umask=function(){return 0};var qt=A1.exports;(function(t,e){if(t.setImmediate)return;var n=1,r={},i=!1,o=t.document,s;function a(S){typeof S!="function"&&(S=new Function(""+S));for(var R=new Array(arguments.length-1),F=0;F<R.length;F++)R[F]=arguments[F+1];var M={callback:S,args:R};return r[n]=M,s(n),n++}function c(S){delete r[S]}function l(S){var R=S.callback,F=S.args;switch(F.length){case 0:R();break;case 1:R(F[0]);break;case 2:R(F[0],F[1]);break;case 3:R(F[0],F[1],F[2]);break;default:R.apply(e,F);break}}function u(S){if(i)setTimeout(u,0,S);else{var R=r[S];if(R){i=!0;try{l(R)}finally{c(S),i=!1}}}}function d(){s=function(S){qt.nextTick(function(){u(S)})}}function g(){if(t.postMessage&&!t.importScripts){var S=!0,R=t.onmessage;return t.onmessage=function(){S=!1},t.postMessage("","*"),t.onmessage=R,S}}function p(){var S="setImmediate$"+Math.random()+"$",R=function(F){F.source===t&&typeof F.data=="string"&&F.data.indexOf(S)===0&&u(+F.data.slice(S.length))};t.addEventListener?t.addEventListener("message",R,!1):t.attachEvent("onmessage",R),s=function(F){t.postMessage(S+F,"*")}}function y(){var S=new MessageChannel;S.port1.onmessage=function(R){var F=R.data;u(F)},s=function(R){S.port2.postMessage(R)}}function w(){var S=o.documentElement;s=function(R){var F=o.createElement("script");F.onreadystatechange=function(){u(R),F.onreadystatechange=null,S.removeChild(F),F=null},S.appendChild(F)}}function E(){s=function(S){setTimeout(u,0,S)}}var b=Object.getPrototypeOf&&Object.getPrototypeOf(t);b=b&&b.setTimeout?b:t,{}.toString.call(t.process)==="[object process]"?d():g()?p():t.MessageChannel?y():o&&"onreadystatechange"in o.createElement("script")?w():E(),b.setImmediate=a,b.clearImmediate=c})(typeof self=="undefined"?Vt:self);const $h=self.crypto||self.msCrypto;var k1=class{constructor(e){if(!($h&&$h.subtle))throw new Error("crypto.subtle not found.");if(e==="sha256")this.algorithm={name:"SHA-256"};else if(e==="sha1")this.algorithm={name:"SHA-1"};else throw new Error(`Unsupport algorithm "${e}".`);this._content=""}update(e){this._content+=e}async digest(){const e=new TextEncoder().encode(this._content),n=new Uint8Array(await $h.subtle.digest(this.algorithm,e));let r="";for(let i=0;i<n.length;++i)r+=n[i].toString(16).padStart(2,"0");return r}},F1=class{constructor(e){this.current=e.sort(),this.done=!1,this.dir=new Map;for(let n=0;n<e.length;++n)this.dir.set(e[n],!0)}hasNext(){return!this.done}next(){const{current:e,dir:n}=this,r=e.slice();let i=null,o=0;const s=e.length;for(let a=0;a<s;++a){const c=e[a],l=n.get(c);(i===null||c>i)&&(l&&a>0&&c>e[a-1]||!l&&a<s-1&&c>e[a+1])&&(i=c,o=a)}if(i===null)this.done=!0;else{const a=n.get(i)?o-1:o+1;e[o]=e[a],e[a]=i;for(const c of e)c>i&&n.set(c,!n.get(c))}return r}};const Yk="http://www.w3.org/1999/02/22-rdf-syntax-ns#",Bh=Yk+"langString",Hh="http://www.w3.org/2001/XMLSchema#string",no="NamedNode",ta="BlankNode",cd="Literal",o_="DefaultGraph",fc={};(()=>{const t="(?:<([^:]+:[^>]*)>)",n="A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD"+"_",r=n+"0-9-\xB7\u0300-\u036F\u203F-\u2040",o="(_:(?:["+n+"0-9])(?:(?:["+r+".])*(?:["+r+"]))?)",s='"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"',a="(?:\\^\\^"+t+")",c="(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*))",l="(?:"+s+"(?:"+a+"|"+c+")?)",u="[ \\t]+",d="[ \\t]*",g="(?:"+t+"|"+o+")"+u,p=t+u,y="(?:"+t+"|"+o+"|"+l+")"+d,w="(?:\\.|(?:(?:"+t+"|"+o+")"+d+"\\.))";fc.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,fc.empty=new RegExp("^"+d+"$"),fc.quad=new RegExp("^"+d+g+p+y+w+d+"$")})();var H0=class ng{static parse(e){const n=[],r={},i=e.split(fc.eoln);let o=0;for(const s of i){if(o++,fc.empty.test(s))continue;const a=s.match(fc.quad);if(a===null)throw new Error("N-Quads parse error on line "+o+".");const c={subject:null,predicate:null,object:null,graph:null};if(a[1]!==void 0?c.subject={termType:no,value:a[1]}:c.subject={termType:ta,value:a[2]},c.predicate={termType:no,value:a[3]},a[4]!==void 0?c.object={termType:no,value:a[4]}:a[5]!==void 0?c.object={termType:ta,value:a[5]}:(c.object={termType:cd,value:void 0,datatype:{termType:no}},a[7]!==void 0?c.object.datatype.value=a[7]:a[8]!==void 0?(c.object.datatype.value=Bh,c.object.language=a[8]):c.object.datatype.value=Hh,c.object.value=e6(a[6])),a[9]!==void 0?c.graph={termType:no,value:a[9]}:a[10]!==void 0?c.graph={termType:ta,value:a[10]}:c.graph={termType:o_,value:""},!(c.graph.value in r))r[c.graph.value]=[c],n.push(c);else{let l=!0;const u=r[c.graph.value];for(const d of u)if(Jk(d,c)){l=!1;break}l&&(u.push(c),n.push(c))}}return n}static serialize(e){Array.isArray(e)||(e=ng.legacyDatasetToQuads(e));const n=[];for(const r of e)n.push(ng.serializeQuad(r));return n.sort().join("")}static serializeQuad(e){const n=e.subject,r=e.predicate,i=e.object,o=e.graph;let s="";return n.termType===no?s+=`<${n.value}>`:s+=`${n.value}`,s+=` <${r.value}> `,i.termType===no?s+=`<${i.value}>`:i.termType===ta?s+=i.value:(s+=`"${Qk(i.value)}"`,i.datatype.value===Bh?i.language&&(s+=`@${i.language}`):i.datatype.value!==Hh&&(s+=`^^<${i.datatype.value}>`)),o.termType===no?s+=` <${o.value}>`:o.termType===ta&&(s+=` ${o.value}`),s+=` .
`,s}static legacyDatasetToQuads(e){const n=[],r={"blank node":ta,IRI:no,literal:cd};for(const i in e)e[i].forEach(s=>{const a={};for(const c in s){const l=s[c],u={termType:r[l.type],value:l.value};u.termType===cd&&(u.datatype={termType:no},"datatype"in l&&(u.datatype.value=l.datatype),"language"in l?("datatype"in l||(u.datatype.value=Bh),u.language=l.language):"datatype"in l||(u.datatype.value=Hh)),a[c]=u}i==="@default"?a.graph={termType:o_,value:""}:a.graph={termType:i.startsWith("_:")?ta:no,value:i},n.push(a)});return n}};function Jk(t,e){return!(t.subject.termType===e.subject.termType&&t.object.termType===e.object.termType)||!(t.subject.value===e.subject.value&&t.predicate.value===e.predicate.value&&t.object.value===e.object.value)?!1:t.object.termType!==cd?!0:t.object.datatype.termType===e.object.datatype.termType&&t.object.language===e.object.language&&t.object.datatype.value===e.object.datatype.value}const Zk=/["\\\n\r]/g;function Qk(t){return t.replace(Zk,function(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r"}})}const Xk=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g;function e6(t){return t.replace(Xk,function(e,n,r,i){if(n)switch(n){case"t":return"	";case"b":return"\b";case"n":return`
`;case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(r)return String.fromCharCode(parseInt(r,16));if(i)throw new Error("Unsupported U escape")})}const s_=B0,Kh=k1,t6=F1,a_=H0;var D1=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new s_("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}async main(e){this.quads=e;for(const c of e)this._addBlankNodeQuadInfo({quad:c,component:c.subject}),this._addBlankNodeQuadInfo({quad:c,component:c.object}),this._addBlankNodeQuadInfo({quad:c,component:c.graph});const n=new Map,r=[...this.blankNodeInfo.keys()];let i=0;for(const c of r)++i%100===0&&await this._yield(),await this._hashAndTrackBlankNode({id:c,hashToBlankNodes:n});const o=[...n.keys()].sort(),s=[];for(const c of o){const l=n.get(c);if(l.length>1){s.push(l);continue}const u=l[0];this.canonicalIssuer.getId(u)}for(const c of s){const l=[];for(const u of c){if(this.canonicalIssuer.hasId(u))continue;const d=new s_("_:b");d.getId(u);const g=await this.hashNDegreeQuads(u,d);l.push(g)}l.sort(n6);for(const u of l){const d=u.issuer.getOldIds();for(const g of d)this.canonicalIssuer.getId(g)}}const a=[];for(const c of this.quads){const l={...c};l.subject=this._useCanonicalId({component:l.subject}),l.object=this._useCanonicalId({component:l.object}),l.graph=this._useCanonicalId({component:l.graph}),a.push(a_.serializeQuad(l))}return a.sort(),a.join("")}async hashFirstDegreeQuads(e){const n=[],r=this.blankNodeInfo.get(e),i=r.quads;for(const s of i){const a={subject:null,predicate:s.predicate,object:null,graph:null};a.subject=this.modifyFirstDegreeComponent(e,s.subject,"subject"),a.object=this.modifyFirstDegreeComponent(e,s.object,"object"),a.graph=this.modifyFirstDegreeComponent(e,s.graph,"graph"),n.push(a_.serializeQuad(a))}n.sort();const o=new Kh(this.hashAlgorithm);for(const s of n)o.update(s);return r.hash=await o.digest(),r.hash}async hashRelatedBlankNode(e,n,r,i){let o;this.canonicalIssuer.hasId(e)?o=this.canonicalIssuer.getId(e):r.hasId(e)?o=r.getId(e):o=this.blankNodeInfo.get(e).hash;const s=new Kh(this.hashAlgorithm);return s.update(i),i!=="g"&&s.update(this.getRelatedPredicate(n)),s.update(o),s.digest()}async hashNDegreeQuads(e,n){const r=new Kh(this.hashAlgorithm),i=await this.createHashToRelated(e,n),o=[...i.keys()].sort();for(const s of o){r.update(s);let a="",c;const l=new t6(i.get(s));let u=0;for(;l.hasNext();){const d=l.next();++u%3===0&&await this._yield();let g=n.clone(),p="";const y=[];let w=!1;for(const E of d)if(this.canonicalIssuer.hasId(E)?p+=this.canonicalIssuer.getId(E):(g.hasId(E)||y.push(E),p+=g.getId(E)),a.length!==0&&p>a){w=!0;break}if(!w){for(const E of y){const b=await this.hashNDegreeQuads(E,g);if(p+=g.getId(E),p+=`<${b.hash}>`,g=b.issuer,a.length!==0&&p>a){w=!0;break}}w||(a.length===0||p<a)&&(a=p,c=g)}}r.update(a),n=c}return{hash:await r.digest(),issuer:n}}modifyFirstDegreeComponent(e,n){return n.termType!=="BlankNode"?n:{termType:"BlankNode",value:n.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}async createHashToRelated(e,n){const r=new Map,i=this.blankNodeInfo.get(e).quads;let o=0;for(const s of i)++o%100===0&&await this._yield(),await Promise.all([this._addRelatedBlankNodeHash({quad:s,component:s.subject,position:"s",id:e,issuer:n,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:s,component:s.object,position:"o",id:e,issuer:n,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:s,component:s.graph,position:"g",id:e,issuer:n,hashToRelated:r})]);return r}async _hashAndTrackBlankNode({id:e,hashToBlankNodes:n}){const r=await this.hashFirstDegreeQuads(e),i=n.get(r);i?i.push(e):n.set(r,[e])}_addBlankNodeQuadInfo({quad:e,component:n}){if(n.termType!=="BlankNode")return;const r=n.value,i=this.blankNodeInfo.get(r);i?i.quads.add(e):this.blankNodeInfo.set(r,{quads:new Set([e]),hash:null})}async _addRelatedBlankNodeHash({quad:e,component:n,position:r,id:i,issuer:o,hashToRelated:s}){if(!(n.termType==="BlankNode"&&n.value!==i))return;const a=n.value,c=await this.hashRelatedBlankNode(a,e,o,r),l=s.get(c);l?l.push(a):s.set(c,[a])}_useCanonicalId({component:e}){return e.termType==="BlankNode"&&!e.value.startsWith(this.canonicalIssuer.prefix)?{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}:e}async _yield(){return new Promise(e=>setImmediate(e))}};function n6(t,e){return t.hash<e.hash?-1:t.hash>e.hash?1:0}const r6=D1;var i6=class extends r6{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,n,r){return n.termType!=="BlankNode"?n:r==="graph"?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:n.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}async createHashToRelated(e,n){const r=new Map,i=this.blankNodeInfo.get(e).quads;let o=0;for(const s of i){let a,c;if(s.subject.termType==="BlankNode"&&s.subject.value!==e)c=s.subject.value,a="p";else if(s.object.termType==="BlankNode"&&s.object.value!==e)c=s.object.value,a="r";else continue;++o%100===0&&await this._yield();const l=await this.hashRelatedBlankNode(c,s,n,a),u=r.get(l);u?u.push(c):r.set(l,[c])}return r}};const c_=B0,Wh=k1,o6=F1,l_=H0;var C1=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new c_("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(e){this.quads=e;for(const a of e)this._addBlankNodeQuadInfo({quad:a,component:a.subject}),this._addBlankNodeQuadInfo({quad:a,component:a.object}),this._addBlankNodeQuadInfo({quad:a,component:a.graph});const n=new Map,r=[...this.blankNodeInfo.keys()];for(const a of r)this._hashAndTrackBlankNode({id:a,hashToBlankNodes:n});const i=[...n.keys()].sort(),o=[];for(const a of i){const c=n.get(a);if(c.length>1){o.push(c);continue}const l=c[0];this.canonicalIssuer.getId(l)}for(const a of o){const c=[];for(const l of a){if(this.canonicalIssuer.hasId(l))continue;const u=new c_("_:b");u.getId(l);const d=this.hashNDegreeQuads(l,u);c.push(d)}c.sort(s6);for(const l of c){const u=l.issuer.getOldIds();for(const d of u)this.canonicalIssuer.getId(d)}}const s=[];for(const a of this.quads){const c={...a};c.subject=this._useCanonicalId({component:c.subject}),c.object=this._useCanonicalId({component:c.object}),c.graph=this._useCanonicalId({component:c.graph}),s.push(l_.serializeQuad(c))}return s.sort(),s.join("")}hashFirstDegreeQuads(e){const n=[],r=this.blankNodeInfo.get(e),i=r.quads;for(const s of i){const a={subject:null,predicate:s.predicate,object:null,graph:null};a.subject=this.modifyFirstDegreeComponent(e,s.subject,"subject"),a.object=this.modifyFirstDegreeComponent(e,s.object,"object"),a.graph=this.modifyFirstDegreeComponent(e,s.graph,"graph"),n.push(l_.serializeQuad(a))}n.sort();const o=new Wh(this.hashAlgorithm);for(const s of n)o.update(s);return r.hash=o.digest(),r.hash}hashRelatedBlankNode(e,n,r,i){let o;this.canonicalIssuer.hasId(e)?o=this.canonicalIssuer.getId(e):r.hasId(e)?o=r.getId(e):o=this.blankNodeInfo.get(e).hash;const s=new Wh(this.hashAlgorithm);return s.update(i),i!=="g"&&s.update(this.getRelatedPredicate(n)),s.update(o),s.digest()}hashNDegreeQuads(e,n){const r=new Wh(this.hashAlgorithm),i=this.createHashToRelated(e,n),o=[...i.keys()].sort();for(const s of o){r.update(s);let a="",c;const l=new o6(i.get(s));for(;l.hasNext();){const u=l.next();let d=n.clone(),g="";const p=[];let y=!1;for(const w of u)if(this.canonicalIssuer.hasId(w)?g+=this.canonicalIssuer.getId(w):(d.hasId(w)||p.push(w),g+=d.getId(w)),a.length!==0&&g>a){y=!0;break}if(!y){for(const w of p){const E=this.hashNDegreeQuads(w,d);if(g+=d.getId(w),g+=`<${E.hash}>`,d=E.issuer,a.length!==0&&g>a){y=!0;break}}y||(a.length===0||g<a)&&(a=g,c=d)}}r.update(a),n=c}return{hash:r.digest(),issuer:n}}modifyFirstDegreeComponent(e,n){return n.termType!=="BlankNode"?n:{termType:"BlankNode",value:n.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}createHashToRelated(e,n){const r=new Map,i=this.blankNodeInfo.get(e).quads;for(const o of i)this._addRelatedBlankNodeHash({quad:o,component:o.subject,position:"s",id:e,issuer:n,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:o,component:o.object,position:"o",id:e,issuer:n,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:o,component:o.graph,position:"g",id:e,issuer:n,hashToRelated:r});return r}_hashAndTrackBlankNode({id:e,hashToBlankNodes:n}){const r=this.hashFirstDegreeQuads(e),i=n.get(r);i?i.push(e):n.set(r,[e])}_addBlankNodeQuadInfo({quad:e,component:n}){if(n.termType!=="BlankNode")return;const r=n.value,i=this.blankNodeInfo.get(r);i?i.quads.add(e):this.blankNodeInfo.set(r,{quads:new Set([e]),hash:null})}_addRelatedBlankNodeHash({quad:e,component:n,position:r,id:i,issuer:o,hashToRelated:s}){if(!(n.termType==="BlankNode"&&n.value!==i))return;const a=n.value,c=this.hashRelatedBlankNode(a,e,o,r),l=s.get(c);l?l.push(a):s.set(c,[a])}_useCanonicalId({component:e}){return e.termType==="BlankNode"&&!e.value.startsWith(this.canonicalIssuer.prefix)?{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}:e}};function s6(t,e){return t.hash<e.hash?-1:t.hash>e.hash?1:0}const a6=C1;var c6=class extends a6{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,n,r){return n.termType!=="BlankNode"?n:r==="graph"?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:n.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,n){const r=new Map,i=this.blankNodeInfo.get(e).quads;for(const o of i){let s,a;if(o.subject.termType==="BlankNode"&&o.subject.value!==e)a=o.subject.value,s="p";else if(o.object.termType==="BlankNode"&&o.object.value!==e)a=o.object.value,s="r";else continue;const c=this.hashRelatedBlankNode(a,o,n,s),l=r.get(c);l?l.push(a):r.set(c,[a])}return r}};const l6=D1,u6=i6,d6=C1,f6=c6;let ka;try{ka=require("rdf-canonize-native")}catch{}const Us={};var h6=Us;Us.NQuads=H0;Us.IdentifierIssuer=B0;Us._rdfCanonizeNative=function(t){return t&&(ka=t),ka};Us.canonize=async function(t,e){if(Array.isArray(t)||(t=Us.NQuads.legacyDatasetToQuads(t)),e.useNative){if(!ka)throw new Error("rdf-canonize-native not available");return new Promise((n,r)=>ka.canonize(t,e,(i,o)=>i?r(i):n(o)))}if(e.algorithm==="URDNA2015")return new l6(e).main(t);if(e.algorithm==="URGNA2012")return new u6(e).main(t);throw"algorithm"in e?new Error("Invalid RDF Dataset Canonicalization algorithm: "+e.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")};Us._canonizeSync=function(t,e){if(Array.isArray(t)||(t=Us.NQuads.legacyDatasetToQuads(t)),e.useNative){if(ka)return ka.canonizeSync(t,e);throw new Error("rdf-canonize-native not available")}if(e.algorithm==="URDNA2015")return new d6(e).main(t);if(e.algorithm==="URGNA2012")return new f6(e).main(t);throw"algorithm"in e?new Error("Invalid RDF Dataset Canonicalization algorithm: "+e.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")};var K0=h6;const Ji={};var Qi=Ji;Ji.isArray=Array.isArray;Ji.isBoolean=t=>typeof t=="boolean"||Object.prototype.toString.call(t)==="[object Boolean]";Ji.isDouble=t=>Ji.isNumber(t)&&(String(t).indexOf(".")!==-1||Math.abs(t)>=1e21);Ji.isEmptyObject=t=>Ji.isObject(t)&&Object.keys(t).length===0;Ji.isNumber=t=>typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]";Ji.isNumeric=t=>!isNaN(parseFloat(t))&&isFinite(t);Ji.isObject=t=>Object.prototype.toString.call(t)==="[object Object]";Ji.isString=t=>typeof t=="string"||Object.prototype.toString.call(t)==="[object String]";Ji.isUndefined=t=>typeof t=="undefined";const $c=Qi,fs={};var ms=fs;fs.isSubject=t=>$c.isObject(t)&&!("@value"in t||"@set"in t||"@list"in t)?Object.keys(t).length>1||!("@id"in t):!1;fs.isSubjectReference=t=>$c.isObject(t)&&Object.keys(t).length===1&&"@id"in t;fs.isValue=t=>$c.isObject(t)&&"@value"in t;fs.isList=t=>$c.isObject(t)&&"@list"in t;fs.isGraph=t=>$c.isObject(t)&&"@graph"in t&&Object.keys(t).filter(e=>e!=="@id"&&e!=="@index").length===1;fs.isSimpleGraph=t=>fs.isGraph(t)&&!("@id"in t);fs.isBlankNode=t=>$c.isObject(t)?"@id"in t?t["@id"].indexOf("_:")===0:Object.keys(t).length===0||!("@value"in t||"@set"in t||"@list"in t):!1;var qo=class extends Error{constructor(e="An unspecified JSON-LD error occurred.",n="jsonld.Error",r={}){super(e),this.name=n,this.message=e,this.details=r}};const Hl=ms,Xr=Qi,P1=K0.IdentifierIssuer,p6=qo,g6=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,m6=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,y6=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,u_={headers:{accept:"application/ld+json, application/json"}},Wt={};var yo=Wt;Wt.IdentifierIssuer=P1;Wt.clone=function(t){if(t&&typeof t=="object"){let e;if(Xr.isArray(t)){e=[];for(let n=0;n<t.length;++n)e[n]=Wt.clone(t[n])}else if(t instanceof Map){e=new Map;for(const[n,r]of t)e.set(n,Wt.clone(r))}else if(t instanceof Set){e=new Set;for(const n of t)e.add(Wt.clone(n))}else if(Xr.isObject(t)){e={};for(const n in t)e[n]=Wt.clone(t[n])}else e=t.toString();return e}return t};Wt.asArray=function(t){return Array.isArray(t)?t:[t]};Wt.buildHeaders=(t={})=>{if(Object.keys(t).some(n=>n.toLowerCase()==="accept"))throw new RangeError('Accept header may not be specified; only "'+u_.headers.accept+'" is supported.');return Object.assign({Accept:u_.headers.accept},t)};Wt.parseLinkHeader=t=>{const e={},n=t.match(g6);for(let r=0;r<n.length;++r){let i=n[r].match(m6);if(!i)continue;const o={target:i[1]},s=i[2];for(;i=y6.exec(s);)o[i[1]]=i[2]===void 0?i[3]:i[2];const a=o.rel||"";Array.isArray(e[a])?e[a].push(o):e.hasOwnProperty(a)?e[a]=[e[a],o]:e[a]=o}return e};Wt.validateTypeValue=(t,e)=>{if(!Xr.isString(t)&&!(Xr.isArray(t)&&t.every(n=>Xr.isString(n)))){if(e&&Xr.isObject(t))switch(Object.keys(t).length){case 0:return;case 1:if("@default"in t&&Wt.asArray(t["@default"]).every(n=>Xr.isString(n)))return}throw new p6('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:t})}};Wt.hasProperty=(t,e)=>{if(t.hasOwnProperty(e)){const n=t[e];return!Xr.isArray(n)||n.length>0}return!1};Wt.hasValue=(t,e,n)=>{if(Wt.hasProperty(t,e)){let r=t[e];const i=Hl.isList(r);if(Xr.isArray(r)||i){i&&(r=r["@list"]);for(let o=0;o<r.length;++o)if(Wt.compareValues(n,r[o]))return!0}else if(!Xr.isArray(n))return Wt.compareValues(n,r)}return!1};Wt.addValue=(t,e,n,r)=>{if(r=r||{},"propertyIsArray"in r||(r.propertyIsArray=!1),"valueIsArray"in r||(r.valueIsArray=!1),"allowDuplicate"in r||(r.allowDuplicate=!0),"prependValue"in r||(r.prependValue=!1),r.valueIsArray)t[e]=n;else if(Xr.isArray(n)){n.length===0&&r.propertyIsArray&&!t.hasOwnProperty(e)&&(t[e]=[]),r.prependValue&&(n=n.concat(t[e]),t[e]=[]);for(let i=0;i<n.length;++i)Wt.addValue(t,e,n[i],r)}else if(t.hasOwnProperty(e)){const i=!r.allowDuplicate&&Wt.hasValue(t,e,n);!Xr.isArray(t[e])&&(!i||r.propertyIsArray)&&(t[e]=[t[e]]),i||(r.prependValue?t[e].unshift(n):t[e].push(n))}else t[e]=r.propertyIsArray?[n]:n};Wt.getValues=(t,e)=>[].concat(t[e]||[]);Wt.removeProperty=(t,e)=>{delete t[e]};Wt.removeValue=(t,e,n,r)=>{r=r||{},"propertyIsArray"in r||(r.propertyIsArray=!1);const i=Wt.getValues(t,e).filter(o=>!Wt.compareValues(o,n));i.length===0?Wt.removeProperty(t,e):i.length===1&&!r.propertyIsArray?t[e]=i[0]:t[e]=i};Wt.relabelBlankNodes=(t,e)=>{e=e||{};const n=e.issuer||new P1("_:b");return ld(n,t)};Wt.compareValues=(t,e)=>t===e||Hl.isValue(t)&&Hl.isValue(e)&&t["@value"]===e["@value"]&&t["@type"]===e["@type"]&&t["@language"]===e["@language"]&&t["@index"]===e["@index"]?!0:Xr.isObject(t)&&"@id"in t&&Xr.isObject(e)&&"@id"in e?t["@id"]===e["@id"]:!1;Wt.compareShortestLeast=(t,e)=>t.length<e.length?-1:e.length<t.length?1:t===e?0:t<e?-1:1;function ld(t,e){if(Xr.isArray(e))for(let n=0;n<e.length;++n)e[n]=ld(t,e[n]);else if(Hl.isList(e))e["@list"]=ld(t,e["@list"]);else if(Xr.isObject(e)){Hl.isBlankNode(e)&&(e["@id"]=t.getId(e["@id"]));const n=Object.keys(e).sort();for(let r=0;r<n.length;++r){const i=n[r];i!=="@id"&&(e[i]=ld(t,e[i]))}}return e}const ro="http://www.w3.org/1999/02/22-rdf-syntax-ns#",al="http://www.w3.org/2001/XMLSchema#";var W0={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:ro,RDF_LIST:ro+"List",RDF_FIRST:ro+"first",RDF_REST:ro+"rest",RDF_NIL:ro+"nil",RDF_TYPE:ro+"type",RDF_PLAIN_LITERAL:ro+"PlainLiteral",RDF_XML_LITERAL:ro+"XMLLiteral",RDF_JSON_LITERAL:ro+"JSON",RDF_OBJECT:ro+"object",RDF_LANGSTRING:ro+"langString",XSD:al,XSD_BOOLEAN:al+"boolean",XSD_DOUBLE:al+"double",XSD_INTEGER:al+"integer",XSD_STRING:al+"string"},N1=class{constructor(){this._requests={}}wrapLoader(e){const n=this;return n._loader=e,function(){return n.add.apply(n,arguments)}}async add(e){let n=this._requests[e];if(n)return Promise.resolve(n);n=this._requests[e]=this._loader(e);try{return await n}finally{delete this._requests[e]}}};const Rf=Qi,ei={};var Ks=ei;ei.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}};ei.parse=(t,e)=>{const n={},r=ei.parsers[e||"full"],i=r.regex.exec(t);let o=r.keys.length;for(;o--;)n[r.keys[o]]=i[o]===void 0?null:i[o];return(n.scheme==="https"&&n.port==="443"||n.scheme==="http"&&n.port==="80")&&(n.href=n.href.replace(":"+n.port,""),n.authority=n.authority.replace(":"+n.port,""),n.port=null),n.normalizedPath=ei.removeDotSegments(n.path),n};ei.prependBase=(t,e)=>{if(t===null||ei.isAbsolute(e))return e;(!t||Rf.isString(t))&&(t=ei.parse(t||""));const n=ei.parse(e),r={protocol:t.protocol||""};if(n.authority!==null)r.authority=n.authority,r.path=n.path,r.query=n.query;else if(r.authority=t.authority,n.path==="")r.path=t.path,n.query!==null?r.query=n.query:r.query=t.query;else{if(n.path.indexOf("/")===0)r.path=n.path;else{let o=t.path;o=o.substr(0,o.lastIndexOf("/")+1),(o.length>0||t.authority)&&o.substr(-1)!=="/"&&(o+="/"),o+=n.path,r.path=o}r.query=n.query}n.path!==""&&(r.path=ei.removeDotSegments(r.path));let i=r.protocol;return r.authority!==null&&(i+="//"+r.authority),i+=r.path,r.query!==null&&(i+="?"+r.query),n.fragment!==null&&(i+="#"+n.fragment),i===""&&(i="./"),i};ei.removeBase=(t,e)=>{if(t===null)return e;(!t||Rf.isString(t))&&(t=ei.parse(t||""));let n="";if(t.href!==""?n+=(t.protocol||"")+"//"+(t.authority||""):e.indexOf("//")&&(n+="//"),e.indexOf(n)!==0)return e;const r=ei.parse(e.substr(n.length)),i=t.normalizedPath.split("/"),o=r.normalizedPath.split("/"),s=r.fragment||r.query?0:1;for(;i.length>0&&o.length>s&&i[0]===o[0];)i.shift(),o.shift();let a="";if(i.length>0){i.pop();for(let c=0;c<i.length;++c)a+="../"}return a+=o.join("/"),r.query!==null&&(a+="?"+r.query),r.fragment!==null&&(a+="#"+r.fragment),a===""&&(a="./"),a};ei.removeDotSegments=t=>{if(t.length===0)return"";const e=t.split("/"),n=[];for(;e.length>0;){const r=e.shift(),i=e.length===0;if(r==="."){i&&n.push("");continue}if(r===".."){n.pop(),i&&n.push("");continue}n.push(r)}return t[0]==="/"&&n.length>0&&n[0]!==""&&n.unshift(""),n.length===1&&n[0]===""?"/":n.join("/")};const _6=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;ei.isAbsolute=t=>Rf.isString(t)&&_6.test(t);ei.isRelative=t=>Rf.isString(t);const{parseLinkHeader:w6,buildHeaders:v6}=yo,{LINK_HEADER_CONTEXT:b6}=W0,cl=qo,E6=N1,{prependBase:S6}=Ks,T6=/(^|(\r\n))link:/i;var A6=({secure:t,headers:e={},xhr:n}={headers:{}})=>{return e=v6(e),new E6().wrapLoader(i);async function i(o){if(o.indexOf("http:")!==0&&o.indexOf("https:")!==0)throw new cl('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:o});if(t&&o.indexOf("https")!==0)throw new cl(`URL could not be dereferenced; secure mode is enabled and the URL's scheme is not "https".`,"jsonld.InvalidUrl",{code:"loading document failed",url:o});let s;try{s=await x6(n,o,e)}catch(d){throw new cl("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:o,cause:d})}if(s.status>=400)throw new cl("URL could not be dereferenced: "+s.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:o,httpStatusCode:s.status});let a={contextUrl:null,documentUrl:o,document:s.response},c=null;const l=s.getResponseHeader("Content-Type");let u;if(T6.test(s.getAllResponseHeaders())&&(u=s.getResponseHeader("Link")),u&&l!=="application/ld+json"){const d=w6(u),g=d[b6];if(Array.isArray(g))throw new cl("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:o});g&&(a.contextUrl=g.target),c=d.alternate,c&&c.type=="application/ld+json"&&!(l||"").match(/^application\/(\w*\+)?json$/)&&(a=await i(S6(o,c.target)))}return a}};function x6(t,e,n){t=t||XMLHttpRequest;const r=new t;return new Promise((i,o)=>{r.onload=()=>i(r),r.onerror=s=>o(s),r.open("GET",e,!0);for(const s in n)r.setRequestHeader(s,n[s]);r.send()})}const I6=A6,q0={};var R6=q0;q0.setupDocumentLoaders=function(t){typeof XMLHttpRequest!="undefined"&&(t.documentLoaders.xhr=I6,t.useDocumentLoader("xhr"))};q0.setupGlobals=function(t){typeof globalThis.JsonLdProcessor=="undefined"&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:t.JsonLdProcessor})};var k6=Ot;Ot.Node=Fa;Ot.create=Ot;function Ot(t){var e=this;if(e instanceof Ot||(e=new Ot),e.tail=null,e.head=null,e.length=0,t&&typeof t.forEach=="function")t.forEach(function(i){e.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)e.push(arguments[n]);return e}Ot.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e};Ot.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}};Ot.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}};Ot.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)D6(this,arguments[t]);return this.length};Ot.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)C6(this,arguments[t]);return this.length};Ot.prototype.pop=function(){if(!!this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}};Ot.prototype.shift=function(){if(!!this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}};Ot.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;n!==null;r++)t.call(e,n.value,r,this),n=n.next};Ot.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;n!==null;r--)t.call(e,n.value,r,this),n=n.prev};Ot.prototype.get=function(t){for(var e=0,n=this.head;n!==null&&e<t;e++)n=n.next;if(e===t&&n!==null)return n.value};Ot.prototype.getReverse=function(t){for(var e=0,n=this.tail;n!==null&&e<t;e++)n=n.prev;if(e===t&&n!==null)return n.value};Ot.prototype.map=function(t,e){e=e||this;for(var n=new Ot,r=this.head;r!==null;)n.push(t.call(e,r.value,this)),r=r.next;return n};Ot.prototype.mapReverse=function(t,e){e=e||this;for(var n=new Ot,r=this.tail;r!==null;)n.push(t.call(e,r.value,this)),r=r.prev;return n};Ot.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)n=t(n,r.value,i),r=r.next;return n};Ot.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)n=t(n,r.value,i),r=r.prev;return n};Ot.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;n!==null;e++)t[e]=n.value,n=n.next;return t};Ot.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;n!==null;e++)t[e]=n.value,n=n.prev;return t};Ot.prototype.slice=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var n=new Ot;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var r=0,i=this.head;i!==null&&r<t;r++)i=i.next;for(;i!==null&&r<e;r++,i=i.next)n.push(i.value);return n};Ot.prototype.sliceReverse=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var n=new Ot;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var r=this.length,i=this.tail;i!==null&&r>e;r--)i=i.prev;for(;i!==null&&r>t;r--,i=i.prev)n.push(i.value);return n};Ot.prototype.splice=function(t,e,...n){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var r=0,i=this.head;i!==null&&r<t;r++)i=i.next;for(var o=[],r=0;i&&r<e;r++)o.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<n.length;r++)i=F6(this,i,n[r]);return o};Ot.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this};function F6(t,e,n){var r=e===t.head?new Fa(n,null,e,t):new Fa(n,e,e.next,t);return r.next===null&&(t.tail=r),r.prev===null&&(t.head=r),t.length++,r}function D6(t,e){t.tail=new Fa(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function C6(t,e){t.head=new Fa(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function Fa(t,e,n,r){if(!(this instanceof Fa))return new Fa(t,e,n,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{require("./iterator.js")(Ot)}catch{}const P6=k6,ca=Symbol("max"),ns=Symbol("length"),ec=Symbol("lengthCalculator"),Sl=Symbol("allowStale"),fa=Symbol("maxAge"),es=Symbol("dispose"),d_=Symbol("noDisposeOnSet"),vr=Symbol("lruList"),oo=Symbol("cache"),O1=Symbol("updateAgeOnGet"),qh=()=>1;class N6{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");this[ca]=e.max||1/0;const n=e.length||qh;if(this[ec]=typeof n!="function"?qh:n,this[Sl]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[fa]=e.maxAge||0,this[es]=e.dispose,this[d_]=e.noDisposeOnSet||!1,this[O1]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[ca]=e||1/0,ll(this)}get max(){return this[ca]}set allowStale(e){this[Sl]=!!e}get allowStale(){return this[Sl]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[fa]=e,ll(this)}get maxAge(){return this[fa]}set lengthCalculator(e){typeof e!="function"&&(e=qh),e!==this[ec]&&(this[ec]=e,this[ns]=0,this[vr].forEach(n=>{n.length=this[ec](n.value,n.key),this[ns]+=n.length})),ll(this)}get lengthCalculator(){return this[ec]}get length(){return this[ns]}get itemCount(){return this[vr].length}rforEach(e,n){n=n||this;for(let r=this[vr].tail;r!==null;){const i=r.prev;f_(this,e,r,n),r=i}}forEach(e,n){n=n||this;for(let r=this[vr].head;r!==null;){const i=r.next;f_(this,e,r,n),r=i}}keys(){return this[vr].toArray().map(e=>e.key)}values(){return this[vr].toArray().map(e=>e.value)}reset(){this[es]&&this[vr]&&this[vr].length&&this[vr].forEach(e=>this[es](e.key,e.value)),this[oo]=new Map,this[vr]=new P6,this[ns]=0}dump(){return this[vr].map(e=>jd(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[vr]}set(e,n,r){if(r=r||this[fa],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const i=r?Date.now():0,o=this[ec](n,e);if(this[oo].has(e)){if(o>this[ca])return hc(this,this[oo].get(e)),!1;const c=this[oo].get(e).value;return this[es]&&(this[d_]||this[es](e,c.value)),c.now=i,c.maxAge=r,c.value=n,this[ns]+=o-c.length,c.length=o,this.get(e),ll(this),!0}const s=new O6(e,n,o,i,r);return s.length>this[ca]?(this[es]&&this[es](e,n),!1):(this[ns]+=s.length,this[vr].unshift(s),this[oo].set(e,this[vr].head),ll(this),!0)}has(e){if(!this[oo].has(e))return!1;const n=this[oo].get(e).value;return!jd(this,n)}get(e){return Vh(this,e,!0)}peek(e){return Vh(this,e,!1)}pop(){const e=this[vr].tail;return e?(hc(this,e),e.value):null}del(e){hc(this,this[oo].get(e))}load(e){this.reset();const n=Date.now();for(let r=e.length-1;r>=0;r--){const i=e[r],o=i.e||0;if(o===0)this.set(i.k,i.v);else{const s=o-n;s>0&&this.set(i.k,i.v,s)}}}prune(){this[oo].forEach((e,n)=>Vh(this,n,!1))}}const Vh=(t,e,n)=>{const r=t[oo].get(e);if(r){const i=r.value;if(jd(t,i)){if(hc(t,r),!t[Sl])return}else n&&(t[O1]&&(r.value.now=Date.now()),t[vr].unshiftNode(r));return i.value}},jd=(t,e)=>{if(!e||!e.maxAge&&!t[fa])return!1;const n=Date.now()-e.now;return e.maxAge?n>e.maxAge:t[fa]&&n>t[fa]},ll=t=>{if(t[ns]>t[ca])for(let e=t[vr].tail;t[ns]>t[ca]&&e!==null;){const n=e.prev;hc(t,e),e=n}},hc=(t,e)=>{if(e){const n=e.value;t[es]&&t[es](n.key,n.value),t[ns]-=n.length,t[oo].delete(n.key),t[vr].removeNode(e)}};class O6{constructor(e,n,r,i,o){this.key=e,this.value=n,this.length=r,this.now=i,this.maxAge=o||0}}const f_=(t,e,n,r)=>{let i=n.value;jd(t,i)&&(hc(t,n),t[Sl]||(i=void 0)),i&&e.call(r,i.value,i.key,t)};var M1=N6;const M6=M1,L6=10;var U6=class{constructor({document:e}){this.document=e,this.cache=new M6({max:L6})}getProcessed(e){return this.cache.get(e)}setProcessed(e,n){this.cache.set(e,n)}};const{isArray:rg,isObject:Tl,isString:$d}=Qi,{asArray:j6}=yo,{prependBase:ig}=Ks,ml=qo,h_=U6,p_=10;var $6=class{constructor({sharedCache:e}){this.perOpCache=new Map,this.sharedCache=e}async resolve({activeCtx:e,context:n,documentLoader:r,base:i,cycles:o=new Set}){n&&Tl(n)&&n["@context"]&&(n=n["@context"]),n=j6(n);const s=[];for(const a of n){if($d(a)){let u=this._get(a);u||(u=await this._resolveRemoteContext({activeCtx:e,url:a,documentLoader:r,base:i,cycles:o})),rg(u)?s.push(...u):s.push(u);continue}if(a===null){s.push(new h_({document:null}));continue}Tl(a)||B6(n);const c=JSON.stringify(a);let l=this._get(c);l||(l=new h_({document:a}),this._cacheResolvedContext({key:c,resolved:l,tag:"static"})),s.push(l)}return s}_get(e){let n=this.perOpCache.get(e);if(!n){const r=this.sharedCache.get(e);r&&(n=r.get("static"),n&&this.perOpCache.set(e,n))}return n}_cacheResolvedContext({key:e,resolved:n,tag:r}){if(this.perOpCache.set(e,n),r!==void 0){let i=this.sharedCache.get(e);i||(i=new Map,this.sharedCache.set(e,i)),i.set(r,n)}return n}async _resolveRemoteContext({activeCtx:e,url:n,documentLoader:r,base:i,cycles:o}){n=ig(i,n);const{context:s,remoteDoc:a}=await this._fetchContext({activeCtx:e,url:n,documentLoader:r,cycles:o});i=a.documentUrl||n,og({context:s,base:i});const c=await this.resolve({activeCtx:e,context:s,documentLoader:r,base:i,cycles:o});return this._cacheResolvedContext({key:n,resolved:c,tag:a.tag}),c}async _fetchContext({activeCtx:e,url:n,documentLoader:r,cycles:i}){if(i.size>p_)throw new ml("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:e.processingMode==="json-ld-1.0"?"loading remote context failed":"context overflow",max:p_});if(i.has(n))throw new ml("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:e.processingMode==="json-ld-1.0"?"recursive context inclusion":"context overflow",url:n});i.add(n);let o,s;try{s=await r(n),o=s.document||null,$d(o)&&(o=JSON.parse(o))}catch(a){throw new ml("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:n,cause:a})}if(!Tl(o))throw new ml("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:n});return"@context"in o?o={"@context":o["@context"]}:o={"@context":{}},s.contextUrl&&(rg(o["@context"])||(o["@context"]=[o["@context"]]),o["@context"].push(s.contextUrl)),{context:o,remoteDoc:s}}};function B6(t){throw new ml("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:t})}function og({context:t,base:e}){if(!t)return;const n=t["@context"];if($d(n)){t["@context"]=ig(e,n);return}if(rg(n)){for(let r=0;r<n.length;++r){const i=n[r];if($d(i)){n[r]=ig(e,i);continue}Tl(i)&&og({context:{"@context":i},base:e})}return}if(!!Tl(n))for(const r in n)og({context:n[r],base:e})}var H6=K0.NQuads;const Bd=yo,Ye=qo,{isArray:L1,isObject:xs,isString:mi,isUndefined:K6}=Qi,{isAbsolute:pc,isRelative:W6,prependBase:Al}=Ks,{asArray:U1,compareShortestLeast:q6}=yo,Wu=new Map,V6=1e4,ud=/^@[a-zA-Z]+$/,Xt={};var $a=Xt;Xt.process=async({activeCtx:t,localCtx:e,options:n,propagate:r=!0,overrideProtected:i=!1,cycles:o=new Set})=>{if(xs(e)&&"@context"in e&&L1(e["@context"])&&(e=e["@context"]),U1(e).length===0)return t;const a=await n.contextResolver.resolve({activeCtx:t,context:e,documentLoader:n.documentLoader,base:n.base});xs(a[0].document)&&typeof a[0].document["@propagate"]=="boolean"&&(r=a[0].document["@propagate"]);let c=t;!r&&!c.previousContext&&(c=c.clone(),c.previousContext=t);for(const l of a){let{document:u}=l;if(t=c,u===null){if(!i&&Object.keys(t.protected).length!==0){const p=n&&n.protectedMode||"error";if(p==="error")throw new Ye("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if(p==="warn"){console.warn("WARNING: invalid context nullification");const y=l.getProcessed(t);if(y){c=t=y;continue}const w=t;c=t=Xt.getInitialContext(n).clone();for(const[E,b]of Object.entries(w.protected))b&&(t.mappings[E]=Bd.clone(w.mappings[E]));t.protected=Bd.clone(w.protected),l.setProcessed(w,c);continue}throw new Ye("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:e,protectedMode:p})}c=t=Xt.getInitialContext(n).clone();continue}const d=l.getProcessed(t);if(d){c=t=d;continue}if(xs(u)&&"@context"in u&&(u=u["@context"]),!xs(u))throw new Ye("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:u});c=c.clone();const g=new Map;if("@version"in u){if(u["@version"]!==1.1)throw new Ye("Unsupported JSON-LD version: "+u["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:u});if(t.processingMode&&t.processingMode==="json-ld-1.0")throw new Ye("@version: "+u["@version"]+" not compatible with "+t.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:u});c.processingMode="json-ld-1.1",c["@version"]=u["@version"],g.set("@version",!0)}if(c.processingMode=c.processingMode||t.processingMode,"@base"in u){let p=u["@base"];if(!(p===null||pc(p)))if(W6(p))p=Al(c["@base"],p);else throw new Ye('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:u});c["@base"]=p,g.set("@base",!0)}if("@vocab"in u){const p=u["@vocab"];if(p===null)delete c["@vocab"];else if(mi(p)){if(!pc(p)&&Xt.processingMode(c,1))throw new Ye('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:u});c["@vocab"]=sc(c,p,{vocab:!0,base:!0},void 0,void 0,n)}else throw new Ye('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:u});g.set("@vocab",!0)}if("@language"in u){const p=u["@language"];if(p===null)delete c["@language"];else if(mi(p))c["@language"]=p.toLowerCase();else throw new Ye('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:u});g.set("@language",!0)}if("@direction"in u){const p=u["@direction"];if(t.processingMode==="json-ld-1.0")throw new Ye("Invalid JSON-LD syntax; @direction not compatible with "+t.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:u});if(p===null)delete c["@direction"];else{if(p!=="ltr"&&p!=="rtl")throw new Ye('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:u});c["@direction"]=p}g.set("@direction",!0)}if("@propagate"in u){const p=u["@propagate"];if(t.processingMode==="json-ld-1.0")throw new Ye("Invalid JSON-LD syntax; @propagate not compatible with "+t.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:u});if(typeof p!="boolean")throw new Ye("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:e});g.set("@propagate",!0)}if("@import"in u){const p=u["@import"];if(t.processingMode==="json-ld-1.0")throw new Ye("Invalid JSON-LD syntax; @import not compatible with "+t.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:u});if(!mi(p))throw new Ye("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:e});const y=await n.contextResolver.resolve({activeCtx:t,context:p,documentLoader:n.documentLoader,base:n.base});if(y.length!==1)throw new Ye("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:e});const w=y[0].getProcessed(t);if(w)u=w;else{const E=y[0].document;if("@import"in E)throw new Ye("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:e});for(const b in E)u.hasOwnProperty(b)||(u[b]=E[b]);y[0].setProcessed(t,u)}g.set("@import",!0)}g.set("@protected",u["@protected"]||!1);for(const p in u)if(Xt.createTermDefinition({activeCtx:c,localCtx:u,term:p,defined:g,options:n,overrideProtected:i}),xs(u[p])&&"@context"in u[p]){const y=u[p]["@context"];let w=!0;if(mi(y)){const E=Al(n.base,y);o.has(E)?w=!1:o.add(E)}if(w)try{await Xt.process({activeCtx:c.clone(),localCtx:u[p]["@context"],overrideProtected:!0,options:n,cycles:o})}catch{throw new Ye("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:u[p]["@context"],term:p})}}l.setProcessed(t,c)}return c};Xt.createTermDefinition=({activeCtx:t,localCtx:e,term:n,defined:r,options:i,overrideProtected:o=!1})=>{if(r.has(n)){if(r.get(n))return;throw new Ye("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:e,term:n})}r.set(n,!1);let s;if(e.hasOwnProperty(n)&&(s=e[n]),n==="@type"&&xs(s)&&(s["@container"]||"@set")==="@set"&&Xt.processingMode(t,1.1)){const p=["@container","@id","@protected"],y=Object.keys(s);if(y.length===0||y.some(w=>!p.includes(w)))throw new Ye("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:e,term:n})}else{if(Xt.isKeyword(n))throw new Ye("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:e,term:n});if(n.match(ud)){console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:n});return}else if(n==="")throw new Ye("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:e})}const a=t.mappings.get(n);t.mappings.has(n)&&t.mappings.delete(n);let c=!1;if((mi(s)||s===null)&&(c=!0,s={"@id":s}),!xs(s))throw new Ye("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:e});const l={};t.mappings.set(n,l),l.reverse=!1;const u=["@container","@id","@language","@reverse","@type"];Xt.processingMode(t,1.1)&&u.push("@context","@direction","@index","@nest","@prefix","@protected");for(const p in s)if(!u.includes(p))throw new Ye("Invalid JSON-LD syntax; a term definition must not contain "+p,"jsonld.SyntaxError",{code:"invalid term definition",context:e});const d=n.indexOf(":");if(l._termHasColon=d>0,"@reverse"in s){if("@id"in s)throw new Ye("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:e});if("@nest"in s)throw new Ye("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:e});const p=s["@reverse"];if(!mi(p))throw new Ye("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e});if(!Xt.isKeyword(p)&&p.match(ud)){console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:p}),a?t.mappings.set(n,a):t.mappings.delete(n);return}const y=sc(t,p,{vocab:!0,base:!1},e,r,i);if(!pc(y))throw new Ye("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e});l["@id"]=y,l.reverse=!0}else if("@id"in s){let p=s["@id"];if(p&&!mi(p))throw new Ye("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e});if(p===null)l["@id"]=null;else if(!Xt.isKeyword(p)&&p.match(ud)){console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:p}),a?t.mappings.set(n,a):t.mappings.delete(n);return}else if(p!==n){if(p=sc(t,p,{vocab:!0,base:!1},e,r,i),!pc(p)&&!Xt.isKeyword(p))throw new Ye("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e});if(n.match(/(?::[^:])|\//)){const y=new Map(r).set(n,!0);if(sc(t,n,{vocab:!0,base:!1},e,y,i)!==p)throw new Ye("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e})}l["@id"]=p,l._prefix=c&&!l._termHasColon&&p.match(/[:\/\?#\[\]@]$/)}}if(!("@id"in l))if(l._termHasColon){const p=n.substr(0,d);if(e.hasOwnProperty(p)&&Xt.createTermDefinition({activeCtx:t,localCtx:e,term:p,defined:r,options:i}),t.mappings.has(p)){const y=n.substr(d+1);l["@id"]=t.mappings.get(p)["@id"]+y}else l["@id"]=n}else if(n==="@type")l["@id"]=n;else{if(!("@vocab"in t))throw new Ye("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e,term:n});l["@id"]=t["@vocab"]+n}if((s["@protected"]===!0||r.get("@protected")===!0&&s["@protected"]!==!1)&&(t.protected[n]=!0,l.protected=!0),r.set(n,!0),"@type"in s){let p=s["@type"];if(!mi(p))throw new Ye("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:e});if(p==="@json"||p==="@none"){if(Xt.processingMode(t,1))throw new Ye(`Invalid JSON-LD syntax; an @context @type value must not be "${p}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:e})}else if(p!=="@id"&&p!=="@vocab"){if(p=sc(t,p,{vocab:!0,base:!1},e,r,i),!pc(p))throw new Ye("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:e});if(p.indexOf("_:")===0)throw new Ye("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:e})}l["@type"]=p}if("@container"in s){const p=mi(s["@container"])?[s["@container"]]:s["@container"]||[],y=["@list","@set","@index","@language"];let w=!0;const E=p.includes("@set");if(Xt.processingMode(t,1.1)){if(y.push("@graph","@id","@type"),p.includes("@list")){if(p.length!==1)throw new Ye("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:e})}else if(p.includes("@graph")){if(p.some(b=>b!=="@graph"&&b!=="@id"&&b!=="@index"&&b!=="@set"))throw new Ye("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:e})}else w&=p.length<=(E?2:1);if(p.includes("@type")&&(l["@type"]=l["@type"]||"@id",!["@id","@vocab"].includes(l["@type"])))throw new Ye("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:e})}else w&=!L1(s["@container"]),w&=p.length<=1;if(w&=p.every(b=>y.includes(b)),w&=!(E&&p.includes("@list")),!w)throw new Ye("Invalid JSON-LD syntax; @context @container value must be one of the following: "+y.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:e});if(l.reverse&&!p.every(b=>["@index","@set"].includes(b)))throw new Ye("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:e});l["@container"]=p}if("@index"in s){if(!("@container"in s)||!l["@container"].includes("@index"))throw new Ye(`Invalid JSON-LD syntax; @index without @index in @container: "${s["@index"]}" on term "${n}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:e});if(!mi(s["@index"])||s["@index"].indexOf("@")===0)throw new Ye(`Invalid JSON-LD syntax; @index must expand to an IRI: "${s["@index"]}" on term "${n}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:e});l["@index"]=s["@index"]}if("@context"in s&&(l["@context"]=s["@context"]),"@language"in s&&!("@type"in s)){let p=s["@language"];if(p!==null&&!mi(p))throw new Ye("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:e});p!==null&&(p=p.toLowerCase()),l["@language"]=p}if("@prefix"in s){if(n.match(/:|\//))throw new Ye("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:e});if(Xt.isKeyword(l["@id"]))throw new Ye("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:e});if(typeof s["@prefix"]=="boolean")l._prefix=s["@prefix"]===!0;else throw new Ye("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:e})}if("@direction"in s){const p=s["@direction"];if(p!==null&&p!=="ltr"&&p!=="rtl")throw new Ye('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:e});l["@direction"]=p}if("@nest"in s){const p=s["@nest"];if(!mi(p)||p!=="@nest"&&p.indexOf("@")===0)throw new Ye("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:e});l["@nest"]=p}// disallow aliasing @context and @preserve
const g=l["@id"];if(g==="@context"||g==="@preserve")throw new Ye("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:e});if(a&&a.protected&&!o&&(t.protected[n]=!0,l.protected=!0,!sg(a,l))){const p=i&&i.protectedMode||"error";if(p==="error")throw new Ye(`Invalid JSON-LD syntax; tried to redefine "${n}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:e,term:n});if(p==="warn"){console.warn("WARNING: protected term redefinition",{term:n});return}throw new Ye("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:e,term:n,protectedMode:p})}};Xt.expandIri=(t,e,n,r)=>sc(t,e,n,void 0,void 0,r);function sc(t,e,n,r,i,o){if(e===null||!mi(e)||Xt.isKeyword(e))return e;if(e.match(ud))return null;if(r&&r.hasOwnProperty(e)&&i.get(e)!==!0&&Xt.createTermDefinition({activeCtx:t,localCtx:r,term:e,defined:i,options:o}),n=n||{},n.vocab){const a=t.mappings.get(e);if(a===null)return null;if(xs(a)&&"@id"in a)return a["@id"]}const s=e.indexOf(":");if(s>0){const a=e.substr(0,s),c=e.substr(s+1);if(a==="_"||c.indexOf("//")===0)return e;r&&r.hasOwnProperty(a)&&Xt.createTermDefinition({activeCtx:t,localCtx:r,term:a,defined:i,options:o});const l=t.mappings.get(a);if(l&&l._prefix)return l["@id"]+c;if(pc(e))return e}if(n.vocab&&"@vocab"in t)return t["@vocab"]+e;if(n.base&&"@base"in t){if(t["@base"])return Al(Al(o.base,t["@base"]),e)}else if(n.base)return Al(o.base,e);return e}Xt.getInitialContext=t=>{const e=JSON.stringify({processingMode:t.processingMode}),n=Wu.get(e);if(n)return n;const r={processingMode:t.processingMode,mappings:new Map,inverse:null,getInverse:i,clone:a,revertToPreviousContext:c,protected:{}};return Wu.size===V6&&Wu.clear(),Wu.set(e,r),r;function i(){const l=this;if(l.inverse)return l.inverse;const u=l.inverse={},d=l.fastCurieMap={},g={},p=(l["@language"]||"@none").toLowerCase(),y=l["@direction"],w=l.mappings,E=[...w.keys()].sort(q6);for(const b of E){const S=w.get(b);if(S===null)continue;let R=S["@container"]||"@none";if(R=[].concat(R).sort().join(""),S["@id"]===null)continue;const F=U1(S["@id"]);for(const M of F){let P=u[M];const D=Xt.isKeyword(M);if(P)!D&&!S._termHasColon&&g[M].push(b);else if(u[M]=P={},!D&&!S._termHasColon){g[M]=[b];const Y={iri:M,terms:g[M]};M[0]in d?d[M[0]].push(Y):d[M[0]]=[Y]}if(P[R]||(P[R]={"@language":{},"@type":{},"@any":{}}),P=P[R],s(b,P["@any"],"@none"),S.reverse)s(b,P["@type"],"@reverse");else if(S["@type"]==="@none")s(b,P["@any"],"@none"),s(b,P["@language"],"@none"),s(b,P["@type"],"@none");else if("@type"in S)s(b,P["@type"],S["@type"]);else if("@language"in S&&"@direction"in S){const Y=S["@language"],X=S["@direction"];Y&&X?s(b,P["@language"],`${Y}_${X}`.toLowerCase()):Y?s(b,P["@language"],Y.toLowerCase()):X?s(b,P["@language"],`_${X}`):s(b,P["@language"],"@null")}else"@language"in S?s(b,P["@language"],(S["@language"]||"@null").toLowerCase()):"@direction"in S?S["@direction"]?s(b,P["@language"],`_${S["@direction"]}`):s(b,P["@language"],"@none"):y?(s(b,P["@language"],`_${y}`),s(b,P["@language"],"@none"),s(b,P["@type"],"@none")):(s(b,P["@language"],p),s(b,P["@language"],"@none"),s(b,P["@type"],"@none"))}}for(const b in d)o(d,b,1);return u}function o(l,u,d){const g=l[u],p=l[u]={};let y,w;for(const E of g)y=E.iri,d>=y.length?w="":w=y[d],w in p?p[w].push(E):p[w]=[E];for(const E in p)E!==""&&o(p,E,d+1)}function s(l,u,d){u.hasOwnProperty(d)||(u[d]=l)}function a(){const l={};return l.mappings=Bd.clone(this.mappings),l.clone=this.clone,l.inverse=null,l.getInverse=this.getInverse,l.protected=Bd.clone(this.protected),this.previousContext&&(l.previousContext=this.previousContext.clone()),l.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(l["@base"]=this["@base"]),"@language"in this&&(l["@language"]=this["@language"]),"@vocab"in this&&(l["@vocab"]=this["@vocab"]),l}function c(){return this.previousContext?this.previousContext.clone():this}};Xt.getContextValue=(t,e,n)=>{if(e===null)return n==="@context"?void 0:null;if(t.mappings.has(e)){const r=t.mappings.get(e);if(K6(n))return r;if(r.hasOwnProperty(n))return r[n]}if(n==="@language"&&n in t||n==="@direction"&&n in t)return t[n];if(n!=="@context")return null};Xt.processingMode=(t,e)=>e.toString()>="1.1"?!t.processingMode||t.processingMode>="json-ld-"+e.toString():t.processingMode==="json-ld-1.0";Xt.isKeyword=t=>{if(!mi(t)||t[0]!=="@")return!1;switch(t){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1};function sg(t,e){if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return t===e;const n=Array.isArray(t);if(n!==Array.isArray(e))return!1;if(n){if(t.length!==e.length)return!1;for(let o=0;o<t.length;++o)if(!sg(t[o],e[o]))return!1;return!0}const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const o in t){let s=t[o],a=e[o];if(o==="@container"&&Array.isArray(s)&&Array.isArray(a)&&(s=s.slice().sort(),a=a.slice().sort()),!sg(s,a))return!1}return!0}const An=qo,{isArray:Hi,isObject:Ui,isEmptyObject:ag,isString:Jr,isUndefined:Hd}=Qi,{isList:zh,isValue:cg,isGraph:z6,isSubject:G6}=ms,{expandIri:tr,getContextValue:Ki,isKeyword:lg,process:xl,processingMode:dd}=$a,{isAbsolute:j1}=Ks,{addValue:xi,asArray:io,getValues:Y6,validateTypeValue:J6}=yo,Rs={};var Z6=Rs;const Q6=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;Rs.expand=async({activeCtx:t,activeProperty:e=null,element:n,options:r={},insideList:i=!1,insideIndex:o=!1,typeScopedContext:s=null,expansionMap:a=()=>{}})=>{if(n==null)return null;if(e==="@default"&&(r=Object.assign({},r,{isFrame:!1})),!Hi(n)&&!Ui(n)){if(!i&&(e===null||tr(t,e,{vocab:!0},r)==="@graph")){const w=await a({unmappedValue:n,activeCtx:t,activeProperty:e,options:r,insideList:i});return w===void 0?null:w}return B1({activeCtx:t,activeProperty:e,value:n,options:r})}if(Hi(n)){let w=[];const E=Ki(t,e,"@container")||[];i=i||E.includes("@list");for(let b=0;b<n.length;++b){let S=await Rs.expand({activeCtx:t,activeProperty:e,element:n[b],options:r,expansionMap:a,insideIndex:o,typeScopedContext:s});i&&Hi(S)&&(S={"@list":S}),!(S===null&&(S=await a({unmappedValue:n[b],activeCtx:t,activeProperty:e,parent:n,index:b,options:r,expandedParent:w,insideList:i}),S===void 0))&&(Hi(S)?w=w.concat(S):w.push(S))}return w}const c=tr(t,e,{vocab:!0},r),l=Ki(t,e,"@context");s=s||(t.previousContext?t:null);let u=Object.keys(n).sort(),d=!o;if(d&&s&&u.length<=2&&!u.includes("@context"))for(const w of u){const E=tr(s,w,{vocab:!0},r);if(E==="@value"){d=!1,t=s;break}if(E==="@id"&&u.length===1){d=!1;break}}d&&(t=t.revertToPreviousContext()),Hd(l)||(t=await xl({activeCtx:t,localCtx:l,propagate:!0,overrideProtected:!0,options:r})),"@context"in n&&(t=await xl({activeCtx:t,localCtx:n["@context"],options:r})),s=t;let g=null;for(const w of u)if(tr(t,w,{vocab:!0},r)==="@type"){g=g||w;const b=n[w],S=Array.isArray(b)?b.length>1?b.slice().sort():b:[b];for(const R of S){const F=Ki(s,R,"@context");Hd(F)||(t=await xl({activeCtx:t,localCtx:F,options:r,propagate:!1}))}}let p={};await $1({activeCtx:t,activeProperty:e,expandedActiveProperty:c,element:n,expandedParent:p,options:r,insideList:i,typeKey:g,typeScopedContext:s,expansionMap:a}),u=Object.keys(p);let y=u.length;if("@value"in p){if("@type"in p&&("@language"in p||"@direction"in p))throw new An('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:p});let w=y-1;if("@type"in p&&(w-=1),"@index"in p&&(w-=1),"@language"in p&&(w-=1),"@direction"in p&&(w-=1),w!==0)throw new An('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:p});const E=p["@value"]===null?[]:io(p["@value"]),b=Y6(p,"@type");if(!(dd(t,1.1)&&b.includes("@json")&&b.length===1))if(E.length===0){const S=await a({unmappedValue:p,activeCtx:t,activeProperty:e,element:n,options:r,insideList:i});S!==void 0?p=S:p=null}else{if(!E.every(S=>Jr(S)||ag(S))&&"@language"in p)throw new An("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:p});if(!b.every(S=>j1(S)&&!(Jr(S)&&S.indexOf("_:")===0)||ag(S)))throw new An('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:p})}}else if("@type"in p&&!Hi(p["@type"]))p["@type"]=[p["@type"]];else if("@set"in p||"@list"in p){if(y>1&&!(y===2&&"@index"in p))throw new An('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:p});"@set"in p&&(p=p["@set"],u=Object.keys(p),y=u.length)}else if(y===1&&"@language"in p){const w=await a(p,{unmappedValue:p,activeCtx:t,activeProperty:e,element:n,options:r,insideList:i});w!==void 0?p=w:p=null}if(Ui(p)&&!r.keepFreeFloatingNodes&&!i&&(e===null||c==="@graph")&&(y===0||"@value"in p||"@list"in p||y===1&&"@id"in p)){const w=await a({unmappedValue:p,activeCtx:t,activeProperty:e,element:n,options:r,insideList:i});w!==void 0?p=w:p=null}return p};async function $1({activeCtx:t,activeProperty:e,expandedActiveProperty:n,element:r,expandedParent:i,options:o={},insideList:s,typeKey:a,typeScopedContext:c,expansionMap:l}){const u=Object.keys(r).sort(),d=[];let g;const p=r[a]&&tr(t,Hi(r[a])?r[a][0]:r[a],{vocab:!0},o)==="@json";for(const y of u){let w=r[y],E;if(y==="@context")continue;let b=tr(t,y,{vocab:!0},o);if((b===null||!(j1(b)||lg(b)))&&(b=l({unmappedProperty:y,activeCtx:t,activeProperty:e,parent:r,options:o,insideList:s,value:w,expandedParent:i}),b===void 0))continue;if(lg(b)){if(n==="@reverse")throw new An("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:w});if(b in i&&b!=="@included"&&b!=="@type")throw new An("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:b})}if(b==="@id"){if(!Jr(w)){if(!o.isFrame)throw new An('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:w});if(Ui(w)){if(!ag(w))throw new An('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:w})}else if(Hi(w)){if(!w.every(M=>Jr(M)))throw new An('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:w})}else throw new An('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:w})}xi(i,"@id",io(w).map(M=>Jr(M)?tr(t,M,{base:!0},o):M),{propertyIsArray:o.isFrame});continue}if(b==="@type"){Ui(w)&&(w=Object.fromEntries(Object.entries(w).map(([M,P])=>[tr(c,M,{vocab:!0}),io(P).map(D=>tr(c,D,{base:!0,vocab:!0}))]))),J6(w,o.isFrame),xi(i,"@type",io(w).map(M=>Jr(M)?tr(c,M,{base:!0,vocab:!0},o):M),{propertyIsArray:o.isFrame});continue}if(b==="@included"&&dd(t,1.1)){const M=io(await Rs.expand({activeCtx:t,activeProperty:e,element:w,options:o,expansionMap:l}));if(!M.every(P=>G6(P)))throw new An("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:w});xi(i,"@included",M,{propertyIsArray:!0});continue}if(b==="@graph"&&!(Ui(w)||Hi(w)))throw new An('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:w});if(b==="@value"){g=w,p&&dd(t,1.1)?i["@value"]=w:xi(i,"@value",w,{propertyIsArray:o.isFrame});continue}if(b==="@language"){if(w===null)continue;if(!Jr(w)&&!o.isFrame)throw new An('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:w});w=io(w).map(M=>Jr(M)?M.toLowerCase():M);for(const M of w)Jr(M)&&!M.match(Q6)&&console.warn(`@language must be valid BCP47: ${M}`);xi(i,"@language",w,{propertyIsArray:o.isFrame});continue}if(b==="@direction"){if(!Jr(w)&&!o.isFrame)throw new An('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:w});w=io(w);for(const M of w)if(Jr(M)&&M!=="ltr"&&M!=="rtl")throw new An('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:w});xi(i,"@direction",w,{propertyIsArray:o.isFrame});continue}if(b==="@index"){if(!Jr(w))throw new An('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:w});xi(i,"@index",w);continue}if(b==="@reverse"){if(!Ui(w))throw new An('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:w});if(E=await Rs.expand({activeCtx:t,activeProperty:"@reverse",element:w,options:o,expansionMap:l}),"@reverse"in E)for(const P in E["@reverse"])xi(i,P,E["@reverse"][P],{propertyIsArray:!0});let M=i["@reverse"]||null;for(const P in E){if(P==="@reverse")continue;M===null&&(M=i["@reverse"]={}),xi(M,P,[],{propertyIsArray:!0});const D=E[P];for(let Y=0;Y<D.length;++Y){const X=D[Y];if(cg(X)||zh(X))throw new An('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:E});xi(M,P,X,{propertyIsArray:!0})}}continue}if(b==="@nest"){d.push(y);continue}let S=t;const R=Ki(t,y,"@context");Hd(R)||(S=await xl({activeCtx:t,localCtx:R,propagate:!0,overrideProtected:!0,options:o}));const F=Ki(S,y,"@container")||[];if(F.includes("@language")&&Ui(w)){const M=Ki(S,y,"@direction");E=X6(S,w,M,o)}else if(F.includes("@index")&&Ui(w)){const M=F.includes("@graph"),P=Ki(S,y,"@index")||"@index",D=P!=="@index"&&tr(t,P,{vocab:!0},o);E=await Gh({activeCtx:S,options:o,activeProperty:y,value:w,expansionMap:l,asGraph:M,indexKey:P,propertyIndex:D})}else if(F.includes("@id")&&Ui(w)){const M=F.includes("@graph");E=await Gh({activeCtx:S,options:o,activeProperty:y,value:w,expansionMap:l,asGraph:M,indexKey:"@id"})}else if(F.includes("@type")&&Ui(w))E=await Gh({activeCtx:S.revertToPreviousContext(),options:o,activeProperty:y,value:w,expansionMap:l,asGraph:!1,indexKey:"@type"});else{const M=b==="@list";if(M||b==="@set"){let P=e;M&&n==="@graph"&&(P=null),E=await Rs.expand({activeCtx:S,activeProperty:P,element:w,options:o,insideList:M,expansionMap:l})}else Ki(t,y,"@type")==="@json"?E={"@type":"@json","@value":w}:E=await Rs.expand({activeCtx:S,activeProperty:y,element:w,options:o,insideList:!1,expansionMap:l})}if(!(E===null&&b!=="@value"&&(E=l({unmappedValue:w,expandedProperty:b,activeCtx:S,activeProperty:e,parent:r,options:o,insideList:s,key:y,expandedParent:i}),E===void 0))){if(b!=="@list"&&!zh(E)&&F.includes("@list")&&(E={"@list":io(E)}),F.includes("@graph")&&!F.some(M=>M==="@id"||M==="@index")&&(E=io(E).map(M=>({"@graph":io(M)}))),S.mappings.has(y)&&S.mappings.get(y).reverse){const M=i["@reverse"]=i["@reverse"]||{};E=io(E);for(let P=0;P<E.length;++P){const D=E[P];if(cg(D)||zh(D))throw new An('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:E});xi(M,b,D,{propertyIsArray:!0})}continue}xi(i,b,E,{propertyIsArray:!0})}}if("@value"in i&&!(i["@type"]==="@json"&&dd(t,1.1))){if((Ui(g)||Hi(g))&&!o.isFrame)throw new An('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:g})}for(const y of d){const w=Hi(r[y])?r[y]:[r[y]];for(const E of w){if(!Ui(E)||Object.keys(E).some(b=>tr(t,b,{vocab:!0},o)==="@value"))throw new An("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:E});await $1({activeCtx:t,activeProperty:e,expandedActiveProperty:n,element:E,expandedParent:i,options:o,insideList:s,typeScopedContext:c,typeKey:a,expansionMap:l})}}}function B1({activeCtx:t,activeProperty:e,value:n,options:r}){if(n==null)return null;const i=tr(t,e,{vocab:!0},r);if(i==="@id")return tr(t,n,{base:!0},r);if(i==="@type")return tr(t,n,{vocab:!0,base:!0},r);const o=Ki(t,e,"@type");if((o==="@id"||i==="@graph")&&Jr(n))return{"@id":tr(t,n,{base:!0},r)};if(o==="@vocab"&&Jr(n))return{"@id":tr(t,n,{vocab:!0,base:!0},r)};if(lg(i))return n;const s={};if(o&&!["@id","@vocab","@none"].includes(o))s["@type"]=o;else if(Jr(n)){const a=Ki(t,e,"@language");a!==null&&(s["@language"]=a);const c=Ki(t,e,"@direction");c!==null&&(s["@direction"]=c)}return["boolean","number","string"].includes(typeof n)||(n=n.toString()),s["@value"]=n,s}function X6(t,e,n,r){const i=[],o=Object.keys(e).sort();for(const s of o){const a=tr(t,s,{vocab:!0},r);let c=e[s];Hi(c)||(c=[c]);for(const l of c){if(l===null)continue;if(!Jr(l))throw new An("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:e});const u={"@value":l};a!=="@none"&&(u["@language"]=s.toLowerCase()),n&&(u["@direction"]=n),i.push(u)}}return i}async function Gh({activeCtx:t,options:e,activeProperty:n,value:r,expansionMap:i,asGraph:o,indexKey:s,propertyIndex:a}){const c=[],l=Object.keys(r).sort(),u=s==="@type";for(let d of l){if(u){const y=Ki(t,d,"@context");Hd(y)||(t=await xl({activeCtx:t,localCtx:y,propagate:!1,options:e}))}let g=r[d];Hi(g)||(g=[g]),g=await Rs.expand({activeCtx:t,activeProperty:n,element:g,options:e,insideList:!1,insideIndex:!0,expansionMap:i});let p;a?d==="@none"?p="@none":p=B1({activeCtx:t,activeProperty:s,value:d,options:e}):p=tr(t,d,{vocab:!0},e),s==="@id"?d=tr(t,d,{base:!0},e):u&&(d=p);for(let y of g){if(o&&!z6(y)&&(y={"@graph":[y]}),s==="@type")p==="@none"||(y["@type"]?y["@type"]=[d].concat(y["@type"]):y["@type"]=[d]);else{if(cg(y)&&!["@language","@type","@index"].includes(s))throw new An(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${s}".`,"jsonld.SyntaxError",{code:"invalid value object",value:y});a?p!=="@none"&&xi(y,a,p,{propertyIsArray:!0,prependValue:!0}):p!=="@none"&&!(s in y)&&(y[s]=d)}c.push(y)}}return c}const{isKeyword:H1}=$a,Eo=ms,Yh=Qi,Io=yo,e3=qo,ai={};var kf=ai;ai.createMergedNodeMap=(t,e)=>{e=e||{};const n=e.issuer||new Io.IdentifierIssuer("_:b"),r={"@default":{}};return ai.createNodeMap(t,r,"@default",n),ai.mergeNodeMaps(r)};ai.createNodeMap=(t,e,n,r,i,o)=>{if(Yh.isArray(t)){for(const l of t)ai.createNodeMap(l,e,n,r,void 0,o);return}if(!Yh.isObject(t)){o&&o.push(t);return}if(Eo.isValue(t)){if("@type"in t){let l=t["@type"];l.indexOf("_:")===0&&(t["@type"]=l=r.getId(l))}o&&o.push(t);return}else if(o&&Eo.isList(t)){const l=[];ai.createNodeMap(t["@list"],e,n,r,i,l),o.push({"@list":l});return}if("@type"in t){const l=t["@type"];for(const u of l)u.indexOf("_:")===0&&r.getId(u)}Yh.isUndefined(i)&&(i=Eo.isBlankNode(t)?r.getId(t["@id"]):t["@id"]),o&&o.push({"@id":i});const s=e[n],a=s[i]=s[i]||{};a["@id"]=i;const c=Object.keys(t).sort();for(let l of c){if(l==="@id")continue;if(l==="@reverse"){const d={"@id":i},g=t["@reverse"];for(const p in g){const y=g[p];for(const w of y){let E=w["@id"];Eo.isBlankNode(w)&&(E=r.getId(E)),ai.createNodeMap(w,e,n,r,E),Io.addValue(s[E],p,d,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if(l==="@graph"){i in e||(e[i]={}),ai.createNodeMap(t[l],e,i,r);continue}if(l==="@included"){ai.createNodeMap(t[l],e,n,r);continue}if(l!=="@type"&&H1(l)){if(l==="@index"&&l in a&&(t[l]!==a[l]||t[l]["@id"]!==a[l]["@id"]))throw new e3("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:a});a[l]=t[l];continue}const u=t[l];if(l.indexOf("_:")===0&&(l=r.getId(l)),u.length===0){Io.addValue(a,l,[],{propertyIsArray:!0});continue}for(let d of u)if(l==="@type"&&(d=d.indexOf("_:")===0?r.getId(d):d),Eo.isSubject(d)||Eo.isSubjectReference(d)){if("@id"in d&&!d["@id"])continue;const g=Eo.isBlankNode(d)?r.getId(d["@id"]):d["@id"];Io.addValue(a,l,{"@id":g},{propertyIsArray:!0,allowDuplicate:!1}),ai.createNodeMap(d,e,n,r,g)}else if(Eo.isValue(d))Io.addValue(a,l,d,{propertyIsArray:!0,allowDuplicate:!1});else if(Eo.isList(d)){const g=[];ai.createNodeMap(d["@list"],e,n,r,i,g),d={"@list":g},Io.addValue(a,l,d,{propertyIsArray:!0,allowDuplicate:!1})}else ai.createNodeMap(d,e,n,r,i),Io.addValue(a,l,d,{propertyIsArray:!0,allowDuplicate:!1})}};ai.mergeNodeMapGraphs=t=>{const e={};for(const n of Object.keys(t).sort())for(const r of Object.keys(t[n]).sort()){const i=t[n][r];r in e||(e[r]={"@id":r});const o=e[r];for(const s of Object.keys(i).sort())if(H1(s)&&s!=="@type")o[s]=Io.clone(i[s]);else for(const a of i[s])Io.addValue(o,s,Io.clone(a),{propertyIsArray:!0,allowDuplicate:!1})}return e};ai.mergeNodeMaps=t=>{const e=t["@default"],n=Object.keys(t).sort();for(const r of n){if(r==="@default")continue;const i=t[r];let o=e[r];o?"@graph"in o||(o["@graph"]=[]):e[r]=o={"@id":r,"@graph":[]};const s=o["@graph"];for(const a of Object.keys(i).sort()){const c=i[a];Eo.isSubjectReference(c)||s.push(c)}}return e};const{isSubjectReference:t3}=ms,{createMergedNodeMap:n3}=kf,K1={};var r3=K1;K1.flatten=t=>{const e=n3(t),n=[],r=Object.keys(e).sort();for(let i=0;i<r.length;++i){const o=e[r[i]];t3(o)||n.push(o)}return n};const i3=qo,Jh=ms,yl=Qi,g_=yo,{RDF_LIST:o3,RDF_FIRST:Zh,RDF_REST:Qh,RDF_NIL:Xh,RDF_TYPE:s3,RDF_JSON_LITERAL:a3,XSD_BOOLEAN:m_,XSD_DOUBLE:y_,XSD_INTEGER:__,XSD_STRING:ep}=W0,c3=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,W1={};var l3=W1;W1.fromRDF=async(t,{useRdfType:e=!1,useNativeTypes:n=!1,rdfDirection:r=null})=>{const i={},o={"@default":i},s={};for(const l of t){const u=l.graph.termType==="DefaultGraph"?"@default":l.graph.value;u in o||(o[u]={}),u!=="@default"&&!(u in i)&&(i[u]={"@id":u});const d=o[u],g=l.subject.value,p=l.predicate.value,y=l.object;g in d||(d[g]={"@id":g});const w=d[g],E=y.termType.endsWith("Node");if(E&&!(y.value in d)&&(d[y.value]={"@id":y.value}),p===s3&&!e&&E){g_.addValue(w,"@type",y.value,{propertyIsArray:!0});continue}const b=u3(y,n,r);if(g_.addValue(w,p,b,{propertyIsArray:!0}),E)if(y.value===Xh){const S=d[y.value];"usages"in S||(S.usages=[]),S.usages.push({node:w,property:p,value:b})}else y.value in s?s[y.value]=!1:s[y.value]={node:w,property:p,value:b}}for(const l in o){const u=o[l];if(!(Xh in u))continue;const d=u[Xh];if(!!d.usages){for(let g of d.usages){let p=g.node,y=g.property,w=g.value;const E=[],b=[];let S=Object.keys(p).length;for(;y===Qh&&yl.isObject(s[p["@id"]])&&yl.isArray(p[Zh])&&p[Zh].length===1&&yl.isArray(p[Qh])&&p[Qh].length===1&&(S===3||S===4&&yl.isArray(p["@type"])&&p["@type"].length===1&&p["@type"][0]===o3)&&(E.push(p[Zh][0]),b.push(p["@id"]),g=s[p["@id"]],p=g.node,y=g.property,w=g.value,S=Object.keys(p).length,!!Jh.isBlankNode(p)););delete w["@id"],w["@list"]=E.reverse();for(const R of b)delete u[R]}delete d.usages}}const a=[],c=Object.keys(i).sort();for(const l of c){const u=i[l];if(l in o){const d=u["@graph"]=[],g=o[l],p=Object.keys(g).sort();for(const y of p){const w=g[y];Jh.isSubjectReference(w)||d.push(w)}}Jh.isSubjectReference(u)||a.push(u)}return a};function u3(t,e,n){if(t.termType.endsWith("Node"))return{"@id":t.value};const r={"@value":t.value};if(t.language)r["@language"]=t.language;else{let i=t.datatype.value;if(i||(i=ep),i===a3){i="@json";try{r["@value"]=JSON.parse(r["@value"])}catch(o){throw new i3("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:r["@value"],cause:o})}}if(e){if(i===m_)r["@value"]==="true"?r["@value"]=!0:r["@value"]==="false"&&(r["@value"]=!1);else if(yl.isNumeric(r["@value"]))if(i===__){const o=parseInt(r["@value"],10);o.toFixed(0)===r["@value"]&&(r["@value"]=o)}else i===y_&&(r["@value"]=parseFloat(r["@value"]));[m_,__,y_,ep].includes(i)||(r["@type"]=i)}else if(n==="i18n-datatype"&&i.startsWith("https://www.w3.org/ns/i18n#")){const[,o,s]=i.split(/[#_]/);o.length>0&&(r["@language"]=o,o.match(c3)||console.warn(`@language must be valid BCP47: ${o}`)),r["@direction"]=s}else i!==ep&&(r["@type"]=i)}return r}var d3=function t(e){return e===null||typeof e!="object"||e.toJSON!=null?JSON.stringify(e):Array.isArray(e)?"["+e.reduce((n,r,i)=>{const o=i===0?"":",",s=r===void 0||typeof r=="symbol"?null:r;return n+o+t(s)},"")+"]":"{"+Object.keys(e).sort().reduce((n,r,i)=>{if(e[r]===void 0||typeof e[r]=="symbol")return n;const o=n.length===0?"":",";return n+o+t(r)+":"+t(e[r])},"")+"}"};const{createNodeMap:f3}=kf,{isKeyword:h3}=$a,w_=ms,p3=d3,ul=Qi,g3=yo,{RDF_FIRST:m3,RDF_REST:y3,RDF_NIL:_3,RDF_TYPE:w3,RDF_JSON_LITERAL:v3,RDF_LANGSTRING:b3,XSD_BOOLEAN:E3,XSD_DOUBLE:v_,XSD_INTEGER:S3,XSD_STRING:T3}=W0,{isAbsolute:Kd}=Ks,q1={};var A3=q1;q1.toRDF=(t,e)=>{const n=new g3.IdentifierIssuer("_:b"),r={"@default":{}};f3(t,r,"@default",n);const i=[],o=Object.keys(r).sort();for(const s of o){let a;if(s==="@default")a={termType:"DefaultGraph",value:""};else if(Kd(s))s.startsWith("_:")?a={termType:"BlankNode"}:a={termType:"NamedNode"},a.value=s;else continue;x3(i,r[s],a,n,e)}return i};function x3(t,e,n,r,i){const o=Object.keys(e).sort();for(const s of o){const a=e[s],c=Object.keys(a).sort();for(let l of c){const u=a[l];if(l==="@type")l=w3;else if(h3(l))continue;for(const d of u){const g={termType:s.startsWith("_:")?"BlankNode":"NamedNode",value:s};if(!Kd(s))continue;const p={termType:l.startsWith("_:")?"BlankNode":"NamedNode",value:l};if(!Kd(l)||p.termType==="BlankNode"&&!i.produceGeneralizedRdf)continue;const y=ug(d,r,t,n,i.rdfDirection);y&&t.push({subject:g,predicate:p,object:y,graph:n})}}}}function I3(t,e,n,r,i){const o={termType:"NamedNode",value:m3},s={termType:"NamedNode",value:y3},a={termType:"NamedNode",value:_3},c=t.pop(),l=c?{termType:"BlankNode",value:e.getId()}:a;let u=l;for(const d of t){const g=ug(d,e,n,r,i),p={termType:"BlankNode",value:e.getId()};n.push({subject:u,predicate:o,object:g,graph:r}),n.push({subject:u,predicate:s,object:p,graph:r}),u=p}if(c){const d=ug(c,e,n,r,i);n.push({subject:u,predicate:o,object:d,graph:r}),n.push({subject:u,predicate:s,object:a,graph:r})}return l}function ug(t,e,n,r,i){const o={};if(w_.isValue(t)){o.termType="Literal",o.value=void 0,o.datatype={termType:"NamedNode"};let s=t["@value"];const a=t["@type"]||null;if(a==="@json")o.value=p3(s),o.datatype.value=v3;else if(ul.isBoolean(s))o.value=s.toString(),o.datatype.value=a||E3;else if(ul.isDouble(s)||a===v_)ul.isDouble(s)||(s=parseFloat(s)),o.value=s.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),o.datatype.value=a||v_;else if(ul.isNumber(s))o.value=s.toFixed(0),o.datatype.value=a||S3;else if(i==="i18n-datatype"&&"@direction"in t){const c="https://www.w3.org/ns/i18n#"+(t["@language"]||"")+`_${t["@direction"]}`;o.datatype.value=c,o.value=s}else"@language"in t?(o.value=s,o.datatype.value=a||b3,o.language=t["@language"]):(o.value=s,o.datatype.value=a||T3)}else if(w_.isList(t)){const s=I3(t["@list"],e,n,r,i);o.termType=s.termType,o.value=s.value}else{const s=ul.isObject(t)?t["@id"]:t;o.termType=s.startsWith("_:")?"BlankNode":"NamedNode",o.value=s}return o.termType==="NamedNode"&&!Kd(o.value)?null:o}const{isKeyword:dg}=$a,$i=ms,nn=Qi,Dr=yo,b_=Ks,Il=qo,{createNodeMap:R3,mergeNodeMapGraphs:k3}=kf,Bi={};var F3=Bi;Bi.frameMergedOrDefault=(t,e,n)=>{const r={options:n,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},i=new Dr.IdentifierIssuer("_:b");R3(t,r.graphMap,"@default",i),n.merged&&(r.graphMap["@merged"]=k3(r.graphMap),r.graph="@merged"),r.subjects=r.graphMap[r.graph];const o=[];Bi.frame(r,Object.keys(r.subjects).sort(),e,o),n.pruneBlankNodeIdentifiers&&(n.bnodesToClear=Object.keys(r.bnodeMap).filter(s=>r.bnodeMap[s].length===1));// remove @preserve from results
return n.link={},fd(o,n)};Bi.frame=(t,e,n,r,i=null)=>{V1(n),n=n[0];const o=t.options,s={embed:qu(n,o,"embed"),explicit:qu(n,o,"explicit"),requireAll:qu(n,o,"requireAll")};t.link.hasOwnProperty(t.graph)||(t.link[t.graph]={});const a=t.link[t.graph],c=C3(t,e,n,s),l=Object.keys(c).sort();for(const u of l){const d=c[u];if(i===null?t.uniqueEmbeds={[t.graph]:{}}:t.uniqueEmbeds[t.graph]=t.uniqueEmbeds[t.graph]||{},s.embed==="@link"&&u in a){na(r,i,a[u]);continue}const g={"@id":u};if(u.indexOf("_:")===0&&Dr.addValue(t.bnodeMap,u,g,{propertyIsArray:!0}),a[u]=g,(s.embed==="@first"||s.embed==="@last")&&t.is11)throw new Il("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:n});if(!(!t.embedded&&t.uniqueEmbeds[t.graph].hasOwnProperty(u))){if(t.embedded&&(s.embed==="@never"||D3(d,t.graph,t.subjectStack))){na(r,i,g);continue}if(t.embedded&&(s.embed=="@first"||s.embed=="@once")&&t.uniqueEmbeds[t.graph].hasOwnProperty(u)){na(r,i,g);continue}if(s.embed==="@last"&&u in t.uniqueEmbeds[t.graph]&&P3(t,u),t.uniqueEmbeds[t.graph][u]={parent:r,property:i},t.subjectStack.push({subject:d,graph:t.graph}),u in t.graphMap){let p=!1,y=null;"@graph"in n?(y=n["@graph"][0],p=!(u==="@merged"||u==="@default"),nn.isObject(y)||(y={})):(p=t.graph!=="@merged",y={}),p&&Bi.frame({...t,graph:u,embedded:!1},Object.keys(t.graphMap[u]).sort(),[y],g,"@graph")}"@included"in n&&Bi.frame({...t,embedded:!1},e,n["@included"],g,"@included");for(const p of Object.keys(d).sort()){if(dg(p)){if(g[p]=Dr.clone(d[p]),p==="@type")for(const y of d["@type"])y.indexOf("_:")===0&&Dr.addValue(t.bnodeMap,y,g,{propertyIsArray:!0});continue}if(!(s.explicit&&!(p in n)))for(const y of d[p]){const w=p in n?n[p]:E_(s);if($i.isList(y)){const E=n[p]&&n[p][0]&&n[p][0]["@list"]?n[p][0]["@list"]:E_(s),b={"@list":[]};na(g,p,b);const S=y["@list"];for(const R of S)$i.isSubjectReference(R)?Bi.frame({...t,embedded:!0},[R["@id"]],E,b,"@list"):na(b,"@list",Dr.clone(R))}else $i.isSubjectReference(y)?Bi.frame({...t,embedded:!0},[y["@id"]],w,g,p):fg(w[0],y)&&na(g,p,Dr.clone(y))}}for(const p of Object.keys(n).sort()){if(p==="@type"){if(!nn.isObject(n[p][0])||!("@default"in n[p][0]))continue}else if(dg(p))continue;const y=n[p][0]||{};if(!qu(y,o,"omitDefault")&&!(p in g)){let E="@null";"@default"in y&&(E=Dr.clone(y["@default"])),nn.isArray(E)||(E=[E]),g[p]=[{"@preserve":E}]}}for(const p of Object.keys(n["@reverse"]||{}).sort()){const y=n["@reverse"][p];for(const w of Object.keys(t.subjects))Dr.getValues(t.subjects[w],p).some(b=>b["@id"]===u)&&(g["@reverse"]=g["@reverse"]||{},Dr.addValue(g["@reverse"],p,[],{propertyIsArray:!0}),Bi.frame({...t,embedded:!0},[w],y,g["@reverse"][p],i))}na(r,i,g),t.subjectStack.pop()}}};Bi.cleanupNull=(t,e)=>{if(nn.isArray(t))return t.map(r=>Bi.cleanupNull(r,e)).filter(r=>r);if(t==="@null")return null;if(nn.isObject(t)){if("@id"in t){const n=t["@id"];if(e.link.hasOwnProperty(n)){const r=e.link[n].indexOf(t);if(r!==-1)return e.link[n][r];e.link[n].push(t)}else e.link[n]=[t]}for(const n in t)t[n]=Bi.cleanupNull(t[n],e)}return t};function E_(t){const e={};for(const n in t)t[n]!==void 0&&(e["@"+n]=[t[n]]);return[e]}function D3(t,e,n){for(let r=n.length-1;r>=0;--r){const i=n[r];if(i.graph===e&&i.subject["@id"]===t["@id"])return!0}return!1}function qu(t,e,n){const r="@"+n;let i=r in t?t[r][0]:e[n];if(n==="embed"){if(i===!0)i="@once";else if(i===!1)i="@never";else if(i!=="@always"&&i!=="@never"&&i!=="@link"&&i!=="@first"&&i!=="@last"&&i!=="@once")throw new Il("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:t})}return i}function V1(t){if(!nn.isArray(t)||t.length!==1||!nn.isObject(t[0]))throw new Il("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:t});if("@id"in t[0]){for(const e of Dr.asArray(t[0]["@id"]))if(!(nn.isObject(e)||b_.isAbsolute(e))||nn.isString(e)&&e.indexOf("_:")===0)throw new Il("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:t})}if("@type"in t[0]){for(const e of Dr.asArray(t[0]["@type"]))if(!(nn.isObject(e)||b_.isAbsolute(e))||nn.isString(e)&&e.indexOf("_:")===0)throw new Il("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:t})}}function C3(t,e,n,r){const i={};for(const o of e){const s=t.graphMap[t.graph][o];z1(t,s,n,r)&&(i[o]=s)}return i}function z1(t,e,n,r){let i=!0,o=!1;for(const s in n){let a=!1;const c=Dr.getValues(e,s),l=Dr.getValues(n,s).length===0;if(s==="@id"){if(nn.isEmptyObject(n["@id"][0]||{})?a=!0:n["@id"].length>=0&&(a=n["@id"].includes(c[0])),!r.requireAll)return a}else if(s==="@type"){if(i=!1,l){if(c.length>0)return!1;a=!0}else if(n["@type"].length===1&&nn.isEmptyObject(n["@type"][0]))a=c.length>0;else for(const u of n["@type"])nn.isObject(u)&&"@default"in u?a=!0:a=a||c.some(d=>d===u);if(!r.requireAll)return a}else{if(dg(s))continue;{const u=Dr.getValues(n,s)[0];let d=!1;if(u&&(V1([u]),d="@default"in u),i=!1,c.length===0&&d)continue;if(c.length>0&&l)return!1;if(u===void 0){if(c.length>0)return!1;a=!0}else if($i.isList(u)){const g=u["@list"][0];if($i.isList(c[0])){const p=c[0]["@list"];$i.isValue(g)?a=p.some(y=>fg(g,y)):($i.isSubject(g)||$i.isSubjectReference(g))&&(a=p.some(y=>S_(t,g,y,r)))}}else $i.isValue(u)?a=c.some(g=>fg(u,g)):$i.isSubjectReference(u)?a=c.some(g=>S_(t,u,g,r)):nn.isObject(u)?a=c.length>0:a=!1}}if(!a&&r.requireAll)return!1;o=o||a}return i||o}function P3(t,e){const n=t.uniqueEmbeds[t.graph],r=n[e],i=r.parent,o=r.property,s={"@id":e};if(nn.isArray(i)){for(let c=0;c<i.length;++c)if(Dr.compareValues(i[c],s)){i[c]=s;break}}else{const c=nn.isArray(i[o]);Dr.removeValue(i,o,s,{propertyIsArray:c}),Dr.addValue(i,o,s,{propertyIsArray:c})}const a=c=>{const l=Object.keys(n);for(const u of l)u in n&&nn.isObject(n[u].parent)&&n[u].parent["@id"]===c&&(delete n[u],a(u))};a(e)}/**
 * Removes the @preserve keywords from expanded result of framing.
 *
 * @param input the framed, framed output.
 * @param options the framing options used.
 *
 * @return the resulting output.
 */function fd(t,e){if(nn.isArray(t))return t.map(n=>fd(n,e));if(nn.isObject(t)){// remove @preserve
if("@preserve"in t)return t["@preserve"][0];if($i.isValue(t))return t;if($i.isList(t))return t["@list"]=fd(t["@list"],e),t;if("@id"in t){const n=t["@id"];if(e.link.hasOwnProperty(n)){const r=e.link[n].indexOf(t);if(r!==-1)return e.link[n][r];e.link[n].push(t)}else e.link[n]=[t]}for(const n in t){if(n==="@id"&&e.bnodesToClear.includes(t[n])){delete t["@id"];continue}t[n]=fd(t[n],e)}}return t}function na(t,e,n){nn.isObject(t)?Dr.addValue(t,e,n,{propertyIsArray:!0}):t.push(n)}function S_(t,e,n,r){if(!("@id"in n))return!1;const i=t.subjects[n["@id"]];return i&&z1(t,i,e,r)}function fg(t,e){const n=e["@value"],r=e["@type"],i=e["@language"],o=t["@value"]?nn.isArray(t["@value"])?t["@value"]:[t["@value"]]:[],s=t["@type"]?nn.isArray(t["@type"])?t["@type"]:[t["@type"]]:[],a=t["@language"]?nn.isArray(t["@language"])?t["@language"]:[t["@language"]]:[];return o.length===0&&s.length===0&&a.length===0?!0:!(!(o.includes(n)||nn.isEmptyObject(o[0]))||!(!r&&s.length===0||s.includes(r)||r&&nn.isEmptyObject(s[0]))||!(!i&&a.length===0||a.includes(i)||i&&nn.isEmptyObject(a[0])))}const V0=qo,{isArray:ws,isObject:ks,isString:G1,isUndefined:tp}=Qi,{isList:hg,isValue:os,isGraph:Y1,isSimpleGraph:T_,isSubjectReference:np}=ms,{expandIri:J1,getContextValue:si,isKeyword:Z1,process:rp,processingMode:N3}=$a,{removeBase:A_,prependBase:O3}=Ks,{addValue:Ti,asArray:Vu,compareShortestLeast:M3}=yo,dt={};var L3=dt;dt.compact=async({activeCtx:t,activeProperty:e=null,element:n,options:r={},compactionMap:i=()=>{}})=>{if(ws(n)){let s=[];for(let a=0;a<n.length;++a){let c=await dt.compact({activeCtx:t,activeProperty:e,element:n[a],options:r,compactionMap:i});c===null&&(c=await i({unmappedValue:n[a],activeCtx:t,activeProperty:e,parent:n,index:a,options:r}),c===void 0)||s.push(c)}return r.compactArrays&&s.length===1&&(si(t,e,"@container")||[]).length===0&&(s=s[0]),s}const o=si(t,e,"@context");if(tp(o)||(t=await rp({activeCtx:t,localCtx:o,propagate:!0,overrideProtected:!0,options:r})),ks(n)){if(r.link&&"@id"in n&&r.link.hasOwnProperty(n["@id"])){const p=r.link[n["@id"]];for(let y=0;y<p.length;++y)if(p[y].expanded===n)return p[y].compacted}if(os(n)||np(n)){const p=dt.compactValue({activeCtx:t,activeProperty:e,value:n,options:r});return r.link&&np(n)&&(r.link.hasOwnProperty(n["@id"])||(r.link[n["@id"]]=[]),r.link[n["@id"]].push({expanded:n,compacted:p})),p}if(hg(n)&&(si(t,e,"@container")||[]).includes("@list"))return dt.compact({activeCtx:t,activeProperty:e,element:n["@list"],options:r,compactionMap:i});const s=e==="@reverse",a={},c=t;!os(n)&&!np(n)&&(t=t.revertToPreviousContext());const l=si(c,e,"@context");tp(l)||(t=await rp({activeCtx:t,localCtx:l,propagate:!0,overrideProtected:!0,options:r})),r.link&&"@id"in n&&(r.link.hasOwnProperty(n["@id"])||(r.link[n["@id"]]=[]),r.link[n["@id"]].push({expanded:n,compacted:a}));let u=n["@type"]||[];u.length>1&&(u=Array.from(u).sort());const d=t;for(const p of u){const y=dt.compactIri({activeCtx:d,iri:p,relativeTo:{vocab:!0}}),w=si(c,y,"@context");tp(w)||(t=await rp({activeCtx:t,localCtx:w,options:r,propagate:!1}))}const g=Object.keys(n).sort();for(const p of g){const y=n[p];if(p==="@id"){let w=Vu(y).map(b=>dt.compactIri({activeCtx:t,iri:b,relativeTo:{vocab:!1},base:r.base}));w.length===1&&(w=w[0]);const E=dt.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}});a[E]=w;continue}if(p==="@type"){let w=Vu(y).map(F=>dt.compactIri({activeCtx:c,iri:F,relativeTo:{vocab:!0}}));w.length===1&&(w=w[0]);const E=dt.compactIri({activeCtx:t,iri:"@type",relativeTo:{vocab:!0}}),R=(si(t,E,"@container")||[]).includes("@set")&&N3(t,1.1)||ws(w)&&y.length===0;Ti(a,E,w,{propertyIsArray:R});continue}if(p==="@reverse"){const w=await dt.compact({activeCtx:t,activeProperty:"@reverse",element:y,options:r,compactionMap:i});for(const E in w)if(t.mappings.has(E)&&t.mappings.get(E).reverse){const b=w[E],R=(si(t,E,"@container")||[]).includes("@set")||!r.compactArrays;Ti(a,E,b,{propertyIsArray:R}),delete w[E]}if(Object.keys(w).length>0){const E=dt.compactIri({activeCtx:t,iri:p,relativeTo:{vocab:!0}});Ti(a,E,w)}continue}if(p==="@preserve"){const w=await dt.compact({activeCtx:t,activeProperty:e,element:y,options:r,compactionMap:i});ws(w)&&w.length===0||Ti(a,p,w);continue}if(p==="@index"){if((si(t,e,"@container")||[]).includes("@index"))continue;const E=dt.compactIri({activeCtx:t,iri:p,relativeTo:{vocab:!0}});Ti(a,E,y);continue}if(p!=="@graph"&&p!=="@list"&&p!=="@included"&&Z1(p)){const w=dt.compactIri({activeCtx:t,iri:p,relativeTo:{vocab:!0}});Ti(a,w,y);continue}if(!ws(y))throw new V0("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(y.length===0){const w=dt.compactIri({activeCtx:t,iri:p,value:y,relativeTo:{vocab:!0},reverse:s}),E=t.mappings.has(w)?t.mappings.get(w)["@nest"]:null;let b=a;E&&(x_(t,E,r),ks(a[E])||(a[E]={}),b=a[E]),Ti(b,w,y,{propertyIsArray:!0})}for(const w of y){const E=dt.compactIri({activeCtx:t,iri:p,value:w,relativeTo:{vocab:!0},reverse:s}),b=t.mappings.has(E)?t.mappings.get(E)["@nest"]:null;let S=a;b&&(x_(t,b,r),ks(a[b])||(a[b]={}),S=a[b]);const R=si(t,E,"@container")||[],F=Y1(w),M=hg(w);let P;M?P=w["@list"]:F&&(P=w["@graph"]);let D=await dt.compact({activeCtx:t,activeProperty:E,element:M||F?P:w,options:r,compactionMap:i});if(M)if(ws(D)||(D=[D]),!R.includes("@list"))D={[dt.compactIri({activeCtx:t,iri:"@list",relativeTo:{vocab:!0}})]:D},"@index"in w&&(D[dt.compactIri({activeCtx:t,iri:"@index",relativeTo:{vocab:!0}})]=w["@index"]);else{Ti(S,E,D,{valueIsArray:!0,allowDuplicate:!0});continue}if(F)if(R.includes("@graph")&&(R.includes("@id")||R.includes("@index")&&T_(w))){let Y;S.hasOwnProperty(E)?Y=S[E]:S[E]=Y={};const X=(R.includes("@id")?w["@id"]:w["@index"])||dt.compactIri({activeCtx:t,iri:"@none",relativeTo:{vocab:!0}});Ti(Y,X,D,{propertyIsArray:!r.compactArrays||R.includes("@set")})}else R.includes("@graph")&&T_(w)?(ws(D)&&D.length>1&&(D={"@included":D}),Ti(S,E,D,{propertyIsArray:!r.compactArrays||R.includes("@set")})):(ws(D)&&D.length===1&&r.compactArrays&&(D=D[0]),D={[dt.compactIri({activeCtx:t,iri:"@graph",relativeTo:{vocab:!0}})]:D},"@id"in w&&(D[dt.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}})]=w["@id"]),"@index"in w&&(D[dt.compactIri({activeCtx:t,iri:"@index",relativeTo:{vocab:!0}})]=w["@index"]),Ti(S,E,D,{propertyIsArray:!r.compactArrays||R.includes("@set")}));else if(R.includes("@language")||R.includes("@index")||R.includes("@id")||R.includes("@type")){let Y;S.hasOwnProperty(E)?Y=S[E]:S[E]=Y={};let X;if(R.includes("@language"))os(D)&&(D=D["@value"]),X=w["@language"];else if(R.includes("@index")){const $=si(t,E,"@index")||"@index",te=dt.compactIri({activeCtx:t,iri:$,relativeTo:{vocab:!0}});if($==="@index")X=w["@index"],delete D[te];else{let _e;if([X,..._e]=Vu(D[$]||[]),!G1(X))X=null;else switch(_e.length){case 0:delete D[$];break;case 1:D[$]=_e[0];break;default:D[$]=_e;break}}}else if(R.includes("@id")){const $=dt.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}});X=D[$],delete D[$]}else if(R.includes("@type")){const $=dt.compactIri({activeCtx:t,iri:"@type",relativeTo:{vocab:!0}});let te;switch([X,...te]=Vu(D[$]||[]),te.length){case 0:delete D[$];break;case 1:D[$]=te[0];break;default:D[$]=te;break}Object.keys(D).length===1&&"@id"in w&&(D=await dt.compact({activeCtx:t,activeProperty:E,element:{"@id":w["@id"]},options:r,compactionMap:i}))}X||(X=dt.compactIri({activeCtx:t,iri:"@none",relativeTo:{vocab:!0}})),Ti(Y,X,D,{propertyIsArray:R.includes("@set")})}else{const Y=!r.compactArrays||R.includes("@set")||R.includes("@list")||ws(D)&&D.length===0||p==="@list"||p==="@graph";Ti(S,E,D,{propertyIsArray:Y})}}}return a}return n};dt.compactIri=({activeCtx:t,iri:e,value:n=null,relativeTo:r={vocab:!1},reverse:i=!1,base:o=null})=>{if(e===null)return e;t.isPropertyTermScoped&&t.previousContext&&(t=t.previousContext);const s=t.getInverse();if(Z1(e)&&e in s&&"@none"in s[e]&&"@type"in s[e]["@none"]&&"@none"in s[e]["@none"]["@type"])return s[e]["@none"]["@type"]["@none"];if(r.vocab&&e in s){const d=t["@language"]||"@none",g=[];ks(n)&&"@index"in n&&!("@graph"in n)&&g.push("@index","@index@set"),ks(n)&&"@preserve"in n&&(n=n["@preserve"][0]),Y1(n)?("@index"in n&&g.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in n&&g.push("@graph@id","@graph@id@set"),g.push("@graph","@graph@set","@set"),"@index"in n||g.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in n||g.push("@graph@id","@graph@id@set")):ks(n)&&!os(n)&&g.push("@id","@id@set","@type","@set@type");let p="@language",y="@null";if(i)p="@type",y="@reverse",g.push("@set");else if(hg(n)){"@index"in n||g.push("@list");const E=n["@list"];if(E.length===0)p="@any",y="@none";else{let b=E.length===0?d:null,S=null;for(let R=0;R<E.length;++R){const F=E[R];let M="@none",P="@none";if(os(F))if("@direction"in F){const D=(F["@language"]||"").toLowerCase(),Y=F["@direction"];M=`${D}_${Y}`}else"@language"in F?M=F["@language"].toLowerCase():"@type"in F?P=F["@type"]:M="@null";else P="@id";if(b===null?b=M:M!==b&&os(F)&&(b="@none"),S===null?S=P:P!==S&&(S="@none"),b==="@none"&&S==="@none")break}b=b||"@none",S=S||"@none",S!=="@none"?(p="@type",y=S):y=b}}else{if(os(n))if("@language"in n&&!("@index"in n)){g.push("@language","@language@set"),y=n["@language"];const E=n["@direction"];E&&(y=`${y}_${E}`)}else"@direction"in n&&!("@index"in n)?y=`_${n["@direction"]}`:"@type"in n&&(p="@type",y=n["@type"]);else p="@type",y="@id";g.push("@set")}g.push("@none"),ks(n)&&!("@index"in n)&&g.push("@index","@index@set"),os(n)&&Object.keys(n).length===1&&g.push("@language","@language@set");const w=U3(t,e,n,g,p,y);if(w!==null)return w}if(r.vocab&&"@vocab"in t){const d=t["@vocab"];if(e.indexOf(d)===0&&e!==d){const g=e.substr(d.length);if(!t.mappings.has(g))return g}}let a=null;const c=[];let l=t.fastCurieMap;const u=e.length-1;for(let d=0;d<u&&e[d]in l;++d)l=l[e[d]],""in l&&c.push(l[""][0]);for(let d=c.length-1;d>=0;--d){const g=c[d],p=g.terms;for(const y of p){const w=y+":"+e.substr(g.iri.length);t.mappings.get(y)._prefix&&(!t.mappings.has(w)||n===null&&t.mappings.get(w)["@id"]===e)&&(a===null||M3(w,a)<0)&&(a=w)}}if(a!==null)return a;for(const[d,g]of t.mappings)if(g&&g._prefix&&e.startsWith(d+":"))throw new V0(`Absolute IRI "${e}" confused with prefix "${d}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:t});return r.vocab?e:"@base"in t?t["@base"]?A_(O3(o,t["@base"]),e):e:A_(o,e)};dt.compactValue=({activeCtx:t,activeProperty:e,value:n,options:r})=>{if(os(n)){const a=si(t,e,"@type"),c=si(t,e,"@language"),l=si(t,e,"@direction"),u=si(t,e,"@container")||[],d="@index"in n&&!u.includes("@index");if(!d&&a!=="@none"&&(n["@type"]===a||"@language"in n&&n["@language"]===c&&"@direction"in n&&n["@direction"]===l||"@language"in n&&n["@language"]===c||"@direction"in n&&n["@direction"]===l))return n["@value"];const g=Object.keys(n).length,p=g===1||g===2&&"@index"in n&&!d,y="@language"in t,w=G1(n["@value"]),E=t.mappings.has(e)&&t.mappings.get(e)["@language"]===null;if(p&&a!=="@none"&&(!y||!w||E))return n["@value"];const b={};return d&&(b[dt.compactIri({activeCtx:t,iri:"@index",relativeTo:{vocab:!0}})]=n["@index"]),"@type"in n?b[dt.compactIri({activeCtx:t,iri:"@type",relativeTo:{vocab:!0}})]=dt.compactIri({activeCtx:t,iri:n["@type"],relativeTo:{vocab:!0}}):"@language"in n&&(b[dt.compactIri({activeCtx:t,iri:"@language",relativeTo:{vocab:!0}})]=n["@language"]),"@direction"in n&&(b[dt.compactIri({activeCtx:t,iri:"@direction",relativeTo:{vocab:!0}})]=n["@direction"]),b[dt.compactIri({activeCtx:t,iri:"@value",relativeTo:{vocab:!0}})]=n["@value"],b}const i=J1(t,e,{vocab:!0},r),o=si(t,e,"@type"),s=dt.compactIri({activeCtx:t,iri:n["@id"],relativeTo:{vocab:o==="@vocab"},base:r.base});return o==="@id"||o==="@vocab"||i==="@graph"?s:{[dt.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}})]:s}};function U3(t,e,n,r,i,o){o===null&&(o="@null");const s=[];if((o==="@id"||o==="@reverse")&&ks(n)&&"@id"in n){o==="@reverse"&&s.push("@reverse");const c=dt.compactIri({activeCtx:t,iri:n["@id"],relativeTo:{vocab:!0}});t.mappings.has(c)&&t.mappings.get(c)&&t.mappings.get(c)["@id"]===n["@id"]?s.push.apply(s,["@vocab","@id"]):s.push.apply(s,["@id","@vocab"])}else{s.push(o);const c=s.find(l=>l.includes("_"));c&&s.push(c.replace(/^[^_]+_/,"_"))}s.push("@none");const a=t.inverse[e];for(const c of r){if(!(c in a))continue;const l=a[c][i];for(const u of s)if(u in l)return l[u]}return null}function x_(t,e,n){if(J1(t,e,{vocab:!0},n)!=="@nest")throw new V0("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}var j3=t=>{class e{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(e,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(e.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:e}),e.compact=function(n,r){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):t.compact(n,r)},e.expand=function(n){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):t.expand(n)},e.flatten=function(n){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):t.flatten(n)},e};/**
 * A JavaScript implementation of the JSON-LD API.
 *
 * @author Dave Longley
 *
 * @license BSD 3-Clause License
 * Copyright (c) 2011-2019 Digital Bazaar, Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 *
 * Redistributions in binary form must reproduce the above copyright
 * notice, this list of conditions and the following disclaimer in the
 * documentation and/or other materials provided with the distribution.
 *
 * Neither the name of the Digital Bazaar, Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
 * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
 * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
 * PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
 * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */const I_=K0,R_=R6,bs=yo,Qo=$6,ip=bs.IdentifierIssuer,vs=qo,$3=M1,zu=H6,{expand:B3}=Z6,{flatten:H3}=r3,{fromRDF:K3}=l3,{toRDF:W3}=A3,{frameMergedOrDefault:q3,cleanupNull:V3}=F3,{isArray:tc,isObject:ra,isString:vo}=Qi,{isSubjectReference:z3}=ms,{expandIri:G3,getInitialContext:Gu,process:k_,processingMode:op}=$a,{compact:Y3,compactIri:J3}=L3,{createNodeMap:Z3,createMergedNodeMap:Q3,mergeNodeMaps:X3}=kf,Q1=function(t){const e={},r=new $3({max:100});t.compact=async function(o,s,a){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(s===null)throw new vs("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(o===null)return null;a=i(a,{base:vo(o)?o:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new ip("_:b"),contextResolver:new Qo({sharedCache:r})}),a.link&&(a.skipExpansion=!0),a.compactToRelative||delete a.base;let c;a.skipExpansion?c=o:c=await t.expand(o,a);const l=await t.processContext(Gu(a),s,a);let u=await Y3({activeCtx:l,element:c,options:a,compactionMap:a.compactionMap});a.compactArrays&&!a.graph&&tc(u)?u.length===1?u=u[0]:u.length===0&&(u={}):a.graph&&ra(u)&&(u=[u]),ra(s)&&"@context"in s&&(s=s["@context"]),s=bs.clone(s),tc(s)||(s=[s]);const d=s;s=[];for(let p=0;p<d.length;++p)(!ra(d[p])||Object.keys(d[p]).length>0)&&s.push(d[p]);const g=s.length>0;if(s.length===1&&(s=s[0]),tc(u)){const p=J3({activeCtx:l,iri:"@graph",relativeTo:{vocab:!0}}),y=u;u={},g&&(u["@context"]=s),u[p]=y}else if(ra(u)&&g){const p=u;u={"@context":s};for(const y in p)u[y]=p[y]}return u},t.expand=async function(o,s){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");s=i(s,{keepFreeFloatingNodes:!1,contextResolver:new Qo({sharedCache:r})}),s.expansionMap===!1&&(s.expansionMap=void 0);const a={},c=[];if("expandContext"in s){const g=bs.clone(s.expandContext);ra(g)&&"@context"in g?a.expandContext=g:a.expandContext={"@context":g},c.push(a.expandContext)}let l;if(!vo(o))a.input=bs.clone(o);else{const g=await t.get(o,s);l=g.documentUrl,a.input=g.document,g.contextUrl&&(a.remoteContext={"@context":g.contextUrl},c.push(a.remoteContext))}"base"in s||(s.base=l||"");let u=Gu(s);for(const g of c)u=await k_({activeCtx:u,localCtx:g,options:s});let d=await B3({activeCtx:u,element:a.input,options:s,expansionMap:s.expansionMap});return ra(d)&&"@graph"in d&&Object.keys(d).length===1?d=d["@graph"]:d===null&&(d=[]),tc(d)||(d=[d]),d},t.flatten=async function(o,s,a){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");typeof s=="function"?s=null:s=s||null,a=i(a,{base:vo(o)?o:"",contextResolver:new Qo({sharedCache:r})});const c=await t.expand(o,a),l=H3(c);return s===null?l:(a.graph=!0,a.skipExpansion=!0,await t.compact(l,s,a))},t.frame=async function(o,s,a){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(a=i(a,{base:vo(o)?o:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new Qo({sharedCache:r})}),vo(s)){const E=await t.get(s,a);if(s=E.document,E.contextUrl){let b=s["@context"];b?tc(b)?b.push(E.contextUrl):b=[b,E.contextUrl]:b=E.contextUrl,s["@context"]=b}}const c=s?s["@context"]||{}:{},l=await t.processContext(Gu(a),c,a);a.hasOwnProperty("omitGraph")||(a.omitGraph=op(l,1.1)),a.hasOwnProperty("pruneBlankNodeIdentifiers")||(a.pruneBlankNodeIdentifiers=op(l,1.1));const u=await t.expand(o,a),d={...a};d.isFrame=!0,d.keepFreeFloatingNodes=!0;const g=await t.expand(s,d),p=Object.keys(s).map(E=>G3(l,E,{vocab:!0}));d.merged=!p.includes("@graph"),d.is11=op(l,1.1);const y=q3(u,g,d);d.graph=!a.omitGraph,d.skipExpansion=!0,d.link={},d.framing=!0;let w=await t.compact(y,c,d);return d.link={},w=V3(w,d),w},t.link=async function(o,s,a){const c={};return s&&(c["@context"]=s),c["@embed"]="@link",t.frame(o,c,a)},t.normalize=t.canonize=async function(o,s){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if(s=i(s,{base:vo(o)?o:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new Qo({sharedCache:r})}),"inputFormat"in s){if(s.inputFormat!=="application/n-quads"&&s.inputFormat!=="application/nquads")throw new vs("Unknown canonicalization input format.","jsonld.CanonizeError");const l=zu.parse(o);return I_.canonize(l,s)}const a={...s};delete a.format,a.produceGeneralizedRdf=!1;const c=await t.toRDF(o,a);return I_.canonize(c,s)},t.fromRDF=async function(o,s){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");s=i(s,{format:vo(o)?"application/n-quads":void 0});const{format:a}=s;let{rdfParser:c}=s;if(a){if(c=c||e[a],!c)throw new vs("Unknown input format.","jsonld.UnknownFormat",{format:a})}else c=()=>o;const l=await c(o);return K3(l,s)},t.toRDF=async function(o,s){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");s=i(s,{base:vo(o)?o:"",skipExpansion:!1,contextResolver:new Qo({sharedCache:r})});let a;s.skipExpansion?a=o:a=await t.expand(o,s);const c=W3(a,s);if(s.format){if(s.format==="application/n-quads"||s.format==="application/nquads")return zu.serialize(c);throw new vs("Unknown output format.","jsonld.UnknownFormat",{format:s.format})}return c},t.createNodeMap=async function(o,s){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");s=i(s,{base:vo(o)?o:"",contextResolver:new Qo({sharedCache:r})});const a=await t.expand(o,s);return Q3(a,s)},t.merge=async function(o,s,a){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!tc(o))throw new TypeError('Could not merge, "docs" must be an array.');typeof s=="function"?s=null:s=s||null,a=i(a,{contextResolver:new Qo({sharedCache:r})});const c=await Promise.all(o.map(E=>{const b={...a};return t.expand(E,b)}));let l=!0;"mergeNodes"in a&&(l=a.mergeNodes);const u=a.issuer||new ip("_:b"),d={"@default":{}};for(let E=0;E<c.length;++E){const b=bs.relabelBlankNodes(c[E],{issuer:new ip("_:b"+E+"-")}),S=l||E===0?d:{"@default":{}};if(Z3(b,S,"@default",u),S!==d)for(const R in S){const F=S[R];if(!(R in d)){d[R]=F;continue}const M=d[R];for(const P in F)P in M||(M[P]=F[P])}}const g=X3(d),p=[],y=Object.keys(g).sort();for(let E=0;E<y.length;++E){const b=g[y[E]];z3(b)||p.push(b)}return s===null?p:(a.graph=!0,a.skipExpansion=!0,await t.compact(p,s,a))},Object.defineProperty(t,"documentLoader",{get:()=>t._documentLoader,set:o=>t._documentLoader=o}),t.documentLoader=async o=>{throw new vs("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:o})},t.get=async function(o,s){let a;typeof s.documentLoader=="function"?a=s.documentLoader:a=t.documentLoader;const c=await a(o);try{if(!c.document)throw new vs("No remote document found at the given URL.","jsonld.NullRemoteDocument");vo(c.document)&&(c.document=JSON.parse(c.document))}catch(l){throw new vs("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:l,remoteDoc:c})}return c},t.processContext=async function(o,s,a){return a=i(a,{base:"",contextResolver:new Qo({sharedCache:r})}),s===null?Gu(a):(s=bs.clone(s),ra(s)&&"@context"in s||(s={"@context":s}),k_({activeCtx:o,localCtx:s,options:a}))},t.getContextValue=$a.getContextValue,t.documentLoaders={},t.useDocumentLoader=function(o){if(!(o in t.documentLoaders))throw new vs('Unknown document loader type: "'+o+'"',"jsonld.UnknownDocumentLoader",{type:o});t.documentLoader=t.documentLoaders[o].apply(t,Array.prototype.slice.call(arguments,1))},t.registerRDFParser=function(o,s){e[o]=s},t.unregisterRDFParser=function(o){delete e[o]},t.registerRDFParser("application/n-quads",zu.parse),t.registerRDFParser("application/nquads",zu.parse),t.url=Ks,t.util=bs,Object.assign(t,bs),t.promises=t,t.RequestQueue=N1,t.JsonLdProcessor=j3(t),R_.setupGlobals(t),R_.setupDocumentLoaders(t);function i(o,{documentLoader:s=t.documentLoader,...a}){return Object.assign({},{documentLoader:s},a,o)}return t},X1=function(){return Q1(function(){return X1()})};Q1(X1);const dl="http://www.w3.org/1999/02/22-rdf-syntax-ns#",fl="http://www.w3.org/2001/XMLSchema#",sp="http://www.w3.org/2000/10/swap/";var Qr={xsd:{decimal:`${fl}decimal`,boolean:`${fl}boolean`,double:`${fl}double`,integer:`${fl}integer`,string:`${fl}string`},rdf:{type:`${dl}type`,nil:`${dl}nil`,first:`${dl}first`,rest:`${dl}rest`,langString:`${dl}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${sp}reify#forSome`,forAll:`${sp}reify#forAll`},log:{implies:`${sp}log#implies`}};/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let F_;var eF=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window!="undefined"?window:Vt):t=>(F_||(F_=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0)),tF=eF;const{xsd:Yu}=Qr,nF=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,D_={"\\":"\\","'":"'",'"':'"',n:`
`,r:"\r",t:"	",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},rF=/[\x00-\x20<>\\"\{\}\|\^\`]/,iF={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},oF=/$0^/;class sF{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._lineMode=!!e.lineMode){this._n3Mode=!1;for(const n in this)!(n in iF)&&this[n]instanceof RegExp&&(this[n]=oF)}else this._n3Mode=e.n3!==!1;this._comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,n){let r=this._input,i=r.length;for(;;){let a,c;for(;a=this._newline.exec(r);)this._comments&&(c=this._comment.exec(a[0]))&&o("comment",c[1],"",this._line,a[0].length),r=r.substr(a[0].length,r.length),i=r.length,this._line++;if(!a&&(a=this._whitespace.exec(r))&&(r=r.substr(a[0].length,r.length)),this._endOfFile.test(r))return n&&(this._comments&&(c=this._comment.exec(r))&&o("comment",c[1],"",this._line,r.length),r=null,o("eof","","",this._line,0)),this._input=r;const l=this._line,u=r[0];let d="",g="",p="",y=null,w=0,E=!1;switch(u){case"^":if(r.length<3)break;if(r[1]==="^"){if(this._previousMarker="^^",r=r.substr(2),r[0]!=="<"){E=!0;break}}else{this._n3Mode&&(w=1,d="^");break}case"<":if(y=this._unescapedIri.exec(r))d="IRI",g=y[1];else if(y=this._iri.exec(r)){if(g=this._unescape(y[1]),g===null||rF.test(g))return s(this);d="IRI"}else r.length>1&&r[1]==="<"?(d="<<",w=2):this._n3Mode&&r.length>1&&r[1]==="="&&(d="inverse",w=2,g=">");break;case">":r.length>1&&r[1]===">"&&(d=">>",w=2);break;case"_":((y=this._blank.exec(r))||n&&(y=this._blank.exec(`${r} `)))&&(d="blank",p="_",g=y[1]);break;case'"':if(y=this._simpleQuotedString.exec(r))g=y[1];else if({value:g,matchLength:w}=this._parseLiteral(r),g===null)return s(this);(y!==null||w!==0)&&(d="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(y=this._simpleApostropheString.exec(r))g=y[1];else if({value:g,matchLength:w}=this._parseLiteral(r),g===null)return s(this);(y!==null||w!==0)&&(d="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(y=this._variable.exec(r))&&(d="var",g=y[0]);break;case"@":this._previousMarker==="literal"&&(y=this._langcode.exec(r))?(d="langcode",g=y[1]):(y=this._keyword.exec(r))&&(d=y[0]);break;case".":if(r.length===1?n:r[1]<"0"||r[1]>"9"){d=".",w=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(y=this._number.exec(r)||n&&(y=this._number.exec(`${r} `)))&&(d="literal",g=y[0],p=typeof y[1]=="string"?Yu.double:typeof y[2]=="string"?Yu.decimal:Yu.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(y=this._sparqlKeyword.exec(r))?d=y[0].toUpperCase():E=!0;break;case"f":case"t":(y=this._boolean.exec(r))?(d="literal",g=y[0],p=Yu.boolean):E=!0;break;case"a":(y=this._shortPredicates.exec(r))?(d="abbreviation",g="a"):E=!0;break;case"=":this._n3Mode&&r.length>1&&(d="abbreviation",r[1]!==">"?(w=1,g="="):(w=2,g=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(w=1,d=u);break;default:E=!0}if(E&&((this._previousMarker==="@prefix"||this._previousMarker==="PREFIX")&&(y=this._prefix.exec(r))?(d="prefix",g=y[1]||""):((y=this._prefixed.exec(r))||n&&(y=this._prefixed.exec(`${r} `)))&&(d="prefixed",p=y[1]||"",g=this._unescape(y[2]))),this._previousMarker==="^^")switch(d){case"prefixed":d="type";break;case"IRI":d="typeIRI";break;default:d=""}if(!d)return n||!/^'''|^"""/.test(r)&&/\n|\r/.test(r)?s(this):this._input=r;const b=w||y[0].length,S=o(d,g,p,l,b);this.previousToken=S,this._previousMarker=d,r=r.substr(b,r.length)}function o(a,c,l,u,d){const g=r?i-r.length:i,p=g+d,y={type:a,value:c,prefix:l,line:u,start:g,end:p};return e(null,y),y}function s(a){e(a._syntaxError(/^\S*/.exec(r)[0]))}}_unescape(e){let n=!1;const r=e.replace(nF,(i,o,s,a)=>{if(typeof o=="string")return String.fromCharCode(Number.parseInt(o,16));if(typeof s=="string"){let c=Number.parseInt(s,16);return c<=65535?String.fromCharCode(Number.parseInt(s,16)):String.fromCharCode(55296+((c-=65536)>>10),56320+(c&1023))}return a in D_?D_[a]:(n=!0,"")});return n?null:r}_parseLiteral(e){if(e.length>=3){const n=e.match(/^(?:"""|"|'''|'|)/)[0],r=n.length;let i=Math.max(this._literalClosingPos,r);for(;(i=e.indexOf(n,i))>0;){let o=0;for(;e[i-o-1]==="\\";)o++;if(o%2===0){const s=e.substring(r,i),a=s.split(/\r\n|\r|\n/).length-1,c=i+r;if(r===1&&a!==0||r===3&&this._lineMode)break;return this._line+=a,{value:this._unescape(s),matchLength:c}}i++}this._literalClosingPos=e.length-r+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;const n=new Error(`Unexpected "${e}" on line ${this._line}.`);return n.context={token:void 0,line:this._line,previousToken:this.previousToken},n}_readStartingBom(e){return e.startsWith("\uFEFF")?e.substr(1):e}tokenize(e,n){if(this._line=1,typeof e=="string")if(this._input=this._readStartingBom(e),typeof n=="function")tF(()=>this._tokenizeToEnd(n,!0));else{const r=[];let i;if(this._tokenizeToEnd((o,s)=>o?i=o:r.push(s),!0),i)throw i;return r}else this._pendingBuffer=null,typeof e.setEncoding=="function"&&e.setEncoding("utf8"),e.on("data",r=>{this._input!==null&&r.length!==0&&(this._pendingBuffer&&(r=Ls.Buffer.concat([this._pendingBuffer,r]),this._pendingBuffer=null),r[r.length-1]&128?this._pendingBuffer=r:(typeof this._input=="undefined"?this._input=this._readStartingBom(typeof r=="string"?r:r.toString()):this._input+=r,this._tokenizeToEnd(n,!1)))}),e.on("end",()=>{typeof this._input=="string"&&this._tokenizeToEnd(n,!0)}),e.on("error",n)}}function eb(t){return!!t&&t.termType==="DefaultGraph"}const{rdf:aF,xsd:la}=Qr;let hu,cF=0;const tb=/^"(.*".*)(?="[^"]*$)/,lF=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,pg={namedNode:pF,blankNode:gF,variable:yF,literal:mF,defaultGraph:_F,quad:C_,triple:C_};var z0=pg;class Vo{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof Vo?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}class nb extends Vo{get termType(){return"NamedNode"}}class gc extends Vo{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const e=this.id;let n=e.lastIndexOf('"')+1;return n<e.length&&e[n++]==="@"?e.substr(n).toLowerCase():""}get datatype(){return new nb(this.datatypeString)}get datatypeString(){const e=this.id,n=e.lastIndexOf('"')+1,r=n<e.length?e[n]:"";return r==="^"?e.substr(n+2):r!=="@"?la.string:aF.langString}equals(e){return e instanceof gc?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}class uF extends Vo{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}class dF extends Vo{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}class fF extends Vo{constructor(){return super(""),hu||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}}hu=new fF;function ss(t,e){if(e=e||pg,!t)return e.defaultGraph();switch(t[0]){case"?":return e.variable(t.substr(1));case"_":return e.blankNode(t.substr(2));case'"':if(e===pg)return new gc(t);if(t[t.length-1]==='"')return e.literal(t.substr(1,t.length-2));const n=t.lastIndexOf('"',t.length-1);return e.literal(t.substr(1,n-1),t[n+1]==="@"?t.substr(n+2):e.namedNode(t.substr(n+3)));case"<":const r=lF.exec(t);return e.quad(ss(Ju(r[1]),e),ss(Ju(r[2]),e),ss(Ju(r[3]),e),r[4]&&ss(Ju(r[4]),e));default:return e.namedNode(t)}}function Ht(t){if(typeof t=="string")return t;if(t instanceof Vo&&t.termType!=="Quad")return t.id;if(!t)return hu.id;switch(t.termType){case"NamedNode":return t.value;case"BlankNode":return`_:${t.value}`;case"Variable":return`?${t.value}`;case"DefaultGraph":return"";case"Literal":return`"${t.value}"${t.language?`@${t.language}`:t.datatype&&t.datatype.value!==la.string?`^^${t.datatype.value}`:""}`;case"Quad":return`<<${ap(Ht(t.subject))} ${ap(Ht(t.predicate))} ${ap(Ht(t.object))}${eb(t.graph)?"":` ${Ht(t.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${t.termType}`)}}class hF extends Vo{constructor(e,n,r,i){super(""),this._subject=e,this._predicate=n,this._object=r,this._graph=i||hu}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}}function ap(t){return t.replace(tb,(e,n)=>`"${n.replace(/"/g,'""')}`)}function Ju(t){return t.replace(tb,(e,n)=>`"${n.replace(/""/g,'"')}`)}function pF(t){return new nb(t)}function gF(t){return new uF(t||`n3-${cF++}`)}function mF(t,e){if(typeof e=="string")return new gc(`"${t}"@${e.toLowerCase()}`);let n=e?e.value:"";return n===""&&(typeof t=="boolean"?n=la.boolean:typeof t=="number"&&(Number.isFinite(t)?n=Number.isInteger(t)?la.integer:la.double:(n=la.double,Number.isNaN(t)||(t=t>0?"INF":"-INF")))),n===""||n===la.string?new gc(`"${t}"`):new gc(`"${t}"^^${n}`)}function yF(t){return new dF(t)}function _F(){return hu}function C_(t,e,n,r){return new hF(t,e,n,r)}let P_=0;class G0{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&rb(this,e.factory);const n=typeof e.format=="string"?e.format.match(/\w*$/)[0].toLowerCase():"",r=/turtle/.test(n),i=/trig/.test(n),o=/triple/.test(n),s=/quad/.test(n),a=this._n3Mode=/n3/.test(n),c=o||s;(this._supportsNamedGraphs=!(r||a))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(r||i||o||a),this._supportsRDFStar=n===""||/star|\*$/.test(n),c&&(this._resolveRelativeIRI=l=>null),this._blankNodePrefix=typeof e.blankNodePrefix!="string"?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new sF({lineMode:c,n3:a}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){P_=0}_setBase(e){if(!e)this._base="",this._basePath="";else{const n=e.indexOf("#");n>=0&&(e=e.substr(0,n)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}}_saveContext(e,n,r,i,o){const s=this._n3Mode;this._contextStack.push({type:e,subject:r,predicate:i,object:o,graph:n,inverse:s?this._inversePredicate:!1,blankPrefix:s?this._prefixes._:"",quantified:s?this._quantified:null}),s&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(e,n){const r=this._contextStack.pop();if(!r||r.type!==e)return this._error(`Unexpected ${n.type}`,n);this._subject=r.subject,this._predicate=r.predicate,this._object=r.object,this._graph=r.graph,this._n3Mode&&(this._inversePredicate=r.inverse,this._prefixes._=r.blankPrefix,this._quantified=r.quantified)}_readInTopContext(e){switch(e.type){case"eof":return this._graph!==null?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,n){let r;switch(e.type){case"IRI":case"typeIRI":const i=this._resolveIRI(e.value);if(i===null)return this._error("Invalid IRI",e);r=this._namedNode(i);break;case"type":case"prefixed":const o=this._prefixes[e.prefix];if(o===void 0)return this._error(`Undefined prefix "${e.prefix}:"`,e);r=this._namedNode(o+e.value);break;case"blank":r=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":r=this._variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!n&&this._n3Mode&&r.id in this._quantified&&(r=this._quantified[r.id]),r}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(e.prefix.length===0)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._literal(e.value,this._namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if((this._subject=this._readEntity(e))===void 0)return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){const n=e.type;switch(n){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return this._predicate===null?this._error(`Unexpected ${n}`,e):(this._subject=null,n==="]"?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return this._predicate!==null?this._readPredicate:this._error("Expected predicate but got ;",e);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if((this._predicate=this._readEntity(e))===void 0)return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(e.prefix.length===0)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if((this._object=this._readEntity(e))===void 0)return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return e.type==="{"?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return e.type!=="{"?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return e.type==="]"?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if(e.type!=="]")return this._readBlankNodePunctuation(e);this._subject!==null&&this._emit(this._subject,this._predicate,this._object,this._graph);const n=this._predicate===null;return this._restoreContext("blank",e),this._object!==null?this._getContextEndReader():this._predicate!==null?this._readObject:n?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let n=null,r=null,i=this._readListItem;const o=this._subject,s=this._contextStack,a=s[s.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,r=this._blankNode(),this.RDF_FIRST,this._subject=n=this._blankNode()),i=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,r=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",e),s.length!==0&&s[s.length-1].type==="list"&&this._emit(this._subject,this._predicate,this._object,this._graph),this._predicate===null){if(i=this._readPredicate,this._subject===this.RDF_NIL)return i}else if(i=this._getContextEndReader(),this._object===this.RDF_NIL)return i;r=this.RDF_NIL;break;case"literal":e.prefix.length===0?(this._literalValue=e.value,i=this._readListItemDataTypeOrLang):(n=this._literal(e.value,this._namedNode(e.prefix)),i=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if((n=this._readEntity(e))===void 0)return}if(r===null&&(this._subject=r=this._blankNode()),o===null?a.predicate===null?a.subject=r:a.object=r:this._emit(o,this.RDF_REST,r,this._graph),n!==null){if(this._n3Mode&&(e.type==="IRI"||e.type==="prefixed"))return this._saveContext("item",this._graph,r,this.RDF_FIRST,n),this._subject=n,this._predicate=null,this._getPathReader(this._readListItem);this._emit(r,this.RDF_FIRST,n,this._graph)}return i}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let n=this._literal(this._literalValue);switch(e.type){case"type":case"typeIRI":const r=this._readEntity(e);if(r===void 0)return;n=this._literal(this._literalValue,r),e=null;break;case"langcode":n=this._literal(this._literalValue,e.value),e=null;break}return{token:e,literal:n}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,n){const r=this._completeLiteral(e);if(!!r)return this._object=r.literal,n&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),r.token===null?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(r.token))}_readFormulaTail(e){return e.type!=="}"?this._readPunctuation(e):(this._subject!==null&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",e),this._object===null?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let n,r=this._graph;const i=this._subject,o=this._inversePredicate;switch(e.type){case"}":if(this._graph===null)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,n=this._contextStack.length?this._readSubject:this._readInTopContext,o&&(this._inversePredicate=!1);break;case";":n=this._readPredicate;break;case",":n=this._readObject;break;default:if(this._supportsQuads&&this._graph===null&&(r=this._readEntity(e))!==void 0){n=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(i!==null){const s=this._predicate,a=this._object;o?this._emit(a,s,i,r):this._emit(i,s,a,r)}return n}_readBlankNodePunctuation(e){let n;switch(e.type){case";":n=this._readPredicate;break;case",":n=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),n}_readQuadPunctuation(e){return e.type!=="."?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return e.type!=="prefix"?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if(e.type!=="IRI")return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);const n=this._readEntity(e);return this._prefixes[this._prefix]=n.value,this._prefixCallback(this._prefix,n),this._readDeclarationPunctuation}_readBaseIRI(e){const n=e.type==="IRI"&&this._resolveIRI(e.value);return n?(this._setBase(n),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return e.type!=="]"?this._error("Invalid graph label",e):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):e.type!=="."?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let n;switch(e.type){case"IRI":case"prefixed":if((n=this._readEntity(e,!0))!==void 0)break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(this._subject===null?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,n,this.QUANTIFIERS_GRAPH)):this._quantified[n.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return e.type===","?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const n=this._contextStack,r=n.length&&n[n.length-1];if(r&&r.type==="item"){const i=this._subject;this._restoreContext("item",e),this._emit(this._subject,this.RDF_FIRST,i,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let n,r;const i=this._blankNode();if((r=this._readEntity(e))!==void 0)return this._predicate===null?(n=this._subject,this._subject=i):(n=this._object,this._object=i),this._emit(n,r,i,this._graph),this._readPath}_readBackwardPath(e){const n=this._blankNode();let r,i;if((r=this._readEntity(e))!==void 0)return this._predicate===null?(i=this._subject,this._subject=n):(i=this._object,this._object=n),this._emit(n,r,i,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return e.type!==">>"?this._supportsQuads&&this._graph===null&&(this._graph=this._readEntity(e))!==void 0?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(e.type!==">>")return this._error(`Expected >> but got ${e.type}`,e);const n=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",e),this._subject===null?(this._subject=n,this._readPredicate):(this._object=n,this._getContextEndReader())}_getContextEndReader(){const e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,n,r,i){this._callback(null,this._quad(e,n,r,i||this.DEFAULTGRAPH))}_error(e,n){const r=new Error(`${e} on line ${n.line}.`);r.context={token:n,line:n.line,previousToken:this._lexer.previousToken},this._callback(r),this._callback=cp}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return(e[1]==="/"?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;const n=e.length;let r="",i=-1,o=-1,s=0,a="/";for(;i<n;){switch(a){case":":if(o<0&&e[++i]==="/"&&e[++i]==="/")for(;(o=i+1)<n&&e[o]!=="/";)i=o;break;case"?":case"#":i=n;break;case"/":if(e[i+1]===".")switch(a=e[++i+1],a){case"/":r+=e.substring(s,i-1),s=i+1;break;case void 0:case"?":case"#":return r+e.substring(s,i)+e.substr(i+1);case".":if(a=e[++i+1],a===void 0||a==="/"||a==="?"||a==="#"){if(r+=e.substring(s,i-2),(s=r.lastIndexOf("/"))>=o&&(r=r.substr(0,s)),a!=="/")return`${r}/${e.substr(i+1)}`;s=i+1}}}a=e[++i]}return r+e.substring(s)}parse(e,n,r){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${P_++}_`,this._prefixCallback=r||cp,this._inversePredicate=!1,this._quantified=Object.create(null),!n){const i=[];let o;if(this._callback=(s,a)=>{s?o=s:a&&i.push(a)},this._lexer.tokenize(e).every(s=>this._readCallback=this._readCallback(s)),o)throw o;return i}this._callback=n,this._lexer.tokenize(e,(i,o)=>{i!==null?(this._callback(i),this._callback=cp):this._readCallback&&(this._readCallback=this._readCallback(o))})}}function cp(){}function rb(t,e){const n=e.namedNode;t._namedNode=n,t._blankNode=e.blankNode,t._literal=e.literal,t._variable=e.variable,t._quad=e.quad,t.DEFAULTGRAPH=e.defaultGraph(),t.RDF_FIRST=n(Qr.rdf.first),t.RDF_REST=n(Qr.rdf.rest),t.RDF_NIL=n(Qr.rdf.nil),t.N3_FORALL=n(Qr.r.forAll),t.N3_FORSOME=n(Qr.r.forSome),t.ABBREVIATIONS={a:n(Qr.rdf.type),"=":n(Qr.owl.sameAs),">":n(Qr.log.implies)},t.QUANTIFIERS_GRAPH=n("urn:n3:quantifiers")}rb(G0.prototype,z0);const hl=z0.defaultGraph(),{rdf:wF,xsd:nc}=Qr,N_=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,O_=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,vF={"\\":"\\\\",'"':'\\"',"	":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class pl extends Vo{equals(){return!1}}class ib{constructor(e,n){if(this._prefixRegex=/$0^/,e&&typeof e.write!="function"&&(n=e,e=null),n=n||{},this._lists=n.lists,e)this._outputStream=e,this._endStream=n.end===void 0?!0:!!n.end;else{let r="";this._outputStream={write(i,o,s){r+=i,s&&s()},end:i=>{i&&i(null,r)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(n.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=hl,this._prefixIRIs=Object.create(null),n.prefixes&&this.addPrefixes(n.prefixes),n.baseIRI&&(this._baseMatcher=new RegExp(`^${L_(n.baseIRI)}${n.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=n.baseIRI.length))}get _inDefaultGraph(){return hl.equals(this._graph)}_write(e,n){this._outputStream.write(e,"utf8",n)}_writeQuad(e,n,r,i,o){try{i.equals(this._graph)||(this._write((this._subject===null?"":this._inDefaultGraph?`.
`:`
}
`)+(hl.equals(i)?"":`${this._encodeIriOrBlank(i)} {
`)),this._graph=i,this._subject=null),e.equals(this._subject)?n.equals(this._predicate)?this._write(`, ${this._encodeObject(r)}`,o):this._write(`;
    ${this._encodePredicate(this._predicate=n)} ${this._encodeObject(r)}`,o):this._write(`${(this._subject===null?"":`.
`)+this._encodeSubject(this._subject=e)} ${this._encodePredicate(this._predicate=n)} ${this._encodeObject(r)}`,o)}catch(s){o&&o(s)}}_writeQuadLine(e,n,r,i,o){delete this._prefixMatch,this._write(this.quadToString(e,n,r,i),o)}quadToString(e,n,r,i){return`${this._encodeSubject(e)} ${this._encodeIriOrBlank(n)} ${this._encodeObject(r)}${i&&i.value?` ${this._encodeIriOrBlank(i)} .
`:` .
`}`}quadsToString(e){return e.map(n=>this.quadToString(n.subject,n.predicate,n.object,n.graph)).join("")}_encodeSubject(e){return e.termType==="Quad"?this._encodeQuad(e):this._encodeIriOrBlank(e)}_encodeIriOrBlank(e){if(e.termType!=="NamedNode")return this._lists&&e.value in this._lists&&(e=this.list(this._lists[e.value])),"id"in e?e.id:`_:${e.value}`;let n=e.value;this._baseMatcher&&this._baseMatcher.test(n)&&(n=n.substr(this._baseLength)),N_.test(n)&&(n=n.replace(O_,M_));const r=this._prefixRegex.exec(n);return r?r[1]?this._prefixIRIs[r[1]]+r[2]:n:`<${n}>`}_encodeLiteral(e){let n=e.value;if(N_.test(n)&&(n=n.replace(O_,M_)),e.language)return`"${n}"@${e.language}`;if(this._lineMode){if(e.datatype.value===nc.string)return`"${n}"`}else switch(e.datatype.value){case nc.string:return`"${n}"`;case nc.boolean:if(n==="true"||n==="false")return n;break;case nc.integer:if(/^[+-]?\d+$/.test(n))return n;break;case nc.decimal:if(/^[+-]?\d*\.\d+$/.test(n))return n;break;case nc.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(n))return n;break}return`"${n}"^^${this._encodeIriOrBlank(e.datatype)}`}_encodePredicate(e){return e.value===wF.type?"a":this._encodeIriOrBlank(e)}_encodeObject(e){switch(e.termType){case"Quad":return this._encodeQuad(e);case"Literal":return this._encodeLiteral(e);default:return this._encodeIriOrBlank(e)}}_encodeQuad({subject:e,predicate:n,object:r,graph:i}){return`<<${this._encodeSubject(e)} ${this._encodePredicate(n)} ${this._encodeObject(r)}${eb(i)?"":` ${this._encodeIriOrBlank(i)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(e,n,r,i,o){r===void 0?this._writeQuad(e.subject,e.predicate,e.object,e.graph,n):typeof i=="function"?this._writeQuad(e,n,r,hl,i):this._writeQuad(e,n,r,i||hl,o)}addQuads(e){for(let n=0;n<e.length;n++)this.addQuad(e[n])}addPrefix(e,n,r){const i={};i[e]=n,this.addPrefixes(i,r)}addPrefixes(e,n){if(!this._prefixIRIs)return n&&n();let r=!1;for(let i in e){let o=e[i];typeof o!="string"&&(o=o.value),r=!0,this._subject!==null&&(this._write(this._inDefaultGraph?`.
`:`
}
`),this._subject=null,this._graph=""),this._prefixIRIs[o]=i+=":",this._write(`@prefix ${i} <${o}>.
`)}if(r){let i="",o="";for(const s in this._prefixIRIs)i+=i?`|${s}`:s,o+=(o?"|":"")+this._prefixIRIs[s];i=L_(i),this._prefixRegex=new RegExp(`^(?:${o})[^/]*$|^(${i})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(r?`
`:"",n)}blank(e,n){let r=e,i,o;switch(e===void 0?r=[]:e.termType?r=[{predicate:e,object:n}]:"length"in e||(r=[e]),o=r.length){case 0:return new pl("[]");case 1:if(i=r[0],!(i.object instanceof pl))return new pl(`[ ${this._encodePredicate(i.predicate)} ${this._encodeObject(i.object)} ]`);default:let s="[";for(let a=0;a<o;a++)i=r[a],i.predicate.equals(e)?s+=`, ${this._encodeObject(i.object)}`:(s+=`${(a?`;
  `:`
  `)+this._encodePredicate(i.predicate)} ${this._encodeObject(i.object)}`,e=i.predicate);return new pl(`${s}
]`)}}list(e){const n=e&&e.length||0,r=new Array(n);for(let i=0;i<n;i++)r[i]=this._encodeObject(e[i]);return new pl(`(${r.join(" ")})`)}end(e){this._subject!==null&&(this._write(this._inDefaultGraph?`.
`:`
}
`),this._subject=null),this._write=this._blockedWrite;let n=e&&((r,i)=>{n=null,e(r,i)});if(this._endStream)try{return this._outputStream.end(n)}catch{}n&&n()}}function M_(t){let e=vF[t];return e===void 0&&(t.length===1?(e=t.charCodeAt(0).toString(16),e="\\u0000".substr(0,6-e.length)+e):(e=((t.charCodeAt(0)-55296)*1024+t.charCodeAt(1)+9216).toString(16),e="\\U00000000".substr(0,10-e.length)+e)),e}function L_(t){return t.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}var Cc={exports:{}},ob=su.exports.EventEmitter,bF={},EF=Object.freeze(Object.defineProperty({__proto__:null,default:bF},Symbol.toStringTag,{value:"Module"})),sb=lf(EF);function U_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function SF(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?U_(Object(n),!0).forEach(function(r){TF(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function TF(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AF(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xF(t,e,n){return e&&j_(t.prototype,e),n&&j_(t,n),t}var IF=Ls,hd=IF.Buffer,RF=sb,gg=RF.inspect,kF=gg&&gg.custom||"inspect";function FF(t,e,n){hd.prototype.copy.call(t,e,n)}var DF=function(){function t(){AF(this,t),this.head=null,this.tail=null,this.length=0}return xF(t,[{key:"push",value:function(n){var r={data:n,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length}},{key:"unshift",value:function(n){var r={data:n,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length}},{key:"shift",value:function(){if(this.length!==0){var n=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,n}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(n){if(this.length===0)return"";for(var r=this.head,i=""+r.data;r=r.next;)i+=n+r.data;return i}},{key:"concat",value:function(n){if(this.length===0)return hd.alloc(0);for(var r=hd.allocUnsafe(n>>>0),i=this.head,o=0;i;)FF(i.data,r,o),o+=i.data.length,i=i.next;return r}},{key:"consume",value:function(n,r){var i;return n<this.head.data.length?(i=this.head.data.slice(0,n),this.head.data=this.head.data.slice(n)):n===this.head.data.length?i=this.shift():i=r?this._getString(n):this._getBuffer(n),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(n){var r=this.head,i=1,o=r.data;for(n-=o.length;r=r.next;){var s=r.data,a=n>s.length?s.length:n;if(a===s.length?o+=s:o+=s.slice(0,n),n-=a,n===0){a===s.length?(++i,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=s.slice(a));break}++i}return this.length-=i,o}},{key:"_getBuffer",value:function(n){var r=hd.allocUnsafe(n),i=this.head,o=1;for(i.data.copy(r),n-=i.data.length;i=i.next;){var s=i.data,a=n>s.length?s.length:n;if(s.copy(r,r.length-n,0,a),n-=a,n===0){a===s.length?(++o,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=s.slice(a));break}++o}return this.length-=o,r}},{key:kF,value:function(n,r){return gg(this,SF({},r,{depth:0,customInspect:!1}))}}]),t}();function CF(t,e){var n=this,r=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return r||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,qt.nextTick(mg,this,t)):qt.nextTick(mg,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(o){!e&&o?n._writableState?n._writableState.errorEmitted?qt.nextTick(pd,n):(n._writableState.errorEmitted=!0,qt.nextTick($_,n,o)):qt.nextTick($_,n,o):e?(qt.nextTick(pd,n),e(o)):qt.nextTick(pd,n)}),this)}function $_(t,e){mg(t,e),pd(t)}function pd(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function PF(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function mg(t,e){t.emit("error",e)}function NF(t,e){var n=t._readableState,r=t._writableState;n&&n.autoDestroy||r&&r.autoDestroy?t.destroy(e):t.emit("error",e)}var ab={destroy:CF,undestroy:PF,errorOrDestroy:NF},Ba={};function OF(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var cb={};function Xi(t,e,n){n||(n=Error);function r(o,s,a){return typeof e=="string"?e:e(o,s,a)}var i=function(o){OF(s,o);function s(a,c,l){return o.call(this,r(a,c,l))||this}return s}(n);i.prototype.name=n.name,i.prototype.code=t,cb[t]=i}function B_(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map(function(r){return String(r)}),n>2?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:n===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function MF(t,e,n){return t.substr(!n||n<0?0:+n,e.length)===e}function LF(t,e,n){return(n===void 0||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}function UF(t,e,n){return typeof n!="number"&&(n=0),n+e.length>t.length?!1:t.indexOf(e,n)!==-1}Xi("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);Xi("ERR_INVALID_ARG_TYPE",function(t,e,n){var r;typeof e=="string"&&MF(e,"not ")?(r="must not be",e=e.replace(/^not /,"")):r="must be";var i;if(LF(t," argument"))i="The ".concat(t," ").concat(r," ").concat(B_(e,"type"));else{var o=UF(t,".")?"property":"argument";i='The "'.concat(t,'" ').concat(o," ").concat(r," ").concat(B_(e,"type"))}return i+=". Received type ".concat(typeof n),i},TypeError);Xi("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Xi("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});Xi("ERR_STREAM_PREMATURE_CLOSE","Premature close");Xi("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});Xi("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Xi("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Xi("ERR_STREAM_WRITE_AFTER_END","write after end");Xi("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Xi("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);Xi("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");Ba.codes=cb;var jF=Ba.codes.ERR_INVALID_OPT_VALUE;function $F(t,e,n){return t.highWaterMark!=null?t.highWaterMark:e?t[n]:null}function BF(t,e,n,r){var i=$F(e,r,n);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var o=r?n:"highWaterMark";throw new jF(o,i)}return Math.floor(i)}return t.objectMode?16:16*1024}var lb={getHighWaterMark:BF},Da={exports:{}};typeof Object.create=="function"?Da.exports=function(e,n){n&&(e.super_=n,e.prototype=Object.create(n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Da.exports=function(e,n){if(n){e.super_=n;var r=function(){};r.prototype=n.prototype,e.prototype=new r,e.prototype.constructor=e}};var HF=KF;function KF(t,e){if(lp("noDeprecation"))return t;var n=!1;function r(){if(!n){if(lp("throwDeprecation"))throw new Error(e);lp("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}return r}function lp(t){try{if(!Vt.localStorage)return!1}catch{return!1}var e=Vt.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}var ub=Bn;function db(t){var e=this;this.next=null,this.entry=null,this.finish=function(){mD(e,t)}}var mc;Bn.WritableState=pu;var WF={deprecate:HF},fb=ob,Ff=Ls.Buffer,qF=Vt.Uint8Array||function(){};function VF(t){return Ff.from(t)}function zF(t){return Ff.isBuffer(t)||t instanceof qF}var Y0=ab,GF=lb,YF=GF.getHighWaterMark,Ws=Ba.codes,JF=Ws.ERR_INVALID_ARG_TYPE,ZF=Ws.ERR_METHOD_NOT_IMPLEMENTED,QF=Ws.ERR_MULTIPLE_CALLBACK,XF=Ws.ERR_STREAM_CANNOT_PIPE,eD=Ws.ERR_STREAM_DESTROYED,tD=Ws.ERR_STREAM_NULL_VALUES,nD=Ws.ERR_STREAM_WRITE_AFTER_END,rD=Ws.ERR_UNKNOWN_ENCODING,Pc=Y0.errorOrDestroy;Da.exports(Bn,fb);function iD(){}function pu(t,e,n){mc=mc||Bc,t=t||{},typeof n!="boolean"&&(n=e instanceof mc),this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=YF(this,t,"writableHighWaterMark",n),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var r=t.decodeStrings===!1;this.decodeStrings=!r,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(i){dD(e,i)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new db(this)}pu.prototype.getBuffer=function(){for(var e=this.bufferedRequest,n=[];e;)n.push(e),e=e.next;return n};(function(){try{Object.defineProperty(pu.prototype,"buffer",{get:WF.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var gd;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(gd=Function.prototype[Symbol.hasInstance],Object.defineProperty(Bn,Symbol.hasInstance,{value:function(e){return gd.call(this,e)?!0:this!==Bn?!1:e&&e._writableState instanceof pu}})):gd=function(e){return e instanceof this};function Bn(t){mc=mc||Bc;var e=this instanceof mc;if(!e&&!gd.call(Bn,this))return new Bn(t);this._writableState=new pu(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),fb.call(this)}Bn.prototype.pipe=function(){Pc(this,new XF)};function oD(t,e){var n=new nD;Pc(t,n),qt.nextTick(e,n)}function sD(t,e,n,r){var i;return n===null?i=new tD:typeof n!="string"&&!e.objectMode&&(i=new JF("chunk",["string","Buffer"],n)),i?(Pc(t,i),qt.nextTick(r,i),!1):!0}Bn.prototype.write=function(t,e,n){var r=this._writableState,i=!1,o=!r.objectMode&&zF(t);return o&&!Ff.isBuffer(t)&&(t=VF(t)),typeof e=="function"&&(n=e,e=null),o?e="buffer":e||(e=r.defaultEncoding),typeof n!="function"&&(n=iD),r.ending?oD(this,n):(o||sD(this,r,t,n))&&(r.pendingcb++,i=cD(this,r,o,t,e,n)),i};Bn.prototype.cork=function(){this._writableState.corked++};Bn.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&hb(this,t))};Bn.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new rD(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(Bn.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function aD(t,e,n){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=Ff.from(e,n)),e}Object.defineProperty(Bn.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function cD(t,e,n,r,i,o){if(!n){var s=aD(e,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var l=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},l?l.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else yg(t,e,!1,a,r,i,o);return c}function yg(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new eD("write")):n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function lD(t,e,n,r,i){--e.pendingcb,n?(qt.nextTick(i,r),qt.nextTick(Kl,t,e),t._writableState.errorEmitted=!0,Pc(t,r)):(i(r),t._writableState.errorEmitted=!0,Pc(t,r),Kl(t,e))}function uD(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function dD(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(typeof i!="function")throw new QF;if(uD(n),e)lD(t,n,r,e,i);else{var o=pb(n)||t.destroyed;!o&&!n.corked&&!n.bufferProcessing&&n.bufferedRequest&&hb(t,n),r?qt.nextTick(H_,t,n,o,i):H_(t,n,o,i)}}function H_(t,e,n,r){n||fD(t,e),e.pendingcb--,r(),Kl(t,e)}function fD(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function hb(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),o=e.corkedRequestsFree;o.entry=n;for(var s=0,a=!0;n;)i[s]=n,n.isBuf||(a=!1),n=n.next,s+=1;i.allBuffers=a,yg(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new db(e),e.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,l=n.encoding,u=n.callback,d=e.objectMode?1:c.length;if(yg(t,e,!1,d,c,l,u),n=n.next,e.bufferedRequestCount--,e.writing)break}n===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}Bn.prototype._write=function(t,e,n){n(new ZF("_write()"))};Bn.prototype._writev=null;Bn.prototype.end=function(t,e,n){var r=this._writableState;return typeof t=="function"?(n=t,t=null,e=null):typeof e=="function"&&(n=e,e=null),t!=null&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||gD(this,r,n),this};Object.defineProperty(Bn.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function pb(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function hD(t,e){t._final(function(n){e.pendingcb--,n&&Pc(t,n),e.prefinished=!0,t.emit("prefinish"),Kl(t,e)})}function pD(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,qt.nextTick(hD,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function Kl(t,e){var n=pb(e);if(n&&(pD(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var r=t._readableState;(!r||r.autoDestroy&&r.endEmitted)&&t.destroy()}return n}function gD(t,e,n){e.ending=!0,Kl(t,e),n&&(e.finished?qt.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}function mD(t,e,n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree.next=t}Object.defineProperty(Bn.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});Bn.prototype.destroy=Y0.destroy;Bn.prototype._undestroy=Y0.undestroy;Bn.prototype._destroy=function(t,e){e(t)};var yD=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},Bc=jo,gb=yb,_g=ub;Da.exports(jo,gb);for(var K_=yD(_g.prototype),up=0;up<K_.length;up++){var dp=K_[up];jo.prototype[dp]||(jo.prototype[dp]=_g.prototype[dp])}function jo(t){if(!(this instanceof jo))return new jo(t);gb.call(this,t),_g.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",_D)))}Object.defineProperty(jo.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(jo.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(jo.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function _D(){this._writableState.ended||qt.nextTick(wD,this)}function wD(t){t.end()}Object.defineProperty(jo.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}});var J0={},wg={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(t,e){var n=Ls,r=n.Buffer;function i(s,a){for(var c in s)a[c]=s[c]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?t.exports=n:(i(n,e),e.Buffer=o);function o(s,a,c){return r(s,a,c)}o.prototype=Object.create(r.prototype),i(r,o),o.from=function(s,a,c){if(typeof s=="number")throw new TypeError("Argument must not be a number");return r(s,a,c)},o.alloc=function(s,a,c){if(typeof s!="number")throw new TypeError("Argument must be a number");var l=r(s);return a!==void 0?typeof c=="string"?l.fill(a,c):l.fill(a):l.fill(0),l},o.allocUnsafe=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return r(s)},o.allocUnsafeSlow=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(s)}})(wg,wg.exports);var Z0=wg.exports.Buffer,W_=Z0.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function vD(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function bD(t){var e=vD(t);if(typeof e!="string"&&(Z0.isEncoding===W_||!W_(t)))throw new Error("Unknown encoding: "+t);return e||t}J0.StringDecoder=gu;function gu(t){this.encoding=bD(t);var e;switch(this.encoding){case"utf16le":this.text=ID,this.end=RD,e=4;break;case"utf8":this.fillLast=TD,e=4;break;case"base64":this.text=kD,this.end=FD,e=3;break;default:this.write=DD,this.end=CD;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Z0.allocUnsafe(e)}gu.prototype.write=function(t){if(t.length===0)return"";var e,n;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""};gu.prototype.end=xD;gu.prototype.text=AD;gu.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function fp(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function ED(t,e,n){var r=e.length-1;if(r<n)return 0;var i=fp(e[r]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--r<n||i===-2?0:(i=fp(e[r]),i>=0?(i>0&&(t.lastNeed=i-2),i):--r<n||i===-2?0:(i=fp(e[r]),i>=0?(i>0&&(i===2?i=0:t.lastNeed=i-3),i):0))}function SD(t,e,n){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function TD(t){var e=this.lastTotal-this.lastNeed,n=SD(this,t);if(n!==void 0)return n;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function AD(t,e){var n=ED(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)}function xD(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function ID(t,e){if((t.length-e)%2===0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function RD(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function kD(t,e){var n=(t.length-e)%3;return n===0?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,n===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function FD(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function DD(t){return t.toString(this.encoding)}function CD(t){return t&&t.length?this.write(t):""}var q_=Ba.codes.ERR_STREAM_PREMATURE_CLOSE;function PD(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t.apply(this,r)}}}function ND(){}function OD(t){return t.setHeader&&typeof t.abort=="function"}function mb(t,e,n){if(typeof e=="function")return mb(t,null,e);e||(e={}),n=PD(n||ND);var r=e.readable||e.readable!==!1&&t.readable,i=e.writable||e.writable!==!1&&t.writable,o=function(){t.writable||a()},s=t._writableState&&t._writableState.finished,a=function(){i=!1,s=!0,r||n.call(t)},c=t._readableState&&t._readableState.endEmitted,l=function(){r=!1,c=!0,i||n.call(t)},u=function(y){n.call(t,y)},d=function(){var y;if(r&&!c)return(!t._readableState||!t._readableState.ended)&&(y=new q_),n.call(t,y);if(i&&!s)return(!t._writableState||!t._writableState.ended)&&(y=new q_),n.call(t,y)},g=function(){t.req.on("finish",a)};return OD(t)?(t.on("complete",a),t.on("abort",d),t.req?g():t.on("request",g)):i&&!t._writableState&&(t.on("end",o),t.on("close",o)),t.on("end",l),t.on("finish",a),e.error!==!1&&t.on("error",u),t.on("close",d),function(){t.removeListener("complete",a),t.removeListener("abort",d),t.removeListener("request",g),t.req&&t.req.removeListener("finish",a),t.removeListener("end",o),t.removeListener("close",o),t.removeListener("finish",a),t.removeListener("end",l),t.removeListener("error",u),t.removeListener("close",d)}}var Q0=mb,Zu;function Ts(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var MD=Q0,As=Symbol("lastResolve"),oa=Symbol("lastReject"),Rl=Symbol("error"),Wd=Symbol("ended"),ha=Symbol("lastPromise"),X0=Symbol("handlePromise"),pa=Symbol("stream");function Fs(t,e){return{value:t,done:e}}function LD(t){var e=t[As];if(e!==null){var n=t[pa].read();n!==null&&(t[ha]=null,t[As]=null,t[oa]=null,e(Fs(n,!1)))}}function UD(t){qt.nextTick(LD,t)}function jD(t,e){return function(n,r){t.then(function(){if(e[Wd]){n(Fs(void 0,!0));return}e[X0](n,r)},r)}}var $D=Object.getPrototypeOf(function(){}),BD=Object.setPrototypeOf((Zu={get stream(){return this[pa]},next:function(){var e=this,n=this[Rl];if(n!==null)return Promise.reject(n);if(this[Wd])return Promise.resolve(Fs(void 0,!0));if(this[pa].destroyed)return new Promise(function(s,a){qt.nextTick(function(){e[Rl]?a(e[Rl]):s(Fs(void 0,!0))})});var r=this[ha],i;if(r)i=new Promise(jD(r,this));else{var o=this[pa].read();if(o!==null)return Promise.resolve(Fs(o,!1));i=new Promise(this[X0])}return this[ha]=i,i}},Ts(Zu,Symbol.asyncIterator,function(){return this}),Ts(Zu,"return",function(){var e=this;return new Promise(function(n,r){e[pa].destroy(null,function(i){if(i){r(i);return}n(Fs(void 0,!0))})})}),Zu),$D),HD=function(e){var n,r=Object.create(BD,(n={},Ts(n,pa,{value:e,writable:!0}),Ts(n,As,{value:null,writable:!0}),Ts(n,oa,{value:null,writable:!0}),Ts(n,Rl,{value:null,writable:!0}),Ts(n,Wd,{value:e._readableState.endEmitted,writable:!0}),Ts(n,X0,{value:function(o,s){var a=r[pa].read();a?(r[ha]=null,r[As]=null,r[oa]=null,o(Fs(a,!1))):(r[As]=o,r[oa]=s)},writable:!0}),n));return r[ha]=null,MD(e,function(i){if(i&&i.code!=="ERR_STREAM_PREMATURE_CLOSE"){var o=r[oa];o!==null&&(r[ha]=null,r[As]=null,r[oa]=null,o(i)),r[Rl]=i;return}var s=r[As];s!==null&&(r[ha]=null,r[As]=null,r[oa]=null,s(Fs(void 0,!0))),r[Wd]=!0}),e.on("readable",UD.bind(null,r)),r},KD=HD,WD=function(){throw new Error("Readable.from is not available in the browser")},yb=Ft,yc;Ft.ReadableState=wb;su.exports.EventEmitter;var _b=function(e,n){return e.listeners(n).length},mu=ob,Df=Ls.Buffer,qD=Vt.Uint8Array||function(){};function VD(t){return Df.from(t)}function zD(t){return Df.isBuffer(t)||t instanceof qD}var hp=sb,_t;hp&&hp.debuglog?_t=hp.debuglog("stream"):_t=function(){};var GD=DF,em=ab,YD=lb,JD=YD.getHighWaterMark,Cf=Ba.codes,ZD=Cf.ERR_INVALID_ARG_TYPE,QD=Cf.ERR_STREAM_PUSH_AFTER_EOF,XD=Cf.ERR_METHOD_NOT_IMPLEMENTED,eC=Cf.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,_c,pp,gp;Da.exports(Ft,mu);var kl=em.errorOrDestroy,mp=["error","close","destroy","pause","resume"];function tC(t,e,n){if(typeof t.prependListener=="function")return t.prependListener(e,n);!t._events||!t._events[e]?t.on(e,n):Array.isArray(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]}function wb(t,e,n){yc=yc||Bc,t=t||{},typeof n!="boolean"&&(n=e instanceof yc),this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=JD(this,t,"readableHighWaterMark",n),this.buffer=new GD,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(_c||(_c=J0.StringDecoder),this.decoder=new _c(t.encoding),this.encoding=t.encoding)}function Ft(t){if(yc=yc||Bc,!(this instanceof Ft))return new Ft(t);var e=this instanceof yc;this._readableState=new wb(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),mu.call(this)}Object.defineProperty(Ft.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});Ft.prototype.destroy=em.destroy;Ft.prototype._undestroy=em.undestroy;Ft.prototype._destroy=function(t,e){e(t)};Ft.prototype.push=function(t,e){var n=this._readableState,r;return n.objectMode?r=!0:typeof t=="string"&&(e=e||n.defaultEncoding,e!==n.encoding&&(t=Df.from(t,e),e=""),r=!0),vb(this,t,e,!1,r)};Ft.prototype.unshift=function(t){return vb(this,t,null,!0,!1)};function vb(t,e,n,r,i){_t("readableAddChunk",e);var o=t._readableState;if(e===null)o.reading=!1,iC(t,o);else{var s;if(i||(s=nC(o,e)),s)kl(t,s);else if(o.objectMode||e&&e.length>0)if(typeof e!="string"&&!o.objectMode&&Object.getPrototypeOf(e)!==Df.prototype&&(e=VD(e)),r)o.endEmitted?kl(t,new eC):yp(t,o,e,!0);else if(o.ended)kl(t,new QD);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!n?(e=o.decoder.write(e),o.objectMode||e.length!==0?yp(t,o,e,!1):vg(t,o)):yp(t,o,e,!1)}else r||(o.reading=!1,vg(t,o))}return!o.ended&&(o.length<o.highWaterMark||o.length===0)}function yp(t,e,n,r){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",n)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&Pf(t)),vg(t,e)}function nC(t,e){var n;return!zD(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(n=new ZD("chunk",["string","Buffer","Uint8Array"],e)),n}Ft.prototype.isPaused=function(){return this._readableState.flowing===!1};Ft.prototype.setEncoding=function(t){_c||(_c=J0.StringDecoder);var e=new _c(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,r="";n!==null;)r+=e.write(n.data),n=n.next;return this._readableState.buffer.clear(),r!==""&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var V_=1073741824;function rC(t){return t>=V_?t=V_:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function z_(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=rC(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}Ft.prototype.read=function(t){_t("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return _t("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?_p(this):Pf(this),null;if(t=z_(t,e),t===0&&e.ended)return e.length===0&&_p(this),null;var r=e.needReadable;_t("need readable",r),(e.length===0||e.length-t<e.highWaterMark)&&(r=!0,_t("length less than watermark",r)),e.ended||e.reading?(r=!1,_t("reading or ended",r)):r&&(_t("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=z_(n,e)));var i;return t>0?i=Sb(t,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&_p(this)),i!==null&&this.emit("data",i),i};function iC(t,e){if(_t("onEofChunk"),!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,e.sync?Pf(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,bb(t)))}}function Pf(t){var e=t._readableState;_t("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(_t("emitReadable",e.flowing),e.emittedReadable=!0,qt.nextTick(bb,t))}function bb(t){var e=t._readableState;_t("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,tm(t)}function vg(t,e){e.readingMore||(e.readingMore=!0,qt.nextTick(oC,t,e))}function oC(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var n=e.length;if(_t("maybeReadMore read 0"),t.read(0),n===e.length)break}e.readingMore=!1}Ft.prototype._read=function(t){kl(this,new XD("_read()"))};Ft.prototype.pipe=function(t,e){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t);break}r.pipesCount+=1,_t("pipe count=%d opts=%j",r.pipesCount,e);var i=(!e||e.end!==!1)&&t!==qt.stdout&&t!==qt.stderr,o=i?a:w;r.endEmitted?qt.nextTick(o):n.once("end",o),t.on("unpipe",s);function s(E,b){_t("onunpipe"),E===n&&b&&b.hasUnpiped===!1&&(b.hasUnpiped=!0,u())}function a(){_t("onend"),t.end()}var c=sC(n);t.on("drain",c);var l=!1;function u(){_t("cleanup"),t.removeListener("close",p),t.removeListener("finish",y),t.removeListener("drain",c),t.removeListener("error",g),t.removeListener("unpipe",s),n.removeListener("end",a),n.removeListener("end",w),n.removeListener("data",d),l=!0,r.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&c()}n.on("data",d);function d(E){_t("ondata");var b=t.write(E);_t("dest.write",b),b===!1&&((r.pipesCount===1&&r.pipes===t||r.pipesCount>1&&Tb(r.pipes,t)!==-1)&&!l&&(_t("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function g(E){_t("onerror",E),w(),t.removeListener("error",g),_b(t,"error")===0&&kl(t,E)}tC(t,"error",g);function p(){t.removeListener("finish",y),w()}t.once("close",p);function y(){_t("onfinish"),t.removeListener("close",p),w()}t.once("finish",y);function w(){_t("unpipe"),n.unpipe(t)}return t.emit("pipe",n),r.flowing||(_t("pipe resume"),n.resume()),t};function sC(t){return function(){var n=t._readableState;_t("pipeOnDrain",n.awaitDrain),n.awaitDrain&&n.awaitDrain--,n.awaitDrain===0&&_b(t,"data")&&(n.flowing=!0,tm(t))}}Ft.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n),this);if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=Tb(e.pipes,t);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n),this)};Ft.prototype.on=function(t,e){var n=mu.prototype.on.call(this,t,e),r=this._readableState;return t==="data"?(r.readableListening=this.listenerCount("readable")>0,r.flowing!==!1&&this.resume()):t==="readable"&&!r.endEmitted&&!r.readableListening&&(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,_t("on readable",r.length,r.reading),r.length?Pf(this):r.reading||qt.nextTick(aC,this)),n};Ft.prototype.addListener=Ft.prototype.on;Ft.prototype.removeListener=function(t,e){var n=mu.prototype.removeListener.call(this,t,e);return t==="readable"&&qt.nextTick(Eb,this),n};Ft.prototype.removeAllListeners=function(t){var e=mu.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&qt.nextTick(Eb,this),e};function Eb(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function aC(t){_t("readable nexttick read 0"),t.read(0)}Ft.prototype.resume=function(){var t=this._readableState;return t.flowing||(_t("resume"),t.flowing=!t.readableListening,cC(this,t)),t.paused=!1,this};function cC(t,e){e.resumeScheduled||(e.resumeScheduled=!0,qt.nextTick(lC,t,e))}function lC(t,e){_t("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),tm(t),e.flowing&&!e.reading&&t.read(0)}Ft.prototype.pause=function(){return _t("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(_t("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function tm(t){var e=t._readableState;for(_t("flow",e.flowing);e.flowing&&t.read()!==null;);}Ft.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;t.on("end",function(){if(_t("wrapped end"),n.decoder&&!n.ended){var s=n.decoder.end();s&&s.length&&e.push(s)}e.push(null)}),t.on("data",function(s){if(_t("wrapped data"),n.decoder&&(s=n.decoder.write(s)),!(n.objectMode&&s==null)&&!(!n.objectMode&&(!s||!s.length))){var a=e.push(s);a||(r=!0,t.pause())}});for(var i in t)this[i]===void 0&&typeof t[i]=="function"&&(this[i]=function(a){return function(){return t[a].apply(t,arguments)}}(i));for(var o=0;o<mp.length;o++)t.on(mp[o],this.emit.bind(this,mp[o]));return this._read=function(s){_t("wrapped _read",s),r&&(r=!1,t.resume())},this};typeof Symbol=="function"&&(Ft.prototype[Symbol.asyncIterator]=function(){return pp===void 0&&(pp=KD),pp(this)});Object.defineProperty(Ft.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(Ft.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Ft.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});Ft._fromList=Sb;Object.defineProperty(Ft.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Sb(t,e){if(e.length===0)return null;var n;return e.objectMode?n=e.buffer.shift():!t||t>=e.length?(e.decoder?n=e.buffer.join(""):e.buffer.length===1?n=e.buffer.first():n=e.buffer.concat(e.length),e.buffer.clear()):n=e.buffer.consume(t,e.decoder),n}function _p(t){var e=t._readableState;_t("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,qt.nextTick(uC,e,t))}function uC(t,e){if(_t("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var n=e._writableState;(!n||n.autoDestroy&&n.finished)&&e.destroy()}}typeof Symbol=="function"&&(Ft.from=function(t,e){return gp===void 0&&(gp=WD),gp(Ft,t,e)});function Tb(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}var Ab=hs,Nf=Ba.codes,dC=Nf.ERR_METHOD_NOT_IMPLEMENTED,fC=Nf.ERR_MULTIPLE_CALLBACK,hC=Nf.ERR_TRANSFORM_ALREADY_TRANSFORMING,pC=Nf.ERR_TRANSFORM_WITH_LENGTH_0,Of=Bc;Da.exports(hs,Of);function gC(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(r===null)return this.emit("error",new fC);n.writechunk=null,n.writecb=null,e!=null&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function hs(t){if(!(this instanceof hs))return new hs(t);Of.call(this,t),this._transformState={afterTransform:gC.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",mC)}function mC(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,n){G_(t,e,n)}):G_(this,null,null)}hs.prototype.push=function(t,e){return this._transformState.needTransform=!1,Of.prototype.push.call(this,t,e)};hs.prototype._transform=function(t,e,n){n(new dC("_transform()"))};hs.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};hs.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};hs.prototype._destroy=function(t,e){Of.prototype._destroy.call(this,t,function(n){e(n)})};function G_(t,e,n){if(e)return t.emit("error",e);if(n!=null&&t.push(n),t._writableState.length)throw new pC;if(t._transformState.transforming)throw new hC;return t.push(null)}var yC=Wl,xb=Ab;Da.exports(Wl,xb);function Wl(t){if(!(this instanceof Wl))return new Wl(t);xb.call(this,t)}Wl.prototype._transform=function(t,e,n){n(null,t)};var wp;function _C(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var Ib=Ba.codes,wC=Ib.ERR_MISSING_ARGS,vC=Ib.ERR_STREAM_DESTROYED;function Y_(t){if(t)throw t}function bC(t){return t.setHeader&&typeof t.abort=="function"}function EC(t,e,n,r){r=_C(r);var i=!1;t.on("close",function(){i=!0}),wp===void 0&&(wp=Q0),wp(t,{readable:e,writable:n},function(s){if(s)return r(s);i=!0,r()});var o=!1;return function(s){if(!i&&!o){if(o=!0,bC(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();r(s||new vC("pipe"))}}}function J_(t){t()}function SC(t,e){return t.pipe(e)}function TC(t){return!t.length||typeof t[t.length-1]!="function"?Y_:t.pop()}function AC(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=TC(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new wC("streams");var i,o=e.map(function(s,a){var c=a<e.length-1,l=a>0;return EC(s,c,l,function(u){i||(i=u),u&&o.forEach(J_),!c&&(o.forEach(J_),r(i))})});return e.reduce(SC)}var xC=AC;(function(t,e){e=t.exports=yb,e.Stream=e,e.Readable=e,e.Writable=ub,e.Duplex=Bc,e.Transform=Ab,e.PassThrough=yC,e.finished=Q0,e.pipeline=xC})(Cc,Cc.exports);class IC{constructor(e,n){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,!n&&e&&!e[0]&&(n=e,e=null),n=n||{},this._factory=n.factory||z0,e&&this.addQuads(e)}get size(){let e=this._size;if(e!==null)return e;e=0;const n=this._graphs;let r,i;for(const o in n)for(const s in r=n[o].subjects)for(const a in i=r[s])e+=Object.keys(i[a]).length;return this._size=e}_addToIndex(e,n,r,i){const o=e[n]||(e[n]={}),s=o[r]||(o[r]={}),a=i in s;return a||(s[i]=null),!a}_removeFromIndex(e,n,r,i){const o=e[n],s=o[r];delete s[i];for(const a in s)return;delete o[r];for(const a in o)return;delete e[n]}*_findInIndex(e,n,r,i,o,s,a,c){let l,u,d;const g=this._entities,p=ss(c,this._factory),y={subject:null,predicate:null,object:null};n&&((l=e,e={})[n]=l[n]);for(const w in e)if(u=e[w]){y[o]=ss(g[w],this._factory),r&&((l=u,u={})[r]=l[r]);for(const E in u)if(d=u[E]){y[s]=ss(g[E],this._factory);const b=i?i in d?[i]:[]:Object.keys(d);for(let S=0;S<b.length;S++)y[a]=ss(g[b[S]],this._factory),yield this._factory.quad(y.subject,y.predicate,y.object,p)}}}_loop(e,n){for(const r in e)n(r)}_loopByKey0(e,n,r){let i,o;if(i=e[n])for(o in i)r(o)}_loopByKey1(e,n,r){let i,o;for(i in e)o=e[i],o[n]&&r(i)}_loopBy2Keys(e,n,r,i){let o,s,a;if((o=e[n])&&(s=o[r]))for(a in s)i(a)}_countInIndex(e,n,r,i){let o=0,s,a,c;n&&((s=e,e={})[n]=s[n]);for(const l in e)if(a=e[l]){r&&((s=a,a={})[r]=s[r]);for(const u in a)(c=a[u])&&(i?i in c&&o++:o+=Object.keys(c).length)}return o}_getGraphs(e){if(!Ai(e))return this._graphs;const n={};return n[e]=this._graphs[e],n}_uniqueEntities(e){const n=Object.create(null);return r=>{r in n||(n[r]=!0,e(ss(this._entities[r],this._factory)))}}add(e){return this.addQuad(e),this}addQuad(e,n,r,i){n||(i=e.graph,r=e.object,n=e.predicate,e=e.subject),e=Ht(e),n=Ht(n),r=Ht(r),i=Ht(i);let o=this._graphs[i];o||(o=this._graphs[i]={subjects:{},predicates:{},objects:{}},Object.freeze(o));const s=this._ids,a=this._entities;e=s[e]||(s[a[++this._id]=e]=this._id),n=s[n]||(s[a[++this._id]=n]=this._id),r=s[r]||(s[a[++this._id]=r]=this._id);const c=this._addToIndex(o.subjects,e,n,r);return this._addToIndex(o.predicates,n,r,e),this._addToIndex(o.objects,r,e,n),this._size=null,c}addQuads(e){for(let n=0;n<e.length;n++)this.addQuad(e[n])}delete(e){return this.removeQuad(e),this}has(e,n,r,i){return e&&e.subject&&({subject:e,predicate:n,object:r,graph:i}=e),!this.readQuads(e,n,r,i).next().done}import(e){return e.on("data",n=>{this.addQuad(n)}),e}removeQuad(e,n,r,i){n||(i=e.graph,r=e.object,n=e.predicate,e=e.subject),e=Ht(e),n=Ht(n),r=Ht(r),i=Ht(i);const o=this._ids,s=this._graphs;let a,c,l;if(!(e=o[e])||!(n=o[n])||!(r=o[r])||!(a=s[i])||!(c=a.subjects[e])||!(l=c[n])||!(r in l))return!1;this._removeFromIndex(a.subjects,e,n,r),this._removeFromIndex(a.predicates,n,r,e),this._removeFromIndex(a.objects,r,e,n),this._size!==null&&this._size--;for(e in a.subjects)return!0;return delete s[i],!0}removeQuads(e){for(let n=0;n<e.length;n++)this.removeQuad(e[n])}remove(e){return e.on("data",n=>{this.removeQuad(n)}),e}removeMatches(e,n,r,i){const o=new Cc.exports.Readable({objectMode:!0});return o._read=()=>{for(const s of this.readQuads(e,n,r,i))o.push(s);o.push(null)},this.remove(o)}deleteGraph(e){return this.removeMatches(null,null,null,e)}getQuads(e,n,r,i){return[...this.readQuads(e,n,r,i)]}*readQuads(e,n,r,i){e=e&&Ht(e),n=n&&Ht(n),r=r&&Ht(r),i=i&&Ht(i);const o=this._getGraphs(i),s=this._ids;let a,c,l,u;if(!(Ai(e)&&!(c=s[e])||Ai(n)&&!(l=s[n])||Ai(r)&&!(u=s[r])))for(const d in o)(a=o[d])&&(c?u?yield*this._findInIndex(a.objects,u,c,l,"object","subject","predicate",d):yield*this._findInIndex(a.subjects,c,l,null,"subject","predicate","object",d):l?yield*this._findInIndex(a.predicates,l,u,null,"predicate","object","subject",d):u?yield*this._findInIndex(a.objects,u,null,null,"object","subject","predicate",d):yield*this._findInIndex(a.subjects,null,null,null,"subject","predicate","object",d))}match(e,n,r,i){return new nm(this,e,n,r,i)}countQuads(e,n,r,i){e=e&&Ht(e),n=n&&Ht(n),r=r&&Ht(r),i=i&&Ht(i);const o=this._getGraphs(i),s=this._ids;let a=0,c,l,u,d;if(Ai(e)&&!(l=s[e])||Ai(n)&&!(u=s[n])||Ai(r)&&!(d=s[r]))return 0;for(const g in o)(c=o[g])&&(e?r?a+=this._countInIndex(c.objects,d,l,u):a+=this._countInIndex(c.subjects,l,u,d):n?a+=this._countInIndex(c.predicates,u,d,l):a+=this._countInIndex(c.objects,d,l,u));return a}forEach(e,n,r,i,o){this.some(s=>(e(s),!1),n,r,i,o)}every(e,n,r,i,o){let s=!1;const a=!this.some(c=>(s=!0,!e(c)),n,r,i,o);return s&&a}some(e,n,r,i,o){for(const s of this.readQuads(n,r,i,o))if(e(s))return!0;return!1}getSubjects(e,n,r){const i=[];return this.forSubjects(o=>{i.push(o)},e,n,r),i}forSubjects(e,n,r,i){n=n&&Ht(n),r=r&&Ht(r),i=i&&Ht(i);const o=this._ids,s=this._getGraphs(i);let a,c,l;if(e=this._uniqueEntities(e),!(Ai(n)&&!(c=o[n])||Ai(r)&&!(l=o[r])))for(i in s)(a=s[i])&&(c?l?this._loopBy2Keys(a.predicates,c,l,e):this._loopByKey1(a.subjects,c,e):l?this._loopByKey0(a.objects,l,e):this._loop(a.subjects,e))}getPredicates(e,n,r){const i=[];return this.forPredicates(o=>{i.push(o)},e,n,r),i}forPredicates(e,n,r,i){n=n&&Ht(n),r=r&&Ht(r),i=i&&Ht(i);const o=this._ids,s=this._getGraphs(i);let a,c,l;if(e=this._uniqueEntities(e),!(Ai(n)&&!(c=o[n])||Ai(r)&&!(l=o[r])))for(i in s)(a=s[i])&&(c?l?this._loopBy2Keys(a.objects,l,c,e):this._loopByKey0(a.subjects,c,e):l?this._loopByKey1(a.predicates,l,e):this._loop(a.predicates,e))}getObjects(e,n,r){const i=[];return this.forObjects(o=>{i.push(o)},e,n,r),i}forObjects(e,n,r,i){n=n&&Ht(n),r=r&&Ht(r),i=i&&Ht(i);const o=this._ids,s=this._getGraphs(i);let a,c,l;if(e=this._uniqueEntities(e),!(Ai(n)&&!(c=o[n])||Ai(r)&&!(l=o[r])))for(i in s)(a=s[i])&&(c?l?this._loopBy2Keys(a.subjects,c,l,e):this._loopByKey1(a.objects,c,e):l?this._loopByKey0(a.predicates,l,e):this._loop(a.objects,e))}getGraphs(e,n,r){const i=[];return this.forGraphs(o=>{i.push(o)},e,n,r),i}forGraphs(e,n,r,i){for(const o in this._graphs)this.some(s=>(e(s.graph),!0),n,r,i,o)}createBlankNode(e){let n,r;if(e)for(n=e=`_:${e}`,r=1;this._ids[n];)n=e+r++;else do n=`_:b${this._blankNodeIndex++}`;while(this._ids[n]);return this._ids[n]=++this._id,this._entities[this._id]=n,this._factory.blankNode(n.substr(2))}extractLists({remove:e=!1,ignoreErrors:n=!1}={}){const r={},i=n?()=>!0:(a,c)=>{throw new Error(`${a.value} ${c}`)},o=this.getQuads(null,Qr.rdf.rest,Qr.rdf.nil,null),s=e?[...o]:[];return o.forEach(a=>{const c=[];let l=!1,u,d;const g=a.graph;let p=a.subject;for(;p&&!l;){const y=this.getQuads(null,null,p,null),w=this.getQuads(p,null,null,null);let E,b=null,S=null,R=null;for(let F=0;F<w.length&&!l;F++)E=w[F],E.graph.equals(g)?u?l=i(p,"has non-list arcs out"):E.predicate.value===Qr.rdf.first?b?l=i(p,"has multiple rdf:first arcs"):s.push(b=E):E.predicate.value===Qr.rdf.rest?S?l=i(p,"has multiple rdf:rest arcs"):s.push(S=E):y.length?l=i(p,"can't be subject and object"):(u=E,d="subject"):l=i(p,"not confined to single graph");for(let F=0;F<y.length&&!l;++F)E=y[F],u?l=i(p,"can't have coreferences"):E.predicate.value===Qr.rdf.rest?R?l=i(p,"has incoming rdf:rest arcs"):R=E:(u=E,d="object");b?c.unshift(b.object):l=i(p,"has no list head"),p=R&&R.subject}l?e=!1:u&&(r[u[d].value]=c)}),e&&this.removeQuads(s),r}*[Symbol.iterator](){yield*this.readQuads()}}function Ai(t){return typeof t=="string"||t instanceof String}class nm extends Cc.exports.Readable{constructor(e,n,r,i,o){super({objectMode:!0}),Object.assign(this,{n3Store:e,subject:n,predicate:r,object:i,graph:o})}get filtered(){if(!this._filtered){const{n3Store:e,graph:n,object:r,predicate:i,subject:o}=this,s=this._filtered=new IC({factory:e._factory});for(const a of e.readQuads(o,i,r,n))s.addQuad(a)}return this._filtered}get size(){return this.filtered.size}_read(){for(const e of this)this.push(e);this.push(null)}add(e){return this.filtered.add(e)}delete(e){return this.filtered.delete(e)}has(e){return this.filtered.has(e)}match(e,n,r,i){return new nm(this.filtered,e,n,r,i)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}class HO extends Cc.exports.Transform{constructor(e){super({decodeStrings:!0}),this._readableState.objectMode=!0;const n=new G0(e);let r,i;n.parse({on:(o,s)=>{switch(o){case"data":r=s;break;case"end":i=s;break}}},(o,s)=>{o&&this.emit("error",o)||s&&this.push(s)},(o,s)=>{this.emit("prefix",o,s)}),this._transform=(o,s,a)=>{r(o),a()},this._flush=o=>{i(),o()}}import(e){return e.on("data",n=>{this.write(n)}),e.on("end",()=>{this.end()}),e.on("error",n=>{this.emit("error",n)}),this}}class KO extends Cc.exports.Transform{constructor(e){super({encoding:"utf8",writableObjectMode:!0});const n=this._writer=new ib({write:(r,i,o)=>{this.push(r),o&&o()},end:r=>{this.push(null),r&&r()}},e);this._transform=(r,i,o)=>{n.addQuad(r,o)},this._flush=r=>{n.end(r)}}import(e){return e.on("data",n=>{this.write(n)}),e.on("end",()=>{this.end()}),e.on("error",n=>{this.emit("error",n)}),e.on("prefix",(n,r)=>{this._writer.addPrefix(n,r)}),this}}function Mf(t){const e=t;return typeof e=="object"&&typeof e.internal_resourceInfo=="object"}function yu(t){const e=t;return typeof e=="object"&&typeof e.internal_resourceInfo=="object"&&typeof e.internal_resourceInfo.linkedResources=="object"}function Hc(t){const e=t;return typeof e.internal_changeLog=="object"&&Array.isArray(e.internal_changeLog.additions)&&Array.isArray(e.internal_changeLog.deletions)}class _u extends Error{}function lt(t){return typeof t=="string"?t:t.value}const Rb=async(t,e)=>{if(typeof window=="object"&&typeof require!="function")return await window.fetch(t,e);if(typeof require!="function"){const i=(await aS(()=>Promise.resolve().then(function(){return lA}),void 0)).default;return i(t,e)}let n;return n=require("cross-fetch"),await n(t,e)};function rm(t){var e,n,r,i,o;const s=(n=(e=t.headers.get("Content-Type"))===null||e===void 0?void 0:e.split(";"))!==null&&n!==void 0?n:[],a=s.length>0&&["text/turtle","application/ld+json"].includes(s[0]),c={sourceIri:t.url,isRawData:!a,contentLocation:(r=t.headers.get("Content-Location"))!==null&&r!==void 0?r:void 0,contentType:(i=t.headers.get("Content-Type"))!==null&&i!==void 0?i:void 0,linkedResources:{},location:(o=t.headers.get("Location"))!==null&&o!==void 0?o:void 0},l=t.headers.get("Link");if(l){const d=mk.parse(l),g=d.get("rel","acl");g.length===1&&(c.aclUrl=new URL(g[0].uri,c.sourceIri).href),c.linkedResources=d.refs.reduce((p,y)=>{var w,E;return(w=p[E=y.rel])!==null&&w!==void 0||(p[E]=[]),p[y.rel].push(new URL(y.uri,c.sourceIri).href),p},c.linkedResources)}const u=t.headers.get("WAC-Allow");return u&&(c.permissions=RC(u)),c}function RC(t){function e(r){const i=r.split(" ");return i.includes("write")?{read:i.includes("read"),append:!0,write:!0,control:i.includes("control")}:{read:i.includes("read"),append:i.includes("append"),write:!1,control:i.includes("control")}}function n(r,i){const o=r.split(",").map(a=>a.split("=")).filter(a=>a.length===2&&a[0].trim()===i);if(o.length!==1)return"";const s=o[0][1].trim();return s.charAt(0)!=='"'||s.charAt(s.length-1)!=='"'?"":s.substring(1,s.length-1)}return{user:e(n(t,"user")),public:e(n(t,"public"))}}function wu(t){let e;return typeof t.slice=="function"?e=Object.assign(t.slice(),Object.assign({},t)):e=Object.assign({},t),e}function vu(t){return!t.ok}function kC(t){return t.status===401||t.status===403}const ui={type:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"},FC={BasicContainer:"http://www.w3.org/ns/ldp#BasicContainer",Container:"http://www.w3.org/ns/ldp#Container",Resource:"http://www.w3.org/ns/ldp#Resource",contains:"http://www.w3.org/ns/ldp#contains"},ue={AccessControlResource:"http://www.w3.org/ns/solid/acp#AccessControlResource",Policy:"http://www.w3.org/ns/solid/acp#Policy",AccessControl:"http://www.w3.org/ns/solid/acp#AccessControl",Read:"http://www.w3.org/ns/solid/acp#Read",Append:"http://www.w3.org/ns/solid/acp#Append",Write:"http://www.w3.org/ns/solid/acp#Write",Rule:"http://www.w3.org/ns/solid/acp#Rule",Matcher:"http://www.w3.org/ns/solid/acp#Matcher",accessControl:"http://www.w3.org/ns/solid/acp#accessControl",memberAccessControl:"http://www.w3.org/ns/solid/acp#memberAccessControl",apply:"http://www.w3.org/ns/solid/acp#apply",applyMembers:"http://www.w3.org/ns/solid/acp#applyMembers",allow:"http://www.w3.org/ns/solid/acp#allow",deny:"http://www.w3.org/ns/solid/acp#deny",allOf:"http://www.w3.org/ns/solid/acp#allOf",anyOf:"http://www.w3.org/ns/solid/acp#anyOf",noneOf:"http://www.w3.org/ns/solid/acp#noneOf",access:"http://www.w3.org/ns/solid/acp#access",accessMembers:"http://www.w3.org/ns/solid/acp#accessMembers",agent:"http://www.w3.org/ns/solid/acp#agent",group:"http://www.w3.org/ns/solid/acp#group",client:"http://www.w3.org/ns/solid/acp#client",PublicAgent:"http://www.w3.org/ns/solid/acp#PublicAgent",AuthenticatedAgent:"http://www.w3.org/ns/solid/acp#AuthenticatedAgent",CreatorAgent:"http://www.w3.org/ns/solid/acp#CreatorAgent"},qs={PublicOidcClient:"http://www.w3.org/ns/solid/terms#PublicOidcClient"},_n={fetch:Rb};async function bu(t,e=Object.assign(Object.assign({},_n),{ignoreAuthenticationErrors:!1})){var n;const i=await Object.assign(Object.assign({},_n),e).fetch(t,{method:"HEAD"});return kb(i,{ignoreAuthenticationErrors:(n=e.ignoreAuthenticationErrors)!==null&&n!==void 0?n:!1})}function kb(t,e={ignoreAuthenticationErrors:!1}){if(vu(t)&&(!kC(t)||!e.ignoreAuthenticationErrors))throw new Eu(`Fetching the metadata of the Resource at [${t.url}] failed: [${t.status}] [${t.statusText}].`,t);return{internal_resourceInfo:rm(t)}}function DC(t){var e;return(e=t.internal_resourceInfo.contentType)!==null&&e!==void 0?e:null}function et(t){return Mf(t)?t.internal_resourceInfo.sourceIri:null}const va=et;function CC(t){return t.internal_resourceInfo.linkedResources}class Eu extends _u{constructor(e,n){super(e),this.response=n}get statusCode(){return this.response.status}get statusText(){return this.response.statusText}}const Z_={fetch:Rb};async function Fb(t,e=Z_){const n=Object.assign(Object.assign({},Z_),e),r=lt(t),i=await n.fetch(r,n.init);if(vu(i))throw new Eu(`Fetching the File failed: [${i.status}] [${i.statusText}].`,i);const o=rm(i),s=await i.blob();return Object.assign(s,{internal_resourceInfo:o})}S1.dataset;const qd="https://inrupt.com/.well-known/sdk-local-node/",be=Object.freeze;function co(t){return t.substring(0,qd.length)===qd}function Zi(t){return t.substring(qd.length)}function PC(t){return`${qd}${t}`}function Lf(t){return typeof t=="string"&&t.substring(0,2)==="_:"}function im(t){return t.substring(2)}function Db(t){return`_:${t.value}`}const Rn={boolean:"http://www.w3.org/2001/XMLSchema#boolean",dateTime:"http://www.w3.org/2001/XMLSchema#dateTime",date:"http://www.w3.org/2001/XMLSchema#date",time:"http://www.w3.org/2001/XMLSchema#time",decimal:"http://www.w3.org/2001/XMLSchema#decimal",integer:"http://www.w3.org/2001/XMLSchema#integer",string:"http://www.w3.org/2001/XMLSchema#string",langString:"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"};function NC(t){return t?"true":"false"}function Cb(t){return t==="true"||t==="1"?!0:t==="false"||t==="0"?!1:null}function OC(t){let e,n;if(t.millisecond&&(t.millisecond<10?e="00"+t.millisecond:t.millisecond<100?e="0"+t.millisecond:e=t.millisecond),typeof t.timezoneHourOffset=="number"){const r=Math.abs(t.timezoneHourOffset)<10?"0"+Math.abs(t.timezoneHourOffset):Math.abs(t.timezoneHourOffset);n=t.timezoneHourOffset>=0?"+"+r:"-"+r,t.timezoneMinuteOffset?n=n+":"+(t.timezoneMinuteOffset<10?"0"+t.timezoneMinuteOffset:t.timezoneMinuteOffset):n=n+":00"}return(t.hour<10?"0"+t.hour:t.hour)+":"+(t.minute<10?"0"+t.minute:t.minute)+":"+(t.second<10?"0"+t.second:t.second)+(t.millisecond?"."+e:"")+(n||"")}function MC(t){if(!/\d\d:\d\d:\d\d(\.\d+)?(Z|(\+|-)\d\d:\d\d)?/.test(t))return null;const[n,r]=om(t),[i,o,s]=n.split(":");let a=Number.parseInt(i,10),c=Number.parseInt(o,10);const[l,u]=s.split("."),d=Number.parseInt(l,10),g=u?Number.parseInt(u,10):void 0;c>=60&&(a=a+1,c=c-60);const p={hour:a,minute:c,second:d};if(typeof g=="number"&&(p.millisecond=g),typeof r=="string"){const[y,w]=Nb(r);if(typeof y!="number"||y>24||typeof w!="number"||w>59)return null;p.timezoneHourOffset=y,p.timezoneMinuteOffset=w}return p}function LC(t){return t.toISOString()}function Pb(t){if(!/-?\d{4,}-\d\d-\d\dT\d\d:\d\d:\d\d(\.\d+)?(Z|(\+|-)\d\d:\d\d)?/.test(t))return null;const[n,r]=t.split("T"),[i,o]=n.charAt(0)==="-"?[-1,n.substring(1)]:[1,n],[s,a,c]=o.split("-"),l=Number.parseInt(s,10)*i,u=Number.parseInt(a,10)-1,d=Number.parseInt(c,10),[g,p]=om(r),[y,w]=typeof p=="string"?Nb(p):[0,0],[E,b,S]=g.split(":"),R=Number.parseInt(E,10)+y,F=Number.parseInt(b,10)+w,[M,P]=S.split("."),D=Number.parseInt(M,10),Y=P?Number.parseInt(P,10):0,X=new Date(Date.UTC(l,u,d,R,F,D,Y));return l>=0&&l<100&&X.setUTCFullYear(X.getUTCFullYear()-1900),X}function UC(t){const e=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),[i,o]=om(t.toISOString());return`${e}-${String(n).padStart(2,"0")}-${String(r).padStart(2,"0")}${o}`}function jC(t){if(!/-?\d{4,}-\d\d-\d\d(Z|(\+|-)\d\d:\d\d)?/.test(t))return null;const n=t,[r,i]=n.charAt(0)==="-"?[-1,n.substring(1)]:[1,n],[o,s,a]=i.split("-"),c=a.length>2?a.substring(0,2):a,l=Number.parseInt(o,10)*r,u=Number.parseInt(s,10)-1,d=Number.parseInt(c,10),g=12,p=new Date(Date.UTC(l,u,d,g));return l>=0&&l<100&&p.setUTCFullYear(p.getUTCFullYear()-1900),p}function om(t){if(t.endsWith("Z"))return[t.substring(0,t.length-1),"Z"];const e=t.split("+"),n=t.split("-");return e.length===1&&n.length===1?[e[0],void 0]:e.length>n.length?[e[0],"+"+e[1]]:[n[0],"-"+n[1]]}function Nb(t){if(t==="Z")return[0,0];const e=t.charAt(0)==="+"?1:-1,[n,r]=t.substring(1).split(":"),i=Number.parseInt(n,10),o=Number.parseInt(r,10);return[i*e,o*e]}function $C(t){return t.toString()}function Ob(t){const e=Number.parseFloat(t);return Number.isNaN(e)?null:e}function BC(t){return t.toString()}function Mb(t){const e=Number.parseInt(t,10);return Number.isNaN(e)?null:e}function bg(t){return t.toLowerCase()}function yr(t){return Lb(t)&&t.termType==="NamedNode"}function HC(t){return Lb(t)&&t.termType==="Literal"}function Lb(t){return t!==null&&typeof t=="object"&&typeof t.termType=="string"&&typeof t.value=="string"&&typeof t.equals=="function"}function Q_(t){return yr(t)&&co(t.value)}function Mn(t){const e=lt(t);if(typeof URL!="function")return!0;try{new URL(e)}catch{return!1}return!0}function X_(t,e){return li.namedNode(Su(Zi(t.value),e))}function Su(t,e){if(typeof URL!="function")throw new Error("The URL interface is not available, so an IRI cannot be determined.");const n=new URL(e);return n.hash=t,n.href}const li=If;function ew(t,e,n={}){var r;if(!["NamedNode","DefaultGraph"].includes(e.graph.termType))throw new Error(`Cannot parse Quads with nodes of type [${e.graph.termType}] as their Graph node.`);const o=e.graph.termType==="DefaultGraph"?"default":e.graph.value,s=(r=t.graphs[o])!==null&&r!==void 0?r:{};return be(Object.assign(Object.assign({},t),{graphs:be(Object.assign(Object.assign({},t.graphs),{[o]:KC(s,e,n)}))}))}function KC(t,e,n){var r;if(!["NamedNode","BlankNode"].includes(e.subject.termType))throw new Error(`Cannot parse Quads with nodes of type [${e.subject.termType}] as their Subject node.`);const o=e.subject.termType==="BlankNode"?`_:${e.subject.value}`:e.subject.value,s=(r=t[o])!==null&&r!==void 0?r:{type:"Subject",url:o,predicates:{}};return be(Object.assign(Object.assign({},t),{[o]:WC(s,e,n)}))}function WC(t,e,n){return be(Object.assign(Object.assign({},t),{predicates:qC(t.predicates,e,n)}))}function qC(t,e,n){var r;if(!["NamedNode"].includes(e.predicate.termType))throw new Error(`Cannot parse Quads with nodes of type [${e.predicate.termType}] as their Predicate node.`);const o=e.predicate.value,s=(r=t[o])!==null&&r!==void 0?r:{};return be(Object.assign(Object.assign({},t),{[o]:Ub(s,e,n)}))}function Ub(t,e,n){var r,i,o,s,a,c,l,u;if(e.object.termType==="NamedNode"){const d=be([...(r=t.namedNodes)!==null&&r!==void 0?r:[],e.object.value]);return be(Object.assign(Object.assign({},t),{namedNodes:d}))}if(e.object.termType==="Literal"){if(e.object.datatype.value===Rn.langString){const p=e.object.language.toLowerCase(),y=be([...(o=(i=t.langStrings)===null||i===void 0?void 0:i[p])!==null&&o!==void 0?o:[],e.object.value]),w=be(Object.assign(Object.assign({},(s=t.langStrings)!==null&&s!==void 0?s:{}),{[p]:y}));return be(Object.assign(Object.assign({},t),{langStrings:w}))}const d=be([...(c=(a=t.literals)===null||a===void 0?void 0:a[e.object.datatype.value])!==null&&c!==void 0?c:[],e.object.value]),g=be(Object.assign(Object.assign({},(l=t.literals)!==null&&l!==void 0?l:{}),{[e.object.datatype.value]:d}));return be(Object.assign(Object.assign({},t),{literals:g}))}if(e.object.termType==="BlankNode"){const d=jb(e.object,n),g=be([...(u=t.blankNodes)!==null&&u!==void 0?u:[],d]);return be(Object.assign(Object.assign({},t),{blankNodes:g}))}throw new Error(`Objects of type [${e.object.termType}] are not supported.`)}function jb(t,e){var n,r;if(((n=e.chainBlankNodes)!==null&&n!==void 0?n:[]).find(l=>l.equals(t))===void 0)return Db(t);const s=((r=e.otherQuads)!==null&&r!==void 0?r:[]).filter(l=>l.subject.equals(t)),a=s.filter(l=>!Vl(l.object)).reduce((l,u)=>{var d;if(!["NamedNode"].includes(u.predicate.termType))throw new Error(`Cannot parse Quads with nodes of type [${u.predicate.termType}] as their Predicate node.`);const p=(d=l[u.predicate.value])!==null&&d!==void 0?d:{};return be(Object.assign(Object.assign({},l),{[u.predicate.value]:Ub(p,u,e)}))},{});return s.filter(l=>Vl(l.object)).reduce((l,u)=>{var d,g;if(!["NamedNode"].includes(u.predicate.termType))throw new Error(`Cannot parse Quads with nodes of type [${u.predicate.termType}] as their Predicate node.`);const y=(d=l[u.predicate.value])!==null&&d!==void 0?d:{},w=(g=y.blankNodes)!==null&&g!==void 0?g:[];return be(Object.assign(Object.assign({},l),{[u.predicate.value]:Object.assign(Object.assign({},y),{blankNodes:[...w,jb(u.object,e)]})}))},a)}function VC(t){const e=t.map(s=>s.subject).filter(Vl),n=t.map(s=>s.object).filter(Vl);function r(s){return s.every(a=>s.every(c=>a.equals(c)))}const i=[];return n.forEach(s=>{i.push(...$b(s,t))}),e.concat(n).filter(s=>{if(i.some(c=>c.equals(s)))return!1;const a=t.filter(c=>c.object.equals(s)).map(c=>c.subject);return a.length>0&&r(a)})}function zC(t,e={}){var n;const r=[],i=(n=e.dataFactory)!==null&&n!==void 0?n:If;return Object.keys(t.graphs).forEach(o=>{const s=t.graphs[o],a=o==="default"?i.defaultGraph():i.namedNode(o);Object.keys(s).forEach(c=>{const l=s[c].predicates,u=Lf(c)?i.blankNode(im(c)):i.namedNode(c);r.push(...ql(l,u,a,e))})}),r}function ql(t,e,n,r={}){var i;const o=[],s=(i=r.dataFactory)!==null&&i!==void 0?i:If;return Object.keys(t).forEach(a=>{var c,l,u,d;const g=s.namedNode(a),p=(c=t[a].langStrings)!==null&&c!==void 0?c:{},y=(l=t[a].namedNodes)!==null&&l!==void 0?l:[],w=(u=t[a].literals)!==null&&u!==void 0?u:{},E=(d=t[a].blankNodes)!==null&&d!==void 0?d:[];Object.keys(w).forEach(R=>{const F=s.namedNode(R);w[R].forEach(P=>{const D=s.literal(P,F);o.push(s.quad(e,g,D,n))})}),Object.keys(p).forEach(R=>{p[R].forEach(M=>{const P=s.literal(M,R);o.push(s.quad(e,g,P,n))})}),y.forEach(R=>{const F=s.namedNode(R);o.push(s.quad(e,g,F,n))}),E.forEach(R=>{if(Lf(R)){const F=s.blankNode(im(R));o.push(s.quad(e,g,F,n))}else{const F=s.blankNode(),M=s.quad(e,g,F,n),P=ql(R,F,n);o.push(M),o.push(...P)}})}),o}function $b(t,e,n=[]){if(n.find(a=>a.equals(t))!==void 0)return n;const r=e.filter(a=>a.subject.equals(t)&&Vl(a.object)).map(a=>a.object);if(r.length===0)return[];const i=[...n,t],o=r.map(a=>$b(a,e,i)),s=[];for(const a of o)s.push(...a);return s}function Vl(t){return t.termType==="BlankNode"}const GC=()=>{const t=[],e=[],n=[];return{onQuad:r=>{t.push(r)},onError:r=>{n.push(r)},onComplete:r=>{e.push(r)},parse:async(r,i)=>{(await YC(et(i))).parse(r,(s,a,c)=>{s?n.forEach(l=>l(s)):a?t.forEach(l=>l(a)):e.forEach(l=>l())})}}};async function YC(t){return new G0({format:"text/turtle",baseIRI:t})}async function Eg(t){const e="text/turtle",n=new ib({format:e}),r=t.map(s=>li.quad(s.subject,s.predicate,s.object,void 0));return n.addQuads(r),await new Promise((s,a)=>{n.end((c,l)=>{if(c)return a(c);s(l)})})}function Sg(t){var e,n,r,i,o,s,a,c;if(yr(t))return`<${t.value}> (URL)`;if(HC(t)){if(!yr(t.datatype))return`[${t.value}] (RDF/JS Literal of unknown type)`;let l;switch(t.datatype.value){case Rn.boolean:return l=(n=(e=Cb(t.value))===null||e===void 0?void 0:e.valueOf())!==null&&n!==void 0?n:`Invalid data: \`${t.value}\``,l+" (boolean)";case Rn.dateTime:return l=(i=(r=Pb(t.value))===null||r===void 0?void 0:r.toUTCString())!==null&&i!==void 0?i:`Invalid data: \`${t.value}\``,l+" (datetime)";case Rn.decimal:return l=(s=(o=Ob(t.value))===null||o===void 0?void 0:o.toString())!==null&&s!==void 0?s:`Invalid data: \`${t.value}\``,l+" (decimal)";case Rn.integer:return l=(c=(a=Mb(t.value))===null||a===void 0?void 0:a.toString())!==null&&c!==void 0?c:`Invalid data: \`${t.value}\``,l+" (integer)";case Rn.langString:return`"${t.value}" (${t.language} string)`;case Rn.string:return`"${t.value}" (string)`;default:return`[${t.value}] (RDF/JS Literal of type: \`${t.datatype.value}\`)`}}return t.termType==="BlankNode"?`[${t.value}] (RDF/JS BlankNode)`:t.termType==="Quad"?"??? (nested RDF* Quad)":t.termType==="Variable"?`?${t.value} (RDF/JS Variable)`:t}function ft(t){if(!Tu(t))throw new sP(t)}function JC(t,e){const n=Hc(t)?t.internal_changeLog:{additions:[],deletions:[]},[r,i]=e.filter(o=>!Hb(o)).reduce(([o,s],a)=>typeof s.find(l=>l.equals(a))!="undefined"?[o,s.filter(l=>!l.equals(a))]:[o.concat(a),s],[n.additions,n.deletions]);return be(Object.assign(Object.assign({},t),{internal_changeLog:{additions:r,deletions:i}}))}function Bb(t,e){const n=Hc(t)?t.internal_changeLog:{additions:[],deletions:[]},[r,i]=e.filter(o=>!Hb(o)).reduce(([o,s],a)=>typeof o.find(l=>l.equals(a))!="undefined"?[o.filter(l=>!l.equals(a)),s]:[o,s.concat(a)],[n.additions,n.deletions]);return be(Object.assign(Object.assign({},t),{internal_changeLog:{additions:r,deletions:i}}))}function ZC(t){return Hc(t)?t:be(Object.assign(Object.assign({},t),{internal_changeLog:{additions:[],deletions:[]}}))}function Hb(t){return t.subject.termType==="BlankNode"||t.object.termType==="BlankNode"}function QC(t,e){var n,r,i;if(ft(t),!Mn(e))throw new ti(e);const o=lt(e),s=(i=(r=(n=t.predicates[o])===null||n===void 0?void 0:n.namedNodes)===null||r===void 0?void 0:r[0])!==null&&i!==void 0?i:null;return s===null?null:co(s)?`#${Zi(s)}`:s}function XC(t,e){var n,r,i;if(ft(t),!Mn(e))throw new ti(e);const o=lt(e);return(i=(r=(n=t.predicates[o])===null||n===void 0?void 0:n.namedNodes)===null||r===void 0?void 0:r.map(s=>co(s)?`#${Zi(s)}`:s))!==null&&i!==void 0?i:[]}const st=XC;function eP(t,e){return ft(t),iP(t,e,Rn.string)}function tP(t,e){return st(t,e).map(r=>li.namedNode(r))}function nP(t,e){var n,r,i,o;if(ft(t),!Mn(e))throw new ti(e);const s=lt(e);let a=[];const c=(r=(n=t.predicates[s])===null||n===void 0?void 0:n.langStrings)!==null&&r!==void 0?r:{},l=Object.keys(c);for(const g of l){const y=c[g].map(w=>li.literal(w,g));a=a.concat(y)}const u=(o=(i=t.predicates[s])===null||i===void 0?void 0:i.literals)!==null&&o!==void 0?o:{},d=Object.keys(u);for(const g of d){const p=u[g],y=li.namedNode(g),w=p.map(E=>li.literal(E,y));a=a.concat(w)}return a}function rP(t,e){var n,r;ft(t);const i=tP(t,e),o=nP(t,e),s=lt(e),c=((r=(n=t.predicates[s])===null||n===void 0?void 0:n.blankNodes)!==null&&r!==void 0?r:[]).map(u=>{const d=Lf(u)?im(u):void 0;return li.blankNode(d)});return i.concat(o).concat(c)}function iP(t,e,n){var r,i,o;if(!Mn(e))throw new ti(e);const s=lt(e);return[...(o=(i=(r=t.predicates[s])===null||r===void 0?void 0:r.literals)===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:[]]}function wn(t,e,n={}){var r;if(!Mn(e))throw new Kb(e);const i=typeof n.scope!="undefined"?lt(n.scope):"default",o=(r=t.graphs[i])!==null&&r!==void 0?r:{},s=lt(e),a=co(s)&&yu(t)?Su(Zi(s),et(t)):s,c=o[a];return typeof c=="undefined"?null:c}function Vs(t,e={acceptBlankNodes:!1}){var n;const r=typeof e.scope!="undefined"?lt(e.scope):"default",i=(n=t.graphs[r])!==null&&n!==void 0?n:{};return Object.values(i).filter(o=>!Lf(o.url)||e.acceptBlankNodes)}function Kr(t,e){var n;const r=Kc(e)&&yu(t)?Su(Zi(e.url),et(t)):e.url,i=t.graphs.default,o=be(Object.assign(Object.assign({},i),{[r]:be(Object.assign(Object.assign({},e),{url:r}))})),s=be(Object.assign(Object.assign({},t.graphs),{default:o})),a=li.namedNode(r),c=(n=t.graphs.default[r])===null||n===void 0?void 0:n.predicates,l=typeof c!="undefined"?ql(c,a,li.defaultGraph()):[],u=ql(e.predicates,a,li.defaultGraph());return JC(Bb(be(Object.assign(Object.assign({},t),{graphs:s})),l),u)}function zs(t,e){var n;let r;yr(e)?r=e.value:typeof e=="string"?r=co(e)&&yu(t)?Su(Zi(e),et(t)):e:Kc(e)?r=e.url:r=Au(e);const i=t.graphs.default,o=Object.assign({},i);delete o[r];const s=be(Object.assign(Object.assign({},t.graphs),{default:be(o)})),a=li.namedNode(r),c=(n=t.graphs.default[r])===null||n===void 0?void 0:n.predicates,l=typeof c!="undefined"?ql(c,a,li.defaultGraph()):[];return Bb(be(Object.assign(Object.assign({},t),{graphs:s})),l)}function di(t={}){var e;if(typeof t.url!="undefined"){const o=t.url;if(!Mn(o))throw new Kb(o);return be({type:"Subject",predicates:be({}),url:o})}const n=(e=t.name)!==null&&e!==void 0?e:aP(),r=PC(n);return be({type:"Subject",predicates:be({}),url:r})}function Tu(t){return typeof t=="object"&&t!==null&&typeof t.type=="string"&&t.type==="Subject"}function ys(t,e){if(Kc(t)){if(typeof e=="undefined")throw new Error("The URL of a Thing that has not been persisted cannot be determined without a base URL.");return Su(Zi(t.url),e)}return t.url}const Au=ys;function oP(t){let e="";Kc(t)?e+=`## Thing (no URL yet \u2014 identifier: \`#${Zi(t.url)}\`)
`:e+=`## Thing: ${t.url}
`;const n=Object.keys(t.predicates);if(n.length===0)e+=`
<empty>
`;else for(const r of n)e+=`
Property: ${r}
`,rP(t,r).forEach(o=>{e+=`- ${Sg(o)}
`});return e}function Kc(t){return co(t.url)}class sP extends _u{constructor(e){const n=`Expected a Thing, but received: [${e}].`;super(n),this.receivedValue=e}}class ti extends _u{constructor(e){const n=yr(e)?e.value:e,r=`Expected a valid URL to identify a property, but received: [${n}].`;super(r),this.receivedProperty=n}}class sm extends _u{constructor(e){const n=yr(e)?e.value:e,r=`Expected a valid URL value, but received: [${n}].`;super(r),this.receivedValue=n}}class Kb extends _u{constructor(e){const n=yr(e)?e.value:e,r=`Expected a valid URL to identify a Thing, but received: [${n}].`;super(r),this.receivedValue=n}}const aP=()=>Date.now().toString()+Math.random().toString().substring(2);function ac(t){const e=new URL(t);return e.hash="",e.href}function Wb(){return be({type:"Dataset",graphs:{default:{}}})}async function cP(t,e={}){if(vu(t))throw new Eu(`Fetching the SolidDataset at [${t.url}] failed: [${t.status}] [${t.statusText}].`,t);const n=kb(t),r=Object.assign({"text/turtle":GC()},e.parsers),i=DC(n);if(i===null)throw new Error(`Could not determine the content type of the Resource at [${et(n)}].`);const o=i.split(";")[0],s=r[o];if(typeof s=="undefined")throw new Error(`The Resource at [${et(n)}] has a MIME type of [${o}], but the only parsers available are for the following MIME types: [${Object.keys(r).join(", ")}].`);const a=await t.text();return await new Promise((l,u)=>{let d=be({graphs:be({default:be({})}),type:"Dataset"});const g=[],p=[];s.onError(y=>{u(new Error(`Encountered an error parsing the Resource at [${et(n)}] with content type [${i}]: ${y}`))}),s.onQuad(y=>{p.push(y),y.subject.termType==="BlankNode"||y.object.termType==="BlankNode"?g.push(y):d=ew(d,y)}),s.onComplete(async()=>{const w=g.length<=20?VC(g):[];d=g.filter(S=>w.every(R=>!R.equals(S.subject))).reduce((S,R)=>ew(S,R,{otherQuads:p,chainBlankNodes:w}),d);const b=be(Object.assign(Object.assign({},d),n));l(b)}),s.parse(a,n)})}async function xu(t,e=_n){var n;t=lt(t);const r=Object.assign(Object.assign({},_n),e),i=Object.keys((n=e.parsers)!==null&&n!==void 0?n:{}),o=i.length>0?i.join(", "):"text/turtle",s=await r.fetch(t,{headers:{Accept:o}});if(vu(s))throw new Eu(`Fetching the Resource at [${t}] failed: [${s.status}] [${s.statusText}].`,s);return await cP(s,e)}async function lP(t){const e=t.internal_changeLog.deletions.length>0?`DELETE DATA {${(await Eg(t.internal_changeLog.deletions.map(Tg))).trim()}};`:"",n=t.internal_changeLog.additions.length>0?`INSERT DATA {${(await Eg(t.internal_changeLog.additions.map(Tg))).trim()}};`:"";return{method:"PATCH",body:`${e} ${n}`,headers:{"Content-Type":"application/sparql-update"}}}async function uP(t){return{method:"PUT",body:await Eg(zC(t).map(Tg)),headers:{"Content-Type":"text/turtle","If-None-Match":"*",Link:`<${FC.Resource}>; rel="type"`}}}async function qb(t,e,n=_n){t=lt(t);const r=Object.assign(Object.assign({},_n),n),i=ZC(e),o=tw(i,t)?await lP(i):await uP(i),s=await r.fetch(t,o);if(vu(s)){const u=tw(i,t)?`The changes that were sent to the Pod are listed below.

`+hP(i):`The SolidDataset that was sent to the Pod is listed below.

`+fP(i);throw new Eu(`Storing the Resource at [${t}] failed: [${s.status}] [${s.statusText}].

`+u,s)}const a=Object.assign(Object.assign({},rm(s)),{isRawData:!1}),c=be(Object.assign(Object.assign({},e),{internal_changeLog:{additions:[],deletions:[]},internal_resourceInfo:a}));return mP(c)}function dP(t,e){return ac(t.internal_resourceInfo.sourceIri)===ac(e)}function tw(t,e){return Hc(t)&&Mf(t)&&typeof t.internal_resourceInfo.sourceIri=="string"&&dP(t,e)}function fP(t){let e="";Mf(t)?e+=`# SolidDataset: ${et(t)}
`:e+=`# SolidDataset (no URL yet)
`;const n=Vs(t);return n.length===0?e+=`
<empty>
`:n.forEach(r=>{e+=`
`+oP(r),Hc(t)&&(e+=`
`+gP(t,r)+`
`)}),e}function hP(t){if(!Mf(t))return"This is a newly initialized SolidDataset, so there is no source to compare it to.";if(!Hc(t)||t.internal_changeLog.additions.length===0&&t.internal_changeLog.deletions.length===0)return`## Changes compared to ${et(t)}

This SolidDataset has not been modified since it was fetched from ${et(t)}.
`;let e=`## Changes compared to ${et(t)}
`;const n=pP(t);return Object.keys(n).forEach(r=>{e+=`
### Thing: ${r}
`;const i=n[r];Object.keys(i).forEach(o=>{e+=`
Property: ${o}
`;const s=i[o].deleted,a=i[o].added;s.length>0&&(e+=`- Removed:
`,s.forEach(c=>e+=`  - ${Sg(c)}
`)),a.length>0&&(e+=`- Added:
`,a.forEach(c=>e+=`  - ${Sg(c)}
`))})}),e}function pP(t){const e={};return t.internal_changeLog.deletions.forEach(n=>{var r,i,o;const s=Q_(n.subject)?X_(n.subject,et(t)):n.subject;if(!yr(s)||!yr(n.predicate))return;const a=lt(s),c=lt(n.predicate);(r=e[a])!==null&&r!==void 0||(e[a]={}),(i=(o=e[a])[c])!==null&&i!==void 0||(o[c]={added:[],deleted:[]}),e[a][c].deleted.push(n.object)}),t.internal_changeLog.additions.forEach(n=>{var r,i,o;const s=Q_(n.subject)?X_(n.subject,et(t)):n.subject;if(!yr(s)||!yr(n.predicate))return;const a=lt(s),c=lt(n.predicate);(r=e[a])!==null&&r!==void 0||(e[a]={}),(i=(o=e[a])[c])!==null&&i!==void 0||(o[c]={added:[],deleted:[]}),e[a][c].added.push(n.object)}),e}function gP(t,e){const n=li.namedNode(e.url),r=t.internal_changeLog.additions.reduce((a,c)=>c.subject.equals(n)?a+1:a,0),i=t.internal_changeLog.deletions.reduce((a,c)=>c.subject.equals(n)?a+1:a,0),o=r===1?"1 new value added":r+" new values added",s=i===1?"1 value removed":i+" values removed";return`(${o} / ${s})`}function Tg(t){const e=yr(t.subject)?nw(t.subject):t.subject,n=yr(t.object)?nw(t.object):t.object;return li.quad(e,t.predicate,n,t.graph)}function nw(t){return co(t.value)?li.namedNode("#"+Zi(t.value)):t}function mP(t){const e=et(t),n=t.graphs.default,i=Object.keys(n).reduce((s,a)=>{const c=yP(s[a],e),l=co(a)?`${e}#${Zi(a)}`:a,u=Object.assign({},s);return delete u[a],u[l]=c,be(u)},n),o=be(Object.assign(Object.assign({},t.graphs),{default:i}));return be(Object.assign(Object.assign({},t),{graphs:o}))}function yP(t,e){const r=Object.keys(t.predicates).reduce((i,o)=>{var s;const a=(s=i[o].namedNodes)!==null&&s!==void 0?s:[];if(a.every(u=>!co(u)))return i;const c=be(a.map(u=>co(u)?`${e}#${Zi(u)}`:u)),l=be(Object.assign(Object.assign({},i[o]),{namedNodes:c}));return be(Object.assign(Object.assign({},i),{[o]:l}))},t.predicates);return be(Object.assign(Object.assign({},t),{predicates:r,url:co(t.url)?`${e}#${Zi(t.url)}`:t.url}))}function _P(t){const e=Wb();return Object.assign(Object.assign({},e),{internal_resourceInfo:{sourceIri:lt(t),isRawData:!1,contentType:"text/turtle",linkedResources:{}}})}const Uf=(t,e,n)=>{var r,i;if(ft(t),!Mn(e))throw new ti(e);if(!Tu(n)&&!Mn(n))throw new sm(n);const o=lt(e),s=(r=t.predicates[o])!==null&&r!==void 0?r:{},a=(i=s.namedNodes)!==null&&i!==void 0?i:[];let c;yr(n)?c=n.value:typeof n=="string"?c=n:Kc(n)?c=n.url:c=Au(n);const l=be(a.concat(lt(c))),u=be(Object.assign(Object.assign({},s),{namedNodes:l})),d=be(Object.assign(Object.assign({},t.predicates),{[o]:u}));return be(Object.assign(Object.assign({},t),{predicates:d}))},ut=Uf,Vb=(t,e,n)=>(ft(t),Gs(t,e,NC(n),Rn.boolean)),zb=(t,e,n)=>(ft(t),Gs(t,e,LC(n),Rn.dateTime)),Gb=(t,e,n)=>(ft(t),Gs(t,e,UC(n),Rn.date)),Yb=(t,e,n)=>(ft(t),Gs(t,e,OC(n),Rn.time)),Jb=(t,e,n)=>(ft(t),Gs(t,e,$C(n),Rn.decimal)),Zb=(t,e,n)=>(ft(t),Gs(t,e,BC(n),Rn.integer));function Vd(t,e,n,r){var i,o,s;if(ft(t),!Mn(e))throw new ti(e);const a=lt(e),c=bg(r),l=(i=t.predicates[a])!==null&&i!==void 0?i:{},u=(o=l.langStrings)!==null&&o!==void 0?o:{},d=(s=u[c])!==null&&s!==void 0?s:[],g=be(d.concat(n)),p=be(Object.assign(Object.assign({},u),{[c]:g})),y=be(Object.assign(Object.assign({},l),{langStrings:p})),w=be(Object.assign(Object.assign({},t.predicates),{[a]:y}));return be(Object.assign(Object.assign({},t),{predicates:w}))}const am=(t,e,n)=>(ft(t),Gs(t,e,n,Rn.string));function cm(t,e,n){return Uf(t,e,n.value)}function lm(t,e,n){if(ft(t),!Mn(e))throw new ti(e);return n.datatype.value===Rn.langString?Vd(t,e,n.value,n.language):Gs(t,e,n.value,n.datatype.value)}function Qb(t,e,n){var r,i;if(n.termType==="NamedNode")return cm(t,e,n);if(n.termType==="Literal")return lm(t,e,n);if(n.termType==="BlankNode"){if(ft(t),!Mn(e))throw new ti(e);const o=lt(e),s=(r=t.predicates[o])!==null&&r!==void 0?r:{},a=(i=s.blankNodes)!==null&&i!==void 0?i:[],c=be(a.concat(Db(n))),l=be(Object.assign(Object.assign({},s),{blankNodes:c})),u=be(Object.assign(Object.assign({},t.predicates),{[o]:l}));return be(Object.assign(Object.assign({},t),{predicates:u}))}throw new Error(`Term type [${n.termType}] is not supported by @inrupt/solid-client.`)}function Gs(t,e,n,r){var i,o,s;if(ft(t),!Mn(e))throw new ti(e);const a=lt(e),c=(i=t.predicates[a])!==null&&i!==void 0?i:{},l=(o=c.literals)!==null&&o!==void 0?o:{},u=(s=l[r])!==null&&s!==void 0?s:[],d=be(u.concat(n)),g=be(Object.assign(Object.assign({},l),{[r]:d})),p=be(Object.assign(Object.assign({},c),{literals:g})),y=be(Object.assign(Object.assign({},t.predicates),{[a]:p}));return be(Object.assign(Object.assign({},t),{predicates:y}))}function Hn(t,e){if(ft(t),!Mn(e))throw new ti(e);const n=lt(e),r=Object.assign({},t.predicates);return delete r[n],be(Object.assign(Object.assign({},t),{predicates:be(r)}))}const um=(t,e,n)=>{var r,i,o;if(ft(t),!Mn(e))throw new ti(e);const s=lt(e);if(!Tu(n)&&!Mn(n))throw new sm(n);const a=yr(n)?n.value:typeof n=="string"?n:Au(n),c=be((o=(i=(r=t.predicates[s])===null||r===void 0?void 0:r.namedNodes)===null||i===void 0?void 0:i.filter(d=>d.toLowerCase()!==a.toLowerCase()))!==null&&o!==void 0?o:[]),l=be(Object.assign(Object.assign({},t.predicates[s]),{namedNodes:c})),u=be(Object.assign(Object.assign({},t.predicates),{[s]:l}));return be(Object.assign(Object.assign({},t),{predicates:u}))},Yt=um,wP=(t,e,n)=>(ft(t),Ha(t,e,Rn.boolean,r=>Cb(r)===n)),vP=(t,e,n)=>(ft(t),Ha(t,e,Rn.dateTime,r=>{var i;return((i=Pb(r))===null||i===void 0?void 0:i.getTime())===n.getTime()})),bP=(t,e,n)=>(ft(t),Ha(t,e,Rn.date,function(r){const i=jC(r);return i?i.getFullYear()===n.getFullYear()&&i.getMonth()===n.getMonth()&&i.getDate()===n.getDate():!1})),EP=(t,e,n)=>(ft(t),Ha(t,e,Rn.time,function(r){const i=MC(r);return i?i.hour===n.hour&&i.minute===n.minute&&i.second===n.second&&i.millisecond===n.millisecond&&i.timezoneHourOffset===n.timezoneHourOffset&&i.timezoneMinuteOffset===n.timezoneMinuteOffset:!1})),SP=(t,e,n)=>(ft(t),Ha(t,e,Rn.decimal,r=>Ob(r)===n)),TP=(t,e,n)=>(ft(t),Ha(t,e,Rn.integer,r=>Mb(r)===n));function Ag(t,e,n,r){var i,o;if(ft(t),!Mn(e))throw new ti(e);const s=lt(e),a=(o=(i=t.predicates[s])===null||i===void 0?void 0:i.langStrings)!==null&&o!==void 0?o:{},c=Object.keys(a).find(y=>bg(y)===bg(r)&&Array.isArray(a[y])&&a[y].length>0);if(typeof c!="string")return t;const l=a[c],u=be(l.filter(y=>y!==n)),d=be(Object.assign(Object.assign({},a),{[c]:u})),g=be(Object.assign(Object.assign({},t.predicates[s]),{langStrings:d})),p=be(Object.assign(Object.assign({},t.predicates),{[s]:g}));return be(Object.assign(Object.assign({},t),{predicates:p}))}const Xb=(t,e,n)=>(ft(t),Ha(t,e,Rn.string,r=>r===n));function AP(t,e,n){return um(t,e,n.value)}function xP(t,e,n){var r,i,o;if(ft(t),!Mn(e))throw new ti(e);const s=n.datatype.value;if(s===Rn.langString)return Ag(t,e,n.value,n.language);const a=lt(e),c=(r=t.predicates[a])!==null&&r!==void 0?r:{},l=(i=c.literals)!==null&&i!==void 0?i:{},u=(o=l[s])!==null&&o!==void 0?o:[],d=be(u.filter(E=>E!==n.value)),g=be(Object.assign(Object.assign({},l),{[s]:d})),p=be(Object.assign(Object.assign({},c),{literals:g})),y=be(Object.assign(Object.assign({},t.predicates),{[a]:p}));return be(Object.assign(Object.assign({},t),{predicates:y}))}function Ha(t,e,n,r){var i,o,s;if(!Mn(e))throw new ti(e);const a=lt(e),c=(i=t.predicates[a])!==null&&i!==void 0?i:{},l=(o=c.literals)!==null&&o!==void 0?o:{},u=(s=l[n])!==null&&s!==void 0?s:[],d=be(u.filter(E=>!r(E))),g=be(Object.assign(Object.assign({},l),{[n]:d})),p=be(Object.assign(Object.assign({},c),{literals:g})),y=be(Object.assign(Object.assign({},t.predicates),{[a]:p}));return be(Object.assign(Object.assign({},t),{predicates:y}))}const Ys=(t,e,n)=>{if(ft(t),!Mn(e))throw new ti(e);if(!Tu(n)&&!Mn(n))throw new sm(n);return Uf(Hn(t,e),e,n)},Ni=Ys,IP=(t,e,n)=>(ft(t),Vb(Hn(t,e),e,n)),RP=(t,e,n)=>(ft(t),zb(Hn(t,e),e,n)),kP=(t,e,n)=>(ft(t),Gb(Hn(t,e),e,n)),FP=(t,e,n)=>(ft(t),Yb(Hn(t,e),e,n)),DP=(t,e,n)=>(ft(t),Jb(Hn(t,e),e,n)),CP=(t,e,n)=>(ft(t),Zb(Hn(t,e),e,n));function rw(t,e,n,r){return ft(t),Vd(Hn(t,e),e,n,r)}const PP=(t,e,n)=>(ft(t),am(Hn(t,e),e,n));function NP(t,e,n){return ft(t),cm(Hn(t,e),e,n)}function OP(t,e,n){return ft(t),lm(Hn(t,e),e,n)}function MP(t,e,n){if(ft(t),!Mn(e))throw new ti(e);return Qb(Hn(t,e),e,n)}function lo(t=di()){let e=Tu(t)?t:di(t);function n(s){return(a,c)=>(e=s(e,a,c),o)}function r(s){return(a,c)=>(e=s(e,a,c),o)}function i(s){return(a,c)=>(e=s(e,a,c),o)}const o={build:()=>e,addUrl:n(Uf),addIri:n(ut),addBoolean:n(Vb),addDatetime:n(zb),addDate:n(Gb),addTime:n(Yb),addDecimal:n(Jb),addInteger:n(Zb),addStringNoLocale:n(am),addStringEnglish:(s,a)=>(e=Vd(e,s,a,"en"),o),addStringWithLocale:(s,a,c)=>(e=Vd(e,s,a,c),o),addNamedNode:n(cm),addLiteral:n(lm),addTerm:n(Qb),setUrl:r(Ys),setIri:r(Ni),setBoolean:r(IP),setDatetime:r(RP),setDate:r(kP),setTime:r(FP),setDecimal:r(DP),setInteger:r(CP),setStringNoLocale:r(PP),setStringEnglish:(s,a)=>(e=rw(e,s,a,"en"),o),setStringWithLocale:(s,a,c)=>(e=rw(e,s,a,c),o),setNamedNode:r(NP),setLiteral:r(OP),setTerm:r(MP),removeAll:s=>(e=Hn(e,s),o),removeUrl:i(um),removeIri:i(Yt),removeBoolean:i(wP),removeDatetime:i(vP),removeDate:i(bP),removeTime:i(EP),removeDecimal:i(SP),removeInteger:i(TP),removeStringNoLocale:i(Xb),removeStringEnglish:(s,a)=>lo(Ag(e,s,a,"en")),removeStringWithLocale:(s,a,c)=>lo(Ag(e,s,a,c)),removeNamedNode:i(AP),removeLiteral:i(xP)};return o}function eE(t){const e=CC(t).type;return Array.isArray(e)&&e.includes(ue.AccessControlResource)}async function dm(t,e=_n){if(!Ka(t))return{resourceAcl:null,fallbackAcl:null};try{const n=await tE(t,e);return n===null?{resourceAcl:null,fallbackAcl:await nE(t,e)}:{resourceAcl:n,fallbackAcl:null}}catch(n){if(n instanceof xg)return{resourceAcl:null,fallbackAcl:null};throw n}}async function tE(t,e=_n){if(!Ka(t))return null;try{const n=await xu(t.internal_resourceInfo.aclUrl,e);if(eE(n))throw new xg(t,n);return be(Object.assign(Object.assign({},n),{internal_accessTo:et(t)}))}catch(n){if(n instanceof xg)throw n;return null}}async function nE(t,e=_n){const n=new URL(et(t)),r=n.pathname;if(r==="/")return null;const i=LP(r),o=new URL(i,n.origin).href,s=await bu(o,e);if(!Ka(s))return null;const a=await tE(s,e);return a===null?nE(s,e):a}function LP(t){const e=t.substring(t.length-1)==="/"?t.substring(0,t.length-1):t;return t.substring(0,e.lastIndexOf("/"))+"/"}const qi={read:"http://www.w3.org/ns/auth/acl#Read",append:"http://www.w3.org/ns/auth/acl#Append",write:"http://www.w3.org/ns/auth/acl#Write",control:"http://www.w3.org/ns/auth/acl#Control"};function fm(t,e){return Object.assign(wu(t),{internal_acl:e})}class xg extends Error{constructor(e,n){super(`[${va(e)}] is governed by Access Control Policies in [${va(n)}] rather than by Web Access Control.`)}}function Ka(t){return typeof t.internal_resourceInfo.aclUrl=="string"}S1.dataset;function gt(t){if(!qc(t))throw new Error(`An Access Control Resource for [${et(t)}] is not available. This could be because the current user is not allowed to see it, or because their Pod Server does not support Access Control Resources.`);return t.internal_acp.acr}function Wr(t,e){return Object.assign(wu(t),{internal_acp:Object.assign(Object.assign({},t.internal_acp),{acr:e})})}function rE(t){let e=di(t);return e=Ni(e,ui.type,ue.AccessControl),e}function UP(t,e,n){const r=gt(t),i=wn(r,e,n);return i===null||!st(i,ui.type).includes(ue.AccessControl)?null:i}function ps(t,e){const n=gt(t),r=Vs(n,e),i=r.filter(s=>st(s,ui.type).includes(ue.AccessControl)),o=r.filter(s=>st(s,ue.accessControl).length>0).map(s=>{const a=st(s,ue.accessControl)[0];return di({url:a})});return i.concat(o)}function Wa(t,e){const n=gt(t),r=Kr(n,e);return Wr(t,r)}function iE(t,e){return ut(t,ue.apply,e)}function oE(t){return st(t,ue.apply)}function sE(t,e){return Yt(t,ue.apply,e)}function aE(t){return Hn(t,ue.apply)}function cE(t,e){return ut(t,ue.applyMembers,e)}function Ig(t){return st(t,ue.applyMembers)}function jP(t,e){return Yt(t,ue.applyMembers,e)}function lE(t){return Hn(t,ue.applyMembers)}function uE(t){const e=ps(t);return e.length===0?rE():e[0]}function Iu(t){return yu(t)&&Array.isArray(t.internal_resourceInfo.linkedResources[ue.accessControl])&&t.internal_resourceInfo.linkedResources[ue.accessControl].length===1}function jf(t,e){var n;const r=gt(t),i=et(r);let o=(n=wn(r,i))!==null&&n!==void 0?n:di({url:i});o=ut(o,ue.access,e);const s=Kr(r,o);return Wr(t,s)}function hm(t,e){var n;const r=gt(t),i=et(r);let o=(n=wn(r,i))!==null&&n!==void 0?n:di({url:i});o=ut(o,ue.accessMembers,e);const s=Kr(r,o);return Wr(t,s)}function qa(t){const e=gt(t),n=et(e),r=wn(e,n);return r===null?[]:st(r,ue.access)}function Ru(t){const e=gt(t),n=et(e),r=wn(e,n);return r===null?[]:st(r,ue.accessMembers)}function $f(t,e){const n=gt(t),r=et(n),i=wn(n,r);if(i===null)return t;const o=Yt(i,ue.access,e),s=Kr(n,o);return Wr(t,s)}function pm(t,e){const n=gt(t),r=et(n),i=wn(n,r);if(i===null)return t;const o=Yt(i,ue.accessMembers,e),s=Kr(n,o);return Wr(t,s)}function Bf(t){const e=gt(t),n=et(e),r=wn(e,n);if(r===null)return t;const i=Hn(r,ue.access),o=Kr(e,i);return Wr(t,o)}function Hf(t){const e=gt(t),n=et(e),r=wn(e,n);if(r===null)return t;const i=Hn(r,ue.accessMembers),o=Kr(e,i);return Wr(t,o)}function gm(t,e){const n=uE(t),r=iE(n,e);return Wa(t,r)}function dE(t,e){const n=uE(t),r=cE(n,e);return Wa(t,r)}function Wc(t){const n=ps(t).map(i=>oE(i)),r=new Set;return n.forEach(i=>{i.forEach(o=>r.add(o))}),Array.from(r)}function Kf(t){const n=ps(t).map(i=>Ig(i)),r=new Set;return n.forEach(i=>{i.forEach(o=>r.add(o))}),Array.from(r)}function mm(t,e){return ps(t).map(o=>sE(o,e)).reduce(Wa,t)}function fE(t,e){return ps(t).map(o=>jP(o,e)).reduce(Wa,t)}function ym(t){return ps(t).map(i=>aE(i)).reduce(Wa,t)}function _m(t){return ps(t).map(i=>lE(i)).reduce(Wa,t)}function hE(t){let e=`# Access controls for ${et(t)}
`;const n=Wc(t),r=Kf(t),i=qa(t),o=Ru(t);return n.length===0&&r.length===0&&i.length===0&&o.length===0&&(e+=`
<no policies specified yet>
`),n.length>0&&(e+=`
The following policies apply to this resource:
- `,e+=n.join(`
- `)+`
`),i.length>0&&(e+=`
The following policies apply to the access control resource for this resource:
- `,e+=i.join(`
- `)+`
`),r.length>0&&(e+=`
The following policies apply to the children of this resource:
- `,e+=r.join(`
- `)+`
`),o.length>0&&(e+=`
The following policies apply to the access control resources for children of this resource:
- `,e+=o.join(`
- `)+`
`),e}const hr="http://www.w3.org/ns/solid/acp#",Ut={AccessControl:hr.concat("AccessControl"),AccessControlResource:hr.concat("AccessControlResource"),AuthenticatedAgent:hr.concat("AuthenticatedAgent"),CreatorAgent:hr.concat("CreatorAgent"),Matcher:hr.concat("Matcher"),Policy:hr.concat("Policy"),PublicAgent:hr.concat("PublicAgent"),access:hr.concat("access"),accessControl:hr.concat("accessControl"),agent:hr.concat("agent"),allOf:hr.concat("allOf"),allow:hr.concat("allow"),anyOf:hr.concat("anyOf"),apply:hr.concat("apply"),client:hr.concat("client"),deny:hr.concat("deny"),memberAccessControl:hr.concat("memberAccessControl"),noneOf:hr.concat("noneOf"),vc:hr.concat("vc")},Qu="http://www.w3.org/ns/auth/acl#",wc={Append:Qu.concat("Append"),Control:Qu.concat("Control"),Read:Qu.concat("Read"),Write:Qu.concat("Write")},$P="http://www.w3.org/ns/solid/vc#SolidAccessGrant";function ku(t){const e=gt(t),n=et(e);return wn(e,n)}const Rg="defaultAccessControl",kg="defaultAcrAccessControl",Fg="defaultMemberAccessControl",Dg="defaultMemberAcrAccessControl";function pE(t,e){const n=gt(t);return et(n).concat("#").concat(e)}function zo(t,e){const n=gt(t),r=pE(t,e),i=wn(n,r);return i===null||typeof i=="undefined"?di({url:r}):i}function gE(t,e){const n=st(t,e);return{read:n.includes(wc.Read),append:n.includes(wc.Append),write:n.includes(wc.Write),controlRead:!1,controlWrite:!1}}function BP(t,e){return Object.assign(wu(t),{internal_acp:{acr:e}})}function HP(t,e,n){let r=Hn(t,n);return(e.read||e.controlRead)&&(r=ut(r,n,wc.Read)),e.append&&(r=ut(r,n,wc.Append)),(e.write||e.controlWrite)&&(r=ut(r,n,wc.Write)),r}const mE="defaultVcPolicy",yE="defaultVcMatcher";function KP(t,e){var n,r;let i=gt(t);const o=`${va(i)}#${mE}`,s=`${va(i)}#${yE}`;let a=zo(t,"defaultAccessControl"),c=(n=ku(t))!==null&&n!==void 0?n:lo({url:va(i)}).addIri(Ut.accessControl,a).build();st(c,Ut.accessControl).includes(Au(a))||(c=ut(c,Ut.accessControl,a));let l=wn(i,o);l===null&&(l=lo({url:o}).addIri(ui.type,Ut.Policy).addIri(Ut.anyOf,s).build(),a=ut(a,Ut.apply,l));const u=(r=wn(i,s))!==null&&r!==void 0?r:lo({url:s}).addIri(ui.type,Ut.Matcher).addIri(Ut.vc,$P).build(),d=gE(l,Ut.allow);return l=HP(l,Object.assign(Object.assign({},d),e),Ut.allow),i=[c,a,l,u].reduce(Kr,i),BP(t,i)}const vp={read:!1,append:!1,write:!1,controlRead:!1,controlWrite:!1},bp=(t,e,n)=>st(t,e).includes(Au(n));function WP(t){const e=gt(t),n=zo(t,"defaultAccessControl"),r=ku(t);if(r===null||!bp(r,Ut.accessControl,n))return vp;const i=`${va(e)}#${mE}`,o=wn(e,i);if(o===null||!bp(n,Ut.apply,o))return vp;const s=`${va(e)}#${yE}`,a=wn(e,s);return a===null||!bp(o,Ut.anyOf,a)?vp:gE(o,Ut.allow)}async function Wf(t,e=_n){const n=lt(t),r=Object.assign(Object.assign({},_n),e),i=await xu(n,r),o=await Va(i,r);return Object.assign(Object.assign({},i),o)}async function qf(t,e=_n){const n=lt(t),r=Object.assign(Object.assign({},_n),e),i=await Fb(n,r),o=await Va(i,r);return Object.assign(i,o)}async function Vf(t,e=_n){const n=lt(t),r=Object.assign(Object.assign({},_n),e),i=await bu(n,r),o=await Va(i,r);return Object.assign(Object.assign({},i),o)}async function zf(t,e=_n){const n=lt(t),r=Object.assign(Object.assign({},_n),e),i=await xu(n,r);if(Ka(i)){const o=await dm(i,r);return fm(i,o)}else{const o=await Va(i,r);return Object.assign(Object.assign({},i),o)}}async function Gf(t,e=_n){const n=lt(t),r=Object.assign(Object.assign({},_n),e),i=await Fb(n,r);if(Ka(i)){const o=await dm(i,r);return fm(i,o)}else{const o=await Va(i,r);return Object.assign(i,o)}}async function Yf(t,e=_n){const n=lt(t),r=Object.assign(Object.assign({},_n),e),i=await bu(n,r);if(Ka(i)){const o=await dm(i,r);return fm(i,o)}else{const o=await Va(i,r);return Object.assign(Object.assign({},i),o)}}async function Jf(t,e=_n){const n=gt(t),r=Object.assign(Object.assign({},_n),e),i=await qb(et(n),n,r);return Wr(t,i)}function qc(t){return typeof t.internal_acp=="object"&&t.internal_acp!==null&&typeof t.internal_acp.acr=="object"&&t.internal_acp.acr!==null}async function Va(t,e){let n;if(Iu(t))n=t.internal_resourceInfo.linkedResources[ue.accessControl][0];else if(Ka(t)){const s=await bu(t.internal_resourceInfo.aclUrl,e);eE(s)&&(n=et(s))}if(typeof n!="string")return{internal_acp:{acr:null}};let r;try{r=await xu(n,e)}catch{return{internal_acp:{acr:null}}}return{internal_acp:{acr:Object.assign(Object.assign({},r),{accessTo:et(t)})}}}function Zf(t){const e=Wc(t).map(ac).concat(Kf(t).map(ac)).concat(qa(t).map(ac)).concat(Ru(t).map(ac));return Array.from(new Set(e))}async function _E(t,e=_n){const n=lt(t),r=Object.assign(Object.assign({},_n),e),i=await bu(n,r);return qc(await Va(i,r))}function qP(t){return yu(t)?[ue.accessControl,"acl"].map(n=>{if(Array.isArray(t.internal_resourceInfo.linkedResources[n])&&t.internal_resourceInfo.linkedResources[n].length===1)return t.internal_resourceInfo.linkedResources[n][0]}).find(n=>n!==void 0):void 0}function wm(t){return st(t,ui.type).includes(ue.Rule)}function vm(t,e){return ut(t,ue.allOf,e)}function bm(t,e){return Yt(t,ue.allOf,e)}function Em(t,e){return Ni(t,ue.allOf,e)}function Qf(t){return st(t,ue.allOf)}function Sm(t,e){return ut(t,ue.anyOf,e)}function Tm(t,e){return Yt(t,ue.anyOf,e)}function Am(t,e){return Ni(t,ue.anyOf,e)}function Xf(t){return st(t,ue.anyOf)}function xm(t,e){return ut(t,ue.noneOf,e)}function Im(t,e){return Yt(t,ue.noneOf,e)}function Rm(t,e){return Ni(t,ue.noneOf,e)}function Vc(t){return st(t,ue.noneOf)}function km(t){const e=lt(t);let n=di({url:e});return n=Ys(n,ui.type,ue.Rule),n}function VP(t,e){const n=gt(t),r=new URL(et(n));r.hash=`#${e}`;let i=di({url:r.href});return i=Ys(i,ui.type,ue.Rule),i}function Fm(t,e){const n=wn(t,e);return n===null||QC(n,ui.type)!==ue.Rule?null:n}function wE(t,e){const n=gt(t),r=et(n),i=new URL(r);i.hash=`#${e}`;const o=wn(n,i.href);return o===null||!wm(o)?null:o}function Dm(t){return Vs(t).filter(wm)}function zP(t){const e=gt(t);return Vs(e).filter(wm)}function Cm(t,e){return zs(t,e)}function GP(t,e){const n=gt(t);let r;if(typeof e=="string")try{new URL(e),r=e}catch{const c=new URL(et(n));c.hash=`#${e}`,r=c.href}else yr(e)?r=lt(e):r=ys(e);const i=wE(t,new URL(r).hash.substring(1));if(i===null)return t;const o=zs(n,i);return Wr(t,o)}function Pm(t,e){return Kr(t,e)}function YP(t,e){const n=gt(t),r=Kr(n,e);return Wr(t,r)}function eh(t){return st(t,ue.agent).filter(e=>e!==ue.PublicAgent&&e!==ue.AuthenticatedAgent&&e!==ue.CreatorAgent)}function Nm(t,e){const n=Fu(t),r=Du(t),i=Cu(t);let o=Ni(t,ue.agent,e);return n&&(o=$m(o)),r&&(o=Bm(o)),i&&(o=Hm(o)),o}function Om(t,e){return ut(t,ue.agent,e)}function Mm(t,e){return Yt(t,ue.agent,e)}function th(t){return st(t,ue.group)}function Lm(t,e){return Ni(t,ue.group,e)}function Um(t,e){return ut(t,ue.group,e)}function jm(t,e){return Yt(t,ue.group,e)}function Fu(t){return st(t,ue.agent).filter(e=>e===ue.PublicAgent).length>0}function $m(t){if(typeof arguments=="object"&&typeof arguments[1]=="boolean")throw new Error("The function `setPublic` no longer takes a second parameter. It is now used together with `removePublic` instead.");return ut(t,ue.agent,ue.PublicAgent)}function vE(t){return Yt(t,ue.agent,ue.PublicAgent)}function Du(t){return st(t,ue.agent).filter(e=>e===ue.AuthenticatedAgent).length>0}function Bm(t){if(typeof arguments=="object"&&typeof arguments[1]=="boolean")throw new Error("The function `setAuthenticated` no longer takes a second parameter. It is now used together with `removeAuthenticated` instead.");return ut(t,ue.agent,ue.AuthenticatedAgent)}function bE(t){return Yt(t,ue.agent,ue.AuthenticatedAgent)}function Cu(t){return st(t,ue.agent).filter(e=>e===ue.CreatorAgent).length>0}function Hm(t){if(typeof arguments=="object"&&typeof arguments[1]=="boolean")throw new Error("The function `setCreator` no longer takes a second parameter. It is now used together with `removeCreator` instead.");return ut(t,ue.agent,ue.CreatorAgent)}function EE(t){return Yt(t,ue.agent,ue.CreatorAgent)}function SE(t){return st(t,ue.client).filter(e=>e!==qs.PublicOidcClient)}function JP(t,e){const n=Km(t);let r=Ni(t,ue.client,e);return n&&(r=TE(r)),r}function ZP(t,e){return ut(t,ue.client,e)}function QP(t,e){return Yt(t,ue.client,e)}function Km(t){return st(t,ue.client).filter(e=>e===qs.PublicOidcClient).length>0}function TE(t){return ut(t,ue.client,qs.PublicOidcClient)}function XP(t){return Yt(t,ue.client,qs.PublicOidcClient)}function Wm(t){let e=`## Rule: ${ys(t)}

`,n="";Fu(t)&&(n+=`- Everyone
`),Du(t)&&(n+=`- All authenticated agents
`),Cu(t)&&(n+=`- The creator of this resource
`),Km(t)&&(n+=`- Users of any client application
`);const r=eh(t);r.length>0&&(n+=`- The following agents:
  - `,n+=r.join(`
  - `)+`
`);const i=th(t);i.length>0&&(n+=`- Members of the following groups:
  - `,n+=i.join(`
  - `)+`
`);const o=SE(t);return o.length>0&&(n+=`- Users of the following client applications:
  - `,n+=o.join(`
  - `)+`
`),e+=n.length>0?`This rule applies to:
`+n:`<empty>
`,e}function zc(t){return st(t,ui.type).includes(ue.Policy)}function nh(t){const e=lt(t);let n=di({url:e});return n=Ys(n,ui.type,ue.Policy),n}function rh(t,e){const n=wn(t,e);return n===null||!zc(n)?null:n}function ih(t){return Vs(t).filter(r=>!Kc(r)&&zc(r))}function oh(t,e){return zs(t,e)}function sh(t,e){return Kr(t,e)}function eN(t,e){let n=Hn(t,ue.allow);return e.read===!0&&(n=ut(n,ue.allow,qi.read)),e.append===!0&&(n=ut(n,ue.allow,qi.append)),e.write===!0&&(n=ut(n,ue.allow,qi.write)),n}function qm(t,e){let n=Hn(t,ue.allow);return e.read===!0&&(n=ut(n,ue.allow,ue.Read)),e.append===!0&&(n=ut(n,ue.allow,ue.Append)),e.write===!0&&(n=ut(n,ue.allow,ue.Write)),n}function tN(t){const e=st(t,ue.allow);return{read:e.includes(qi.read),append:e.includes(qi.append),write:e.includes(qi.write)}}function ah(t){const e=st(t,ue.allow);return{read:e.includes(ue.Read),append:e.includes(ue.Append),write:e.includes(ue.Write)}}function nN(t,e){let n=Hn(t,ue.deny);return e.read===!0&&(n=ut(n,ue.deny,qi.read)),e.append===!0&&(n=ut(n,ue.deny,qi.append)),e.write===!0&&(n=ut(n,ue.deny,qi.write)),n}function Vm(t,e){let n=Hn(t,ue.deny);return e.read===!0&&(n=ut(n,ue.deny,ue.Read)),e.append===!0&&(n=ut(n,ue.deny,ue.Append)),e.write===!0&&(n=ut(n,ue.deny,ue.Write)),n}function rN(t){const e=st(t,ue.deny);return{read:e.includes(qi.read),append:e.includes(qi.append),write:e.includes(qi.write)}}function ch(t){const e=st(t,ue.deny);return{read:e.includes(ue.Read),append:e.includes(ue.Append),write:e.includes(ue.Write)}}function AE(t,e){const n=gt(t),r=new URL(et(n));r.hash=`#${e}`;let i=di({url:r.href});return i=Ys(i,ui.type,ue.Policy),i}function zm(t,e){const n=gt(t),r=et(n),i=new URL(r);i.hash=`#${e}`;const o=wn(n,i.href);return!Wc(t).includes(i.href)||o===null||!zc(o)?null:o}function Gm(t,e){const n=gt(t),r=et(n),i=new URL(r);i.hash=`#${e}`;const o=wn(n,i.href);return!qa(t).includes(i.href)||o===null||!zc(o)?null:o}function xE(t){const e=gt(t);return Wc(t).map(o=>wn(e,o)).filter(o=>o!==null&&zc(o))}function IE(t){const e=gt(t);return qa(t).map(o=>wn(e,o)).filter(o=>o!==null&&zc(o))}function RE(t,e){const n=gt(t);let r=e;if(typeof r=="string")try{new URL(r)}catch{const l=new URL(et(n));l.hash=`#${e}`,r=l.href}let i;if(typeof r=="string"?i=r:yr(r)?i=lt(r):i=ys(r,et(n)),zm(t,new URL(i).hash.substring(1))===null)return t;const s=zs(n,r),a=Wr(t,s);return mm(a,i)}function kE(t,e){const n=gt(t);let r=e;if(typeof r=="string")try{new URL(r)}catch{const l=new URL(et(n));l.hash=`#${e}`,r=l.href}let i;if(typeof r=="string"?i=r:yr(r)?i=lt(r):i=ys(r,et(n)),Gm(t,new URL(i).hash.substring(1))===null)return t;const s=zs(n,r),a=Wr(t,s);return $f(a,i)}function iN(t,e){const n=gt(t),r=Kr(n,e),i=Wr(t,r),o=ys(e,et(n));return gm(i,o)}function oN(t,e){const n=gt(t),r=Kr(n,e),i=Wr(t,r),o=ys(e,et(n));return jf(i,o)}function Ym(t){function e(c,l){return l?"denied":c?"allowed":"unspecified"}const n=ah(t),r=ch(t);let i=`## Policy: ${ys(t)}

`;i+=`- Read: ${e(n.read,r.read)}
`,i+=`- Append: ${e(n.append,r.append)}
`,i+=`- Write: ${e(n.write,r.write)}
`;const o=Qf(t),s=Xf(t),a=Vc(t);return o.length===0&&s.length===0&&a.length===0&&(i+=`
<no rules specified yet>
`),o.length>0&&(i+=`
All of these rules should match:
`,i+="- "+o.join(`
- `)+`
`),s.length>0&&(i+=`
At least one of these rules should match:
`,i+="- "+s.join(`
- `)+`
`),a.length>0&&(i+=`
None of these rules should match:
`,i+="- "+a.join(`
- `)+`
`),i}function Pu(t){const e=new URL("access-control-resource",t).href;return Object.assign(Object.assign({},_P(e)),{accessTo:t})}function lh(t,e=Pu(et(t))){return Object.assign(wu(t),{internal_acp:{acr:e,aprs:{}}})}const sN={getFileWithAccessDatasets:Gf,getFileWithAcr:qf,getReferencedPolicyUrlAll:Zf,getResourceInfoWithAccessDatasets:Yf,getResourceInfoWithAcr:Vf,getSolidDatasetWithAccessDatasets:zf,getSolidDatasetWithAcr:Wf,hasAccessibleAcr:qc,saveAcrFor:Jf},aN={acrAsMarkdown:hE,addAcrPolicyUrl:jf,addMemberAcrPolicyUrl:hm,addMemberPolicyUrl:dE,addPolicyUrl:gm,getAcrPolicyUrlAll:qa,getMemberAcrPolicyUrlAll:Ru,getMemberPolicyUrlAll:Kf,getPolicyUrlAll:Wc,hasLinkedAcr:Iu,removeAcrPolicyUrl:$f,removeAcrPolicyUrlAll:Bf,removeMemberAcrPolicyUrl:pm,removeMemberAcrPolicyUrlAll:Hf,removeMemberPolicyUrl:fE,removeMemberPolicyUrlAll:_m,removePolicyUrl:mm,removePolicyUrlAll:ym},cN={createPolicy:nh,getAllowModes:ah,getDenyModes:ch,getPolicy:rh,getPolicyAll:ih,policyAsMarkdown:Ym,removePolicy:oh,setAllowModes:qm,setDenyModes:Vm,setPolicy:sh},lN={addAgent:Om,addForbiddenRuleUrl:xm,addGroup:Um,addOptionalRuleUrl:Sm,addRequiredRuleUrl:vm,createRule:km,getAgentAll:eh,getForbiddenRuleUrlAll:Vc,getGroupAll:th,getOptionalRuleUrlAll:Xf,getRequiredRuleUrlAll:Qf,getRule:Fm,getRuleAll:Dm,hasAuthenticated:Du,hasCreator:Cu,hasPublic:Fu,removeAgent:Mm,removeForbiddenRuleUrl:Im,removeGroup:jm,removeOptionalRuleUrl:Tm,removeRequiredRuleUrl:bm,removeRule:Cm,ruleAsMarkdown:Wm,setAgent:Nm,setForbiddenRuleUrl:Rm,setGroup:Lm,setOptionalRuleUrl:Am,setRequiredRuleUrl:Em,setRule:Pm},uN={addMockAcrTo:lh,mockAcrFor:Pu};function FE(t,e){return e?$m(t):vE(t)}function DE(t,e){return e?Bm(t):bE(t)}function CE(t,e){return e?Hm(t):EE(t)}const dN={getForbiddenRuleurlAll:Vc,setPublic:FE,setAuthenticated:DE,setCreator:CE};Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},sN),aN),cN),lN),uN),dN);const fN={getFileWithAccessDatasets:Gf,getFileWithAcr:qf,getReferencedPolicyUrlAll:Zf,getResourceInfoWithAccessDatasets:Yf,getResourceInfoWithAcr:Vf,getSolidDatasetWithAccessDatasets:zf,getSolidDatasetWithAcr:Wf,hasAccessibleAcr:qc,saveAcrFor:Jf},hN={createPolicy:nh,getAllowModes:ah,getDenyModes:ch,getPolicy:rh,getPolicyAll:ih,policyAsMarkdown:Ym,removePolicy:oh,setAllowModes:qm,setDenyModes:Vm,setPolicy:sh},pN={addAgent:Om,addForbiddenRuleUrl:xm,addGroup:Um,addOptionalRuleUrl:Sm,addRequiredRuleUrl:vm,createRule:km,getAgentAll:eh,getForbiddenRuleUrlAll:Vc,getGroupAll:th,getOptionalRuleUrlAll:Xf,getRequiredRuleUrlAll:Qf,getRule:Fm,getRuleAll:Dm,hasAuthenticated:Du,hasCreator:Cu,hasPublic:Fu,removeAgent:Mm,removeForbiddenRuleUrl:Im,removeGroup:jm,removeOptionalRuleUrl:Tm,removeRequiredRuleUrl:bm,removeRule:Cm,ruleAsMarkdown:Wm,setAgent:Nm,setForbiddenRuleUrl:Rm,setGroup:Lm,setOptionalRuleUrl:Am,setRequiredRuleUrl:Em,setRule:Pm},gN={addMockAcrTo:lh,mockAcrFor:Pu},mN={hasLinkedAcr:Iu,addAcrPolicyUrl:jf,addMemberAcrPolicyUrl:hm,getAcrPolicyUrlAll:qa,getMemberAcrPolicyUrlAll:Ru,removeAcrPolicyUrl:$f,removeAcrPolicyUrlAll:Bf,removeMemberAcrPolicyUrl:pm,removeMemberAcrPolicyUrlAll:Hf},yN={createControl:rE,getControl:UP,getAllControl:ps,getControlAll:ps,setControl:Wa,removeControl:_N,addPolicyUrl:iE,getPolicyUrlAll:oE,removePolicyUrl:sE,removePolicyUrlAll:aE,addMemberPolicyUrl:cE,getMemberPolicyUrlAll:Ig,removeMemberPolicyUrl:Ig,removeMemberPolicyUrlAll:lE,getForbiddenRuleurlAll:Vc,setPublic:FE,setAuthenticated:DE,setCreator:CE};Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},fN),hN),pN),gN),mN),yN);function _N(t,e){const n=gt(t),r=zs(n,e);return Wr(t,r)}const wN={getFileWithAccessDatasets:Gf,getFileWithAcr:qf,getLinkedAcrUrl:qP,getReferencedPolicyUrlAll:Zf,getResourceInfoWithAccessDatasets:Yf,getResourceInfoWithAcr:Vf,getSolidDatasetWithAccessDatasets:zf,getSolidDatasetWithAcr:Wf,hasAccessibleAcr:qc,saveAcrFor:Jf,isAcpControlled:_E},vN={acrAsMarkdown:hE,addAcrPolicyUrl:jf,addMemberAcrPolicyUrl:hm,addMemberPolicyUrl:dE,addPolicyUrl:gm,getAcrPolicyUrlAll:qa,getMemberAcrPolicyUrlAll:Ru,getMemberPolicyUrlAll:Kf,getPolicyUrlAll:Wc,hasLinkedAcr:Iu,removeAcrPolicyUrl:$f,removeAcrPolicyUrlAll:Bf,removeMemberAcrPolicyUrl:pm,removeMemberAcrPolicyUrlAll:Hf,removeMemberPolicyUrl:fE,removeMemberPolicyUrlAll:_m,removePolicyUrl:mm,removePolicyUrlAll:ym},bN={createPolicy:nh,getAllowModes:ah,getDenyModes:ch,getPolicy:rh,getPolicyAll:ih,policyAsMarkdown:Ym,removePolicy:oh,setAllowModes:qm,setDenyModes:Vm,setPolicy:sh,createResourcePolicyFor:AE,getResourceAcrPolicy:Gm,getResourceAcrPolicyAll:IE,getResourcePolicy:zm,getResourcePolicyAll:xE,removeResourceAcrPolicy:kE,removeResourcePolicy:RE,setResourceAcrPolicy:oN,setResourcePolicy:iN},EN={addAgent:Om,addGroup:Um,createRule:km,getAgentAll:eh,getGroupAll:th,getRule:Fm,getRuleAll:Dm,removeAgent:Mm,removeGroup:jm,removeRule:Cm,ruleAsMarkdown:Wm,setAgent:Nm,setGroup:Lm,setRule:Pm,addClient:ZP,getClientAll:SE,hasAnyClient:Km,removeClient:QP,setAnyClient:TE,setClient:JP,removeAnyClient:XP,hasAuthenticated:Du,hasCreator:Cu,hasPublic:Fu,setAuthenticated:Bm,setCreator:Hm,setPublic:$m,removeAuthenticated:bE,removeCreator:EE,removePublic:vE,getAnyOfRuleUrlAll:Xf,addAnyOfRuleUrl:Sm,removeAnyOfRuleUrl:Tm,setAnyOfRuleUrl:Am,getAllOfRuleUrlAll:Qf,addAllOfRuleUrl:vm,removeAllOfRuleUrl:bm,setAllOfRuleUrl:Em,getNoneOfRuleUrlAll:Vc,addNoneOfRuleUrl:xm,removeNoneOfRuleUrl:Im,setNoneOfRuleUrl:Rm,createResourceRuleFor:VP,getResourceRule:wE,getResourceRuleAll:zP,removeResourceRule:GP,setResourceRule:YP},SN={addMockAcrTo:lh,mockAcrFor:Pu};Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},wN),vN),bN),EN),SN);function Go(t,e){return Object.assign(wu(t),{internal_acp:Object.assign(Object.assign({},t.internal_acp),{acr:Kr(t.internal_acp.acr,e)})})}function iw(t){return t.includes("Member")?Ut.memberAccessControl:Ut.accessControl}function uh(t,e){const n=pE(t,e),r=gt(t);let i=ku(t);return(i===null||typeof i=="undefined")&&(i=di({url:et(r)})),st(i,iw(e)).includes(n)?t:(i=lo(i).addUrl(iw(e),n).build(),Go(t,i))}function TN(t,e){const n=uh(t,kg),r=zo(n,kg);return Go(n,lo(r).addUrl(Ut.access,e).build())}function AN(t,e){const n=uh(t,Dg),r=zo(n,Dg);return Go(n,lo(r).addUrl(Ut.access,e).build())}function xN(t,e){const n=uh(t,Fg),r=zo(n,Fg);return Go(n,lo(r).addUrl(Ut.apply,e).build())}function IN(t,e){const n=uh(t,Rg),r=zo(n,Rg);return Go(n,lo(r).addUrl(Ut.apply,e).build())}function PE(t){const e=ku(t);return e===null?[]:st(e,Ut.accessControl)}function dh(t,e,n){const r=gt(t);return Array.from(new Set(e.map(i=>{const o=wn(r,i);return o!==null?st(o,n):[]}).reduce((i,o)=>i.concat(o),[])))}function RN(t){return dh(t,PE(t),Ut.access)}function NE(t){const e=ku(t);return e===null?[]:st(e,Ut.memberAccessControl)}function kN(t){return dh(t,NE(t),Ut.access)}function FN(t){return dh(t,NE(t),Ut.apply)}function DN(t){return dh(t,PE(t),Ut.apply)}function CN(t,e){const n=zo(t,kg);return Go(t,Yt(n,Ut.access,e))}function PN(t,e){const n=zo(t,Dg);return Go(t,Yt(n,Ut.access,e))}function NN(t,e){const n=zo(t,Fg);return Go(t,Yt(n,Ut.apply,e))}function ON(t,e){const n=zo(t,Rg);return Go(t,Yt(n,Ut.apply,e))}function MN(t,e){return Go(t,e)}function fh(t){return st(t,ui.type).includes(ue.Matcher)}function LN(t,e){return ut(t,ue.allOf,e)}function UN(t,e){return Yt(t,ue.allOf,e)}function jN(t,e){return Ni(t,ue.allOf,e)}function $N(t){return st(t,ue.allOf)}function BN(t,e){return ut(t,ue.anyOf,e)}function HN(t,e){return Yt(t,ue.anyOf,e)}function KN(t,e){return Ni(t,ue.anyOf,e)}function WN(t){return st(t,ue.anyOf)}function qN(t,e){return ut(t,ue.noneOf,e)}function VN(t,e){return Yt(t,ue.noneOf,e)}function zN(t,e){return Ni(t,ue.noneOf,e)}function GN(t){return st(t,ue.noneOf)}function YN(t){const e=lt(t);let n=di({url:e});return n=Ys(n,ui.type,ue.Matcher),n}function JN(t,e){const n=gt(t),r=new URL(et(n));r.hash=`#${e}`;let i=di({url:r.href});return i=Ys(i,ui.type,ue.Matcher),i}function ZN(t,e){const n=wn(t,e);return n===null||!fh(n)?null:n}function OE(t,e){const n=gt(t),r=et(n),i=new URL(r);i.hash=`#${e}`;const o=wn(n,i.href);return o===null||!fh(o)?null:o}function QN(t){return Vs(t).filter(fh)}function XN(t){const e=gt(t);return Vs(e).filter(fh)}function eO(t,e){return zs(t,e)}function tO(t,e){const n=gt(t);let r;if(typeof e=="string")try{new URL(e),r=e}catch{const c=new URL(et(n));c.hash=`#${e}`,r=c.href}else yr(e)?r=lt(e):r=ys(e);const i=OE(t,new URL(r).hash.substring(1));if(i===null)return t;const o=zs(n,i);return Wr(t,o)}function nO(t,e){return Kr(t,e)}function rO(t,e){const n=gt(t),r=Kr(n,e);return Wr(t,r)}function iO(t){return st(t,ue.agent).filter(e=>e!==ue.PublicAgent&&e!==ue.AuthenticatedAgent&&e!==ue.CreatorAgent)}function oO(t,e){const n=ME(t),r=UE(t),i=$E(t);let o=Ni(t,ue.agent,e);return n&&(o=LE(o)),r&&(o=jE(o)),i&&(o=BE(o)),o}function sO(t,e){return ut(t,ue.agent,e)}function aO(t,e){return Yt(t,ue.agent,e)}function ME(t){return st(t,ue.agent).filter(e=>e===ue.PublicAgent).length>0}function LE(t){if(typeof arguments=="object"&&typeof arguments[1]=="boolean")throw new Error("The function `setPublic` no longer takes a second parameter. It is now used together with `removePublic` instead.");return ut(t,ue.agent,ue.PublicAgent)}function cO(t){return Yt(t,ue.agent,ue.PublicAgent)}function UE(t){return st(t,ue.agent).filter(e=>e===ue.AuthenticatedAgent).length>0}function jE(t){if(typeof arguments=="object"&&typeof arguments[1]=="boolean")throw new Error("The function `setAuthenticated` no longer takes a second parameter. It is now used together with `removeAuthenticated` instead.");return ut(t,ue.agent,ue.AuthenticatedAgent)}function lO(t){return Yt(t,ue.agent,ue.AuthenticatedAgent)}function $E(t){return st(t,ue.agent).filter(e=>e===ue.CreatorAgent).length>0}function BE(t){if(typeof arguments=="object"&&typeof arguments[1]=="boolean")throw new Error("The function `setCreator` no longer takes a second parameter. It is now used together with `removeCreator` instead.");return ut(t,ue.agent,ue.CreatorAgent)}function uO(t){return Yt(t,ue.agent,ue.CreatorAgent)}function dO(t){return st(t,ue.client).filter(e=>e!==qs.PublicOidcClient).concat(eP(t,ue.client))}function fO(t,e){const n=HE(t);let r=Ni(t,ue.client,e);return n&&(r=KE(r)),r}function hO(t,e){return Mn(e)?ut(t,ue.client,e):am(t,ue.client,e)}function pO(t,e){return Mn(e)?Yt(t,ue.client,e):Xb(t,ue.client,e)}function HE(t){return st(t,ue.client).filter(e=>e===qs.PublicOidcClient).length>0}function KE(t){return ut(t,ue.client,qs.PublicOidcClient)}function gO(t){return Yt(t,ue.client,qs.PublicOidcClient)}const mO={getFileWithAccessDatasets:Gf,getFileWithAcr:qf,getReferencedPolicyUrlAll:Zf,getResourceInfoWithAccessDatasets:Yf,getResourceInfoWithAcr:Vf,getSolidDatasetWithAccessDatasets:zf,getSolidDatasetWithAcr:Wf,hasAccessibleAcr:qc,saveAcrFor:Jf,isAcpControlled:_E,getVcAccess:WP,setVcAccess:KP},yO={addAcrPolicyUrl:TN,addMemberAcrPolicyUrl:AN,addMemberPolicyUrl:xN,addPolicyUrl:IN,getAcrPolicyUrlAll:RN,getMemberAcrPolicyUrlAll:kN,getMemberPolicyUrlAll:FN,getPolicyUrlAll:DN,hasLinkedAcr:Iu,removeAcrPolicyUrl:CN,removeAcrPolicyUrlAll:Bf,removeMemberAcrPolicyUrl:PN,removeMemberAcrPolicyUrlAll:Hf,removeMemberPolicyUrl:NN,removeMemberPolicyUrlAll:_m,removePolicyUrl:ON,removePolicyUrlAll:ym},_O={createPolicy:nh,getAllowModes:tN,getDenyModes:rN,getPolicy:rh,getPolicyAll:ih,removePolicy:oh,setAllowModes:eN,setDenyModes:nN,setPolicy:sh,createResourcePolicyFor:AE,getResourceAcrPolicy:Gm,getResourceAcrPolicyAll:IE,getResourcePolicy:zm,getResourcePolicyAll:xE,removeResourceAcrPolicy:kE,removeResourcePolicy:RE,setResourcePolicy:MN},wO={addAgent:sO,createMatcher:YN,getAgentAll:iO,getMatcher:ZN,getMatcherAll:QN,removeAgent:aO,removeMatcher:eO,setAgent:oO,setMatcher:nO,addClient:hO,getClientAll:dO,hasAnyClient:HE,removeClient:pO,setAnyClient:KE,setClient:fO,removeAnyClient:gO,hasAuthenticated:UE,hasCreator:$E,hasPublic:ME,setAuthenticated:jE,setCreator:BE,setPublic:LE,removeAuthenticated:lO,removeCreator:uO,removePublic:cO,getAnyOfMatcherUrlAll:WN,addAnyOfMatcherUrl:BN,removeAnyOfMatcherUrl:HN,setAnyOfMatcherUrl:KN,getAllOfMatcherUrlAll:$N,addAllOfMatcherUrl:LN,removeAllOfMatcherUrl:UN,setAllOfMatcherUrl:jN,getNoneOfMatcherUrlAll:GN,addNoneOfMatcherUrl:qN,removeNoneOfMatcherUrl:VN,setNoneOfMatcherUrl:zN,createResourceMatcherFor:JN,getResourceMatcher:OE,getResourceMatcherAll:XN,removeResourceMatcher:tO,setResourceMatcher:rO},vO={addMockAcrTo:lh,mockAcrFor:Pu};Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},mO),yO),_O),wO),vO);var WE="http://www.w3.org/1999/02/22-rdf-syntax-ns#";function Dn(t){return WE+t}var bO={PREFIX:"rdf",NAMESPACE:WE,PREFIX_AND_NAMESPACE:{rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#"},NS:Dn,Property:Dn("Property"),HTML:Dn("HTML"),langString:Dn("langString"),PlainLiteral:Dn("PlainLiteral"),Statement:Dn("Statement"),Bag:Dn("Bag"),Seq:Dn("Seq"),Alt:Dn("Alt"),List:Dn("List"),XMLLiteral:Dn("XMLLiteral"),JSON:Dn("JSON"),CompoundLiteral:Dn("CompoundLiteral"),type:Dn("type"),subject:Dn("subject"),predicate:Dn("predicate"),object:Dn("object"),value:Dn("value"),nil:Dn("nil"),first:Dn("first"),rest:Dn("rest"),language:Dn("language"),direction:Dn("direction")},qE="http://schema.org/";function rt(t){return qE+t}var EO={PREFIX:"schema-inrupt",NAMESPACE:qE,PREFIX_AND_NAMESPACE:{"schema-inrupt":"http://schema.org/"},NS:rt,Organization:rt("Organization"),Person:rt("Person"),ImageObject:rt("ImageObject"),URL:rt("URL"),MedicalTherapy:rt("MedicalTherapy"),EducationalOccupationalCredential:rt("EducationalOccupationalCredential"),PostalAddress:rt("PostalAddress"),Product:rt("Product"),Event:rt("Event"),alternateName:rt("alternateName"),givenName:rt("givenName"),familyName:rt("familyName"),additionalName:rt("additionalName"),license:rt("license"),name:rt("name"),text:rt("text"),identifier:rt("identifier"),description:rt("description"),image:rt("image"),url:rt("url"),startTime:rt("startTime"),endTime:rt("endTime"),startDate:rt("startDate"),endDate:rt("endDate"),email:rt("email"),primaryPrevention:rt("primaryPrevention"),qualifications:rt("qualifications"),attendee:rt("attendee"),address:rt("address"),streetAddress:rt("streetAddress"),addressLocality:rt("addressLocality"),addressRegion:rt("addressRegion"),postalCode:rt("postalCode"),addressCountry:rt("addressCountry"),accessCode:rt("accessCode"),accountId:rt("accountId"),serialNumber:rt("serialNumber"),productID:rt("productID"),brand:rt("brand"),model:rt("model"),value:rt("value"),distance:rt("distance"),latitude:rt("latitude"),longitude:rt("longitude"),dateModified:rt("dateModified")};function SO(t){let e,n;return e=new c0({props:{src:G2,class:"cursor-pointer",size:"16"}}),{c(){Cn(e.$$.fragment)},l(r){Pn(e.$$.fragment,r)},m(r,i){Nn(e,r,i),n=!0},p:uo,i(r){n||(Le(e.$$.fragment,r),n=!0)},o(r){Je(e.$$.fragment,r),n=!1},d(r){On(e,r)}}}function TO(t){let e,n;return e=new c0({props:{src:Y2,class:"cursor-pointer",size:"16"}}),{c(){Cn(e.$$.fragment)},l(r){Pn(e.$$.fragment,r)},m(r,i){Nn(e,r,i),n=!0},p:uo,i(r){n||(Le(e.$$.fragment,r),n=!0)},o(r){Je(e.$$.fragment,r),n=!1},d(r){On(e,r)}}}function AO(t){let e;return{c(){e=mn("Create new event")},l(n){e=yn(n,"Create new event")},m(n,r){At(n,e,r)},d(n){n&&De(e)}}}function xO(t){let e,n;return e=new c0({props:{slot:"icon",src:J2,size:"16"}}),{c(){Cn(e.$$.fragment)},l(r){Pn(e.$$.fragment,r)},m(r,i){Nn(e,r,i),n=!0},p:uo,i(r){n||(Le(e.$$.fragment,r),n=!0)},o(r){Je(e.$$.fragment,r),n=!1},d(r){On(e,r)}}}function IO(t){let e,n,r,i,o,s,a,c,l,u,d,g,p,y,w,E;return o=new Uy({props:{filled:!0,$$slots:{default:[SO]},$$scope:{ctx:t}}}),o.$on("click",t[2]),a=new Uy({props:{filled:!0,$$slots:{default:[TO]},$$scope:{ctx:t}}}),a.$on("click",t[3]),d=new Aa({props:{$$slots:{icon:[xO],default:[AO]},$$scope:{ctx:t}}}),d.$on("click",Os.new),p=new qT({props:{firstname:"Abel",lastname:"de Bruijn"}}),p.$on("click",t[1]),w=new HT({props:{startOfWeek:t[0]}}),{c(){e=Pt("div"),n=Pt("h1"),r=mn("Your calendar"),i=en(),Cn(o.$$.fragment),s=en(),Cn(a.$$.fragment),c=en(),l=Pt("div"),u=en(),Cn(d.$$.fragment),g=en(),Cn(p.$$.fragment),y=en(),Cn(w.$$.fragment),this.h()},l(b){e=Nt(b,"DIV",{class:!0});var S=Lt(e);n=Nt(S,"H1",{class:!0});var R=Lt(n);r=yn(R,"Your calendar"),R.forEach(De),i=tn(S),Pn(o.$$.fragment,S),s=tn(S),Pn(a.$$.fragment,S),c=tn(S),l=Nt(S,"DIV",{class:!0}),Lt(l).forEach(De),u=tn(S),Pn(d.$$.fragment,S),g=tn(S),Pn(p.$$.fragment,S),S.forEach(De),y=tn(b),Pn(w.$$.fragment,b),this.h()},h(){it(n,"class","text-3xl font-bold underline"),it(l,"class","m-auto"),it(e,"class","flex py-5 px-4 justify-between items-center gap-4")},m(b,S){At(b,e,S),Me(e,n),Me(n,r),Me(e,i),Nn(o,e,null),Me(e,s),Nn(a,e,null),Me(e,c),Me(e,l),Me(e,u),Nn(d,e,null),Me(e,g),Nn(p,e,null),At(b,y,S),Nn(w,b,S),E=!0},p(b,[S]){const R={};S&1024&&(R.$$scope={dirty:S,ctx:b}),o.$set(R);const F={};S&1024&&(F.$$scope={dirty:S,ctx:b}),a.$set(F);const M={};S&1024&&(M.$$scope={dirty:S,ctx:b}),d.$set(M);const P={};S&1&&(P.startOfWeek=b[0]),w.$set(P)},i(b){E||(Le(o.$$.fragment,b),Le(a.$$.fragment,b),Le(d.$$.fragment,b),Le(p.$$.fragment,b),Le(w.$$.fragment,b),E=!0)},o(b){Je(o.$$.fragment,b),Je(a.$$.fragment,b),Je(d.$$.fragment,b),Je(p.$$.fragment,b),Je(w.$$.fragment,b),E=!1},d(b){b&&De(e),On(o),On(a),On(d),On(p),b&&De(y),On(w,b)}}}function RO(t,e,n){const r=ua.Now.plainDateISO();let i,o,s,a;function c(){return n(0,i=r.subtract({days:r.dayOfWeek-1})),i}cw(async()=>{c(),await ia.handleIncomingRedirect({restorePreviousSession:!0});const p=ia.getDefaultSession();a=window.location.href,o=localStorage.getItem("podUrl")||"http://localhost:3000",s=localStorage.getItem("webID")||"johndoe",p.info.isLoggedIn&&u()});async function l(){var p,y;o=(p=prompt("URL to identity provider/pod host:",o))!=null?p:o,s=(y=prompt("WebID: ",s))!=null?y:s,o.indexOf("//")<0&&(o="http://"+o),localStorage.setItem("podUrl",o),localStorage.setItem("webID",s),ia.getDefaultSession().info.isLoggedIn||await ia.login({oidcIssuer:o,clientName:"Project-IDLab",redirectUrl:a}),console.log("get data"),u()}async function u(){let p;console.log("ytest");let y="test2",w;console.log(`${o}/${s}/${y}`);try{p=await xu(`${o}/${s}/${y}`,{fetch:ia.fetch}),w=Vs(p),console.log(w)}catch(E){console.log(E),E.response.status==404&&(console.log("Dataset not found, creating new one"),p=Wb(),w=lo(di({name:"thingname"})).addStringNoLocale(EO.name,"Schema inrupt name").addUrl(bO.type,"https://schema.org/Thing").build())}console.log(w),p=Kr(p,w),await qb(`${o}/${s}/${y}`,p,{fetch:ia.fetch})}return[i,l,()=>n(0,i=i.subtract({weeks:1})),()=>n(0,i=i.add({weeks:1}))]}class WO extends ho{constructor(e){super(),po(this,e,RO,IO,go,{})}}export{WO as default};
